"use strict";var fU=Object.create;var Bd=Object.defineProperty;var pU=Object.getOwnPropertyDescriptor;var hU=Object.getOwnPropertyNames;var mU=Object.getPrototypeOf,gU=Object.prototype.hasOwnProperty;var oe=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),_U=(t,e)=>{for(var n in e)Bd(t,n,{get:e[n],enumerable:!0})},LR=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of hU(e))!gU.call(t,s)&&s!==n&&Bd(t,s,{get:()=>e[s],enumerable:!(r=pU(e,s))||r.enumerable});return t};var we=(t,e,n)=>(n=t!=null?fU(mU(t)):{},LR(e||!t||!t.__esModule?Bd(n,"default",{value:t,enumerable:!0}):n,t)),vU=t=>LR(Bd({},"__esModule",{value:!0}),t);var mn=oe((rc,Pl)=>{(function(){var t,e="4.17.21",n=200,r="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",a="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",l=500,d="__lodash_placeholder__",f=1,p=2,m=4,g=1,w=2,v=1,x=2,b=4,S=8,k=16,$=32,F=64,L=128,H=256,N=512,X=30,V="...",Y=800,D=16,j=1,ae=2,me=3,ue=1/0,_e=9007199254740991,ke=17976931348623157e292,De=NaN,Ie=4294967295,Ce=Ie-1,Ge=Ie>>>1,Re=[["ary",L],["bind",v],["bindKey",x],["curry",S],["curryRight",k],["flip",N],["partial",$],["partialRight",F],["rearg",H]],Oe="[object Arguments]",mt="[object Array]",ze="[object AsyncFunction]",Xe="[object Boolean]",tt="[object Date]",We="[object DOMException]",rn="[object Error]",sn="[object Function]",Bn="[object GeneratorFunction]",Ye="[object Map]",Yt="[object Number]",ln="[object Null]",rt="[object Object]",Nt="[object Promise]",tn="[object Proxy]",Jt="[object RegExp]",st="[object Set]",At="[object String]",St="[object Symbol]",xn="[object Undefined]",pn="[object WeakMap]",Sr="[object WeakSet]",Zn="[object ArrayBuffer]",Un="[object DataView]",Gt="[object Float32Array]",Dn="[object Float64Array]",q="[object Int8Array]",ie="[object Int16Array]",xe="[object Int32Array]",Pe="[object Uint8Array]",vt="[object Uint8ClampedArray]",Q="[object Uint16Array]",se="[object Uint32Array]",ne=/\b__p \+= '';/g,re=/\b(__p \+=) '' \+/g,ye=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ee=/&(?:amp|lt|gt|quot|#39);/g,Le=/[&<>"']/g,gt=RegExp(Ee.source),Lt=RegExp(Le.source),ni=/<%-([\s\S]+?)%>/g,vi=/<%([\s\S]+?)%>/g,R=/<%=([\s\S]+?)%>/g,te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fe=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,z=/[\\^$.*+?()[\]{}|]/g,E=RegExp(z.source),U=/^\s+/,W=/\s/,I=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,T=/\{\n\/\* \[wrapped with (.+)\] \*/,J=/,? & /,fe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,nt=/[()=,{}\[\]\/\s]/,un=/\\(\\)?/g,zt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_r=/\w*$/,Wr=/^[-+]0x[0-9a-f]+$/i,yi=/^0b[01]+$/i,yt=/^\[object .+?Constructor\]$/,Li=/^0o[0-7]+$/i,_=/^(?:0|[1-9]\d*)$/,G=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,de=/($^)/,Ue=/['\n\r\u2028\u2029\\]/g,In="\\ud800-\\udfff",ir="\\u0300-\\u036f",Ut="\\ufe20-\\ufe2f",Ui="\\u20d0-\\u20ff",Kt=ir+Ut+Ui,sa="\\u2700-\\u27bf",dl="a-z\\xdf-\\xf6\\xf8-\\xff",rd="\\xac\\xb1\\xd7\\xf7",fl="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",dm="\\u2000-\\u206f",id=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",_x="A-Z\\xc0-\\xd6\\xd8-\\xde",vx="\\ufe0e\\ufe0f",yx=rd+fl+dm+id,fm="['\u2019]",fF="["+In+"]",wx="["+yx+"]",sd="["+Kt+"]",bx="\\d+",pF="["+sa+"]",xx="["+dl+"]",Tx="[^"+In+yx+bx+sa+dl+_x+"]",pm="\\ud83c[\\udffb-\\udfff]",hF="(?:"+sd+"|"+pm+")",Rx="[^"+In+"]",hm="(?:\\ud83c[\\udde6-\\uddff]){2}",mm="[\\ud800-\\udbff][\\udc00-\\udfff]",Xa="["+_x+"]",Ex="\\u200d",Sx="(?:"+xx+"|"+Tx+")",mF="(?:"+Xa+"|"+Tx+")",Cx="(?:"+fm+"(?:d|ll|m|re|s|t|ve))?",kx="(?:"+fm+"(?:D|LL|M|RE|S|T|VE))?",Px=hF+"?",Ax="["+vx+"]?",gF="(?:"+Ex+"(?:"+[Rx,hm,mm].join("|")+")"+Ax+Px+")*",_F="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",vF="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Dx=Ax+Px+gF,yF="(?:"+[pF,hm,mm].join("|")+")"+Dx,wF="(?:"+[Rx+sd+"?",sd,hm,mm,fF].join("|")+")",bF=RegExp(fm,"g"),xF=RegExp(sd,"g"),gm=RegExp(pm+"(?="+pm+")|"+wF+Dx,"g"),TF=RegExp([Xa+"?"+xx+"+"+Cx+"(?="+[wx,Xa,"$"].join("|")+")",mF+"+"+kx+"(?="+[wx,Xa+Sx,"$"].join("|")+")",Xa+"?"+Sx+"+"+Cx,Xa+"+"+kx,vF,_F,bx,yF].join("|"),"g"),RF=RegExp("["+Ex+In+Kt+vx+"]"),EF=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,SF=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],CF=-1,hn={};hn[Gt]=hn[Dn]=hn[q]=hn[ie]=hn[xe]=hn[Pe]=hn[vt]=hn[Q]=hn[se]=!0,hn[Oe]=hn[mt]=hn[Zn]=hn[Xe]=hn[Un]=hn[tt]=hn[rn]=hn[sn]=hn[Ye]=hn[Yt]=hn[rt]=hn[Jt]=hn[st]=hn[At]=hn[pn]=!1;var dn={};dn[Oe]=dn[mt]=dn[Zn]=dn[Un]=dn[Xe]=dn[tt]=dn[Gt]=dn[Dn]=dn[q]=dn[ie]=dn[xe]=dn[Ye]=dn[Yt]=dn[rt]=dn[Jt]=dn[st]=dn[At]=dn[St]=dn[Pe]=dn[vt]=dn[Q]=dn[se]=!0,dn[rn]=dn[sn]=dn[pn]=!1;var kF={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},PF={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},AF={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},DF={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},IF=parseFloat,$F=parseInt,Ix=typeof global=="object"&&global&&global.Object===Object&&global,OF=typeof self=="object"&&self&&self.Object===Object&&self,cr=Ix||OF||Function("return this")(),_m=typeof rc=="object"&&rc&&!rc.nodeType&&rc,oa=_m&&typeof Pl=="object"&&Pl&&!Pl.nodeType&&Pl,$x=oa&&oa.exports===_m,vm=$x&&Ix.process,Wi=(function(){try{var K=oa&&oa.require&&oa.require("util").types;return K||vm&&vm.binding&&vm.binding("util")}catch{}})(),Ox=Wi&&Wi.isArrayBuffer,Fx=Wi&&Wi.isDate,Nx=Wi&&Wi.isMap,Mx=Wi&&Wi.isRegExp,qx=Wi&&Wi.isSet,Lx=Wi&&Wi.isTypedArray;function wi(K,ce,ee){switch(ee.length){case 0:return K.call(ce);case 1:return K.call(ce,ee[0]);case 2:return K.call(ce,ee[0],ee[1]);case 3:return K.call(ce,ee[0],ee[1],ee[2])}return K.apply(ce,ee)}function FF(K,ce,ee,qe){for(var ot=-1,Wt=K==null?0:K.length;++ot<Wt;){var sr=K[ot];ce(qe,sr,ee(sr),K)}return qe}function Hi(K,ce){for(var ee=-1,qe=K==null?0:K.length;++ee<qe&&ce(K[ee],ee,K)!==!1;);return K}function NF(K,ce){for(var ee=K==null?0:K.length;ee--&&ce(K[ee],ee,K)!==!1;);return K}function Ux(K,ce){for(var ee=-1,qe=K==null?0:K.length;++ee<qe;)if(!ce(K[ee],ee,K))return!1;return!0}function yo(K,ce){for(var ee=-1,qe=K==null?0:K.length,ot=0,Wt=[];++ee<qe;){var sr=K[ee];ce(sr,ee,K)&&(Wt[ot++]=sr)}return Wt}function od(K,ce){var ee=K==null?0:K.length;return!!ee&&Ba(K,ce,0)>-1}function ym(K,ce,ee){for(var qe=-1,ot=K==null?0:K.length;++qe<ot;)if(ee(ce,K[qe]))return!0;return!1}function Tn(K,ce){for(var ee=-1,qe=K==null?0:K.length,ot=Array(qe);++ee<qe;)ot[ee]=ce(K[ee],ee,K);return ot}function wo(K,ce){for(var ee=-1,qe=ce.length,ot=K.length;++ee<qe;)K[ot+ee]=ce[ee];return K}function wm(K,ce,ee,qe){var ot=-1,Wt=K==null?0:K.length;for(qe&&Wt&&(ee=K[++ot]);++ot<Wt;)ee=ce(ee,K[ot],ot,K);return ee}function MF(K,ce,ee,qe){var ot=K==null?0:K.length;for(qe&&ot&&(ee=K[--ot]);ot--;)ee=ce(ee,K[ot],ot,K);return ee}function bm(K,ce){for(var ee=-1,qe=K==null?0:K.length;++ee<qe;)if(ce(K[ee],ee,K))return!0;return!1}var qF=xm("length");function LF(K){return K.split("")}function UF(K){return K.match(fe)||[]}function Wx(K,ce,ee){var qe;return ee(K,function(ot,Wt,sr){if(ce(ot,Wt,sr))return qe=Wt,!1}),qe}function ad(K,ce,ee,qe){for(var ot=K.length,Wt=ee+(qe?1:-1);qe?Wt--:++Wt<ot;)if(ce(K[Wt],Wt,K))return Wt;return-1}function Ba(K,ce,ee){return ce===ce?JF(K,ce,ee):ad(K,Hx,ee)}function WF(K,ce,ee,qe){for(var ot=ee-1,Wt=K.length;++ot<Wt;)if(qe(K[ot],ce))return ot;return-1}function Hx(K){return K!==K}function jx(K,ce){var ee=K==null?0:K.length;return ee?Rm(K,ce)/ee:De}function xm(K){return function(ce){return ce==null?t:ce[K]}}function Tm(K){return function(ce){return K==null?t:K[ce]}}function Xx(K,ce,ee,qe,ot){return ot(K,function(Wt,sr,on){ee=qe?(qe=!1,Wt):ce(ee,Wt,sr,on)}),ee}function HF(K,ce){var ee=K.length;for(K.sort(ce);ee--;)K[ee]=K[ee].value;return K}function Rm(K,ce){for(var ee,qe=-1,ot=K.length;++qe<ot;){var Wt=ce(K[qe]);Wt!==t&&(ee=ee===t?Wt:ee+Wt)}return ee}function Em(K,ce){for(var ee=-1,qe=Array(K);++ee<K;)qe[ee]=ce(ee);return qe}function jF(K,ce){return Tn(ce,function(ee){return[ee,K[ee]]})}function Bx(K){return K&&K.slice(0,Zx(K)+1).replace(U,"")}function bi(K){return function(ce){return K(ce)}}function Sm(K,ce){return Tn(ce,function(ee){return K[ee]})}function pl(K,ce){return K.has(ce)}function Gx(K,ce){for(var ee=-1,qe=K.length;++ee<qe&&Ba(ce,K[ee],0)>-1;);return ee}function zx(K,ce){for(var ee=K.length;ee--&&Ba(ce,K[ee],0)>-1;);return ee}function XF(K,ce){for(var ee=K.length,qe=0;ee--;)K[ee]===ce&&++qe;return qe}var BF=Tm(kF),GF=Tm(PF);function zF(K){return"\\"+DF[K]}function KF(K,ce){return K==null?t:K[ce]}function Ga(K){return RF.test(K)}function ZF(K){return EF.test(K)}function VF(K){for(var ce,ee=[];!(ce=K.next()).done;)ee.push(ce.value);return ee}function Cm(K){var ce=-1,ee=Array(K.size);return K.forEach(function(qe,ot){ee[++ce]=[ot,qe]}),ee}function Kx(K,ce){return function(ee){return K(ce(ee))}}function bo(K,ce){for(var ee=-1,qe=K.length,ot=0,Wt=[];++ee<qe;){var sr=K[ee];(sr===ce||sr===d)&&(K[ee]=d,Wt[ot++]=ee)}return Wt}function cd(K){var ce=-1,ee=Array(K.size);return K.forEach(function(qe){ee[++ce]=qe}),ee}function YF(K){var ce=-1,ee=Array(K.size);return K.forEach(function(qe){ee[++ce]=[qe,qe]}),ee}function JF(K,ce,ee){for(var qe=ee-1,ot=K.length;++qe<ot;)if(K[qe]===ce)return qe;return-1}function QF(K,ce,ee){for(var qe=ee+1;qe--;)if(K[qe]===ce)return qe;return qe}function za(K){return Ga(K)?tN(K):qF(K)}function as(K){return Ga(K)?nN(K):LF(K)}function Zx(K){for(var ce=K.length;ce--&&W.test(K.charAt(ce)););return ce}var eN=Tm(AF);function tN(K){for(var ce=gm.lastIndex=0;gm.test(K);)++ce;return ce}function nN(K){return K.match(gm)||[]}function rN(K){return K.match(TF)||[]}var iN=(function K(ce){ce=ce==null?cr:xo.defaults(cr.Object(),ce,xo.pick(cr,SF));var ee=ce.Array,qe=ce.Date,ot=ce.Error,Wt=ce.Function,sr=ce.Math,on=ce.Object,km=ce.RegExp,sN=ce.String,ji=ce.TypeError,ld=ee.prototype,oN=Wt.prototype,Ka=on.prototype,ud=ce["__core-js_shared__"],dd=oN.toString,Qt=Ka.hasOwnProperty,aN=0,Vx=(function(){var i=/[^.]+$/.exec(ud&&ud.keys&&ud.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""})(),fd=Ka.toString,cN=dd.call(on),lN=cr._,uN=km("^"+dd.call(Qt).replace(z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pd=$x?ce.Buffer:t,To=ce.Symbol,hd=ce.Uint8Array,Yx=pd?pd.allocUnsafe:t,md=Kx(on.getPrototypeOf,on),Jx=on.create,Qx=Ka.propertyIsEnumerable,gd=ld.splice,eT=To?To.isConcatSpreadable:t,hl=To?To.iterator:t,aa=To?To.toStringTag:t,_d=(function(){try{var i=fa(on,"defineProperty");return i({},"",{}),i}catch{}})(),dN=ce.clearTimeout!==cr.clearTimeout&&ce.clearTimeout,fN=qe&&qe.now!==cr.Date.now&&qe.now,pN=ce.setTimeout!==cr.setTimeout&&ce.setTimeout,vd=sr.ceil,yd=sr.floor,Pm=on.getOwnPropertySymbols,hN=pd?pd.isBuffer:t,tT=ce.isFinite,mN=ld.join,gN=Kx(on.keys,on),or=sr.max,Cr=sr.min,_N=qe.now,vN=ce.parseInt,nT=sr.random,yN=ld.reverse,Am=fa(ce,"DataView"),ml=fa(ce,"Map"),Dm=fa(ce,"Promise"),Za=fa(ce,"Set"),gl=fa(ce,"WeakMap"),_l=fa(on,"create"),wd=gl&&new gl,Va={},wN=pa(Am),bN=pa(ml),xN=pa(Dm),TN=pa(Za),RN=pa(gl),bd=To?To.prototype:t,vl=bd?bd.valueOf:t,rT=bd?bd.toString:t;function C(i){if(Wn(i)&&!ct(i)&&!(i instanceof Ct)){if(i instanceof Xi)return i;if(Qt.call(i,"__wrapped__"))return iR(i)}return new Xi(i)}var Ya=(function(){function i(){}return function(o){if(!$n(o))return{};if(Jx)return Jx(o);i.prototype=o;var u=new i;return i.prototype=t,u}})();function xd(){}function Xi(i,o){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=t}C.templateSettings={escape:ni,evaluate:vi,interpolate:R,variable:"",imports:{_:C}},C.prototype=xd.prototype,C.prototype.constructor=C,Xi.prototype=Ya(xd.prototype),Xi.prototype.constructor=Xi;function Ct(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ie,this.__views__=[]}function EN(){var i=new Ct(this.__wrapped__);return i.__actions__=ri(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=ri(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=ri(this.__views__),i}function SN(){if(this.__filtered__){var i=new Ct(this);i.__dir__=-1,i.__filtered__=!0}else i=this.clone(),i.__dir__*=-1;return i}function CN(){var i=this.__wrapped__.value(),o=this.__dir__,u=ct(i),h=o<0,y=u?i.length:0,P=LM(0,y,this.__views__),M=P.start,B=P.end,Z=B-M,pe=h?B:M-1,he=this.__iteratees__,ve=he.length,$e=0,He=Cr(Z,this.__takeCount__);if(!u||!h&&y==Z&&He==Z)return CT(i,this.__actions__);var Ze=[];e:for(;Z--&&$e<He;){pe+=o;for(var _t=-1,Ve=i[pe];++_t<ve;){var xt=he[_t],Dt=xt.iteratee,Ri=xt.type,Xr=Dt(Ve);if(Ri==ae)Ve=Xr;else if(!Xr){if(Ri==j)continue e;break e}}Ze[$e++]=Ve}return Ze}Ct.prototype=Ya(xd.prototype),Ct.prototype.constructor=Ct;function ca(i){var o=-1,u=i==null?0:i.length;for(this.clear();++o<u;){var h=i[o];this.set(h[0],h[1])}}function kN(){this.__data__=_l?_l(null):{},this.size=0}function PN(i){var o=this.has(i)&&delete this.__data__[i];return this.size-=o?1:0,o}function AN(i){var o=this.__data__;if(_l){var u=o[i];return u===c?t:u}return Qt.call(o,i)?o[i]:t}function DN(i){var o=this.__data__;return _l?o[i]!==t:Qt.call(o,i)}function IN(i,o){var u=this.__data__;return this.size+=this.has(i)?0:1,u[i]=_l&&o===t?c:o,this}ca.prototype.clear=kN,ca.prototype.delete=PN,ca.prototype.get=AN,ca.prototype.has=DN,ca.prototype.set=IN;function Bs(i){var o=-1,u=i==null?0:i.length;for(this.clear();++o<u;){var h=i[o];this.set(h[0],h[1])}}function $N(){this.__data__=[],this.size=0}function ON(i){var o=this.__data__,u=Td(o,i);if(u<0)return!1;var h=o.length-1;return u==h?o.pop():gd.call(o,u,1),--this.size,!0}function FN(i){var o=this.__data__,u=Td(o,i);return u<0?t:o[u][1]}function NN(i){return Td(this.__data__,i)>-1}function MN(i,o){var u=this.__data__,h=Td(u,i);return h<0?(++this.size,u.push([i,o])):u[h][1]=o,this}Bs.prototype.clear=$N,Bs.prototype.delete=ON,Bs.prototype.get=FN,Bs.prototype.has=NN,Bs.prototype.set=MN;function Gs(i){var o=-1,u=i==null?0:i.length;for(this.clear();++o<u;){var h=i[o];this.set(h[0],h[1])}}function qN(){this.size=0,this.__data__={hash:new ca,map:new(ml||Bs),string:new ca}}function LN(i){var o=Fd(this,i).delete(i);return this.size-=o?1:0,o}function UN(i){return Fd(this,i).get(i)}function WN(i){return Fd(this,i).has(i)}function HN(i,o){var u=Fd(this,i),h=u.size;return u.set(i,o),this.size+=u.size==h?0:1,this}Gs.prototype.clear=qN,Gs.prototype.delete=LN,Gs.prototype.get=UN,Gs.prototype.has=WN,Gs.prototype.set=HN;function la(i){var o=-1,u=i==null?0:i.length;for(this.__data__=new Gs;++o<u;)this.add(i[o])}function jN(i){return this.__data__.set(i,c),this}function XN(i){return this.__data__.has(i)}la.prototype.add=la.prototype.push=jN,la.prototype.has=XN;function cs(i){var o=this.__data__=new Bs(i);this.size=o.size}function BN(){this.__data__=new Bs,this.size=0}function GN(i){var o=this.__data__,u=o.delete(i);return this.size=o.size,u}function zN(i){return this.__data__.get(i)}function KN(i){return this.__data__.has(i)}function ZN(i,o){var u=this.__data__;if(u instanceof Bs){var h=u.__data__;if(!ml||h.length<n-1)return h.push([i,o]),this.size=++u.size,this;u=this.__data__=new Gs(h)}return u.set(i,o),this.size=u.size,this}cs.prototype.clear=BN,cs.prototype.delete=GN,cs.prototype.get=zN,cs.prototype.has=KN,cs.prototype.set=ZN;function iT(i,o){var u=ct(i),h=!u&&ha(i),y=!u&&!h&&ko(i),P=!u&&!h&&!y&&tc(i),M=u||h||y||P,B=M?Em(i.length,sN):[],Z=B.length;for(var pe in i)(o||Qt.call(i,pe))&&!(M&&(pe=="length"||y&&(pe=="offset"||pe=="parent")||P&&(pe=="buffer"||pe=="byteLength"||pe=="byteOffset")||Vs(pe,Z)))&&B.push(pe);return B}function sT(i){var o=i.length;return o?i[Hm(0,o-1)]:t}function VN(i,o){return Nd(ri(i),ua(o,0,i.length))}function YN(i){return Nd(ri(i))}function Im(i,o,u){(u!==t&&!ls(i[o],u)||u===t&&!(o in i))&&zs(i,o,u)}function yl(i,o,u){var h=i[o];(!(Qt.call(i,o)&&ls(h,u))||u===t&&!(o in i))&&zs(i,o,u)}function Td(i,o){for(var u=i.length;u--;)if(ls(i[u][0],o))return u;return-1}function JN(i,o,u,h){return Ro(i,function(y,P,M){o(h,y,u(y),M)}),h}function oT(i,o){return i&&Ps(o,lr(o),i)}function QN(i,o){return i&&Ps(o,si(o),i)}function zs(i,o,u){o=="__proto__"&&_d?_d(i,o,{configurable:!0,enumerable:!0,value:u,writable:!0}):i[o]=u}function $m(i,o){for(var u=-1,h=o.length,y=ee(h),P=i==null;++u<h;)y[u]=P?t:pg(i,o[u]);return y}function ua(i,o,u){return i===i&&(u!==t&&(i=i<=u?i:u),o!==t&&(i=i>=o?i:o)),i}function Bi(i,o,u,h,y,P){var M,B=o&f,Z=o&p,pe=o&m;if(u&&(M=y?u(i,h,y,P):u(i)),M!==t)return M;if(!$n(i))return i;var he=ct(i);if(he){if(M=WM(i),!B)return ri(i,M)}else{var ve=kr(i),$e=ve==sn||ve==Bn;if(ko(i))return AT(i,B);if(ve==rt||ve==Oe||$e&&!y){if(M=Z||$e?{}:ZT(i),!B)return Z?AM(i,QN(M,i)):PM(i,oT(M,i))}else{if(!dn[ve])return y?i:{};M=HM(i,ve,B)}}P||(P=new cs);var He=P.get(i);if(He)return He;P.set(i,M),RR(i)?i.forEach(function(Ve){M.add(Bi(Ve,o,u,Ve,i,P))}):xR(i)&&i.forEach(function(Ve,xt){M.set(xt,Bi(Ve,o,u,xt,i,P))});var Ze=pe?Z?Qm:Jm:Z?si:lr,_t=he?t:Ze(i);return Hi(_t||i,function(Ve,xt){_t&&(xt=Ve,Ve=i[xt]),yl(M,xt,Bi(Ve,o,u,xt,i,P))}),M}function eM(i){var o=lr(i);return function(u){return aT(u,i,o)}}function aT(i,o,u){var h=u.length;if(i==null)return!h;for(i=on(i);h--;){var y=u[h],P=o[y],M=i[y];if(M===t&&!(y in i)||!P(M))return!1}return!0}function cT(i,o,u){if(typeof i!="function")throw new ji(s);return Sl(function(){i.apply(t,u)},o)}function wl(i,o,u,h){var y=-1,P=od,M=!0,B=i.length,Z=[],pe=o.length;if(!B)return Z;u&&(o=Tn(o,bi(u))),h?(P=ym,M=!1):o.length>=n&&(P=pl,M=!1,o=new la(o));e:for(;++y<B;){var he=i[y],ve=u==null?he:u(he);if(he=h||he!==0?he:0,M&&ve===ve){for(var $e=pe;$e--;)if(o[$e]===ve)continue e;Z.push(he)}else P(o,ve,h)||Z.push(he)}return Z}var Ro=FT(ks),lT=FT(Fm,!0);function tM(i,o){var u=!0;return Ro(i,function(h,y,P){return u=!!o(h,y,P),u}),u}function Rd(i,o,u){for(var h=-1,y=i.length;++h<y;){var P=i[h],M=o(P);if(M!=null&&(B===t?M===M&&!Ti(M):u(M,B)))var B=M,Z=P}return Z}function nM(i,o,u,h){var y=i.length;for(u=ft(u),u<0&&(u=-u>y?0:y+u),h=h===t||h>y?y:ft(h),h<0&&(h+=y),h=u>h?0:SR(h);u<h;)i[u++]=o;return i}function uT(i,o){var u=[];return Ro(i,function(h,y,P){o(h,y,P)&&u.push(h)}),u}function vr(i,o,u,h,y){var P=-1,M=i.length;for(u||(u=XM),y||(y=[]);++P<M;){var B=i[P];o>0&&u(B)?o>1?vr(B,o-1,u,h,y):wo(y,B):h||(y[y.length]=B)}return y}var Om=NT(),dT=NT(!0);function ks(i,o){return i&&Om(i,o,lr)}function Fm(i,o){return i&&dT(i,o,lr)}function Ed(i,o){return yo(o,function(u){return Ys(i[u])})}function da(i,o){o=So(o,i);for(var u=0,h=o.length;i!=null&&u<h;)i=i[As(o[u++])];return u&&u==h?i:t}function fT(i,o,u){var h=o(i);return ct(i)?h:wo(h,u(i))}function Hr(i){return i==null?i===t?xn:ln:aa&&aa in on(i)?qM(i):YM(i)}function Nm(i,o){return i>o}function rM(i,o){return i!=null&&Qt.call(i,o)}function iM(i,o){return i!=null&&o in on(i)}function sM(i,o,u){return i>=Cr(o,u)&&i<or(o,u)}function Mm(i,o,u){for(var h=u?ym:od,y=i[0].length,P=i.length,M=P,B=ee(P),Z=1/0,pe=[];M--;){var he=i[M];M&&o&&(he=Tn(he,bi(o))),Z=Cr(he.length,Z),B[M]=!u&&(o||y>=120&&he.length>=120)?new la(M&&he):t}he=i[0];var ve=-1,$e=B[0];e:for(;++ve<y&&pe.length<Z;){var He=he[ve],Ze=o?o(He):He;if(He=u||He!==0?He:0,!($e?pl($e,Ze):h(pe,Ze,u))){for(M=P;--M;){var _t=B[M];if(!(_t?pl(_t,Ze):h(i[M],Ze,u)))continue e}$e&&$e.push(Ze),pe.push(He)}}return pe}function oM(i,o,u,h){return ks(i,function(y,P,M){o(h,u(y),P,M)}),h}function bl(i,o,u){o=So(o,i),i=QT(i,o);var h=i==null?i:i[As(zi(o))];return h==null?t:wi(h,i,u)}function pT(i){return Wn(i)&&Hr(i)==Oe}function aM(i){return Wn(i)&&Hr(i)==Zn}function cM(i){return Wn(i)&&Hr(i)==tt}function xl(i,o,u,h,y){return i===o?!0:i==null||o==null||!Wn(i)&&!Wn(o)?i!==i&&o!==o:lM(i,o,u,h,xl,y)}function lM(i,o,u,h,y,P){var M=ct(i),B=ct(o),Z=M?mt:kr(i),pe=B?mt:kr(o);Z=Z==Oe?rt:Z,pe=pe==Oe?rt:pe;var he=Z==rt,ve=pe==rt,$e=Z==pe;if($e&&ko(i)){if(!ko(o))return!1;M=!0,he=!1}if($e&&!he)return P||(P=new cs),M||tc(i)?GT(i,o,u,h,y,P):NM(i,o,Z,u,h,y,P);if(!(u&g)){var He=he&&Qt.call(i,"__wrapped__"),Ze=ve&&Qt.call(o,"__wrapped__");if(He||Ze){var _t=He?i.value():i,Ve=Ze?o.value():o;return P||(P=new cs),y(_t,Ve,u,h,P)}}return $e?(P||(P=new cs),MM(i,o,u,h,y,P)):!1}function uM(i){return Wn(i)&&kr(i)==Ye}function qm(i,o,u,h){var y=u.length,P=y,M=!h;if(i==null)return!P;for(i=on(i);y--;){var B=u[y];if(M&&B[2]?B[1]!==i[B[0]]:!(B[0]in i))return!1}for(;++y<P;){B=u[y];var Z=B[0],pe=i[Z],he=B[1];if(M&&B[2]){if(pe===t&&!(Z in i))return!1}else{var ve=new cs;if(h)var $e=h(pe,he,Z,i,o,ve);if(!($e===t?xl(he,pe,g|w,h,ve):$e))return!1}}return!0}function hT(i){if(!$n(i)||GM(i))return!1;var o=Ys(i)?uN:yt;return o.test(pa(i))}function dM(i){return Wn(i)&&Hr(i)==Jt}function fM(i){return Wn(i)&&kr(i)==st}function pM(i){return Wn(i)&&Hd(i.length)&&!!hn[Hr(i)]}function mT(i){return typeof i=="function"?i:i==null?oi:typeof i=="object"?ct(i)?vT(i[0],i[1]):_T(i):MR(i)}function Lm(i){if(!El(i))return gN(i);var o=[];for(var u in on(i))Qt.call(i,u)&&u!="constructor"&&o.push(u);return o}function hM(i){if(!$n(i))return VM(i);var o=El(i),u=[];for(var h in i)h=="constructor"&&(o||!Qt.call(i,h))||u.push(h);return u}function Um(i,o){return i<o}function gT(i,o){var u=-1,h=ii(i)?ee(i.length):[];return Ro(i,function(y,P,M){h[++u]=o(y,P,M)}),h}function _T(i){var o=tg(i);return o.length==1&&o[0][2]?YT(o[0][0],o[0][1]):function(u){return u===i||qm(u,i,o)}}function vT(i,o){return rg(i)&&VT(o)?YT(As(i),o):function(u){var h=pg(u,i);return h===t&&h===o?hg(u,i):xl(o,h,g|w)}}function Sd(i,o,u,h,y){i!==o&&Om(o,function(P,M){if(y||(y=new cs),$n(P))mM(i,o,M,u,Sd,h,y);else{var B=h?h(sg(i,M),P,M+"",i,o,y):t;B===t&&(B=P),Im(i,M,B)}},si)}function mM(i,o,u,h,y,P,M){var B=sg(i,u),Z=sg(o,u),pe=M.get(Z);if(pe){Im(i,u,pe);return}var he=P?P(B,Z,u+"",i,o,M):t,ve=he===t;if(ve){var $e=ct(Z),He=!$e&&ko(Z),Ze=!$e&&!He&&tc(Z);he=Z,$e||He||Ze?ct(B)?he=B:Gn(B)?he=ri(B):He?(ve=!1,he=AT(Z,!0)):Ze?(ve=!1,he=DT(Z,!0)):he=[]:Cl(Z)||ha(Z)?(he=B,ha(B)?he=CR(B):(!$n(B)||Ys(B))&&(he=ZT(Z))):ve=!1}ve&&(M.set(Z,he),y(he,Z,h,P,M),M.delete(Z)),Im(i,u,he)}function yT(i,o){var u=i.length;if(u)return o+=o<0?u:0,Vs(o,u)?i[o]:t}function wT(i,o,u){o.length?o=Tn(o,function(P){return ct(P)?function(M){return da(M,P.length===1?P[0]:P)}:P}):o=[oi];var h=-1;o=Tn(o,bi(Ke()));var y=gT(i,function(P,M,B){var Z=Tn(o,function(pe){return pe(P)});return{criteria:Z,index:++h,value:P}});return HF(y,function(P,M){return kM(P,M,u)})}function gM(i,o){return bT(i,o,function(u,h){return hg(i,h)})}function bT(i,o,u){for(var h=-1,y=o.length,P={};++h<y;){var M=o[h],B=da(i,M);u(B,M)&&Tl(P,So(M,i),B)}return P}function _M(i){return function(o){return da(o,i)}}function Wm(i,o,u,h){var y=h?WF:Ba,P=-1,M=o.length,B=i;for(i===o&&(o=ri(o)),u&&(B=Tn(i,bi(u)));++P<M;)for(var Z=0,pe=o[P],he=u?u(pe):pe;(Z=y(B,he,Z,h))>-1;)B!==i&&gd.call(B,Z,1),gd.call(i,Z,1);return i}function xT(i,o){for(var u=i?o.length:0,h=u-1;u--;){var y=o[u];if(u==h||y!==P){var P=y;Vs(y)?gd.call(i,y,1):Bm(i,y)}}return i}function Hm(i,o){return i+yd(nT()*(o-i+1))}function vM(i,o,u,h){for(var y=-1,P=or(vd((o-i)/(u||1)),0),M=ee(P);P--;)M[h?P:++y]=i,i+=u;return M}function jm(i,o){var u="";if(!i||o<1||o>_e)return u;do o%2&&(u+=i),o=yd(o/2),o&&(i+=i);while(o);return u}function wt(i,o){return og(JT(i,o,oi),i+"")}function yM(i){return sT(nc(i))}function wM(i,o){var u=nc(i);return Nd(u,ua(o,0,u.length))}function Tl(i,o,u,h){if(!$n(i))return i;o=So(o,i);for(var y=-1,P=o.length,M=P-1,B=i;B!=null&&++y<P;){var Z=As(o[y]),pe=u;if(Z==="__proto__"||Z==="constructor"||Z==="prototype")return i;if(y!=M){var he=B[Z];pe=h?h(he,Z,B):t,pe===t&&(pe=$n(he)?he:Vs(o[y+1])?[]:{})}yl(B,Z,pe),B=B[Z]}return i}var TT=wd?function(i,o){return wd.set(i,o),i}:oi,bM=_d?function(i,o){return _d(i,"toString",{configurable:!0,enumerable:!1,value:gg(o),writable:!0})}:oi;function xM(i){return Nd(nc(i))}function Gi(i,o,u){var h=-1,y=i.length;o<0&&(o=-o>y?0:y+o),u=u>y?y:u,u<0&&(u+=y),y=o>u?0:u-o>>>0,o>>>=0;for(var P=ee(y);++h<y;)P[h]=i[h+o];return P}function TM(i,o){var u;return Ro(i,function(h,y,P){return u=o(h,y,P),!u}),!!u}function Cd(i,o,u){var h=0,y=i==null?h:i.length;if(typeof o=="number"&&o===o&&y<=Ge){for(;h<y;){var P=h+y>>>1,M=i[P];M!==null&&!Ti(M)&&(u?M<=o:M<o)?h=P+1:y=P}return y}return Xm(i,o,oi,u)}function Xm(i,o,u,h){var y=0,P=i==null?0:i.length;if(P===0)return 0;o=u(o);for(var M=o!==o,B=o===null,Z=Ti(o),pe=o===t;y<P;){var he=yd((y+P)/2),ve=u(i[he]),$e=ve!==t,He=ve===null,Ze=ve===ve,_t=Ti(ve);if(M)var Ve=h||Ze;else pe?Ve=Ze&&(h||$e):B?Ve=Ze&&$e&&(h||!He):Z?Ve=Ze&&$e&&!He&&(h||!_t):He||_t?Ve=!1:Ve=h?ve<=o:ve<o;Ve?y=he+1:P=he}return Cr(P,Ce)}function RT(i,o){for(var u=-1,h=i.length,y=0,P=[];++u<h;){var M=i[u],B=o?o(M):M;if(!u||!ls(B,Z)){var Z=B;P[y++]=M===0?0:M}}return P}function ET(i){return typeof i=="number"?i:Ti(i)?De:+i}function xi(i){if(typeof i=="string")return i;if(ct(i))return Tn(i,xi)+"";if(Ti(i))return rT?rT.call(i):"";var o=i+"";return o=="0"&&1/i==-ue?"-0":o}function Eo(i,o,u){var h=-1,y=od,P=i.length,M=!0,B=[],Z=B;if(u)M=!1,y=ym;else if(P>=n){var pe=o?null:OM(i);if(pe)return cd(pe);M=!1,y=pl,Z=new la}else Z=o?[]:B;e:for(;++h<P;){var he=i[h],ve=o?o(he):he;if(he=u||he!==0?he:0,M&&ve===ve){for(var $e=Z.length;$e--;)if(Z[$e]===ve)continue e;o&&Z.push(ve),B.push(he)}else y(Z,ve,u)||(Z!==B&&Z.push(ve),B.push(he))}return B}function Bm(i,o){return o=So(o,i),i=QT(i,o),i==null||delete i[As(zi(o))]}function ST(i,o,u,h){return Tl(i,o,u(da(i,o)),h)}function kd(i,o,u,h){for(var y=i.length,P=h?y:-1;(h?P--:++P<y)&&o(i[P],P,i););return u?Gi(i,h?0:P,h?P+1:y):Gi(i,h?P+1:0,h?y:P)}function CT(i,o){var u=i;return u instanceof Ct&&(u=u.value()),wm(o,function(h,y){return y.func.apply(y.thisArg,wo([h],y.args))},u)}function Gm(i,o,u){var h=i.length;if(h<2)return h?Eo(i[0]):[];for(var y=-1,P=ee(h);++y<h;)for(var M=i[y],B=-1;++B<h;)B!=y&&(P[y]=wl(P[y]||M,i[B],o,u));return Eo(vr(P,1),o,u)}function kT(i,o,u){for(var h=-1,y=i.length,P=o.length,M={};++h<y;){var B=h<P?o[h]:t;u(M,i[h],B)}return M}function zm(i){return Gn(i)?i:[]}function Km(i){return typeof i=="function"?i:oi}function So(i,o){return ct(i)?i:rg(i,o)?[i]:rR(Zt(i))}var RM=wt;function Co(i,o,u){var h=i.length;return u=u===t?h:u,!o&&u>=h?i:Gi(i,o,u)}var PT=dN||function(i){return cr.clearTimeout(i)};function AT(i,o){if(o)return i.slice();var u=i.length,h=Yx?Yx(u):new i.constructor(u);return i.copy(h),h}function Zm(i){var o=new i.constructor(i.byteLength);return new hd(o).set(new hd(i)),o}function EM(i,o){var u=o?Zm(i.buffer):i.buffer;return new i.constructor(u,i.byteOffset,i.byteLength)}function SM(i){var o=new i.constructor(i.source,_r.exec(i));return o.lastIndex=i.lastIndex,o}function CM(i){return vl?on(vl.call(i)):{}}function DT(i,o){var u=o?Zm(i.buffer):i.buffer;return new i.constructor(u,i.byteOffset,i.length)}function IT(i,o){if(i!==o){var u=i!==t,h=i===null,y=i===i,P=Ti(i),M=o!==t,B=o===null,Z=o===o,pe=Ti(o);if(!B&&!pe&&!P&&i>o||P&&M&&Z&&!B&&!pe||h&&M&&Z||!u&&Z||!y)return 1;if(!h&&!P&&!pe&&i<o||pe&&u&&y&&!h&&!P||B&&u&&y||!M&&y||!Z)return-1}return 0}function kM(i,o,u){for(var h=-1,y=i.criteria,P=o.criteria,M=y.length,B=u.length;++h<M;){var Z=IT(y[h],P[h]);if(Z){if(h>=B)return Z;var pe=u[h];return Z*(pe=="desc"?-1:1)}}return i.index-o.index}function $T(i,o,u,h){for(var y=-1,P=i.length,M=u.length,B=-1,Z=o.length,pe=or(P-M,0),he=ee(Z+pe),ve=!h;++B<Z;)he[B]=o[B];for(;++y<M;)(ve||y<P)&&(he[u[y]]=i[y]);for(;pe--;)he[B++]=i[y++];return he}function OT(i,o,u,h){for(var y=-1,P=i.length,M=-1,B=u.length,Z=-1,pe=o.length,he=or(P-B,0),ve=ee(he+pe),$e=!h;++y<he;)ve[y]=i[y];for(var He=y;++Z<pe;)ve[He+Z]=o[Z];for(;++M<B;)($e||y<P)&&(ve[He+u[M]]=i[y++]);return ve}function ri(i,o){var u=-1,h=i.length;for(o||(o=ee(h));++u<h;)o[u]=i[u];return o}function Ps(i,o,u,h){var y=!u;u||(u={});for(var P=-1,M=o.length;++P<M;){var B=o[P],Z=h?h(u[B],i[B],B,u,i):t;Z===t&&(Z=i[B]),y?zs(u,B,Z):yl(u,B,Z)}return u}function PM(i,o){return Ps(i,ng(i),o)}function AM(i,o){return Ps(i,zT(i),o)}function Pd(i,o){return function(u,h){var y=ct(u)?FF:JN,P=o?o():{};return y(u,i,Ke(h,2),P)}}function Ja(i){return wt(function(o,u){var h=-1,y=u.length,P=y>1?u[y-1]:t,M=y>2?u[2]:t;for(P=i.length>3&&typeof P=="function"?(y--,P):t,M&&jr(u[0],u[1],M)&&(P=y<3?t:P,y=1),o=on(o);++h<y;){var B=u[h];B&&i(o,B,h,P)}return o})}function FT(i,o){return function(u,h){if(u==null)return u;if(!ii(u))return i(u,h);for(var y=u.length,P=o?y:-1,M=on(u);(o?P--:++P<y)&&h(M[P],P,M)!==!1;);return u}}function NT(i){return function(o,u,h){for(var y=-1,P=on(o),M=h(o),B=M.length;B--;){var Z=M[i?B:++y];if(u(P[Z],Z,P)===!1)break}return o}}function DM(i,o,u){var h=o&v,y=Rl(i);function P(){var M=this&&this!==cr&&this instanceof P?y:i;return M.apply(h?u:this,arguments)}return P}function MT(i){return function(o){o=Zt(o);var u=Ga(o)?as(o):t,h=u?u[0]:o.charAt(0),y=u?Co(u,1).join(""):o.slice(1);return h[i]()+y}}function Qa(i){return function(o){return wm(FR(OR(o).replace(bF,"")),i,"")}}function Rl(i){return function(){var o=arguments;switch(o.length){case 0:return new i;case 1:return new i(o[0]);case 2:return new i(o[0],o[1]);case 3:return new i(o[0],o[1],o[2]);case 4:return new i(o[0],o[1],o[2],o[3]);case 5:return new i(o[0],o[1],o[2],o[3],o[4]);case 6:return new i(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new i(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var u=Ya(i.prototype),h=i.apply(u,o);return $n(h)?h:u}}function IM(i,o,u){var h=Rl(i);function y(){for(var P=arguments.length,M=ee(P),B=P,Z=ec(y);B--;)M[B]=arguments[B];var pe=P<3&&M[0]!==Z&&M[P-1]!==Z?[]:bo(M,Z);if(P-=pe.length,P<u)return HT(i,o,Ad,y.placeholder,t,M,pe,t,t,u-P);var he=this&&this!==cr&&this instanceof y?h:i;return wi(he,this,M)}return y}function qT(i){return function(o,u,h){var y=on(o);if(!ii(o)){var P=Ke(u,3);o=lr(o),u=function(B){return P(y[B],B,y)}}var M=i(o,u,h);return M>-1?y[P?o[M]:M]:t}}function LT(i){return Zs(function(o){var u=o.length,h=u,y=Xi.prototype.thru;for(i&&o.reverse();h--;){var P=o[h];if(typeof P!="function")throw new ji(s);if(y&&!M&&Od(P)=="wrapper")var M=new Xi([],!0)}for(h=M?h:u;++h<u;){P=o[h];var B=Od(P),Z=B=="wrapper"?eg(P):t;Z&&ig(Z[0])&&Z[1]==(L|S|$|H)&&!Z[4].length&&Z[9]==1?M=M[Od(Z[0])].apply(M,Z[3]):M=P.length==1&&ig(P)?M[B]():M.thru(P)}return function(){var pe=arguments,he=pe[0];if(M&&pe.length==1&&ct(he))return M.plant(he).value();for(var ve=0,$e=u?o[ve].apply(this,pe):he;++ve<u;)$e=o[ve].call(this,$e);return $e}})}function Ad(i,o,u,h,y,P,M,B,Z,pe){var he=o&L,ve=o&v,$e=o&x,He=o&(S|k),Ze=o&N,_t=$e?t:Rl(i);function Ve(){for(var xt=arguments.length,Dt=ee(xt),Ri=xt;Ri--;)Dt[Ri]=arguments[Ri];if(He)var Xr=ec(Ve),Ei=XF(Dt,Xr);if(h&&(Dt=$T(Dt,h,y,He)),P&&(Dt=OT(Dt,P,M,He)),xt-=Ei,He&&xt<pe){var zn=bo(Dt,Xr);return HT(i,o,Ad,Ve.placeholder,u,Dt,zn,B,Z,pe-xt)}var us=ve?u:this,Qs=$e?us[i]:i;return xt=Dt.length,B?Dt=JM(Dt,B):Ze&&xt>1&&Dt.reverse(),he&&Z<xt&&(Dt.length=Z),this&&this!==cr&&this instanceof Ve&&(Qs=_t||Rl(Qs)),Qs.apply(us,Dt)}return Ve}function UT(i,o){return function(u,h){return oM(u,i,o(h),{})}}function Dd(i,o){return function(u,h){var y;if(u===t&&h===t)return o;if(u!==t&&(y=u),h!==t){if(y===t)return h;typeof u=="string"||typeof h=="string"?(u=xi(u),h=xi(h)):(u=ET(u),h=ET(h)),y=i(u,h)}return y}}function Vm(i){return Zs(function(o){return o=Tn(o,bi(Ke())),wt(function(u){var h=this;return i(o,function(y){return wi(y,h,u)})})})}function Id(i,o){o=o===t?" ":xi(o);var u=o.length;if(u<2)return u?jm(o,i):o;var h=jm(o,vd(i/za(o)));return Ga(o)?Co(as(h),0,i).join(""):h.slice(0,i)}function $M(i,o,u,h){var y=o&v,P=Rl(i);function M(){for(var B=-1,Z=arguments.length,pe=-1,he=h.length,ve=ee(he+Z),$e=this&&this!==cr&&this instanceof M?P:i;++pe<he;)ve[pe]=h[pe];for(;Z--;)ve[pe++]=arguments[++B];return wi($e,y?u:this,ve)}return M}function WT(i){return function(o,u,h){return h&&typeof h!="number"&&jr(o,u,h)&&(u=h=t),o=Js(o),u===t?(u=o,o=0):u=Js(u),h=h===t?o<u?1:-1:Js(h),vM(o,u,h,i)}}function $d(i){return function(o,u){return typeof o=="string"&&typeof u=="string"||(o=Ki(o),u=Ki(u)),i(o,u)}}function HT(i,o,u,h,y,P,M,B,Z,pe){var he=o&S,ve=he?M:t,$e=he?t:M,He=he?P:t,Ze=he?t:P;o|=he?$:F,o&=~(he?F:$),o&b||(o&=~(v|x));var _t=[i,o,y,He,ve,Ze,$e,B,Z,pe],Ve=u.apply(t,_t);return ig(i)&&eR(Ve,_t),Ve.placeholder=h,tR(Ve,i,o)}function Ym(i){var o=sr[i];return function(u,h){if(u=Ki(u),h=h==null?0:Cr(ft(h),292),h&&tT(u)){var y=(Zt(u)+"e").split("e"),P=o(y[0]+"e"+(+y[1]+h));return y=(Zt(P)+"e").split("e"),+(y[0]+"e"+(+y[1]-h))}return o(u)}}var OM=Za&&1/cd(new Za([,-0]))[1]==ue?function(i){return new Za(i)}:yg;function jT(i){return function(o){var u=kr(o);return u==Ye?Cm(o):u==st?YF(o):jF(o,i(o))}}function Ks(i,o,u,h,y,P,M,B){var Z=o&x;if(!Z&&typeof i!="function")throw new ji(s);var pe=h?h.length:0;if(pe||(o&=~($|F),h=y=t),M=M===t?M:or(ft(M),0),B=B===t?B:ft(B),pe-=y?y.length:0,o&F){var he=h,ve=y;h=y=t}var $e=Z?t:eg(i),He=[i,o,u,h,y,he,ve,P,M,B];if($e&&ZM(He,$e),i=He[0],o=He[1],u=He[2],h=He[3],y=He[4],B=He[9]=He[9]===t?Z?0:i.length:or(He[9]-pe,0),!B&&o&(S|k)&&(o&=~(S|k)),!o||o==v)var Ze=DM(i,o,u);else o==S||o==k?Ze=IM(i,o,B):(o==$||o==(v|$))&&!y.length?Ze=$M(i,o,u,h):Ze=Ad.apply(t,He);var _t=$e?TT:eR;return tR(_t(Ze,He),i,o)}function XT(i,o,u,h){return i===t||ls(i,Ka[u])&&!Qt.call(h,u)?o:i}function BT(i,o,u,h,y,P){return $n(i)&&$n(o)&&(P.set(o,i),Sd(i,o,t,BT,P),P.delete(o)),i}function FM(i){return Cl(i)?t:i}function GT(i,o,u,h,y,P){var M=u&g,B=i.length,Z=o.length;if(B!=Z&&!(M&&Z>B))return!1;var pe=P.get(i),he=P.get(o);if(pe&&he)return pe==o&&he==i;var ve=-1,$e=!0,He=u&w?new la:t;for(P.set(i,o),P.set(o,i);++ve<B;){var Ze=i[ve],_t=o[ve];if(h)var Ve=M?h(_t,Ze,ve,o,i,P):h(Ze,_t,ve,i,o,P);if(Ve!==t){if(Ve)continue;$e=!1;break}if(He){if(!bm(o,function(xt,Dt){if(!pl(He,Dt)&&(Ze===xt||y(Ze,xt,u,h,P)))return He.push(Dt)})){$e=!1;break}}else if(!(Ze===_t||y(Ze,_t,u,h,P))){$e=!1;break}}return P.delete(i),P.delete(o),$e}function NM(i,o,u,h,y,P,M){switch(u){case Un:if(i.byteLength!=o.byteLength||i.byteOffset!=o.byteOffset)return!1;i=i.buffer,o=o.buffer;case Zn:return!(i.byteLength!=o.byteLength||!P(new hd(i),new hd(o)));case Xe:case tt:case Yt:return ls(+i,+o);case rn:return i.name==o.name&&i.message==o.message;case Jt:case At:return i==o+"";case Ye:var B=Cm;case st:var Z=h&g;if(B||(B=cd),i.size!=o.size&&!Z)return!1;var pe=M.get(i);if(pe)return pe==o;h|=w,M.set(i,o);var he=GT(B(i),B(o),h,y,P,M);return M.delete(i),he;case St:if(vl)return vl.call(i)==vl.call(o)}return!1}function MM(i,o,u,h,y,P){var M=u&g,B=Jm(i),Z=B.length,pe=Jm(o),he=pe.length;if(Z!=he&&!M)return!1;for(var ve=Z;ve--;){var $e=B[ve];if(!(M?$e in o:Qt.call(o,$e)))return!1}var He=P.get(i),Ze=P.get(o);if(He&&Ze)return He==o&&Ze==i;var _t=!0;P.set(i,o),P.set(o,i);for(var Ve=M;++ve<Z;){$e=B[ve];var xt=i[$e],Dt=o[$e];if(h)var Ri=M?h(Dt,xt,$e,o,i,P):h(xt,Dt,$e,i,o,P);if(!(Ri===t?xt===Dt||y(xt,Dt,u,h,P):Ri)){_t=!1;break}Ve||(Ve=$e=="constructor")}if(_t&&!Ve){var Xr=i.constructor,Ei=o.constructor;Xr!=Ei&&"constructor"in i&&"constructor"in o&&!(typeof Xr=="function"&&Xr instanceof Xr&&typeof Ei=="function"&&Ei instanceof Ei)&&(_t=!1)}return P.delete(i),P.delete(o),_t}function Zs(i){return og(JT(i,t,aR),i+"")}function Jm(i){return fT(i,lr,ng)}function Qm(i){return fT(i,si,zT)}var eg=wd?function(i){return wd.get(i)}:yg;function Od(i){for(var o=i.name+"",u=Va[o],h=Qt.call(Va,o)?u.length:0;h--;){var y=u[h],P=y.func;if(P==null||P==i)return y.name}return o}function ec(i){var o=Qt.call(C,"placeholder")?C:i;return o.placeholder}function Ke(){var i=C.iteratee||_g;return i=i===_g?mT:i,arguments.length?i(arguments[0],arguments[1]):i}function Fd(i,o){var u=i.__data__;return BM(o)?u[typeof o=="string"?"string":"hash"]:u.map}function tg(i){for(var o=lr(i),u=o.length;u--;){var h=o[u],y=i[h];o[u]=[h,y,VT(y)]}return o}function fa(i,o){var u=KF(i,o);return hT(u)?u:t}function qM(i){var o=Qt.call(i,aa),u=i[aa];try{i[aa]=t;var h=!0}catch{}var y=fd.call(i);return h&&(o?i[aa]=u:delete i[aa]),y}var ng=Pm?function(i){return i==null?[]:(i=on(i),yo(Pm(i),function(o){return Qx.call(i,o)}))}:wg,zT=Pm?function(i){for(var o=[];i;)wo(o,ng(i)),i=md(i);return o}:wg,kr=Hr;(Am&&kr(new Am(new ArrayBuffer(1)))!=Un||ml&&kr(new ml)!=Ye||Dm&&kr(Dm.resolve())!=Nt||Za&&kr(new Za)!=st||gl&&kr(new gl)!=pn)&&(kr=function(i){var o=Hr(i),u=o==rt?i.constructor:t,h=u?pa(u):"";if(h)switch(h){case wN:return Un;case bN:return Ye;case xN:return Nt;case TN:return st;case RN:return pn}return o});function LM(i,o,u){for(var h=-1,y=u.length;++h<y;){var P=u[h],M=P.size;switch(P.type){case"drop":i+=M;break;case"dropRight":o-=M;break;case"take":o=Cr(o,i+M);break;case"takeRight":i=or(i,o-M);break}}return{start:i,end:o}}function UM(i){var o=i.match(T);return o?o[1].split(J):[]}function KT(i,o,u){o=So(o,i);for(var h=-1,y=o.length,P=!1;++h<y;){var M=As(o[h]);if(!(P=i!=null&&u(i,M)))break;i=i[M]}return P||++h!=y?P:(y=i==null?0:i.length,!!y&&Hd(y)&&Vs(M,y)&&(ct(i)||ha(i)))}function WM(i){var o=i.length,u=new i.constructor(o);return o&&typeof i[0]=="string"&&Qt.call(i,"index")&&(u.index=i.index,u.input=i.input),u}function ZT(i){return typeof i.constructor=="function"&&!El(i)?Ya(md(i)):{}}function HM(i,o,u){var h=i.constructor;switch(o){case Zn:return Zm(i);case Xe:case tt:return new h(+i);case Un:return EM(i,u);case Gt:case Dn:case q:case ie:case xe:case Pe:case vt:case Q:case se:return DT(i,u);case Ye:return new h;case Yt:case At:return new h(i);case Jt:return SM(i);case st:return new h;case St:return CM(i)}}function jM(i,o){var u=o.length;if(!u)return i;var h=u-1;return o[h]=(u>1?"& ":"")+o[h],o=o.join(u>2?", ":" "),i.replace(I,`{
/* [wrapped with `+o+`] */
`)}function XM(i){return ct(i)||ha(i)||!!(eT&&i&&i[eT])}function Vs(i,o){var u=typeof i;return o=o??_e,!!o&&(u=="number"||u!="symbol"&&_.test(i))&&i>-1&&i%1==0&&i<o}function jr(i,o,u){if(!$n(u))return!1;var h=typeof o;return(h=="number"?ii(u)&&Vs(o,u.length):h=="string"&&o in u)?ls(u[o],i):!1}function rg(i,o){if(ct(i))return!1;var u=typeof i;return u=="number"||u=="symbol"||u=="boolean"||i==null||Ti(i)?!0:Fe.test(i)||!te.test(i)||o!=null&&i in on(o)}function BM(i){var o=typeof i;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?i!=="__proto__":i===null}function ig(i){var o=Od(i),u=C[o];if(typeof u!="function"||!(o in Ct.prototype))return!1;if(i===u)return!0;var h=eg(u);return!!h&&i===h[0]}function GM(i){return!!Vx&&Vx in i}var zM=ud?Ys:bg;function El(i){var o=i&&i.constructor,u=typeof o=="function"&&o.prototype||Ka;return i===u}function VT(i){return i===i&&!$n(i)}function YT(i,o){return function(u){return u==null?!1:u[i]===o&&(o!==t||i in on(u))}}function KM(i){var o=Ud(i,function(h){return u.size===l&&u.clear(),h}),u=o.cache;return o}function ZM(i,o){var u=i[1],h=o[1],y=u|h,P=y<(v|x|L),M=h==L&&u==S||h==L&&u==H&&i[7].length<=o[8]||h==(L|H)&&o[7].length<=o[8]&&u==S;if(!(P||M))return i;h&v&&(i[2]=o[2],y|=u&v?0:b);var B=o[3];if(B){var Z=i[3];i[3]=Z?$T(Z,B,o[4]):B,i[4]=Z?bo(i[3],d):o[4]}return B=o[5],B&&(Z=i[5],i[5]=Z?OT(Z,B,o[6]):B,i[6]=Z?bo(i[5],d):o[6]),B=o[7],B&&(i[7]=B),h&L&&(i[8]=i[8]==null?o[8]:Cr(i[8],o[8])),i[9]==null&&(i[9]=o[9]),i[0]=o[0],i[1]=y,i}function VM(i){var o=[];if(i!=null)for(var u in on(i))o.push(u);return o}function YM(i){return fd.call(i)}function JT(i,o,u){return o=or(o===t?i.length-1:o,0),function(){for(var h=arguments,y=-1,P=or(h.length-o,0),M=ee(P);++y<P;)M[y]=h[o+y];y=-1;for(var B=ee(o+1);++y<o;)B[y]=h[y];return B[o]=u(M),wi(i,this,B)}}function QT(i,o){return o.length<2?i:da(i,Gi(o,0,-1))}function JM(i,o){for(var u=i.length,h=Cr(o.length,u),y=ri(i);h--;){var P=o[h];i[h]=Vs(P,u)?y[P]:t}return i}function sg(i,o){if(!(o==="constructor"&&typeof i[o]=="function")&&o!="__proto__")return i[o]}var eR=nR(TT),Sl=pN||function(i,o){return cr.setTimeout(i,o)},og=nR(bM);function tR(i,o,u){var h=o+"";return og(i,jM(h,QM(UM(h),u)))}function nR(i){var o=0,u=0;return function(){var h=_N(),y=D-(h-u);if(u=h,y>0){if(++o>=Y)return arguments[0]}else o=0;return i.apply(t,arguments)}}function Nd(i,o){var u=-1,h=i.length,y=h-1;for(o=o===t?h:o;++u<o;){var P=Hm(u,y),M=i[P];i[P]=i[u],i[u]=M}return i.length=o,i}var rR=KM(function(i){var o=[];return i.charCodeAt(0)===46&&o.push(""),i.replace(Ot,function(u,h,y,P){o.push(y?P.replace(un,"$1"):h||u)}),o});function As(i){if(typeof i=="string"||Ti(i))return i;var o=i+"";return o=="0"&&1/i==-ue?"-0":o}function pa(i){if(i!=null){try{return dd.call(i)}catch{}try{return i+""}catch{}}return""}function QM(i,o){return Hi(Re,function(u){var h="_."+u[0];o&u[1]&&!od(i,h)&&i.push(h)}),i.sort()}function iR(i){if(i instanceof Ct)return i.clone();var o=new Xi(i.__wrapped__,i.__chain__);return o.__actions__=ri(i.__actions__),o.__index__=i.__index__,o.__values__=i.__values__,o}function eq(i,o,u){(u?jr(i,o,u):o===t)?o=1:o=or(ft(o),0);var h=i==null?0:i.length;if(!h||o<1)return[];for(var y=0,P=0,M=ee(vd(h/o));y<h;)M[P++]=Gi(i,y,y+=o);return M}function tq(i){for(var o=-1,u=i==null?0:i.length,h=0,y=[];++o<u;){var P=i[o];P&&(y[h++]=P)}return y}function nq(){var i=arguments.length;if(!i)return[];for(var o=ee(i-1),u=arguments[0],h=i;h--;)o[h-1]=arguments[h];return wo(ct(u)?ri(u):[u],vr(o,1))}var rq=wt(function(i,o){return Gn(i)?wl(i,vr(o,1,Gn,!0)):[]}),iq=wt(function(i,o){var u=zi(o);return Gn(u)&&(u=t),Gn(i)?wl(i,vr(o,1,Gn,!0),Ke(u,2)):[]}),sq=wt(function(i,o){var u=zi(o);return Gn(u)&&(u=t),Gn(i)?wl(i,vr(o,1,Gn,!0),t,u):[]});function oq(i,o,u){var h=i==null?0:i.length;return h?(o=u||o===t?1:ft(o),Gi(i,o<0?0:o,h)):[]}function aq(i,o,u){var h=i==null?0:i.length;return h?(o=u||o===t?1:ft(o),o=h-o,Gi(i,0,o<0?0:o)):[]}function cq(i,o){return i&&i.length?kd(i,Ke(o,3),!0,!0):[]}function lq(i,o){return i&&i.length?kd(i,Ke(o,3),!0):[]}function uq(i,o,u,h){var y=i==null?0:i.length;return y?(u&&typeof u!="number"&&jr(i,o,u)&&(u=0,h=y),nM(i,o,u,h)):[]}function sR(i,o,u){var h=i==null?0:i.length;if(!h)return-1;var y=u==null?0:ft(u);return y<0&&(y=or(h+y,0)),ad(i,Ke(o,3),y)}function oR(i,o,u){var h=i==null?0:i.length;if(!h)return-1;var y=h-1;return u!==t&&(y=ft(u),y=u<0?or(h+y,0):Cr(y,h-1)),ad(i,Ke(o,3),y,!0)}function aR(i){var o=i==null?0:i.length;return o?vr(i,1):[]}function dq(i){var o=i==null?0:i.length;return o?vr(i,ue):[]}function fq(i,o){var u=i==null?0:i.length;return u?(o=o===t?1:ft(o),vr(i,o)):[]}function pq(i){for(var o=-1,u=i==null?0:i.length,h={};++o<u;){var y=i[o];h[y[0]]=y[1]}return h}function cR(i){return i&&i.length?i[0]:t}function hq(i,o,u){var h=i==null?0:i.length;if(!h)return-1;var y=u==null?0:ft(u);return y<0&&(y=or(h+y,0)),Ba(i,o,y)}function mq(i){var o=i==null?0:i.length;return o?Gi(i,0,-1):[]}var gq=wt(function(i){var o=Tn(i,zm);return o.length&&o[0]===i[0]?Mm(o):[]}),_q=wt(function(i){var o=zi(i),u=Tn(i,zm);return o===zi(u)?o=t:u.pop(),u.length&&u[0]===i[0]?Mm(u,Ke(o,2)):[]}),vq=wt(function(i){var o=zi(i),u=Tn(i,zm);return o=typeof o=="function"?o:t,o&&u.pop(),u.length&&u[0]===i[0]?Mm(u,t,o):[]});function yq(i,o){return i==null?"":mN.call(i,o)}function zi(i){var o=i==null?0:i.length;return o?i[o-1]:t}function wq(i,o,u){var h=i==null?0:i.length;if(!h)return-1;var y=h;return u!==t&&(y=ft(u),y=y<0?or(h+y,0):Cr(y,h-1)),o===o?QF(i,o,y):ad(i,Hx,y,!0)}function bq(i,o){return i&&i.length?yT(i,ft(o)):t}var xq=wt(lR);function lR(i,o){return i&&i.length&&o&&o.length?Wm(i,o):i}function Tq(i,o,u){return i&&i.length&&o&&o.length?Wm(i,o,Ke(u,2)):i}function Rq(i,o,u){return i&&i.length&&o&&o.length?Wm(i,o,t,u):i}var Eq=Zs(function(i,o){var u=i==null?0:i.length,h=$m(i,o);return xT(i,Tn(o,function(y){return Vs(y,u)?+y:y}).sort(IT)),h});function Sq(i,o){var u=[];if(!(i&&i.length))return u;var h=-1,y=[],P=i.length;for(o=Ke(o,3);++h<P;){var M=i[h];o(M,h,i)&&(u.push(M),y.push(h))}return xT(i,y),u}function ag(i){return i==null?i:yN.call(i)}function Cq(i,o,u){var h=i==null?0:i.length;return h?(u&&typeof u!="number"&&jr(i,o,u)?(o=0,u=h):(o=o==null?0:ft(o),u=u===t?h:ft(u)),Gi(i,o,u)):[]}function kq(i,o){return Cd(i,o)}function Pq(i,o,u){return Xm(i,o,Ke(u,2))}function Aq(i,o){var u=i==null?0:i.length;if(u){var h=Cd(i,o);if(h<u&&ls(i[h],o))return h}return-1}function Dq(i,o){return Cd(i,o,!0)}function Iq(i,o,u){return Xm(i,o,Ke(u,2),!0)}function $q(i,o){var u=i==null?0:i.length;if(u){var h=Cd(i,o,!0)-1;if(ls(i[h],o))return h}return-1}function Oq(i){return i&&i.length?RT(i):[]}function Fq(i,o){return i&&i.length?RT(i,Ke(o,2)):[]}function Nq(i){var o=i==null?0:i.length;return o?Gi(i,1,o):[]}function Mq(i,o,u){return i&&i.length?(o=u||o===t?1:ft(o),Gi(i,0,o<0?0:o)):[]}function qq(i,o,u){var h=i==null?0:i.length;return h?(o=u||o===t?1:ft(o),o=h-o,Gi(i,o<0?0:o,h)):[]}function Lq(i,o){return i&&i.length?kd(i,Ke(o,3),!1,!0):[]}function Uq(i,o){return i&&i.length?kd(i,Ke(o,3)):[]}var Wq=wt(function(i){return Eo(vr(i,1,Gn,!0))}),Hq=wt(function(i){var o=zi(i);return Gn(o)&&(o=t),Eo(vr(i,1,Gn,!0),Ke(o,2))}),jq=wt(function(i){var o=zi(i);return o=typeof o=="function"?o:t,Eo(vr(i,1,Gn,!0),t,o)});function Xq(i){return i&&i.length?Eo(i):[]}function Bq(i,o){return i&&i.length?Eo(i,Ke(o,2)):[]}function Gq(i,o){return o=typeof o=="function"?o:t,i&&i.length?Eo(i,t,o):[]}function cg(i){if(!(i&&i.length))return[];var o=0;return i=yo(i,function(u){if(Gn(u))return o=or(u.length,o),!0}),Em(o,function(u){return Tn(i,xm(u))})}function uR(i,o){if(!(i&&i.length))return[];var u=cg(i);return o==null?u:Tn(u,function(h){return wi(o,t,h)})}var zq=wt(function(i,o){return Gn(i)?wl(i,o):[]}),Kq=wt(function(i){return Gm(yo(i,Gn))}),Zq=wt(function(i){var o=zi(i);return Gn(o)&&(o=t),Gm(yo(i,Gn),Ke(o,2))}),Vq=wt(function(i){var o=zi(i);return o=typeof o=="function"?o:t,Gm(yo(i,Gn),t,o)}),Yq=wt(cg);function Jq(i,o){return kT(i||[],o||[],yl)}function Qq(i,o){return kT(i||[],o||[],Tl)}var e8=wt(function(i){var o=i.length,u=o>1?i[o-1]:t;return u=typeof u=="function"?(i.pop(),u):t,uR(i,u)});function dR(i){var o=C(i);return o.__chain__=!0,o}function t8(i,o){return o(i),i}function Md(i,o){return o(i)}var n8=Zs(function(i){var o=i.length,u=o?i[0]:0,h=this.__wrapped__,y=function(P){return $m(P,i)};return o>1||this.__actions__.length||!(h instanceof Ct)||!Vs(u)?this.thru(y):(h=h.slice(u,+u+(o?1:0)),h.__actions__.push({func:Md,args:[y],thisArg:t}),new Xi(h,this.__chain__).thru(function(P){return o&&!P.length&&P.push(t),P}))});function r8(){return dR(this)}function i8(){return new Xi(this.value(),this.__chain__)}function s8(){this.__values__===t&&(this.__values__=ER(this.value()));var i=this.__index__>=this.__values__.length,o=i?t:this.__values__[this.__index__++];return{done:i,value:o}}function o8(){return this}function a8(i){for(var o,u=this;u instanceof xd;){var h=iR(u);h.__index__=0,h.__values__=t,o?y.__wrapped__=h:o=h;var y=h;u=u.__wrapped__}return y.__wrapped__=i,o}function c8(){var i=this.__wrapped__;if(i instanceof Ct){var o=i;return this.__actions__.length&&(o=new Ct(this)),o=o.reverse(),o.__actions__.push({func:Md,args:[ag],thisArg:t}),new Xi(o,this.__chain__)}return this.thru(ag)}function l8(){return CT(this.__wrapped__,this.__actions__)}var u8=Pd(function(i,o,u){Qt.call(i,u)?++i[u]:zs(i,u,1)});function d8(i,o,u){var h=ct(i)?Ux:tM;return u&&jr(i,o,u)&&(o=t),h(i,Ke(o,3))}function f8(i,o){var u=ct(i)?yo:uT;return u(i,Ke(o,3))}var p8=qT(sR),h8=qT(oR);function m8(i,o){return vr(qd(i,o),1)}function g8(i,o){return vr(qd(i,o),ue)}function _8(i,o,u){return u=u===t?1:ft(u),vr(qd(i,o),u)}function fR(i,o){var u=ct(i)?Hi:Ro;return u(i,Ke(o,3))}function pR(i,o){var u=ct(i)?NF:lT;return u(i,Ke(o,3))}var v8=Pd(function(i,o,u){Qt.call(i,u)?i[u].push(o):zs(i,u,[o])});function y8(i,o,u,h){i=ii(i)?i:nc(i),u=u&&!h?ft(u):0;var y=i.length;return u<0&&(u=or(y+u,0)),jd(i)?u<=y&&i.indexOf(o,u)>-1:!!y&&Ba(i,o,u)>-1}var w8=wt(function(i,o,u){var h=-1,y=typeof o=="function",P=ii(i)?ee(i.length):[];return Ro(i,function(M){P[++h]=y?wi(o,M,u):bl(M,o,u)}),P}),b8=Pd(function(i,o,u){zs(i,u,o)});function qd(i,o){var u=ct(i)?Tn:gT;return u(i,Ke(o,3))}function x8(i,o,u,h){return i==null?[]:(ct(o)||(o=o==null?[]:[o]),u=h?t:u,ct(u)||(u=u==null?[]:[u]),wT(i,o,u))}var T8=Pd(function(i,o,u){i[u?0:1].push(o)},function(){return[[],[]]});function R8(i,o,u){var h=ct(i)?wm:Xx,y=arguments.length<3;return h(i,Ke(o,4),u,y,Ro)}function E8(i,o,u){var h=ct(i)?MF:Xx,y=arguments.length<3;return h(i,Ke(o,4),u,y,lT)}function S8(i,o){var u=ct(i)?yo:uT;return u(i,Wd(Ke(o,3)))}function C8(i){var o=ct(i)?sT:yM;return o(i)}function k8(i,o,u){(u?jr(i,o,u):o===t)?o=1:o=ft(o);var h=ct(i)?VN:wM;return h(i,o)}function P8(i){var o=ct(i)?YN:xM;return o(i)}function A8(i){if(i==null)return 0;if(ii(i))return jd(i)?za(i):i.length;var o=kr(i);return o==Ye||o==st?i.size:Lm(i).length}function D8(i,o,u){var h=ct(i)?bm:TM;return u&&jr(i,o,u)&&(o=t),h(i,Ke(o,3))}var I8=wt(function(i,o){if(i==null)return[];var u=o.length;return u>1&&jr(i,o[0],o[1])?o=[]:u>2&&jr(o[0],o[1],o[2])&&(o=[o[0]]),wT(i,vr(o,1),[])}),Ld=fN||function(){return cr.Date.now()};function $8(i,o){if(typeof o!="function")throw new ji(s);return i=ft(i),function(){if(--i<1)return o.apply(this,arguments)}}function hR(i,o,u){return o=u?t:o,o=i&&o==null?i.length:o,Ks(i,L,t,t,t,t,o)}function mR(i,o){var u;if(typeof o!="function")throw new ji(s);return i=ft(i),function(){return--i>0&&(u=o.apply(this,arguments)),i<=1&&(o=t),u}}var lg=wt(function(i,o,u){var h=v;if(u.length){var y=bo(u,ec(lg));h|=$}return Ks(i,h,o,u,y)}),gR=wt(function(i,o,u){var h=v|x;if(u.length){var y=bo(u,ec(gR));h|=$}return Ks(o,h,i,u,y)});function _R(i,o,u){o=u?t:o;var h=Ks(i,S,t,t,t,t,t,o);return h.placeholder=_R.placeholder,h}function vR(i,o,u){o=u?t:o;var h=Ks(i,k,t,t,t,t,t,o);return h.placeholder=vR.placeholder,h}function yR(i,o,u){var h,y,P,M,B,Z,pe=0,he=!1,ve=!1,$e=!0;if(typeof i!="function")throw new ji(s);o=Ki(o)||0,$n(u)&&(he=!!u.leading,ve="maxWait"in u,P=ve?or(Ki(u.maxWait)||0,o):P,$e="trailing"in u?!!u.trailing:$e);function He(zn){var us=h,Qs=y;return h=y=t,pe=zn,M=i.apply(Qs,us),M}function Ze(zn){return pe=zn,B=Sl(xt,o),he?He(zn):M}function _t(zn){var us=zn-Z,Qs=zn-pe,qR=o-us;return ve?Cr(qR,P-Qs):qR}function Ve(zn){var us=zn-Z,Qs=zn-pe;return Z===t||us>=o||us<0||ve&&Qs>=P}function xt(){var zn=Ld();if(Ve(zn))return Dt(zn);B=Sl(xt,_t(zn))}function Dt(zn){return B=t,$e&&h?He(zn):(h=y=t,M)}function Ri(){B!==t&&PT(B),pe=0,h=Z=y=B=t}function Xr(){return B===t?M:Dt(Ld())}function Ei(){var zn=Ld(),us=Ve(zn);if(h=arguments,y=this,Z=zn,us){if(B===t)return Ze(Z);if(ve)return PT(B),B=Sl(xt,o),He(Z)}return B===t&&(B=Sl(xt,o)),M}return Ei.cancel=Ri,Ei.flush=Xr,Ei}var O8=wt(function(i,o){return cT(i,1,o)}),F8=wt(function(i,o,u){return cT(i,Ki(o)||0,u)});function N8(i){return Ks(i,N)}function Ud(i,o){if(typeof i!="function"||o!=null&&typeof o!="function")throw new ji(s);var u=function(){var h=arguments,y=o?o.apply(this,h):h[0],P=u.cache;if(P.has(y))return P.get(y);var M=i.apply(this,h);return u.cache=P.set(y,M)||P,M};return u.cache=new(Ud.Cache||Gs),u}Ud.Cache=Gs;function Wd(i){if(typeof i!="function")throw new ji(s);return function(){var o=arguments;switch(o.length){case 0:return!i.call(this);case 1:return!i.call(this,o[0]);case 2:return!i.call(this,o[0],o[1]);case 3:return!i.call(this,o[0],o[1],o[2])}return!i.apply(this,o)}}function M8(i){return mR(2,i)}var q8=RM(function(i,o){o=o.length==1&&ct(o[0])?Tn(o[0],bi(Ke())):Tn(vr(o,1),bi(Ke()));var u=o.length;return wt(function(h){for(var y=-1,P=Cr(h.length,u);++y<P;)h[y]=o[y].call(this,h[y]);return wi(i,this,h)})}),ug=wt(function(i,o){var u=bo(o,ec(ug));return Ks(i,$,t,o,u)}),wR=wt(function(i,o){var u=bo(o,ec(wR));return Ks(i,F,t,o,u)}),L8=Zs(function(i,o){return Ks(i,H,t,t,t,o)});function U8(i,o){if(typeof i!="function")throw new ji(s);return o=o===t?o:ft(o),wt(i,o)}function W8(i,o){if(typeof i!="function")throw new ji(s);return o=o==null?0:or(ft(o),0),wt(function(u){var h=u[o],y=Co(u,0,o);return h&&wo(y,h),wi(i,this,y)})}function H8(i,o,u){var h=!0,y=!0;if(typeof i!="function")throw new ji(s);return $n(u)&&(h="leading"in u?!!u.leading:h,y="trailing"in u?!!u.trailing:y),yR(i,o,{leading:h,maxWait:o,trailing:y})}function j8(i){return hR(i,1)}function X8(i,o){return ug(Km(o),i)}function B8(){if(!arguments.length)return[];var i=arguments[0];return ct(i)?i:[i]}function G8(i){return Bi(i,m)}function z8(i,o){return o=typeof o=="function"?o:t,Bi(i,m,o)}function K8(i){return Bi(i,f|m)}function Z8(i,o){return o=typeof o=="function"?o:t,Bi(i,f|m,o)}function V8(i,o){return o==null||aT(i,o,lr(o))}function ls(i,o){return i===o||i!==i&&o!==o}var Y8=$d(Nm),J8=$d(function(i,o){return i>=o}),ha=pT((function(){return arguments})())?pT:function(i){return Wn(i)&&Qt.call(i,"callee")&&!Qx.call(i,"callee")},ct=ee.isArray,Q8=Ox?bi(Ox):aM;function ii(i){return i!=null&&Hd(i.length)&&!Ys(i)}function Gn(i){return Wn(i)&&ii(i)}function eL(i){return i===!0||i===!1||Wn(i)&&Hr(i)==Xe}var ko=hN||bg,tL=Fx?bi(Fx):cM;function nL(i){return Wn(i)&&i.nodeType===1&&!Cl(i)}function rL(i){if(i==null)return!0;if(ii(i)&&(ct(i)||typeof i=="string"||typeof i.splice=="function"||ko(i)||tc(i)||ha(i)))return!i.length;var o=kr(i);if(o==Ye||o==st)return!i.size;if(El(i))return!Lm(i).length;for(var u in i)if(Qt.call(i,u))return!1;return!0}function iL(i,o){return xl(i,o)}function sL(i,o,u){u=typeof u=="function"?u:t;var h=u?u(i,o):t;return h===t?xl(i,o,t,u):!!h}function dg(i){if(!Wn(i))return!1;var o=Hr(i);return o==rn||o==We||typeof i.message=="string"&&typeof i.name=="string"&&!Cl(i)}function oL(i){return typeof i=="number"&&tT(i)}function Ys(i){if(!$n(i))return!1;var o=Hr(i);return o==sn||o==Bn||o==ze||o==tn}function bR(i){return typeof i=="number"&&i==ft(i)}function Hd(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=_e}function $n(i){var o=typeof i;return i!=null&&(o=="object"||o=="function")}function Wn(i){return i!=null&&typeof i=="object"}var xR=Nx?bi(Nx):uM;function aL(i,o){return i===o||qm(i,o,tg(o))}function cL(i,o,u){return u=typeof u=="function"?u:t,qm(i,o,tg(o),u)}function lL(i){return TR(i)&&i!=+i}function uL(i){if(zM(i))throw new ot(r);return hT(i)}function dL(i){return i===null}function fL(i){return i==null}function TR(i){return typeof i=="number"||Wn(i)&&Hr(i)==Yt}function Cl(i){if(!Wn(i)||Hr(i)!=rt)return!1;var o=md(i);if(o===null)return!0;var u=Qt.call(o,"constructor")&&o.constructor;return typeof u=="function"&&u instanceof u&&dd.call(u)==cN}var fg=Mx?bi(Mx):dM;function pL(i){return bR(i)&&i>=-_e&&i<=_e}var RR=qx?bi(qx):fM;function jd(i){return typeof i=="string"||!ct(i)&&Wn(i)&&Hr(i)==At}function Ti(i){return typeof i=="symbol"||Wn(i)&&Hr(i)==St}var tc=Lx?bi(Lx):pM;function hL(i){return i===t}function mL(i){return Wn(i)&&kr(i)==pn}function gL(i){return Wn(i)&&Hr(i)==Sr}var _L=$d(Um),vL=$d(function(i,o){return i<=o});function ER(i){if(!i)return[];if(ii(i))return jd(i)?as(i):ri(i);if(hl&&i[hl])return VF(i[hl]());var o=kr(i),u=o==Ye?Cm:o==st?cd:nc;return u(i)}function Js(i){if(!i)return i===0?i:0;if(i=Ki(i),i===ue||i===-ue){var o=i<0?-1:1;return o*ke}return i===i?i:0}function ft(i){var o=Js(i),u=o%1;return o===o?u?o-u:o:0}function SR(i){return i?ua(ft(i),0,Ie):0}function Ki(i){if(typeof i=="number")return i;if(Ti(i))return De;if($n(i)){var o=typeof i.valueOf=="function"?i.valueOf():i;i=$n(o)?o+"":o}if(typeof i!="string")return i===0?i:+i;i=Bx(i);var u=yi.test(i);return u||Li.test(i)?$F(i.slice(2),u?2:8):Wr.test(i)?De:+i}function CR(i){return Ps(i,si(i))}function yL(i){return i?ua(ft(i),-_e,_e):i===0?i:0}function Zt(i){return i==null?"":xi(i)}var wL=Ja(function(i,o){if(El(o)||ii(o)){Ps(o,lr(o),i);return}for(var u in o)Qt.call(o,u)&&yl(i,u,o[u])}),kR=Ja(function(i,o){Ps(o,si(o),i)}),Xd=Ja(function(i,o,u,h){Ps(o,si(o),i,h)}),bL=Ja(function(i,o,u,h){Ps(o,lr(o),i,h)}),xL=Zs($m);function TL(i,o){var u=Ya(i);return o==null?u:oT(u,o)}var RL=wt(function(i,o){i=on(i);var u=-1,h=o.length,y=h>2?o[2]:t;for(y&&jr(o[0],o[1],y)&&(h=1);++u<h;)for(var P=o[u],M=si(P),B=-1,Z=M.length;++B<Z;){var pe=M[B],he=i[pe];(he===t||ls(he,Ka[pe])&&!Qt.call(i,pe))&&(i[pe]=P[pe])}return i}),EL=wt(function(i){return i.push(t,BT),wi(PR,t,i)});function SL(i,o){return Wx(i,Ke(o,3),ks)}function CL(i,o){return Wx(i,Ke(o,3),Fm)}function kL(i,o){return i==null?i:Om(i,Ke(o,3),si)}function PL(i,o){return i==null?i:dT(i,Ke(o,3),si)}function AL(i,o){return i&&ks(i,Ke(o,3))}function DL(i,o){return i&&Fm(i,Ke(o,3))}function IL(i){return i==null?[]:Ed(i,lr(i))}function $L(i){return i==null?[]:Ed(i,si(i))}function pg(i,o,u){var h=i==null?t:da(i,o);return h===t?u:h}function OL(i,o){return i!=null&&KT(i,o,rM)}function hg(i,o){return i!=null&&KT(i,o,iM)}var FL=UT(function(i,o,u){o!=null&&typeof o.toString!="function"&&(o=fd.call(o)),i[o]=u},gg(oi)),NL=UT(function(i,o,u){o!=null&&typeof o.toString!="function"&&(o=fd.call(o)),Qt.call(i,o)?i[o].push(u):i[o]=[u]},Ke),ML=wt(bl);function lr(i){return ii(i)?iT(i):Lm(i)}function si(i){return ii(i)?iT(i,!0):hM(i)}function qL(i,o){var u={};return o=Ke(o,3),ks(i,function(h,y,P){zs(u,o(h,y,P),h)}),u}function LL(i,o){var u={};return o=Ke(o,3),ks(i,function(h,y,P){zs(u,y,o(h,y,P))}),u}var UL=Ja(function(i,o,u){Sd(i,o,u)}),PR=Ja(function(i,o,u,h){Sd(i,o,u,h)}),WL=Zs(function(i,o){var u={};if(i==null)return u;var h=!1;o=Tn(o,function(P){return P=So(P,i),h||(h=P.length>1),P}),Ps(i,Qm(i),u),h&&(u=Bi(u,f|p|m,FM));for(var y=o.length;y--;)Bm(u,o[y]);return u});function HL(i,o){return AR(i,Wd(Ke(o)))}var jL=Zs(function(i,o){return i==null?{}:gM(i,o)});function AR(i,o){if(i==null)return{};var u=Tn(Qm(i),function(h){return[h]});return o=Ke(o),bT(i,u,function(h,y){return o(h,y[0])})}function XL(i,o,u){o=So(o,i);var h=-1,y=o.length;for(y||(y=1,i=t);++h<y;){var P=i==null?t:i[As(o[h])];P===t&&(h=y,P=u),i=Ys(P)?P.call(i):P}return i}function BL(i,o,u){return i==null?i:Tl(i,o,u)}function GL(i,o,u,h){return h=typeof h=="function"?h:t,i==null?i:Tl(i,o,u,h)}var DR=jT(lr),IR=jT(si);function zL(i,o,u){var h=ct(i),y=h||ko(i)||tc(i);if(o=Ke(o,4),u==null){var P=i&&i.constructor;y?u=h?new P:[]:$n(i)?u=Ys(P)?Ya(md(i)):{}:u={}}return(y?Hi:ks)(i,function(M,B,Z){return o(u,M,B,Z)}),u}function KL(i,o){return i==null?!0:Bm(i,o)}function ZL(i,o,u){return i==null?i:ST(i,o,Km(u))}function VL(i,o,u,h){return h=typeof h=="function"?h:t,i==null?i:ST(i,o,Km(u),h)}function nc(i){return i==null?[]:Sm(i,lr(i))}function YL(i){return i==null?[]:Sm(i,si(i))}function JL(i,o,u){return u===t&&(u=o,o=t),u!==t&&(u=Ki(u),u=u===u?u:0),o!==t&&(o=Ki(o),o=o===o?o:0),ua(Ki(i),o,u)}function QL(i,o,u){return o=Js(o),u===t?(u=o,o=0):u=Js(u),i=Ki(i),sM(i,o,u)}function e3(i,o,u){if(u&&typeof u!="boolean"&&jr(i,o,u)&&(o=u=t),u===t&&(typeof o=="boolean"?(u=o,o=t):typeof i=="boolean"&&(u=i,i=t)),i===t&&o===t?(i=0,o=1):(i=Js(i),o===t?(o=i,i=0):o=Js(o)),i>o){var h=i;i=o,o=h}if(u||i%1||o%1){var y=nT();return Cr(i+y*(o-i+IF("1e-"+((y+"").length-1))),o)}return Hm(i,o)}var t3=Qa(function(i,o,u){return o=o.toLowerCase(),i+(u?$R(o):o)});function $R(i){return mg(Zt(i).toLowerCase())}function OR(i){return i=Zt(i),i&&i.replace(G,BF).replace(xF,"")}function n3(i,o,u){i=Zt(i),o=xi(o);var h=i.length;u=u===t?h:ua(ft(u),0,h);var y=u;return u-=o.length,u>=0&&i.slice(u,y)==o}function r3(i){return i=Zt(i),i&&Lt.test(i)?i.replace(Le,GF):i}function i3(i){return i=Zt(i),i&&E.test(i)?i.replace(z,"\\$&"):i}var s3=Qa(function(i,o,u){return i+(u?"-":"")+o.toLowerCase()}),o3=Qa(function(i,o,u){return i+(u?" ":"")+o.toLowerCase()}),a3=MT("toLowerCase");function c3(i,o,u){i=Zt(i),o=ft(o);var h=o?za(i):0;if(!o||h>=o)return i;var y=(o-h)/2;return Id(yd(y),u)+i+Id(vd(y),u)}function l3(i,o,u){i=Zt(i),o=ft(o);var h=o?za(i):0;return o&&h<o?i+Id(o-h,u):i}function u3(i,o,u){i=Zt(i),o=ft(o);var h=o?za(i):0;return o&&h<o?Id(o-h,u)+i:i}function d3(i,o,u){return u||o==null?o=0:o&&(o=+o),vN(Zt(i).replace(U,""),o||0)}function f3(i,o,u){return(u?jr(i,o,u):o===t)?o=1:o=ft(o),jm(Zt(i),o)}function p3(){var i=arguments,o=Zt(i[0]);return i.length<3?o:o.replace(i[1],i[2])}var h3=Qa(function(i,o,u){return i+(u?"_":"")+o.toLowerCase()});function m3(i,o,u){return u&&typeof u!="number"&&jr(i,o,u)&&(o=u=t),u=u===t?Ie:u>>>0,u?(i=Zt(i),i&&(typeof o=="string"||o!=null&&!fg(o))&&(o=xi(o),!o&&Ga(i))?Co(as(i),0,u):i.split(o,u)):[]}var g3=Qa(function(i,o,u){return i+(u?" ":"")+mg(o)});function _3(i,o,u){return i=Zt(i),u=u==null?0:ua(ft(u),0,i.length),o=xi(o),i.slice(u,u+o.length)==o}function v3(i,o,u){var h=C.templateSettings;u&&jr(i,o,u)&&(o=t),i=Zt(i),o=Xd({},o,h,XT);var y=Xd({},o.imports,h.imports,XT),P=lr(y),M=Sm(y,P),B,Z,pe=0,he=o.interpolate||de,ve="__p += '",$e=km((o.escape||de).source+"|"+he.source+"|"+(he===R?zt:de).source+"|"+(o.evaluate||de).source+"|$","g"),He="//# sourceURL="+(Qt.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++CF+"]")+`
`;i.replace($e,function(Ve,xt,Dt,Ri,Xr,Ei){return Dt||(Dt=Ri),ve+=i.slice(pe,Ei).replace(Ue,zF),xt&&(B=!0,ve+=`' +
__e(`+xt+`) +
'`),Xr&&(Z=!0,ve+=`';
`+Xr+`;
__p += '`),Dt&&(ve+=`' +
((__t = (`+Dt+`)) == null ? '' : __t) +
'`),pe=Ei+Ve.length,Ve}),ve+=`';
`;var Ze=Qt.call(o,"variable")&&o.variable;if(!Ze)ve=`with (obj) {
`+ve+`
}
`;else if(nt.test(Ze))throw new ot(a);ve=(Z?ve.replace(ne,""):ve).replace(re,"$1").replace(ye,"$1;"),ve="function("+(Ze||"obj")+`) {
`+(Ze?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(B?", __e = _.escape":"")+(Z?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ve+`return __p
}`;var _t=NR(function(){return Wt(P,He+"return "+ve).apply(t,M)});if(_t.source=ve,dg(_t))throw _t;return _t}function y3(i){return Zt(i).toLowerCase()}function w3(i){return Zt(i).toUpperCase()}function b3(i,o,u){if(i=Zt(i),i&&(u||o===t))return Bx(i);if(!i||!(o=xi(o)))return i;var h=as(i),y=as(o),P=Gx(h,y),M=zx(h,y)+1;return Co(h,P,M).join("")}function x3(i,o,u){if(i=Zt(i),i&&(u||o===t))return i.slice(0,Zx(i)+1);if(!i||!(o=xi(o)))return i;var h=as(i),y=zx(h,as(o))+1;return Co(h,0,y).join("")}function T3(i,o,u){if(i=Zt(i),i&&(u||o===t))return i.replace(U,"");if(!i||!(o=xi(o)))return i;var h=as(i),y=Gx(h,as(o));return Co(h,y).join("")}function R3(i,o){var u=X,h=V;if($n(o)){var y="separator"in o?o.separator:y;u="length"in o?ft(o.length):u,h="omission"in o?xi(o.omission):h}i=Zt(i);var P=i.length;if(Ga(i)){var M=as(i);P=M.length}if(u>=P)return i;var B=u-za(h);if(B<1)return h;var Z=M?Co(M,0,B).join(""):i.slice(0,B);if(y===t)return Z+h;if(M&&(B+=Z.length-B),fg(y)){if(i.slice(B).search(y)){var pe,he=Z;for(y.global||(y=km(y.source,Zt(_r.exec(y))+"g")),y.lastIndex=0;pe=y.exec(he);)var ve=pe.index;Z=Z.slice(0,ve===t?B:ve)}}else if(i.indexOf(xi(y),B)!=B){var $e=Z.lastIndexOf(y);$e>-1&&(Z=Z.slice(0,$e))}return Z+h}function E3(i){return i=Zt(i),i&&gt.test(i)?i.replace(Ee,eN):i}var S3=Qa(function(i,o,u){return i+(u?" ":"")+o.toUpperCase()}),mg=MT("toUpperCase");function FR(i,o,u){return i=Zt(i),o=u?t:o,o===t?ZF(i)?rN(i):UF(i):i.match(o)||[]}var NR=wt(function(i,o){try{return wi(i,t,o)}catch(u){return dg(u)?u:new ot(u)}}),C3=Zs(function(i,o){return Hi(o,function(u){u=As(u),zs(i,u,lg(i[u],i))}),i});function k3(i){var o=i==null?0:i.length,u=Ke();return i=o?Tn(i,function(h){if(typeof h[1]!="function")throw new ji(s);return[u(h[0]),h[1]]}):[],wt(function(h){for(var y=-1;++y<o;){var P=i[y];if(wi(P[0],this,h))return wi(P[1],this,h)}})}function P3(i){return eM(Bi(i,f))}function gg(i){return function(){return i}}function A3(i,o){return i==null||i!==i?o:i}var D3=LT(),I3=LT(!0);function oi(i){return i}function _g(i){return mT(typeof i=="function"?i:Bi(i,f))}function $3(i){return _T(Bi(i,f))}function O3(i,o){return vT(i,Bi(o,f))}var F3=wt(function(i,o){return function(u){return bl(u,i,o)}}),N3=wt(function(i,o){return function(u){return bl(i,u,o)}});function vg(i,o,u){var h=lr(o),y=Ed(o,h);u==null&&!($n(o)&&(y.length||!h.length))&&(u=o,o=i,i=this,y=Ed(o,lr(o)));var P=!($n(u)&&"chain"in u)||!!u.chain,M=Ys(i);return Hi(y,function(B){var Z=o[B];i[B]=Z,M&&(i.prototype[B]=function(){var pe=this.__chain__;if(P||pe){var he=i(this.__wrapped__),ve=he.__actions__=ri(this.__actions__);return ve.push({func:Z,args:arguments,thisArg:i}),he.__chain__=pe,he}return Z.apply(i,wo([this.value()],arguments))})}),i}function M3(){return cr._===this&&(cr._=lN),this}function yg(){}function q3(i){return i=ft(i),wt(function(o){return yT(o,i)})}var L3=Vm(Tn),U3=Vm(Ux),W3=Vm(bm);function MR(i){return rg(i)?xm(As(i)):_M(i)}function H3(i){return function(o){return i==null?t:da(i,o)}}var j3=WT(),X3=WT(!0);function wg(){return[]}function bg(){return!1}function B3(){return{}}function G3(){return""}function z3(){return!0}function K3(i,o){if(i=ft(i),i<1||i>_e)return[];var u=Ie,h=Cr(i,Ie);o=Ke(o),i-=Ie;for(var y=Em(h,o);++u<i;)o(u);return y}function Z3(i){return ct(i)?Tn(i,As):Ti(i)?[i]:ri(rR(Zt(i)))}function V3(i){var o=++aN;return Zt(i)+o}var Y3=Dd(function(i,o){return i+o},0),J3=Ym("ceil"),Q3=Dd(function(i,o){return i/o},1),eU=Ym("floor");function tU(i){return i&&i.length?Rd(i,oi,Nm):t}function nU(i,o){return i&&i.length?Rd(i,Ke(o,2),Nm):t}function rU(i){return jx(i,oi)}function iU(i,o){return jx(i,Ke(o,2))}function sU(i){return i&&i.length?Rd(i,oi,Um):t}function oU(i,o){return i&&i.length?Rd(i,Ke(o,2),Um):t}var aU=Dd(function(i,o){return i*o},1),cU=Ym("round"),lU=Dd(function(i,o){return i-o},0);function uU(i){return i&&i.length?Rm(i,oi):0}function dU(i,o){return i&&i.length?Rm(i,Ke(o,2)):0}return C.after=$8,C.ary=hR,C.assign=wL,C.assignIn=kR,C.assignInWith=Xd,C.assignWith=bL,C.at=xL,C.before=mR,C.bind=lg,C.bindAll=C3,C.bindKey=gR,C.castArray=B8,C.chain=dR,C.chunk=eq,C.compact=tq,C.concat=nq,C.cond=k3,C.conforms=P3,C.constant=gg,C.countBy=u8,C.create=TL,C.curry=_R,C.curryRight=vR,C.debounce=yR,C.defaults=RL,C.defaultsDeep=EL,C.defer=O8,C.delay=F8,C.difference=rq,C.differenceBy=iq,C.differenceWith=sq,C.drop=oq,C.dropRight=aq,C.dropRightWhile=cq,C.dropWhile=lq,C.fill=uq,C.filter=f8,C.flatMap=m8,C.flatMapDeep=g8,C.flatMapDepth=_8,C.flatten=aR,C.flattenDeep=dq,C.flattenDepth=fq,C.flip=N8,C.flow=D3,C.flowRight=I3,C.fromPairs=pq,C.functions=IL,C.functionsIn=$L,C.groupBy=v8,C.initial=mq,C.intersection=gq,C.intersectionBy=_q,C.intersectionWith=vq,C.invert=FL,C.invertBy=NL,C.invokeMap=w8,C.iteratee=_g,C.keyBy=b8,C.keys=lr,C.keysIn=si,C.map=qd,C.mapKeys=qL,C.mapValues=LL,C.matches=$3,C.matchesProperty=O3,C.memoize=Ud,C.merge=UL,C.mergeWith=PR,C.method=F3,C.methodOf=N3,C.mixin=vg,C.negate=Wd,C.nthArg=q3,C.omit=WL,C.omitBy=HL,C.once=M8,C.orderBy=x8,C.over=L3,C.overArgs=q8,C.overEvery=U3,C.overSome=W3,C.partial=ug,C.partialRight=wR,C.partition=T8,C.pick=jL,C.pickBy=AR,C.property=MR,C.propertyOf=H3,C.pull=xq,C.pullAll=lR,C.pullAllBy=Tq,C.pullAllWith=Rq,C.pullAt=Eq,C.range=j3,C.rangeRight=X3,C.rearg=L8,C.reject=S8,C.remove=Sq,C.rest=U8,C.reverse=ag,C.sampleSize=k8,C.set=BL,C.setWith=GL,C.shuffle=P8,C.slice=Cq,C.sortBy=I8,C.sortedUniq=Oq,C.sortedUniqBy=Fq,C.split=m3,C.spread=W8,C.tail=Nq,C.take=Mq,C.takeRight=qq,C.takeRightWhile=Lq,C.takeWhile=Uq,C.tap=t8,C.throttle=H8,C.thru=Md,C.toArray=ER,C.toPairs=DR,C.toPairsIn=IR,C.toPath=Z3,C.toPlainObject=CR,C.transform=zL,C.unary=j8,C.union=Wq,C.unionBy=Hq,C.unionWith=jq,C.uniq=Xq,C.uniqBy=Bq,C.uniqWith=Gq,C.unset=KL,C.unzip=cg,C.unzipWith=uR,C.update=ZL,C.updateWith=VL,C.values=nc,C.valuesIn=YL,C.without=zq,C.words=FR,C.wrap=X8,C.xor=Kq,C.xorBy=Zq,C.xorWith=Vq,C.zip=Yq,C.zipObject=Jq,C.zipObjectDeep=Qq,C.zipWith=e8,C.entries=DR,C.entriesIn=IR,C.extend=kR,C.extendWith=Xd,vg(C,C),C.add=Y3,C.attempt=NR,C.camelCase=t3,C.capitalize=$R,C.ceil=J3,C.clamp=JL,C.clone=G8,C.cloneDeep=K8,C.cloneDeepWith=Z8,C.cloneWith=z8,C.conformsTo=V8,C.deburr=OR,C.defaultTo=A3,C.divide=Q3,C.endsWith=n3,C.eq=ls,C.escape=r3,C.escapeRegExp=i3,C.every=d8,C.find=p8,C.findIndex=sR,C.findKey=SL,C.findLast=h8,C.findLastIndex=oR,C.findLastKey=CL,C.floor=eU,C.forEach=fR,C.forEachRight=pR,C.forIn=kL,C.forInRight=PL,C.forOwn=AL,C.forOwnRight=DL,C.get=pg,C.gt=Y8,C.gte=J8,C.has=OL,C.hasIn=hg,C.head=cR,C.identity=oi,C.includes=y8,C.indexOf=hq,C.inRange=QL,C.invoke=ML,C.isArguments=ha,C.isArray=ct,C.isArrayBuffer=Q8,C.isArrayLike=ii,C.isArrayLikeObject=Gn,C.isBoolean=eL,C.isBuffer=ko,C.isDate=tL,C.isElement=nL,C.isEmpty=rL,C.isEqual=iL,C.isEqualWith=sL,C.isError=dg,C.isFinite=oL,C.isFunction=Ys,C.isInteger=bR,C.isLength=Hd,C.isMap=xR,C.isMatch=aL,C.isMatchWith=cL,C.isNaN=lL,C.isNative=uL,C.isNil=fL,C.isNull=dL,C.isNumber=TR,C.isObject=$n,C.isObjectLike=Wn,C.isPlainObject=Cl,C.isRegExp=fg,C.isSafeInteger=pL,C.isSet=RR,C.isString=jd,C.isSymbol=Ti,C.isTypedArray=tc,C.isUndefined=hL,C.isWeakMap=mL,C.isWeakSet=gL,C.join=yq,C.kebabCase=s3,C.last=zi,C.lastIndexOf=wq,C.lowerCase=o3,C.lowerFirst=a3,C.lt=_L,C.lte=vL,C.max=tU,C.maxBy=nU,C.mean=rU,C.meanBy=iU,C.min=sU,C.minBy=oU,C.stubArray=wg,C.stubFalse=bg,C.stubObject=B3,C.stubString=G3,C.stubTrue=z3,C.multiply=aU,C.nth=bq,C.noConflict=M3,C.noop=yg,C.now=Ld,C.pad=c3,C.padEnd=l3,C.padStart=u3,C.parseInt=d3,C.random=e3,C.reduce=R8,C.reduceRight=E8,C.repeat=f3,C.replace=p3,C.result=XL,C.round=cU,C.runInContext=K,C.sample=C8,C.size=A8,C.snakeCase=h3,C.some=D8,C.sortedIndex=kq,C.sortedIndexBy=Pq,C.sortedIndexOf=Aq,C.sortedLastIndex=Dq,C.sortedLastIndexBy=Iq,C.sortedLastIndexOf=$q,C.startCase=g3,C.startsWith=_3,C.subtract=lU,C.sum=uU,C.sumBy=dU,C.template=v3,C.times=K3,C.toFinite=Js,C.toInteger=ft,C.toLength=SR,C.toLower=y3,C.toNumber=Ki,C.toSafeInteger=yL,C.toString=Zt,C.toUpper=w3,C.trim=b3,C.trimEnd=x3,C.trimStart=T3,C.truncate=R3,C.unescape=E3,C.uniqueId=V3,C.upperCase=S3,C.upperFirst=mg,C.each=fR,C.eachRight=pR,C.first=cR,vg(C,(function(){var i={};return ks(C,function(o,u){Qt.call(C.prototype,u)||(i[u]=o)}),i})(),{chain:!1}),C.VERSION=e,Hi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){C[i].placeholder=C}),Hi(["drop","take"],function(i,o){Ct.prototype[i]=function(u){u=u===t?1:or(ft(u),0);var h=this.__filtered__&&!o?new Ct(this):this.clone();return h.__filtered__?h.__takeCount__=Cr(u,h.__takeCount__):h.__views__.push({size:Cr(u,Ie),type:i+(h.__dir__<0?"Right":"")}),h},Ct.prototype[i+"Right"]=function(u){return this.reverse()[i](u).reverse()}}),Hi(["filter","map","takeWhile"],function(i,o){var u=o+1,h=u==j||u==me;Ct.prototype[i]=function(y){var P=this.clone();return P.__iteratees__.push({iteratee:Ke(y,3),type:u}),P.__filtered__=P.__filtered__||h,P}}),Hi(["head","last"],function(i,o){var u="take"+(o?"Right":"");Ct.prototype[i]=function(){return this[u](1).value()[0]}}),Hi(["initial","tail"],function(i,o){var u="drop"+(o?"":"Right");Ct.prototype[i]=function(){return this.__filtered__?new Ct(this):this[u](1)}}),Ct.prototype.compact=function(){return this.filter(oi)},Ct.prototype.find=function(i){return this.filter(i).head()},Ct.prototype.findLast=function(i){return this.reverse().find(i)},Ct.prototype.invokeMap=wt(function(i,o){return typeof i=="function"?new Ct(this):this.map(function(u){return bl(u,i,o)})}),Ct.prototype.reject=function(i){return this.filter(Wd(Ke(i)))},Ct.prototype.slice=function(i,o){i=ft(i);var u=this;return u.__filtered__&&(i>0||o<0)?new Ct(u):(i<0?u=u.takeRight(-i):i&&(u=u.drop(i)),o!==t&&(o=ft(o),u=o<0?u.dropRight(-o):u.take(o-i)),u)},Ct.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},Ct.prototype.toArray=function(){return this.take(Ie)},ks(Ct.prototype,function(i,o){var u=/^(?:filter|find|map|reject)|While$/.test(o),h=/^(?:head|last)$/.test(o),y=C[h?"take"+(o=="last"?"Right":""):o],P=h||/^find/.test(o);y&&(C.prototype[o]=function(){var M=this.__wrapped__,B=h?[1]:arguments,Z=M instanceof Ct,pe=B[0],he=Z||ct(M),ve=function(xt){var Dt=y.apply(C,wo([xt],B));return h&&$e?Dt[0]:Dt};he&&u&&typeof pe=="function"&&pe.length!=1&&(Z=he=!1);var $e=this.__chain__,He=!!this.__actions__.length,Ze=P&&!$e,_t=Z&&!He;if(!P&&he){M=_t?M:new Ct(this);var Ve=i.apply(M,B);return Ve.__actions__.push({func:Md,args:[ve],thisArg:t}),new Xi(Ve,$e)}return Ze&&_t?i.apply(this,B):(Ve=this.thru(ve),Ze?h?Ve.value()[0]:Ve.value():Ve)})}),Hi(["pop","push","shift","sort","splice","unshift"],function(i){var o=ld[i],u=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",h=/^(?:pop|shift)$/.test(i);C.prototype[i]=function(){var y=arguments;if(h&&!this.__chain__){var P=this.value();return o.apply(ct(P)?P:[],y)}return this[u](function(M){return o.apply(ct(M)?M:[],y)})}}),ks(Ct.prototype,function(i,o){var u=C[o];if(u){var h=u.name+"";Qt.call(Va,h)||(Va[h]=[]),Va[h].push({name:o,func:u})}}),Va[Ad(t,x).name]=[{name:"wrapper",func:t}],Ct.prototype.clone=EN,Ct.prototype.reverse=SN,Ct.prototype.value=CN,C.prototype.at=n8,C.prototype.chain=r8,C.prototype.commit=i8,C.prototype.next=s8,C.prototype.plant=a8,C.prototype.reverse=c8,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=l8,C.prototype.first=C.prototype.head,hl&&(C.prototype[hl]=o8),C}),xo=iN();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(cr._=xo,define(function(){return xo})):oa?((oa.exports=xo)._=xo,_m._=xo):cr._=xo}).call(rc)});var es=oe(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.asPromise=Hn.thenable=Hn.typedArray=Hn.stringArray=Hn.array=Hn.func=Hn.error=Hn.number=Hn.string=Hn.boolean=void 0;function K6(t){return t===!0||t===!1}Hn.boolean=K6;function LP(t){return typeof t=="string"||t instanceof String}Hn.string=LP;function Z6(t){return typeof t=="number"||t instanceof Number}Hn.number=Z6;function V6(t){return t instanceof Error}Hn.error=V6;function UP(t){return typeof t=="function"}Hn.func=UP;function WP(t){return Array.isArray(t)}Hn.array=WP;function Y6(t){return WP(t)&&t.every(e=>LP(e))}Hn.stringArray=Y6;function J6(t,e){return Array.isArray(t)&&t.every(e)}Hn.typedArray=J6;function HP(t){return t&&UP(t.then)}Hn.thenable=HP;function Q6(t){return t instanceof Promise?t:HP(t)?new Promise((e,n)=>{t.then(r=>e(r),r=>n(r))}):Promise.resolve(t)}Hn.asPromise=Q6});var Ic=oe($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.stringArray=$r.array=$r.func=$r.error=$r.number=$r.string=$r.boolean=void 0;function e9(t){return t===!0||t===!1}$r.boolean=e9;function jP(t){return typeof t=="string"||t instanceof String}$r.string=jP;function t9(t){return typeof t=="number"||t instanceof Number}$r.number=t9;function n9(t){return t instanceof Error}$r.error=n9;function r9(t){return typeof t=="function"}$r.func=r9;function XP(t){return Array.isArray(t)}$r.array=XP;function i9(t){return XP(t)&&t.every(e=>jP(e))}$r.stringArray=i9});var ny=oe(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.Message=Be.NotificationType9=Be.NotificationType8=Be.NotificationType7=Be.NotificationType6=Be.NotificationType5=Be.NotificationType4=Be.NotificationType3=Be.NotificationType2=Be.NotificationType1=Be.NotificationType0=Be.NotificationType=Be.RequestType9=Be.RequestType8=Be.RequestType7=Be.RequestType6=Be.RequestType5=Be.RequestType4=Be.RequestType3=Be.RequestType2=Be.RequestType1=Be.RequestType=Be.RequestType0=Be.AbstractMessageSignature=Be.ParameterStructures=Be.ResponseError=Be.ErrorCodes=void 0;var ka=Ic(),Iv;(function(t){t.ParseError=-32700,t.InvalidRequest=-32600,t.MethodNotFound=-32601,t.InvalidParams=-32602,t.InternalError=-32603,t.jsonrpcReservedErrorRangeStart=-32099,t.serverErrorStart=-32099,t.MessageWriteError=-32099,t.MessageReadError=-32098,t.PendingResponseRejected=-32097,t.ConnectionInactive=-32096,t.ServerNotInitialized=-32002,t.UnknownErrorCode=-32001,t.jsonrpcReservedErrorRangeEnd=-32e3,t.serverErrorEnd=-32e3})(Iv||(Be.ErrorCodes=Iv={}));var $v=class t extends Error{constructor(e,n,r){super(n),this.code=ka.number(e)?e:Iv.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,t.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};Be.ResponseError=$v;var ui=class t{constructor(e){this.kind=e}static is(e){return e===t.auto||e===t.byName||e===t.byPosition}toString(){return this.kind}};Be.ParameterStructures=ui;ui.auto=new ui("auto");ui.byPosition=new ui("byPosition");ui.byName=new ui("byName");var wn=class{constructor(e,n){this.method=e,this.numberOfParams=n}get parameterStructures(){return ui.auto}};Be.AbstractMessageSignature=wn;var Ov=class extends wn{constructor(e){super(e,0)}};Be.RequestType0=Ov;var Fv=class extends wn{constructor(e,n=ui.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};Be.RequestType=Fv;var Nv=class extends wn{constructor(e,n=ui.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};Be.RequestType1=Nv;var Mv=class extends wn{constructor(e){super(e,2)}};Be.RequestType2=Mv;var qv=class extends wn{constructor(e){super(e,3)}};Be.RequestType3=qv;var Lv=class extends wn{constructor(e){super(e,4)}};Be.RequestType4=Lv;var Uv=class extends wn{constructor(e){super(e,5)}};Be.RequestType5=Uv;var Wv=class extends wn{constructor(e){super(e,6)}};Be.RequestType6=Wv;var Hv=class extends wn{constructor(e){super(e,7)}};Be.RequestType7=Hv;var jv=class extends wn{constructor(e){super(e,8)}};Be.RequestType8=jv;var Xv=class extends wn{constructor(e){super(e,9)}};Be.RequestType9=Xv;var Bv=class extends wn{constructor(e,n=ui.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};Be.NotificationType=Bv;var Gv=class extends wn{constructor(e){super(e,0)}};Be.NotificationType0=Gv;var zv=class extends wn{constructor(e,n=ui.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};Be.NotificationType1=zv;var Kv=class extends wn{constructor(e){super(e,2)}};Be.NotificationType2=Kv;var Zv=class extends wn{constructor(e){super(e,3)}};Be.NotificationType3=Zv;var Vv=class extends wn{constructor(e){super(e,4)}};Be.NotificationType4=Vv;var Yv=class extends wn{constructor(e){super(e,5)}};Be.NotificationType5=Yv;var Jv=class extends wn{constructor(e){super(e,6)}};Be.NotificationType6=Jv;var Qv=class extends wn{constructor(e){super(e,7)}};Be.NotificationType7=Qv;var ey=class extends wn{constructor(e){super(e,8)}};Be.NotificationType8=ey;var ty=class extends wn{constructor(e){super(e,9)}};Be.NotificationType9=ty;var BP;(function(t){function e(s){let a=s;return a&&ka.string(a.method)&&(ka.string(a.id)||ka.number(a.id))}t.isRequest=e;function n(s){let a=s;return a&&ka.string(a.method)&&s.id===void 0}t.isNotification=n;function r(s){let a=s;return a&&(a.result!==void 0||!!a.error)&&(ka.string(a.id)||ka.number(a.id)||a.id===null)}t.isResponse=r})(BP||(Be.Message=BP={}))});var iy=oe(Ho=>{"use strict";var GP;Object.defineProperty(Ho,"__esModule",{value:!0});Ho.LRUCache=Ho.LinkedMap=Ho.Touch=void 0;var Or;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Or||(Ho.Touch=Or={}));var yp=class{constructor(){this[GP]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,n=Or.None){let r=this._map.get(e);if(r)return n!==Or.None&&this.touch(r,n),r.value}set(e,n,r=Or.None){let s=this._map.get(e);if(s)s.value=n,r!==Or.None&&this.touch(s,r);else{switch(s={key:e,value:n,next:void 0,previous:void 0},r){case Or.None:this.addItemLast(s);break;case Or.First:this.addItemFirst(s);break;case Or.Last:this.addItemLast(s);break;default:this.addItemLast(s);break}this._map.set(e,s),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let n=this._map.get(e);if(n)return this._map.delete(e),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,n){let r=this._state,s=this._head;for(;s;){if(n?e.bind(n)(s.value,s.key,this):e(s.value,s.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");s=s.next}}keys(){let e=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.key,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.value,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,n=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:[n.key,n.value],done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return r}[(GP=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let n=this._head,r=this.size;for(;n&&r>e;)this._map.delete(n.key),n=n.next,r--;this._head=n,this._size=r,n&&(n.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let n=e.next,r=e.previous;if(!n||!r)throw new Error("Invalid list");n.previous=r,r.next=n}e.next=void 0,e.previous=void 0,this._state++}touch(e,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==Or.First&&n!==Or.Last)){if(n===Or.First){if(e===this._head)return;let r=e.next,s=e.previous;e===this._tail?(s.next=void 0,this._tail=s):(r.previous=s,s.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(n===Or.Last){if(e===this._tail)return;let r=e.next,s=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=s,s.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((n,r)=>{e.push([r,n])}),e}fromJSON(e){this.clear();for(let[n,r]of e)this.set(n,r)}};Ho.LinkedMap=yp;var ry=class extends yp{constructor(e,n=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,n=Or.AsNew){return super.get(e,n)}peek(e){return super.get(e,Or.None)}set(e,n){return super.set(e,n,Or.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};Ho.LRUCache=ry});var KP=oe(wp=>{"use strict";Object.defineProperty(wp,"__esModule",{value:!0});wp.Disposable=void 0;var zP;(function(t){function e(n){return{dispose:n}}t.create=e})(zP||(wp.Disposable=zP={}))});var jo=oe(ay=>{"use strict";Object.defineProperty(ay,"__esModule",{value:!0});var sy;function oy(){if(sy===void 0)throw new Error("No runtime abstraction layer installed");return sy}(function(t){function e(n){if(n===void 0)throw new Error("No runtime abstraction layer provided");sy=n}t.install=e})(oy||(oy={}));ay.default=oy});var Oc=oe($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.Emitter=$c.Event=void 0;var s9=jo(),ZP;(function(t){let e={dispose(){}};t.None=function(){return e}})(ZP||($c.Event=ZP={}));var cy=class{add(e,n=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(n),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,n)})}remove(e,n=null){if(!this._callbacks)return;let r=!1;for(let s=0,a=this._callbacks.length;s<a;s++)if(this._callbacks[s]===e)if(this._contexts[s]===n){this._callbacks.splice(s,1),this._contexts.splice(s,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let n=[],r=this._callbacks.slice(0),s=this._contexts.slice(0);for(let a=0,c=r.length;a<c;a++)try{n.push(r[a].apply(s[a],e))}catch(l){(0,s9.default)().console.error(l)}return n}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},bp=class t{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,n,r)=>{this._callbacks||(this._callbacks=new cy),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,n);let s={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,n),s.dispose=t._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(s),s}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};$c.Emitter=bp;bp._noop=function(){}});var Rp=oe(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.CancellationTokenSource=Fc.CancellationToken=void 0;var o9=jo(),a9=Ic(),ly=Oc(),xp;(function(t){t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ly.Event.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:ly.Event.None});function e(n){let r=n;return r&&(r===t.None||r===t.Cancelled||a9.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}t.is=e})(xp||(Fc.CancellationToken=xp={}));var c9=Object.freeze(function(t,e){let n=(0,o9.default)().timer.setTimeout(t.bind(e),0);return{dispose(){n.dispose()}}}),Tp=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?c9:(this._emitter||(this._emitter=new ly.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},uy=class{get token(){return this._token||(this._token=new Tp),this._token}cancel(){this._token?this._token.cancel():this._token=xp.Cancelled}dispose(){this._token?this._token instanceof Tp&&this._token.dispose():this._token=xp.None}};Fc.CancellationTokenSource=uy});var VP=oe(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.SharedArrayReceiverStrategy=Nc.SharedArraySenderStrategy=void 0;var l9=Rp(),vu;(function(t){t.Continue=0,t.Cancelled=1})(vu||(vu={}));var dy=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let n=new SharedArrayBuffer(4),r=new Int32Array(n,0,1);r[0]=vu.Continue,this.buffers.set(e.id,n),e.$cancellationData=n}async sendCancellation(e,n){let r=this.buffers.get(n);if(r===void 0)return;let s=new Int32Array(r,0,1);Atomics.store(s,0,vu.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};Nc.SharedArraySenderStrategy=dy;var fy=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===vu.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},py=class{constructor(e){this.token=new fy(e)}cancel(){}dispose(){}},hy=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let n=e.$cancellationData;return n===void 0?new l9.CancellationTokenSource:new py(n)}};Nc.SharedArrayReceiverStrategy=hy});var gy=oe(Ep=>{"use strict";Object.defineProperty(Ep,"__esModule",{value:!0});Ep.Semaphore=void 0;var u9=jo(),my=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((n,r)=>{this._waiting.push({thunk:e,resolve:n,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,u9.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let n=e.thunk();n instanceof Promise?n.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(n),this.runNext())}catch(n){this._active--,e.reject(n),this.runNext()}}};Ep.Semaphore=my});var JP=oe(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.ReadableStreamMessageReader=Xo.AbstractMessageReader=Xo.MessageReader=void 0;var vy=jo(),Mc=Ic(),_y=Oc(),d9=gy(),YP;(function(t){function e(n){let r=n;return r&&Mc.func(r.listen)&&Mc.func(r.dispose)&&Mc.func(r.onError)&&Mc.func(r.onClose)&&Mc.func(r.onPartialMessage)}t.is=e})(YP||(Xo.MessageReader=YP={}));var Sp=class{constructor(){this.errorEmitter=new _y.Emitter,this.closeEmitter=new _y.Emitter,this.partialMessageEmitter=new _y.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${Mc.string(e.message)?e.message:"unknown"}`)}};Xo.AbstractMessageReader=Sp;var yy;(function(t){function e(n){let r,s,a,c=new Map,l,d=new Map;if(n===void 0||typeof n=="string")r=n??"utf-8";else{if(r=n.charset??"utf-8",n.contentDecoder!==void 0&&(a=n.contentDecoder,c.set(a.name,a)),n.contentDecoders!==void 0)for(let f of n.contentDecoders)c.set(f.name,f);if(n.contentTypeDecoder!==void 0&&(l=n.contentTypeDecoder,d.set(l.name,l)),n.contentTypeDecoders!==void 0)for(let f of n.contentTypeDecoders)d.set(f.name,f)}return l===void 0&&(l=(0,vy.default)().applicationJson.decoder,d.set(l.name,l)),{charset:r,contentDecoder:a,contentDecoders:c,contentTypeDecoder:l,contentTypeDecoders:d}}t.fromOptions=e})(yy||(yy={}));var wy=class extends Sp{constructor(e,n){super(),this.readable=e,this.options=yy.fromOptions(n),this.buffer=(0,vy.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new d9.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let n=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),n}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let s=r.get("content-length");if(!s){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let a=parseInt(s);if(isNaN(a)){this.fireError(new Error(`Content-Length value must be a number. Got ${s}`));return}this.nextMessageLength=a}let n=this.buffer.tryReadBody(this.nextMessageLength);if(n===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(n):n,s=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(s)}).catch(r=>{this.fireError(r)})}}catch(n){this.fireError(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,vy.default)().timer.setTimeout((e,n)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:n}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};Xo.ReadableStreamMessageReader=wy});var rA=oe(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.WriteableStreamMessageWriter=Bo.AbstractMessageWriter=Bo.MessageWriter=void 0;var QP=jo(),yu=Ic(),f9=gy(),eA=Oc(),p9="Content-Length: ",tA=`\r
`,nA;(function(t){function e(n){let r=n;return r&&yu.func(r.dispose)&&yu.func(r.onClose)&&yu.func(r.onError)&&yu.func(r.write)}t.is=e})(nA||(Bo.MessageWriter=nA={}));var Cp=class{constructor(){this.errorEmitter=new eA.Emitter,this.closeEmitter=new eA.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,n,r){this.errorEmitter.fire([this.asError(e),n,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${yu.string(e.message)?e.message:"unknown"}`)}};Bo.AbstractMessageWriter=Cp;var by;(function(t){function e(n){return n===void 0||typeof n=="string"?{charset:n??"utf-8",contentTypeEncoder:(0,QP.default)().applicationJson.encoder}:{charset:n.charset??"utf-8",contentEncoder:n.contentEncoder,contentTypeEncoder:n.contentTypeEncoder??(0,QP.default)().applicationJson.encoder}}t.fromOptions=e})(by||(by={}));var xy=class extends Cp{constructor(e,n){super(),this.writable=e,this.options=by.fromOptions(n),this.errorCount=0,this.writeSemaphore=new f9.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let s=[];return s.push(p9,r.byteLength.toString(),tA),s.push(tA),this.doWrite(e,s,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,n,r){try{return await this.writable.write(n.join(""),"ascii"),this.writable.write(r)}catch(s){return this.handleError(s,e),Promise.reject(s)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){this.writable.end()}};Bo.WriteableStreamMessageWriter=xy});var iA=oe(kp=>{"use strict";Object.defineProperty(kp,"__esModule",{value:!0});kp.AbstractMessageBuffer=void 0;var h9=13,m9=10,g9=`\r
`,Ty=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let n=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(n),this._totalLength+=n.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let n=0,r=0,s=0,a=0;e:for(;r<this._chunks.length;){let f=this._chunks[r];for(s=0;s<f.length;){switch(f[s]){case h9:switch(n){case 0:n=1;break;case 2:n=3;break;default:n=0}break;case m9:switch(n){case 1:n=2;break;case 3:n=4,s++;break e;default:n=0}break;default:n=0}s++}a+=f.byteLength,r++}if(n!==4)return;let c=this._read(a+s),l=new Map,d=this.toString(c,"ascii").split(g9);if(d.length<2)return l;for(let f=0;f<d.length-2;f++){let p=d[f],m=p.indexOf(":");if(m===-1)throw new Error(`Message header must separate key and value using ':'
${p}`);let g=p.substr(0,m),w=p.substr(m+1).trim();l.set(e?g.toLowerCase():g,w)}return l}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let a=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(a)}if(this._chunks[0].byteLength>e){let a=this._chunks[0],c=this.asNative(a,e);return this._chunks[0]=a.slice(e),this._totalLength-=e,c}let n=this.allocNative(e),r=0,s=0;for(;e>0;){let a=this._chunks[s];if(a.byteLength>e){let c=a.slice(0,e);n.set(c,r),r+=e,this._chunks[s]=a.slice(e),this._totalLength-=e,e-=e}else n.set(a,r),r+=a.byteLength,this._chunks.shift(),this._totalLength-=a.byteLength,e-=a.byteLength}return n}};kp.AbstractMessageBuffer=Ty});var lA=oe(lt=>{"use strict";Object.defineProperty(lt,"__esModule",{value:!0});lt.createMessageConnection=lt.ConnectionOptions=lt.MessageStrategy=lt.CancellationStrategy=lt.CancellationSenderStrategy=lt.CancellationReceiverStrategy=lt.RequestCancellationReceiverStrategy=lt.IdCancellationReceiverStrategy=lt.ConnectionStrategy=lt.ConnectionError=lt.ConnectionErrors=lt.LogTraceNotification=lt.SetTraceNotification=lt.TraceFormat=lt.TraceValues=lt.Trace=lt.NullLogger=lt.ProgressType=lt.ProgressToken=void 0;var sA=jo(),Nn=Ic(),Qe=ny(),oA=iy(),wu=Oc(),Ry=Rp(),Tu;(function(t){t.type=new Qe.NotificationType("$/cancelRequest")})(Tu||(Tu={}));var Ey;(function(t){function e(n){return typeof n=="string"||typeof n=="number"}t.is=e})(Ey||(lt.ProgressToken=Ey={}));var bu;(function(t){t.type=new Qe.NotificationType("$/progress")})(bu||(bu={}));var Sy=class{constructor(){}};lt.ProgressType=Sy;var Cy;(function(t){function e(n){return Nn.func(n)}t.is=e})(Cy||(Cy={}));lt.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var Xt;(function(t){t[t.Off=0]="Off",t[t.Messages=1]="Messages",t[t.Compact=2]="Compact",t[t.Verbose=3]="Verbose"})(Xt||(lt.Trace=Xt={}));var aA;(function(t){t.Off="off",t.Messages="messages",t.Compact="compact",t.Verbose="verbose"})(aA||(lt.TraceValues=aA={}));(function(t){function e(r){if(!Nn.string(r))return t.Off;switch(r=r.toLowerCase(),r){case"off":return t.Off;case"messages":return t.Messages;case"compact":return t.Compact;case"verbose":return t.Verbose;default:return t.Off}}t.fromString=e;function n(r){switch(r){case t.Off:return"off";case t.Messages:return"messages";case t.Compact:return"compact";case t.Verbose:return"verbose";default:return"off"}}t.toString=n})(Xt||(lt.Trace=Xt={}));var $i;(function(t){t.Text="text",t.JSON="json"})($i||(lt.TraceFormat=$i={}));(function(t){function e(n){return Nn.string(n)?(n=n.toLowerCase(),n==="json"?t.JSON:t.Text):t.Text}t.fromString=e})($i||(lt.TraceFormat=$i={}));var ky;(function(t){t.type=new Qe.NotificationType("$/setTrace")})(ky||(lt.SetTraceNotification=ky={}));var Pp;(function(t){t.type=new Qe.NotificationType("$/logTrace")})(Pp||(lt.LogTraceNotification=Pp={}));var xu;(function(t){t[t.Closed=1]="Closed",t[t.Disposed=2]="Disposed",t[t.AlreadyListening=3]="AlreadyListening"})(xu||(lt.ConnectionErrors=xu={}));var qc=class t extends Error{constructor(e,n){super(n),this.code=e,Object.setPrototypeOf(this,t.prototype)}};lt.ConnectionError=qc;var Py;(function(t){function e(n){let r=n;return r&&Nn.func(r.cancelUndispatched)}t.is=e})(Py||(lt.ConnectionStrategy=Py={}));var Ap;(function(t){function e(n){let r=n;return r&&(r.kind===void 0||r.kind==="id")&&Nn.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Nn.func(r.dispose))}t.is=e})(Ap||(lt.IdCancellationReceiverStrategy=Ap={}));var Ay;(function(t){function e(n){let r=n;return r&&r.kind==="request"&&Nn.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Nn.func(r.dispose))}t.is=e})(Ay||(lt.RequestCancellationReceiverStrategy=Ay={}));var Dp;(function(t){t.Message=Object.freeze({createCancellationTokenSource(n){return new Ry.CancellationTokenSource}});function e(n){return Ap.is(n)||Ay.is(n)}t.is=e})(Dp||(lt.CancellationReceiverStrategy=Dp={}));var Ip;(function(t){t.Message=Object.freeze({sendCancellation(n,r){return n.sendNotification(Tu.type,{id:r})},cleanup(n){}});function e(n){let r=n;return r&&Nn.func(r.sendCancellation)&&Nn.func(r.cleanup)}t.is=e})(Ip||(lt.CancellationSenderStrategy=Ip={}));var $p;(function(t){t.Message=Object.freeze({receiver:Dp.Message,sender:Ip.Message});function e(n){let r=n;return r&&Dp.is(r.receiver)&&Ip.is(r.sender)}t.is=e})($p||(lt.CancellationStrategy=$p={}));var Op;(function(t){function e(n){let r=n;return r&&Nn.func(r.handleMessage)}t.is=e})(Op||(lt.MessageStrategy=Op={}));var cA;(function(t){function e(n){let r=n;return r&&($p.is(r.cancellationStrategy)||Py.is(r.connectionStrategy)||Op.is(r.messageStrategy))}t.is=e})(cA||(lt.ConnectionOptions=cA={}));var xs;(function(t){t[t.New=1]="New",t[t.Listening=2]="Listening",t[t.Closed=3]="Closed",t[t.Disposed=4]="Disposed"})(xs||(xs={}));function _9(t,e,n,r){let s=n!==void 0?n:lt.NullLogger,a=0,c=0,l=0,d="2.0",f,p=new Map,m,g=new Map,w=new Map,v,x=new oA.LinkedMap,b=new Map,S=new Set,k=new Map,$=Xt.Off,F=$i.Text,L,H=xs.New,N=new wu.Emitter,X=new wu.Emitter,V=new wu.Emitter,Y=new wu.Emitter,D=new wu.Emitter,j=r&&r.cancellationStrategy?r.cancellationStrategy:$p.Message;function ae(q){if(q===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+q.toString()}function me(q){return q===null?"res-unknown-"+(++l).toString():"res-"+q.toString()}function ue(){return"not-"+(++c).toString()}function _e(q,ie){Qe.Message.isRequest(ie)?q.set(ae(ie.id),ie):Qe.Message.isResponse(ie)?q.set(me(ie.id),ie):q.set(ue(),ie)}function ke(q){}function De(){return H===xs.Listening}function Ie(){return H===xs.Closed}function Ce(){return H===xs.Disposed}function Ge(){(H===xs.New||H===xs.Listening)&&(H=xs.Closed,X.fire(void 0))}function Re(q){N.fire([q,void 0,void 0])}function Oe(q){N.fire(q)}t.onClose(Ge),t.onError(Re),e.onClose(Ge),e.onError(Oe);function mt(){v||x.size===0||(v=(0,sA.default)().timer.setImmediate(()=>{v=void 0,Xe()}))}function ze(q){Qe.Message.isRequest(q)?We(q):Qe.Message.isNotification(q)?sn(q):Qe.Message.isResponse(q)?rn(q):Bn(q)}function Xe(){if(x.size===0)return;let q=x.shift();try{let ie=r?.messageStrategy;Op.is(ie)?ie.handleMessage(q,ze):ze(q)}finally{mt()}}let tt=q=>{try{if(Qe.Message.isNotification(q)&&q.method===Tu.type.method){let ie=q.params.id,xe=ae(ie),Pe=x.get(xe);if(Qe.Message.isRequest(Pe)){let Q=r?.connectionStrategy,se=Q&&Q.cancelUndispatched?Q.cancelUndispatched(Pe,ke):void 0;if(se&&(se.error!==void 0||se.result!==void 0)){x.delete(xe),k.delete(ie),se.id=Pe.id,rt(se,q.method,Date.now()),e.write(se).catch(()=>s.error("Sending response for canceled message failed."));return}}let vt=k.get(ie);if(vt!==void 0){vt.cancel(),tn(q);return}else S.add(ie)}_e(x,q)}finally{mt()}};function We(q){if(Ce())return;function ie(re,ye,Ee){let Le={jsonrpc:d,id:q.id};re instanceof Qe.ResponseError?Le.error=re.toJson():Le.result=re===void 0?null:re,rt(Le,ye,Ee),e.write(Le).catch(()=>s.error("Sending response failed."))}function xe(re,ye,Ee){let Le={jsonrpc:d,id:q.id,error:re.toJson()};rt(Le,ye,Ee),e.write(Le).catch(()=>s.error("Sending response failed."))}function Pe(re,ye,Ee){re===void 0&&(re=null);let Le={jsonrpc:d,id:q.id,result:re};rt(Le,ye,Ee),e.write(Le).catch(()=>s.error("Sending response failed."))}Nt(q);let vt=p.get(q.method),Q,se;vt&&(Q=vt.type,se=vt.handler);let ne=Date.now();if(se||f){let re=q.id??String(Date.now()),ye=Ap.is(j.receiver)?j.receiver.createCancellationTokenSource(re):j.receiver.createCancellationTokenSource(q);q.id!==null&&S.has(q.id)&&ye.cancel(),q.id!==null&&k.set(re,ye);try{let Ee;if(se)if(q.params===void 0){if(Q!==void 0&&Q.numberOfParams!==0){xe(new Qe.ResponseError(Qe.ErrorCodes.InvalidParams,`Request ${q.method} defines ${Q.numberOfParams} params but received none.`),q.method,ne);return}Ee=se(ye.token)}else if(Array.isArray(q.params)){if(Q!==void 0&&Q.parameterStructures===Qe.ParameterStructures.byName){xe(new Qe.ResponseError(Qe.ErrorCodes.InvalidParams,`Request ${q.method} defines parameters by name but received parameters by position`),q.method,ne);return}Ee=se(...q.params,ye.token)}else{if(Q!==void 0&&Q.parameterStructures===Qe.ParameterStructures.byPosition){xe(new Qe.ResponseError(Qe.ErrorCodes.InvalidParams,`Request ${q.method} defines parameters by position but received parameters by name`),q.method,ne);return}Ee=se(q.params,ye.token)}else f&&(Ee=f(q.method,q.params,ye.token));let Le=Ee;Ee?Le.then?Le.then(gt=>{k.delete(re),ie(gt,q.method,ne)},gt=>{k.delete(re),gt instanceof Qe.ResponseError?xe(gt,q.method,ne):gt&&Nn.string(gt.message)?xe(new Qe.ResponseError(Qe.ErrorCodes.InternalError,`Request ${q.method} failed with message: ${gt.message}`),q.method,ne):xe(new Qe.ResponseError(Qe.ErrorCodes.InternalError,`Request ${q.method} failed unexpectedly without providing any details.`),q.method,ne)}):(k.delete(re),ie(Ee,q.method,ne)):(k.delete(re),Pe(Ee,q.method,ne))}catch(Ee){k.delete(re),Ee instanceof Qe.ResponseError?ie(Ee,q.method,ne):Ee&&Nn.string(Ee.message)?xe(new Qe.ResponseError(Qe.ErrorCodes.InternalError,`Request ${q.method} failed with message: ${Ee.message}`),q.method,ne):xe(new Qe.ResponseError(Qe.ErrorCodes.InternalError,`Request ${q.method} failed unexpectedly without providing any details.`),q.method,ne)}}else xe(new Qe.ResponseError(Qe.ErrorCodes.MethodNotFound,`Unhandled method ${q.method}`),q.method,ne)}function rn(q){if(!Ce())if(q.id===null)q.error?s.error(`Received response message without id: Error is: 
${JSON.stringify(q.error,void 0,4)}`):s.error("Received response message without id. No further error information provided.");else{let ie=q.id,xe=b.get(ie);if(Jt(q,xe),xe!==void 0){b.delete(ie);try{if(q.error){let Pe=q.error;xe.reject(new Qe.ResponseError(Pe.code,Pe.message,Pe.data))}else if(q.result!==void 0)xe.resolve(q.result);else throw new Error("Should never happen.")}catch(Pe){Pe.message?s.error(`Response handler '${xe.method}' failed with message: ${Pe.message}`):s.error(`Response handler '${xe.method}' failed unexpectedly.`)}}}}function sn(q){if(Ce())return;let ie,xe;if(q.method===Tu.type.method){let Pe=q.params.id;S.delete(Pe),tn(q);return}else{let Pe=g.get(q.method);Pe&&(xe=Pe.handler,ie=Pe.type)}if(xe||m)try{if(tn(q),xe)if(q.params===void 0)ie!==void 0&&ie.numberOfParams!==0&&ie.parameterStructures!==Qe.ParameterStructures.byName&&s.error(`Notification ${q.method} defines ${ie.numberOfParams} params but received none.`),xe();else if(Array.isArray(q.params)){let Pe=q.params;q.method===bu.type.method&&Pe.length===2&&Ey.is(Pe[0])?xe({token:Pe[0],value:Pe[1]}):(ie!==void 0&&(ie.parameterStructures===Qe.ParameterStructures.byName&&s.error(`Notification ${q.method} defines parameters by name but received parameters by position`),ie.numberOfParams!==q.params.length&&s.error(`Notification ${q.method} defines ${ie.numberOfParams} params but received ${Pe.length} arguments`)),xe(...Pe))}else ie!==void 0&&ie.parameterStructures===Qe.ParameterStructures.byPosition&&s.error(`Notification ${q.method} defines parameters by position but received parameters by name`),xe(q.params);else m&&m(q.method,q.params)}catch(Pe){Pe.message?s.error(`Notification handler '${q.method}' failed with message: ${Pe.message}`):s.error(`Notification handler '${q.method}' failed unexpectedly.`)}else V.fire(q)}function Bn(q){if(!q){s.error("Received empty message.");return}s.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(q,null,4)}`);let ie=q;if(Nn.string(ie.id)||Nn.number(ie.id)){let xe=ie.id,Pe=b.get(xe);Pe&&Pe.reject(new Error("The received response has neither a result nor an error property."))}}function Ye(q){if(q!=null)switch($){case Xt.Verbose:return JSON.stringify(q,null,4);case Xt.Compact:return JSON.stringify(q);default:return}}function Yt(q){if(!($===Xt.Off||!L))if(F===$i.Text){let ie;($===Xt.Verbose||$===Xt.Compact)&&q.params&&(ie=`Params: ${Ye(q.params)}

`),L.log(`Sending request '${q.method} - (${q.id})'.`,ie)}else st("send-request",q)}function ln(q){if(!($===Xt.Off||!L))if(F===$i.Text){let ie;($===Xt.Verbose||$===Xt.Compact)&&(q.params?ie=`Params: ${Ye(q.params)}

`:ie=`No parameters provided.

`),L.log(`Sending notification '${q.method}'.`,ie)}else st("send-notification",q)}function rt(q,ie,xe){if(!($===Xt.Off||!L))if(F===$i.Text){let Pe;($===Xt.Verbose||$===Xt.Compact)&&(q.error&&q.error.data?Pe=`Error data: ${Ye(q.error.data)}

`:q.result?Pe=`Result: ${Ye(q.result)}

`:q.error===void 0&&(Pe=`No result returned.

`)),L.log(`Sending response '${ie} - (${q.id})'. Processing request took ${Date.now()-xe}ms`,Pe)}else st("send-response",q)}function Nt(q){if(!($===Xt.Off||!L))if(F===$i.Text){let ie;($===Xt.Verbose||$===Xt.Compact)&&q.params&&(ie=`Params: ${Ye(q.params)}

`),L.log(`Received request '${q.method} - (${q.id})'.`,ie)}else st("receive-request",q)}function tn(q){if(!($===Xt.Off||!L||q.method===Pp.type.method))if(F===$i.Text){let ie;($===Xt.Verbose||$===Xt.Compact)&&(q.params?ie=`Params: ${Ye(q.params)}

`:ie=`No parameters provided.

`),L.log(`Received notification '${q.method}'.`,ie)}else st("receive-notification",q)}function Jt(q,ie){if(!($===Xt.Off||!L))if(F===$i.Text){let xe;if(($===Xt.Verbose||$===Xt.Compact)&&(q.error&&q.error.data?xe=`Error data: ${Ye(q.error.data)}

`:q.result?xe=`Result: ${Ye(q.result)}

`:q.error===void 0&&(xe=`No result returned.

`)),ie){let Pe=q.error?` Request failed: ${q.error.message} (${q.error.code}).`:"";L.log(`Received response '${ie.method} - (${q.id})' in ${Date.now()-ie.timerStart}ms.${Pe}`,xe)}else L.log(`Received response ${q.id} without active response promise.`,xe)}else st("receive-response",q)}function st(q,ie){if(!L||$===Xt.Off)return;let xe={isLSPMessage:!0,type:q,message:ie,timestamp:Date.now()};L.log(xe)}function At(){if(Ie())throw new qc(xu.Closed,"Connection is closed.");if(Ce())throw new qc(xu.Disposed,"Connection is disposed.")}function St(){if(De())throw new qc(xu.AlreadyListening,"Connection is already listening")}function xn(){if(!De())throw new Error("Call listen() first.")}function pn(q){return q===void 0?null:q}function Sr(q){if(q!==null)return q}function Zn(q){return q!=null&&!Array.isArray(q)&&typeof q=="object"}function Un(q,ie){switch(q){case Qe.ParameterStructures.auto:return Zn(ie)?Sr(ie):[pn(ie)];case Qe.ParameterStructures.byName:if(!Zn(ie))throw new Error("Received parameters by name but param is not an object literal.");return Sr(ie);case Qe.ParameterStructures.byPosition:return[pn(ie)];default:throw new Error(`Unknown parameter structure ${q.toString()}`)}}function Gt(q,ie){let xe,Pe=q.numberOfParams;switch(Pe){case 0:xe=void 0;break;case 1:xe=Un(q.parameterStructures,ie[0]);break;default:xe=[];for(let vt=0;vt<ie.length&&vt<Pe;vt++)xe.push(pn(ie[vt]));if(ie.length<Pe)for(let vt=ie.length;vt<Pe;vt++)xe.push(null);break}return xe}let Dn={sendNotification:(q,...ie)=>{At();let xe,Pe;if(Nn.string(q)){xe=q;let Q=ie[0],se=0,ne=Qe.ParameterStructures.auto;Qe.ParameterStructures.is(Q)&&(se=1,ne=Q);let re=ie.length,ye=re-se;switch(ye){case 0:Pe=void 0;break;case 1:Pe=Un(ne,ie[se]);break;default:if(ne===Qe.ParameterStructures.byName)throw new Error(`Received ${ye} parameters for 'by Name' notification parameter structure.`);Pe=ie.slice(se,re).map(Ee=>pn(Ee));break}}else{let Q=ie;xe=q.method,Pe=Gt(q,Q)}let vt={jsonrpc:d,method:xe,params:Pe};return ln(vt),e.write(vt).catch(Q=>{throw s.error("Sending notification failed."),Q})},onNotification:(q,ie)=>{At();let xe;return Nn.func(q)?m=q:ie&&(Nn.string(q)?(xe=q,g.set(q,{type:void 0,handler:ie})):(xe=q.method,g.set(q.method,{type:q,handler:ie}))),{dispose:()=>{xe!==void 0?g.delete(xe):m=void 0}}},onProgress:(q,ie,xe)=>{if(w.has(ie))throw new Error(`Progress handler for token ${ie} already registered`);return w.set(ie,xe),{dispose:()=>{w.delete(ie)}}},sendProgress:(q,ie,xe)=>Dn.sendNotification(bu.type,{token:ie,value:xe}),onUnhandledProgress:Y.event,sendRequest:(q,...ie)=>{At(),xn();let xe,Pe,vt;if(Nn.string(q)){xe=q;let re=ie[0],ye=ie[ie.length-1],Ee=0,Le=Qe.ParameterStructures.auto;Qe.ParameterStructures.is(re)&&(Ee=1,Le=re);let gt=ie.length;Ry.CancellationToken.is(ye)&&(gt=gt-1,vt=ye);let Lt=gt-Ee;switch(Lt){case 0:Pe=void 0;break;case 1:Pe=Un(Le,ie[Ee]);break;default:if(Le===Qe.ParameterStructures.byName)throw new Error(`Received ${Lt} parameters for 'by Name' request parameter structure.`);Pe=ie.slice(Ee,gt).map(ni=>pn(ni));break}}else{let re=ie;xe=q.method,Pe=Gt(q,re);let ye=q.numberOfParams;vt=Ry.CancellationToken.is(re[ye])?re[ye]:void 0}let Q=a++,se;vt&&(se=vt.onCancellationRequested(()=>{let re=j.sender.sendCancellation(Dn,Q);return re===void 0?(s.log(`Received no promise from cancellation strategy when cancelling id ${Q}`),Promise.resolve()):re.catch(()=>{s.log(`Sending cancellation messages for id ${Q} failed`)})}));let ne={jsonrpc:d,id:Q,method:xe,params:Pe};return Yt(ne),typeof j.sender.enableCancellation=="function"&&j.sender.enableCancellation(ne),new Promise(async(re,ye)=>{let Ee=Lt=>{re(Lt),j.sender.cleanup(Q),se?.dispose()},Le=Lt=>{ye(Lt),j.sender.cleanup(Q),se?.dispose()},gt={method:xe,timerStart:Date.now(),resolve:Ee,reject:Le};try{await e.write(ne),b.set(Q,gt)}catch(Lt){throw s.error("Sending request failed."),gt.reject(new Qe.ResponseError(Qe.ErrorCodes.MessageWriteError,Lt.message?Lt.message:"Unknown reason")),Lt}})},onRequest:(q,ie)=>{At();let xe=null;return Cy.is(q)?(xe=void 0,f=q):Nn.string(q)?(xe=null,ie!==void 0&&(xe=q,p.set(q,{handler:ie,type:void 0}))):ie!==void 0&&(xe=q.method,p.set(q.method,{type:q,handler:ie})),{dispose:()=>{xe!==null&&(xe!==void 0?p.delete(xe):f=void 0)}}},hasPendingResponse:()=>b.size>0,trace:async(q,ie,xe)=>{let Pe=!1,vt=$i.Text;xe!==void 0&&(Nn.boolean(xe)?Pe=xe:(Pe=xe.sendNotification||!1,vt=xe.traceFormat||$i.Text)),$=q,F=vt,$===Xt.Off?L=void 0:L=ie,Pe&&!Ie()&&!Ce()&&await Dn.sendNotification(ky.type,{value:Xt.toString(q)})},onError:N.event,onClose:X.event,onUnhandledNotification:V.event,onDispose:D.event,end:()=>{e.end()},dispose:()=>{if(Ce())return;H=xs.Disposed,D.fire(void 0);let q=new Qe.ResponseError(Qe.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let ie of b.values())ie.reject(q);b=new Map,k=new Map,S=new Set,x=new oA.LinkedMap,Nn.func(e.dispose)&&e.dispose(),Nn.func(t.dispose)&&t.dispose()},listen:()=>{At(),St(),H=xs.Listening,t.listen(tt)},inspect:()=>{(0,sA.default)().console.log("inspect")}};return Dn.onNotification(Pp.type,q=>{if($===Xt.Off||!L)return;let ie=$===Xt.Verbose||$===Xt.Compact;L.log(q.message,ie?q.verbose:void 0)}),Dn.onNotification(bu.type,q=>{let ie=w.get(q.token);ie?ie(q.value):Y.fire(q)}),Dn}lt.createMessageConnection=_9});var Fp=oe(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.ProgressType=le.ProgressToken=le.createMessageConnection=le.NullLogger=le.ConnectionOptions=le.ConnectionStrategy=le.AbstractMessageBuffer=le.WriteableStreamMessageWriter=le.AbstractMessageWriter=le.MessageWriter=le.ReadableStreamMessageReader=le.AbstractMessageReader=le.MessageReader=le.SharedArrayReceiverStrategy=le.SharedArraySenderStrategy=le.CancellationToken=le.CancellationTokenSource=le.Emitter=le.Event=le.Disposable=le.LRUCache=le.Touch=le.LinkedMap=le.ParameterStructures=le.NotificationType9=le.NotificationType8=le.NotificationType7=le.NotificationType6=le.NotificationType5=le.NotificationType4=le.NotificationType3=le.NotificationType2=le.NotificationType1=le.NotificationType0=le.NotificationType=le.ErrorCodes=le.ResponseError=le.RequestType9=le.RequestType8=le.RequestType7=le.RequestType6=le.RequestType5=le.RequestType4=le.RequestType3=le.RequestType2=le.RequestType1=le.RequestType0=le.RequestType=le.Message=le.RAL=void 0;le.MessageStrategy=le.CancellationStrategy=le.CancellationSenderStrategy=le.CancellationReceiverStrategy=le.ConnectionError=le.ConnectionErrors=le.LogTraceNotification=le.SetTraceNotification=le.TraceFormat=le.TraceValues=le.Trace=void 0;var fn=ny();Object.defineProperty(le,"Message",{enumerable:!0,get:function(){return fn.Message}});Object.defineProperty(le,"RequestType",{enumerable:!0,get:function(){return fn.RequestType}});Object.defineProperty(le,"RequestType0",{enumerable:!0,get:function(){return fn.RequestType0}});Object.defineProperty(le,"RequestType1",{enumerable:!0,get:function(){return fn.RequestType1}});Object.defineProperty(le,"RequestType2",{enumerable:!0,get:function(){return fn.RequestType2}});Object.defineProperty(le,"RequestType3",{enumerable:!0,get:function(){return fn.RequestType3}});Object.defineProperty(le,"RequestType4",{enumerable:!0,get:function(){return fn.RequestType4}});Object.defineProperty(le,"RequestType5",{enumerable:!0,get:function(){return fn.RequestType5}});Object.defineProperty(le,"RequestType6",{enumerable:!0,get:function(){return fn.RequestType6}});Object.defineProperty(le,"RequestType7",{enumerable:!0,get:function(){return fn.RequestType7}});Object.defineProperty(le,"RequestType8",{enumerable:!0,get:function(){return fn.RequestType8}});Object.defineProperty(le,"RequestType9",{enumerable:!0,get:function(){return fn.RequestType9}});Object.defineProperty(le,"ResponseError",{enumerable:!0,get:function(){return fn.ResponseError}});Object.defineProperty(le,"ErrorCodes",{enumerable:!0,get:function(){return fn.ErrorCodes}});Object.defineProperty(le,"NotificationType",{enumerable:!0,get:function(){return fn.NotificationType}});Object.defineProperty(le,"NotificationType0",{enumerable:!0,get:function(){return fn.NotificationType0}});Object.defineProperty(le,"NotificationType1",{enumerable:!0,get:function(){return fn.NotificationType1}});Object.defineProperty(le,"NotificationType2",{enumerable:!0,get:function(){return fn.NotificationType2}});Object.defineProperty(le,"NotificationType3",{enumerable:!0,get:function(){return fn.NotificationType3}});Object.defineProperty(le,"NotificationType4",{enumerable:!0,get:function(){return fn.NotificationType4}});Object.defineProperty(le,"NotificationType5",{enumerable:!0,get:function(){return fn.NotificationType5}});Object.defineProperty(le,"NotificationType6",{enumerable:!0,get:function(){return fn.NotificationType6}});Object.defineProperty(le,"NotificationType7",{enumerable:!0,get:function(){return fn.NotificationType7}});Object.defineProperty(le,"NotificationType8",{enumerable:!0,get:function(){return fn.NotificationType8}});Object.defineProperty(le,"NotificationType9",{enumerable:!0,get:function(){return fn.NotificationType9}});Object.defineProperty(le,"ParameterStructures",{enumerable:!0,get:function(){return fn.ParameterStructures}});var Dy=iy();Object.defineProperty(le,"LinkedMap",{enumerable:!0,get:function(){return Dy.LinkedMap}});Object.defineProperty(le,"LRUCache",{enumerable:!0,get:function(){return Dy.LRUCache}});Object.defineProperty(le,"Touch",{enumerable:!0,get:function(){return Dy.Touch}});var v9=KP();Object.defineProperty(le,"Disposable",{enumerable:!0,get:function(){return v9.Disposable}});var uA=Oc();Object.defineProperty(le,"Event",{enumerable:!0,get:function(){return uA.Event}});Object.defineProperty(le,"Emitter",{enumerable:!0,get:function(){return uA.Emitter}});var dA=Rp();Object.defineProperty(le,"CancellationTokenSource",{enumerable:!0,get:function(){return dA.CancellationTokenSource}});Object.defineProperty(le,"CancellationToken",{enumerable:!0,get:function(){return dA.CancellationToken}});var fA=VP();Object.defineProperty(le,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return fA.SharedArraySenderStrategy}});Object.defineProperty(le,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return fA.SharedArrayReceiverStrategy}});var Iy=JP();Object.defineProperty(le,"MessageReader",{enumerable:!0,get:function(){return Iy.MessageReader}});Object.defineProperty(le,"AbstractMessageReader",{enumerable:!0,get:function(){return Iy.AbstractMessageReader}});Object.defineProperty(le,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Iy.ReadableStreamMessageReader}});var $y=rA();Object.defineProperty(le,"MessageWriter",{enumerable:!0,get:function(){return $y.MessageWriter}});Object.defineProperty(le,"AbstractMessageWriter",{enumerable:!0,get:function(){return $y.AbstractMessageWriter}});Object.defineProperty(le,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return $y.WriteableStreamMessageWriter}});var y9=iA();Object.defineProperty(le,"AbstractMessageBuffer",{enumerable:!0,get:function(){return y9.AbstractMessageBuffer}});var Er=lA();Object.defineProperty(le,"ConnectionStrategy",{enumerable:!0,get:function(){return Er.ConnectionStrategy}});Object.defineProperty(le,"ConnectionOptions",{enumerable:!0,get:function(){return Er.ConnectionOptions}});Object.defineProperty(le,"NullLogger",{enumerable:!0,get:function(){return Er.NullLogger}});Object.defineProperty(le,"createMessageConnection",{enumerable:!0,get:function(){return Er.createMessageConnection}});Object.defineProperty(le,"ProgressToken",{enumerable:!0,get:function(){return Er.ProgressToken}});Object.defineProperty(le,"ProgressType",{enumerable:!0,get:function(){return Er.ProgressType}});Object.defineProperty(le,"Trace",{enumerable:!0,get:function(){return Er.Trace}});Object.defineProperty(le,"TraceValues",{enumerable:!0,get:function(){return Er.TraceValues}});Object.defineProperty(le,"TraceFormat",{enumerable:!0,get:function(){return Er.TraceFormat}});Object.defineProperty(le,"SetTraceNotification",{enumerable:!0,get:function(){return Er.SetTraceNotification}});Object.defineProperty(le,"LogTraceNotification",{enumerable:!0,get:function(){return Er.LogTraceNotification}});Object.defineProperty(le,"ConnectionErrors",{enumerable:!0,get:function(){return Er.ConnectionErrors}});Object.defineProperty(le,"ConnectionError",{enumerable:!0,get:function(){return Er.ConnectionError}});Object.defineProperty(le,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return Er.CancellationReceiverStrategy}});Object.defineProperty(le,"CancellationSenderStrategy",{enumerable:!0,get:function(){return Er.CancellationSenderStrategy}});Object.defineProperty(le,"CancellationStrategy",{enumerable:!0,get:function(){return Er.CancellationStrategy}});Object.defineProperty(le,"MessageStrategy",{enumerable:!0,get:function(){return Er.MessageStrategy}});var w9=jo();le.RAL=w9.default});var mA=oe(My=>{"use strict";Object.defineProperty(My,"__esModule",{value:!0});var pA=require("util"),lo=Fp(),Np=class t extends lo.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return t.emptyBuffer}fromString(e,n){return Buffer.from(e,n)}toString(e,n){return e instanceof Buffer?e.toString(n):new pA.TextDecoder(n).decode(e)}asNative(e,n){return n===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,n):Buffer.from(e,0,n)}allocNative(e){return Buffer.allocUnsafe(e)}};Np.emptyBuffer=Buffer.allocUnsafe(0);var Oy=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),lo.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),lo.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),lo.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),lo.Disposable.create(()=>this.stream.off("data",e))}},Fy=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),lo.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),lo.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),lo.Disposable.create(()=>this.stream.off("end",e))}write(e,n){return new Promise((r,s)=>{let a=c=>{c==null?r():s(c)};typeof e=="string"?this.stream.write(e,n,a):this.stream.write(e,a)})}end(){this.stream.end()}},hA=Object.freeze({messageBuffer:Object.freeze({create:t=>new Np(t)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(t,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(t,void 0,0),e.charset))}catch(n){return Promise.reject(n)}}}),decoder:Object.freeze({name:"application/json",decode:(t,e)=>{try{return t instanceof Buffer?Promise.resolve(JSON.parse(t.toString(e.charset))):Promise.resolve(JSON.parse(new pA.TextDecoder(e.charset).decode(t)))}catch(n){return Promise.reject(n)}}})}),stream:Object.freeze({asReadableStream:t=>new Oy(t),asWritableStream:t=>new Fy(t)}),console,timer:Object.freeze({setTimeout(t,e,...n){let r=setTimeout(t,e,...n);return{dispose:()=>clearTimeout(r)}},setImmediate(t,...e){let n=setImmediate(t,...e);return{dispose:()=>clearImmediate(n)}},setInterval(t,e,...n){let r=setInterval(t,e,...n);return{dispose:()=>clearInterval(r)}}})});function Ny(){return hA}(function(t){function e(){lo.RAL.install(hA)}t.install=e})(Ny||(Ny={}));My.default=Ny});var Da=oe($t=>{"use strict";var b9=$t&&$t.__createBinding||(Object.create?(function(t,e,n,r){r===void 0&&(r=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,s)}):(function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]})),x9=$t&&$t.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&b9(e,t,n)};Object.defineProperty($t,"__esModule",{value:!0});$t.createMessageConnection=$t.createServerSocketTransport=$t.createClientSocketTransport=$t.createServerPipeTransport=$t.createClientPipeTransport=$t.generateRandomPipeName=$t.StreamMessageWriter=$t.StreamMessageReader=$t.SocketMessageWriter=$t.SocketMessageReader=$t.PortMessageWriter=$t.PortMessageReader=$t.IPCMessageWriter=$t.IPCMessageReader=void 0;var Lc=mA();Lc.default.install();var gA=require("path"),T9=require("os"),R9=require("crypto"),Lp=require("net"),Oi=Fp();x9(Fp(),$t);var qy=class extends Oi.AbstractMessageReader{constructor(e){super(),this.process=e;let n=this.process;n.on("error",r=>this.fireError(r)),n.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),Oi.Disposable.create(()=>this.process.off("message",e))}};$t.IPCMessageReader=qy;var Ly=class extends Oi.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let n=this.process;n.on("error",r=>this.fireError(r)),n.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,n=>{n?(this.errorCount++,this.handleError(n,e)):this.errorCount=0}),Promise.resolve()}catch(n){return this.handleError(n,e),Promise.reject(n)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){}};$t.IPCMessageWriter=Ly;var Uy=class extends Oi.AbstractMessageReader{constructor(e){super(),this.onData=new Oi.Emitter,e.on("close",()=>this.fireClose),e.on("error",n=>this.fireError(n)),e.on("message",n=>{this.onData.fire(n)})}listen(e){return this.onData.event(e)}};$t.PortMessageReader=Uy;var Wy=class extends Oi.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",n=>this.fireError(n))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(n){return this.handleError(n,e),Promise.reject(n)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){}};$t.PortMessageWriter=Wy;var Pa=class extends Oi.ReadableStreamMessageReader{constructor(e,n="utf-8"){super((0,Lc.default)().stream.asReadableStream(e),n)}};$t.SocketMessageReader=Pa;var Aa=class extends Oi.WriteableStreamMessageWriter{constructor(e,n){super((0,Lc.default)().stream.asWritableStream(e),n),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};$t.SocketMessageWriter=Aa;var Mp=class extends Oi.ReadableStreamMessageReader{constructor(e,n){super((0,Lc.default)().stream.asReadableStream(e),n)}};$t.StreamMessageReader=Mp;var qp=class extends Oi.WriteableStreamMessageWriter{constructor(e,n){super((0,Lc.default)().stream.asWritableStream(e),n)}};$t.StreamMessageWriter=qp;var _A=process.env.XDG_RUNTIME_DIR,E9=new Map([["linux",107],["darwin",103]]);function S9(){let t=(0,R9.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${t}-sock`;let e;_A?e=gA.join(_A,`vscode-ipc-${t}.sock`):e=gA.join(T9.tmpdir(),`vscode-${t}.sock`);let n=E9.get(process.platform);return n!==void 0&&e.length>n&&(0,Lc.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${n} characters.`),e}$t.generateRandomPipeName=S9;function C9(t,e="utf-8"){let n,r=new Promise((s,a)=>{n=s});return new Promise((s,a)=>{let c=(0,Lp.createServer)(l=>{c.close(),n([new Pa(l,e),new Aa(l,e)])});c.on("error",a),c.listen(t,()=>{c.removeListener("error",a),s({onConnected:()=>r})})})}$t.createClientPipeTransport=C9;function k9(t,e="utf-8"){let n=(0,Lp.createConnection)(t);return[new Pa(n,e),new Aa(n,e)]}$t.createServerPipeTransport=k9;function P9(t,e="utf-8"){let n,r=new Promise((s,a)=>{n=s});return new Promise((s,a)=>{let c=(0,Lp.createServer)(l=>{c.close(),n([new Pa(l,e),new Aa(l,e)])});c.on("error",a),c.listen(t,"127.0.0.1",()=>{c.removeListener("error",a),s({onConnected:()=>r})})})}$t.createClientSocketTransport=P9;function A9(t,e="utf-8"){let n=(0,Lp.createConnection)(t,"127.0.0.1");return[new Pa(n,e),new Aa(n,e)]}$t.createServerSocketTransport=A9;function D9(t){let e=t;return e.read!==void 0&&e.addListener!==void 0}function I9(t){let e=t;return e.write!==void 0&&e.addListener!==void 0}function $9(t,e,n,r){n||(n=Oi.NullLogger);let s=D9(t)?new Mp(t):t,a=I9(e)?new qp(e):e;return Oi.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Oi.createMessageConnection)(s,a,n,r)}$t.createMessageConnection=$9});var Hy=oe((Pee,vA)=>{"use strict";vA.exports=Da()});var Wp=oe((yA,Up)=>{(function(t){if(typeof Up=="object"&&typeof Up.exports=="object"){var e=t(require,yA);e!==void 0&&(Up.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],t)})(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var n;(function(E){function U(W){return typeof W=="string"}E.is=U})(n||(e.DocumentUri=n={}));var r;(function(E){function U(W){return typeof W=="string"}E.is=U})(r||(e.URI=r={}));var s;(function(E){E.MIN_VALUE=-2147483648,E.MAX_VALUE=2147483647;function U(W){return typeof W=="number"&&E.MIN_VALUE<=W&&W<=E.MAX_VALUE}E.is=U})(s||(e.integer=s={}));var a;(function(E){E.MIN_VALUE=0,E.MAX_VALUE=2147483647;function U(W){return typeof W=="number"&&E.MIN_VALUE<=W&&W<=E.MAX_VALUE}E.is=U})(a||(e.uinteger=a={}));var c;(function(E){function U(I,T){return I===Number.MAX_VALUE&&(I=a.MAX_VALUE),T===Number.MAX_VALUE&&(T=a.MAX_VALUE),{line:I,character:T}}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&z.uinteger(T.line)&&z.uinteger(T.character)}E.is=W})(c||(e.Position=c={}));var l;(function(E){function U(I,T,J,fe){if(z.uinteger(I)&&z.uinteger(T)&&z.uinteger(J)&&z.uinteger(fe))return{start:c.create(I,T),end:c.create(J,fe)};if(c.is(I)&&c.is(T))return{start:I,end:T};throw new Error("Range#create called with invalid arguments[".concat(I,", ").concat(T,", ").concat(J,", ").concat(fe,"]"))}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&c.is(T.start)&&c.is(T.end)}E.is=W})(l||(e.Range=l={}));var d;(function(E){function U(I,T){return{uri:I,range:T}}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&l.is(T.range)&&(z.string(T.uri)||z.undefined(T.uri))}E.is=W})(d||(e.Location=d={}));var f;(function(E){function U(I,T,J,fe){return{targetUri:I,targetRange:T,targetSelectionRange:J,originSelectionRange:fe}}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&l.is(T.targetRange)&&z.string(T.targetUri)&&l.is(T.targetSelectionRange)&&(l.is(T.originSelectionRange)||z.undefined(T.originSelectionRange))}E.is=W})(f||(e.LocationLink=f={}));var p;(function(E){function U(I,T,J,fe){return{red:I,green:T,blue:J,alpha:fe}}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&z.numberRange(T.red,0,1)&&z.numberRange(T.green,0,1)&&z.numberRange(T.blue,0,1)&&z.numberRange(T.alpha,0,1)}E.is=W})(p||(e.Color=p={}));var m;(function(E){function U(I,T){return{range:I,color:T}}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&l.is(T.range)&&p.is(T.color)}E.is=W})(m||(e.ColorInformation=m={}));var g;(function(E){function U(I,T,J){return{label:I,textEdit:T,additionalTextEdits:J}}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&z.string(T.label)&&(z.undefined(T.textEdit)||L.is(T))&&(z.undefined(T.additionalTextEdits)||z.typedArray(T.additionalTextEdits,L.is))}E.is=W})(g||(e.ColorPresentation=g={}));var w;(function(E){E.Comment="comment",E.Imports="imports",E.Region="region"})(w||(e.FoldingRangeKind=w={}));var v;(function(E){function U(I,T,J,fe,nt,un){var zt={startLine:I,endLine:T};return z.defined(J)&&(zt.startCharacter=J),z.defined(fe)&&(zt.endCharacter=fe),z.defined(nt)&&(zt.kind=nt),z.defined(un)&&(zt.collapsedText=un),zt}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&z.uinteger(T.startLine)&&z.uinteger(T.startLine)&&(z.undefined(T.startCharacter)||z.uinteger(T.startCharacter))&&(z.undefined(T.endCharacter)||z.uinteger(T.endCharacter))&&(z.undefined(T.kind)||z.string(T.kind))}E.is=W})(v||(e.FoldingRange=v={}));var x;(function(E){function U(I,T){return{location:I,message:T}}E.create=U;function W(I){var T=I;return z.defined(T)&&d.is(T.location)&&z.string(T.message)}E.is=W})(x||(e.DiagnosticRelatedInformation=x={}));var b;(function(E){E.Error=1,E.Warning=2,E.Information=3,E.Hint=4})(b||(e.DiagnosticSeverity=b={}));var S;(function(E){E.Unnecessary=1,E.Deprecated=2})(S||(e.DiagnosticTag=S={}));var k;(function(E){function U(W){var I=W;return z.objectLiteral(I)&&z.string(I.href)}E.is=U})(k||(e.CodeDescription=k={}));var $;(function(E){function U(I,T,J,fe,nt,un){var zt={range:I,message:T};return z.defined(J)&&(zt.severity=J),z.defined(fe)&&(zt.code=fe),z.defined(nt)&&(zt.source=nt),z.defined(un)&&(zt.relatedInformation=un),zt}E.create=U;function W(I){var T,J=I;return z.defined(J)&&l.is(J.range)&&z.string(J.message)&&(z.number(J.severity)||z.undefined(J.severity))&&(z.integer(J.code)||z.string(J.code)||z.undefined(J.code))&&(z.undefined(J.codeDescription)||z.string((T=J.codeDescription)===null||T===void 0?void 0:T.href))&&(z.string(J.source)||z.undefined(J.source))&&(z.undefined(J.relatedInformation)||z.typedArray(J.relatedInformation,x.is))}E.is=W})($||(e.Diagnostic=$={}));var F;(function(E){function U(I,T){for(var J=[],fe=2;fe<arguments.length;fe++)J[fe-2]=arguments[fe];var nt={title:I,command:T};return z.defined(J)&&J.length>0&&(nt.arguments=J),nt}E.create=U;function W(I){var T=I;return z.defined(T)&&z.string(T.title)&&z.string(T.command)}E.is=W})(F||(e.Command=F={}));var L;(function(E){function U(J,fe){return{range:J,newText:fe}}E.replace=U;function W(J,fe){return{range:{start:J,end:J},newText:fe}}E.insert=W;function I(J){return{range:J,newText:""}}E.del=I;function T(J){var fe=J;return z.objectLiteral(fe)&&z.string(fe.newText)&&l.is(fe.range)}E.is=T})(L||(e.TextEdit=L={}));var H;(function(E){function U(I,T,J){var fe={label:I};return T!==void 0&&(fe.needsConfirmation=T),J!==void 0&&(fe.description=J),fe}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&z.string(T.label)&&(z.boolean(T.needsConfirmation)||T.needsConfirmation===void 0)&&(z.string(T.description)||T.description===void 0)}E.is=W})(H||(e.ChangeAnnotation=H={}));var N;(function(E){function U(W){var I=W;return z.string(I)}E.is=U})(N||(e.ChangeAnnotationIdentifier=N={}));var X;(function(E){function U(J,fe,nt){return{range:J,newText:fe,annotationId:nt}}E.replace=U;function W(J,fe,nt){return{range:{start:J,end:J},newText:fe,annotationId:nt}}E.insert=W;function I(J,fe){return{range:J,newText:"",annotationId:fe}}E.del=I;function T(J){var fe=J;return L.is(fe)&&(H.is(fe.annotationId)||N.is(fe.annotationId))}E.is=T})(X||(e.AnnotatedTextEdit=X={}));var V;(function(E){function U(I,T){return{textDocument:I,edits:T}}E.create=U;function W(I){var T=I;return z.defined(T)&&Ie.is(T.textDocument)&&Array.isArray(T.edits)}E.is=W})(V||(e.TextDocumentEdit=V={}));var Y;(function(E){function U(I,T,J){var fe={kind:"create",uri:I};return T!==void 0&&(T.overwrite!==void 0||T.ignoreIfExists!==void 0)&&(fe.options=T),J!==void 0&&(fe.annotationId=J),fe}E.create=U;function W(I){var T=I;return T&&T.kind==="create"&&z.string(T.uri)&&(T.options===void 0||(T.options.overwrite===void 0||z.boolean(T.options.overwrite))&&(T.options.ignoreIfExists===void 0||z.boolean(T.options.ignoreIfExists)))&&(T.annotationId===void 0||N.is(T.annotationId))}E.is=W})(Y||(e.CreateFile=Y={}));var D;(function(E){function U(I,T,J,fe){var nt={kind:"rename",oldUri:I,newUri:T};return J!==void 0&&(J.overwrite!==void 0||J.ignoreIfExists!==void 0)&&(nt.options=J),fe!==void 0&&(nt.annotationId=fe),nt}E.create=U;function W(I){var T=I;return T&&T.kind==="rename"&&z.string(T.oldUri)&&z.string(T.newUri)&&(T.options===void 0||(T.options.overwrite===void 0||z.boolean(T.options.overwrite))&&(T.options.ignoreIfExists===void 0||z.boolean(T.options.ignoreIfExists)))&&(T.annotationId===void 0||N.is(T.annotationId))}E.is=W})(D||(e.RenameFile=D={}));var j;(function(E){function U(I,T,J){var fe={kind:"delete",uri:I};return T!==void 0&&(T.recursive!==void 0||T.ignoreIfNotExists!==void 0)&&(fe.options=T),J!==void 0&&(fe.annotationId=J),fe}E.create=U;function W(I){var T=I;return T&&T.kind==="delete"&&z.string(T.uri)&&(T.options===void 0||(T.options.recursive===void 0||z.boolean(T.options.recursive))&&(T.options.ignoreIfNotExists===void 0||z.boolean(T.options.ignoreIfNotExists)))&&(T.annotationId===void 0||N.is(T.annotationId))}E.is=W})(j||(e.DeleteFile=j={}));var ae;(function(E){function U(W){var I=W;return I&&(I.changes!==void 0||I.documentChanges!==void 0)&&(I.documentChanges===void 0||I.documentChanges.every(function(T){return z.string(T.kind)?Y.is(T)||D.is(T)||j.is(T):V.is(T)}))}E.is=U})(ae||(e.WorkspaceEdit=ae={}));var me=(function(){function E(U,W){this.edits=U,this.changeAnnotations=W}return E.prototype.insert=function(U,W,I){var T,J;if(I===void 0?T=L.insert(U,W):N.is(I)?(J=I,T=X.insert(U,W,I)):(this.assertChangeAnnotations(this.changeAnnotations),J=this.changeAnnotations.manage(I),T=X.insert(U,W,J)),this.edits.push(T),J!==void 0)return J},E.prototype.replace=function(U,W,I){var T,J;if(I===void 0?T=L.replace(U,W):N.is(I)?(J=I,T=X.replace(U,W,I)):(this.assertChangeAnnotations(this.changeAnnotations),J=this.changeAnnotations.manage(I),T=X.replace(U,W,J)),this.edits.push(T),J!==void 0)return J},E.prototype.delete=function(U,W){var I,T;if(W===void 0?I=L.del(U):N.is(W)?(T=W,I=X.del(U,W)):(this.assertChangeAnnotations(this.changeAnnotations),T=this.changeAnnotations.manage(W),I=X.del(U,T)),this.edits.push(I),T!==void 0)return T},E.prototype.add=function(U){this.edits.push(U)},E.prototype.all=function(){return this.edits},E.prototype.clear=function(){this.edits.splice(0,this.edits.length)},E.prototype.assertChangeAnnotations=function(U){if(U===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},E})(),ue=(function(){function E(U){this._annotations=U===void 0?Object.create(null):U,this._counter=0,this._size=0}return E.prototype.all=function(){return this._annotations},Object.defineProperty(E.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),E.prototype.manage=function(U,W){var I;if(N.is(U)?I=U:(I=this.nextId(),W=U),this._annotations[I]!==void 0)throw new Error("Id ".concat(I," is already in use."));if(W===void 0)throw new Error("No annotation provided for id ".concat(I));return this._annotations[I]=W,this._size++,I},E.prototype.nextId=function(){return this._counter++,this._counter.toString()},E})(),_e=(function(){function E(U){var W=this;this._textEditChanges=Object.create(null),U!==void 0?(this._workspaceEdit=U,U.documentChanges?(this._changeAnnotations=new ue(U.changeAnnotations),U.changeAnnotations=this._changeAnnotations.all(),U.documentChanges.forEach(function(I){if(V.is(I)){var T=new me(I.edits,W._changeAnnotations);W._textEditChanges[I.textDocument.uri]=T}})):U.changes&&Object.keys(U.changes).forEach(function(I){var T=new me(U.changes[I]);W._textEditChanges[I]=T})):this._workspaceEdit={}}return Object.defineProperty(E.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),E.prototype.getTextEditChange=function(U){if(Ie.is(U)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var W={uri:U.uri,version:U.version},I=this._textEditChanges[W.uri];if(!I){var T=[],J={textDocument:W,edits:T};this._workspaceEdit.documentChanges.push(J),I=new me(T,this._changeAnnotations),this._textEditChanges[W.uri]=I}return I}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var I=this._textEditChanges[U];if(!I){var T=[];this._workspaceEdit.changes[U]=T,I=new me(T),this._textEditChanges[U]=I}return I}},E.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new ue,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},E.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},E.prototype.createFile=function(U,W,I){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T;H.is(W)||N.is(W)?T=W:I=W;var J,fe;if(T===void 0?J=Y.create(U,I):(fe=N.is(T)?T:this._changeAnnotations.manage(T),J=Y.create(U,I,fe)),this._workspaceEdit.documentChanges.push(J),fe!==void 0)return fe},E.prototype.renameFile=function(U,W,I,T){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var J;H.is(I)||N.is(I)?J=I:T=I;var fe,nt;if(J===void 0?fe=D.create(U,W,T):(nt=N.is(J)?J:this._changeAnnotations.manage(J),fe=D.create(U,W,T,nt)),this._workspaceEdit.documentChanges.push(fe),nt!==void 0)return nt},E.prototype.deleteFile=function(U,W,I){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T;H.is(W)||N.is(W)?T=W:I=W;var J,fe;if(T===void 0?J=j.create(U,I):(fe=N.is(T)?T:this._changeAnnotations.manage(T),J=j.create(U,I,fe)),this._workspaceEdit.documentChanges.push(J),fe!==void 0)return fe},E})();e.WorkspaceChange=_e;var ke;(function(E){function U(I){return{uri:I}}E.create=U;function W(I){var T=I;return z.defined(T)&&z.string(T.uri)}E.is=W})(ke||(e.TextDocumentIdentifier=ke={}));var De;(function(E){function U(I,T){return{uri:I,version:T}}E.create=U;function W(I){var T=I;return z.defined(T)&&z.string(T.uri)&&z.integer(T.version)}E.is=W})(De||(e.VersionedTextDocumentIdentifier=De={}));var Ie;(function(E){function U(I,T){return{uri:I,version:T}}E.create=U;function W(I){var T=I;return z.defined(T)&&z.string(T.uri)&&(T.version===null||z.integer(T.version))}E.is=W})(Ie||(e.OptionalVersionedTextDocumentIdentifier=Ie={}));var Ce;(function(E){function U(I,T,J,fe){return{uri:I,languageId:T,version:J,text:fe}}E.create=U;function W(I){var T=I;return z.defined(T)&&z.string(T.uri)&&z.string(T.languageId)&&z.integer(T.version)&&z.string(T.text)}E.is=W})(Ce||(e.TextDocumentItem=Ce={}));var Ge;(function(E){E.PlainText="plaintext",E.Markdown="markdown";function U(W){var I=W;return I===E.PlainText||I===E.Markdown}E.is=U})(Ge||(e.MarkupKind=Ge={}));var Re;(function(E){function U(W){var I=W;return z.objectLiteral(W)&&Ge.is(I.kind)&&z.string(I.value)}E.is=U})(Re||(e.MarkupContent=Re={}));var Oe;(function(E){E.Text=1,E.Method=2,E.Function=3,E.Constructor=4,E.Field=5,E.Variable=6,E.Class=7,E.Interface=8,E.Module=9,E.Property=10,E.Unit=11,E.Value=12,E.Enum=13,E.Keyword=14,E.Snippet=15,E.Color=16,E.File=17,E.Reference=18,E.Folder=19,E.EnumMember=20,E.Constant=21,E.Struct=22,E.Event=23,E.Operator=24,E.TypeParameter=25})(Oe||(e.CompletionItemKind=Oe={}));var mt;(function(E){E.PlainText=1,E.Snippet=2})(mt||(e.InsertTextFormat=mt={}));var ze;(function(E){E.Deprecated=1})(ze||(e.CompletionItemTag=ze={}));var Xe;(function(E){function U(I,T,J){return{newText:I,insert:T,replace:J}}E.create=U;function W(I){var T=I;return T&&z.string(T.newText)&&l.is(T.insert)&&l.is(T.replace)}E.is=W})(Xe||(e.InsertReplaceEdit=Xe={}));var tt;(function(E){E.asIs=1,E.adjustIndentation=2})(tt||(e.InsertTextMode=tt={}));var We;(function(E){function U(W){var I=W;return I&&(z.string(I.detail)||I.detail===void 0)&&(z.string(I.description)||I.description===void 0)}E.is=U})(We||(e.CompletionItemLabelDetails=We={}));var rn;(function(E){function U(W){return{label:W}}E.create=U})(rn||(e.CompletionItem=rn={}));var sn;(function(E){function U(W,I){return{items:W||[],isIncomplete:!!I}}E.create=U})(sn||(e.CompletionList=sn={}));var Bn;(function(E){function U(I){return I.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}E.fromPlainText=U;function W(I){var T=I;return z.string(T)||z.objectLiteral(T)&&z.string(T.language)&&z.string(T.value)}E.is=W})(Bn||(e.MarkedString=Bn={}));var Ye;(function(E){function U(W){var I=W;return!!I&&z.objectLiteral(I)&&(Re.is(I.contents)||Bn.is(I.contents)||z.typedArray(I.contents,Bn.is))&&(W.range===void 0||l.is(W.range))}E.is=U})(Ye||(e.Hover=Ye={}));var Yt;(function(E){function U(W,I){return I?{label:W,documentation:I}:{label:W}}E.create=U})(Yt||(e.ParameterInformation=Yt={}));var ln;(function(E){function U(W,I){for(var T=[],J=2;J<arguments.length;J++)T[J-2]=arguments[J];var fe={label:W};return z.defined(I)&&(fe.documentation=I),z.defined(T)?fe.parameters=T:fe.parameters=[],fe}E.create=U})(ln||(e.SignatureInformation=ln={}));var rt;(function(E){E.Text=1,E.Read=2,E.Write=3})(rt||(e.DocumentHighlightKind=rt={}));var Nt;(function(E){function U(W,I){var T={range:W};return z.number(I)&&(T.kind=I),T}E.create=U})(Nt||(e.DocumentHighlight=Nt={}));var tn;(function(E){E.File=1,E.Module=2,E.Namespace=3,E.Package=4,E.Class=5,E.Method=6,E.Property=7,E.Field=8,E.Constructor=9,E.Enum=10,E.Interface=11,E.Function=12,E.Variable=13,E.Constant=14,E.String=15,E.Number=16,E.Boolean=17,E.Array=18,E.Object=19,E.Key=20,E.Null=21,E.EnumMember=22,E.Struct=23,E.Event=24,E.Operator=25,E.TypeParameter=26})(tn||(e.SymbolKind=tn={}));var Jt;(function(E){E.Deprecated=1})(Jt||(e.SymbolTag=Jt={}));var st;(function(E){function U(W,I,T,J,fe){var nt={name:W,kind:I,location:{uri:J,range:T}};return fe&&(nt.containerName=fe),nt}E.create=U})(st||(e.SymbolInformation=st={}));var At;(function(E){function U(W,I,T,J){return J!==void 0?{name:W,kind:I,location:{uri:T,range:J}}:{name:W,kind:I,location:{uri:T}}}E.create=U})(At||(e.WorkspaceSymbol=At={}));var St;(function(E){function U(I,T,J,fe,nt,un){var zt={name:I,detail:T,kind:J,range:fe,selectionRange:nt};return un!==void 0&&(zt.children=un),zt}E.create=U;function W(I){var T=I;return T&&z.string(T.name)&&z.number(T.kind)&&l.is(T.range)&&l.is(T.selectionRange)&&(T.detail===void 0||z.string(T.detail))&&(T.deprecated===void 0||z.boolean(T.deprecated))&&(T.children===void 0||Array.isArray(T.children))&&(T.tags===void 0||Array.isArray(T.tags))}E.is=W})(St||(e.DocumentSymbol=St={}));var xn;(function(E){E.Empty="",E.QuickFix="quickfix",E.Refactor="refactor",E.RefactorExtract="refactor.extract",E.RefactorInline="refactor.inline",E.RefactorRewrite="refactor.rewrite",E.Source="source",E.SourceOrganizeImports="source.organizeImports",E.SourceFixAll="source.fixAll"})(xn||(e.CodeActionKind=xn={}));var pn;(function(E){E.Invoked=1,E.Automatic=2})(pn||(e.CodeActionTriggerKind=pn={}));var Sr;(function(E){function U(I,T,J){var fe={diagnostics:I};return T!=null&&(fe.only=T),J!=null&&(fe.triggerKind=J),fe}E.create=U;function W(I){var T=I;return z.defined(T)&&z.typedArray(T.diagnostics,$.is)&&(T.only===void 0||z.typedArray(T.only,z.string))&&(T.triggerKind===void 0||T.triggerKind===pn.Invoked||T.triggerKind===pn.Automatic)}E.is=W})(Sr||(e.CodeActionContext=Sr={}));var Zn;(function(E){function U(I,T,J){var fe={title:I},nt=!0;return typeof T=="string"?(nt=!1,fe.kind=T):F.is(T)?fe.command=T:fe.edit=T,nt&&J!==void 0&&(fe.kind=J),fe}E.create=U;function W(I){var T=I;return T&&z.string(T.title)&&(T.diagnostics===void 0||z.typedArray(T.diagnostics,$.is))&&(T.kind===void 0||z.string(T.kind))&&(T.edit!==void 0||T.command!==void 0)&&(T.command===void 0||F.is(T.command))&&(T.isPreferred===void 0||z.boolean(T.isPreferred))&&(T.edit===void 0||ae.is(T.edit))}E.is=W})(Zn||(e.CodeAction=Zn={}));var Un;(function(E){function U(I,T){var J={range:I};return z.defined(T)&&(J.data=T),J}E.create=U;function W(I){var T=I;return z.defined(T)&&l.is(T.range)&&(z.undefined(T.command)||F.is(T.command))}E.is=W})(Un||(e.CodeLens=Un={}));var Gt;(function(E){function U(I,T){return{tabSize:I,insertSpaces:T}}E.create=U;function W(I){var T=I;return z.defined(T)&&z.uinteger(T.tabSize)&&z.boolean(T.insertSpaces)}E.is=W})(Gt||(e.FormattingOptions=Gt={}));var Dn;(function(E){function U(I,T,J){return{range:I,target:T,data:J}}E.create=U;function W(I){var T=I;return z.defined(T)&&l.is(T.range)&&(z.undefined(T.target)||z.string(T.target))}E.is=W})(Dn||(e.DocumentLink=Dn={}));var q;(function(E){function U(I,T){return{range:I,parent:T}}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&l.is(T.range)&&(T.parent===void 0||E.is(T.parent))}E.is=W})(q||(e.SelectionRange=q={}));var ie;(function(E){E.namespace="namespace",E.type="type",E.class="class",E.enum="enum",E.interface="interface",E.struct="struct",E.typeParameter="typeParameter",E.parameter="parameter",E.variable="variable",E.property="property",E.enumMember="enumMember",E.event="event",E.function="function",E.method="method",E.macro="macro",E.keyword="keyword",E.modifier="modifier",E.comment="comment",E.string="string",E.number="number",E.regexp="regexp",E.operator="operator",E.decorator="decorator"})(ie||(e.SemanticTokenTypes=ie={}));var xe;(function(E){E.declaration="declaration",E.definition="definition",E.readonly="readonly",E.static="static",E.deprecated="deprecated",E.abstract="abstract",E.async="async",E.modification="modification",E.documentation="documentation",E.defaultLibrary="defaultLibrary"})(xe||(e.SemanticTokenModifiers=xe={}));var Pe;(function(E){function U(W){var I=W;return z.objectLiteral(I)&&(I.resultId===void 0||typeof I.resultId=="string")&&Array.isArray(I.data)&&(I.data.length===0||typeof I.data[0]=="number")}E.is=U})(Pe||(e.SemanticTokens=Pe={}));var vt;(function(E){function U(I,T){return{range:I,text:T}}E.create=U;function W(I){var T=I;return T!=null&&l.is(T.range)&&z.string(T.text)}E.is=W})(vt||(e.InlineValueText=vt={}));var Q;(function(E){function U(I,T,J){return{range:I,variableName:T,caseSensitiveLookup:J}}E.create=U;function W(I){var T=I;return T!=null&&l.is(T.range)&&z.boolean(T.caseSensitiveLookup)&&(z.string(T.variableName)||T.variableName===void 0)}E.is=W})(Q||(e.InlineValueVariableLookup=Q={}));var se;(function(E){function U(I,T){return{range:I,expression:T}}E.create=U;function W(I){var T=I;return T!=null&&l.is(T.range)&&(z.string(T.expression)||T.expression===void 0)}E.is=W})(se||(e.InlineValueEvaluatableExpression=se={}));var ne;(function(E){function U(I,T){return{frameId:I,stoppedLocation:T}}E.create=U;function W(I){var T=I;return z.defined(T)&&l.is(I.stoppedLocation)}E.is=W})(ne||(e.InlineValueContext=ne={}));var re;(function(E){E.Type=1,E.Parameter=2;function U(W){return W===1||W===2}E.is=U})(re||(e.InlayHintKind=re={}));var ye;(function(E){function U(I){return{value:I}}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&(T.tooltip===void 0||z.string(T.tooltip)||Re.is(T.tooltip))&&(T.location===void 0||d.is(T.location))&&(T.command===void 0||F.is(T.command))}E.is=W})(ye||(e.InlayHintLabelPart=ye={}));var Ee;(function(E){function U(I,T,J){var fe={position:I,label:T};return J!==void 0&&(fe.kind=J),fe}E.create=U;function W(I){var T=I;return z.objectLiteral(T)&&c.is(T.position)&&(z.string(T.label)||z.typedArray(T.label,ye.is))&&(T.kind===void 0||re.is(T.kind))&&T.textEdits===void 0||z.typedArray(T.textEdits,L.is)&&(T.tooltip===void 0||z.string(T.tooltip)||Re.is(T.tooltip))&&(T.paddingLeft===void 0||z.boolean(T.paddingLeft))&&(T.paddingRight===void 0||z.boolean(T.paddingRight))}E.is=W})(Ee||(e.InlayHint=Ee={}));var Le;(function(E){function U(W){return{kind:"snippet",value:W}}E.createSnippet=U})(Le||(e.StringValue=Le={}));var gt;(function(E){function U(W,I,T,J){return{insertText:W,filterText:I,range:T,command:J}}E.create=U})(gt||(e.InlineCompletionItem=gt={}));var Lt;(function(E){function U(W){return{items:W}}E.create=U})(Lt||(e.InlineCompletionList=Lt={}));var ni;(function(E){E.Invoked=0,E.Automatic=1})(ni||(e.InlineCompletionTriggerKind=ni={}));var vi;(function(E){function U(W,I){return{range:W,text:I}}E.create=U})(vi||(e.SelectedCompletionInfo=vi={}));var R;(function(E){function U(W,I){return{triggerKind:W,selectedCompletionInfo:I}}E.create=U})(R||(e.InlineCompletionContext=R={}));var te;(function(E){function U(W){var I=W;return z.objectLiteral(I)&&r.is(I.uri)&&z.string(I.name)}E.is=U})(te||(e.WorkspaceFolder=te={})),e.EOL=[`
`,`\r
`,"\r"];var Fe;(function(E){function U(J,fe,nt,un){return new Ot(J,fe,nt,un)}E.create=U;function W(J){var fe=J;return!!(z.defined(fe)&&z.string(fe.uri)&&(z.undefined(fe.languageId)||z.string(fe.languageId))&&z.uinteger(fe.lineCount)&&z.func(fe.getText)&&z.func(fe.positionAt)&&z.func(fe.offsetAt))}E.is=W;function I(J,fe){for(var nt=J.getText(),un=T(fe,function(Li,_){var G=Li.range.start.line-_.range.start.line;return G===0?Li.range.start.character-_.range.start.character:G}),zt=nt.length,_r=un.length-1;_r>=0;_r--){var Wr=un[_r],yi=J.offsetAt(Wr.range.start),yt=J.offsetAt(Wr.range.end);if(yt<=zt)nt=nt.substring(0,yi)+Wr.newText+nt.substring(yt,nt.length);else throw new Error("Overlapping edit");zt=yi}return nt}E.applyEdits=I;function T(J,fe){if(J.length<=1)return J;var nt=J.length/2|0,un=J.slice(0,nt),zt=J.slice(nt);T(un,fe),T(zt,fe);for(var _r=0,Wr=0,yi=0;_r<un.length&&Wr<zt.length;){var yt=fe(un[_r],zt[Wr]);yt<=0?J[yi++]=un[_r++]:J[yi++]=zt[Wr++]}for(;_r<un.length;)J[yi++]=un[_r++];for(;Wr<zt.length;)J[yi++]=zt[Wr++];return J}})(Fe||(e.TextDocument=Fe={}));var Ot=(function(){function E(U,W,I,T){this._uri=U,this._languageId=W,this._version=I,this._content=T,this._lineOffsets=void 0}return Object.defineProperty(E.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),E.prototype.getText=function(U){if(U){var W=this.offsetAt(U.start),I=this.offsetAt(U.end);return this._content.substring(W,I)}return this._content},E.prototype.update=function(U,W){this._content=U.text,this._version=W,this._lineOffsets=void 0},E.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var U=[],W=this._content,I=!0,T=0;T<W.length;T++){I&&(U.push(T),I=!1);var J=W.charAt(T);I=J==="\r"||J===`
`,J==="\r"&&T+1<W.length&&W.charAt(T+1)===`
`&&T++}I&&W.length>0&&U.push(W.length),this._lineOffsets=U}return this._lineOffsets},E.prototype.positionAt=function(U){U=Math.max(Math.min(U,this._content.length),0);var W=this.getLineOffsets(),I=0,T=W.length;if(T===0)return c.create(0,U);for(;I<T;){var J=Math.floor((I+T)/2);W[J]>U?T=J:I=J+1}var fe=I-1;return c.create(fe,U-W[fe])},E.prototype.offsetAt=function(U){var W=this.getLineOffsets();if(U.line>=W.length)return this._content.length;if(U.line<0)return 0;var I=W[U.line],T=U.line+1<W.length?W[U.line+1]:this._content.length;return Math.max(Math.min(I+U.character,T),I)},Object.defineProperty(E.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),E})(),z;(function(E){var U=Object.prototype.toString;function W(yt){return typeof yt<"u"}E.defined=W;function I(yt){return typeof yt>"u"}E.undefined=I;function T(yt){return yt===!0||yt===!1}E.boolean=T;function J(yt){return U.call(yt)==="[object String]"}E.string=J;function fe(yt){return U.call(yt)==="[object Number]"}E.number=fe;function nt(yt,Li,_){return U.call(yt)==="[object Number]"&&Li<=yt&&yt<=_}E.numberRange=nt;function un(yt){return U.call(yt)==="[object Number]"&&-2147483648<=yt&&yt<=2147483647}E.integer=un;function zt(yt){return U.call(yt)==="[object Number]"&&0<=yt&&yt<=2147483647}E.uinteger=zt;function _r(yt){return U.call(yt)==="[object Function]"}E.func=_r;function Wr(yt){return yt!==null&&typeof yt=="object"}E.objectLiteral=Wr;function yi(yt,Li){return Array.isArray(yt)&&yt.every(Li)}E.typedArray=yi})(z||(z={}))})});var kn=oe(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.ProtocolNotificationType=di.ProtocolNotificationType0=di.ProtocolRequestType=di.ProtocolRequestType0=di.RegistrationType=di.MessageDirection=void 0;var Uc=Da(),wA;(function(t){t.clientToServer="clientToServer",t.serverToClient="serverToClient",t.both="both"})(wA||(di.MessageDirection=wA={}));var jy=class{constructor(e){this.method=e}};di.RegistrationType=jy;var Xy=class extends Uc.RequestType0{constructor(e){super(e)}};di.ProtocolRequestType0=Xy;var By=class extends Uc.RequestType{constructor(e){super(e,Uc.ParameterStructures.byName)}};di.ProtocolRequestType=By;var Gy=class extends Uc.NotificationType0{constructor(e){super(e)}};di.ProtocolNotificationType0=Gy;var zy=class extends Uc.NotificationType{constructor(e){super(e,Uc.ParameterStructures.byName)}};di.ProtocolNotificationType=zy});var Hp=oe(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.objectLiteral=nr.typedArray=nr.stringArray=nr.array=nr.func=nr.error=nr.number=nr.string=nr.boolean=void 0;function O9(t){return t===!0||t===!1}nr.boolean=O9;function bA(t){return typeof t=="string"||t instanceof String}nr.string=bA;function F9(t){return typeof t=="number"||t instanceof Number}nr.number=F9;function N9(t){return t instanceof Error}nr.error=N9;function M9(t){return typeof t=="function"}nr.func=M9;function xA(t){return Array.isArray(t)}nr.array=xA;function q9(t){return xA(t)&&t.every(e=>bA(e))}nr.stringArray=q9;function L9(t,e){return Array.isArray(t)&&t.every(e)}nr.typedArray=L9;function U9(t){return t!==null&&typeof t=="object"}nr.objectLiteral=U9});var EA=oe(jp=>{"use strict";Object.defineProperty(jp,"__esModule",{value:!0});jp.ImplementationRequest=void 0;var TA=kn(),RA;(function(t){t.method="textDocument/implementation",t.messageDirection=TA.MessageDirection.clientToServer,t.type=new TA.ProtocolRequestType(t.method)})(RA||(jp.ImplementationRequest=RA={}))});var kA=oe(Xp=>{"use strict";Object.defineProperty(Xp,"__esModule",{value:!0});Xp.TypeDefinitionRequest=void 0;var SA=kn(),CA;(function(t){t.method="textDocument/typeDefinition",t.messageDirection=SA.MessageDirection.clientToServer,t.type=new SA.ProtocolRequestType(t.method)})(CA||(Xp.TypeDefinitionRequest=CA={}))});var DA=oe(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.DidChangeWorkspaceFoldersNotification=Wc.WorkspaceFoldersRequest=void 0;var Bp=kn(),PA;(function(t){t.method="workspace/workspaceFolders",t.messageDirection=Bp.MessageDirection.serverToClient,t.type=new Bp.ProtocolRequestType0(t.method)})(PA||(Wc.WorkspaceFoldersRequest=PA={}));var AA;(function(t){t.method="workspace/didChangeWorkspaceFolders",t.messageDirection=Bp.MessageDirection.clientToServer,t.type=new Bp.ProtocolNotificationType(t.method)})(AA||(Wc.DidChangeWorkspaceFoldersNotification=AA={}))});var OA=oe(Gp=>{"use strict";Object.defineProperty(Gp,"__esModule",{value:!0});Gp.ConfigurationRequest=void 0;var IA=kn(),$A;(function(t){t.method="workspace/configuration",t.messageDirection=IA.MessageDirection.serverToClient,t.type=new IA.ProtocolRequestType(t.method)})($A||(Gp.ConfigurationRequest=$A={}))});var MA=oe(Hc=>{"use strict";Object.defineProperty(Hc,"__esModule",{value:!0});Hc.ColorPresentationRequest=Hc.DocumentColorRequest=void 0;var zp=kn(),FA;(function(t){t.method="textDocument/documentColor",t.messageDirection=zp.MessageDirection.clientToServer,t.type=new zp.ProtocolRequestType(t.method)})(FA||(Hc.DocumentColorRequest=FA={}));var NA;(function(t){t.method="textDocument/colorPresentation",t.messageDirection=zp.MessageDirection.clientToServer,t.type=new zp.ProtocolRequestType(t.method)})(NA||(Hc.ColorPresentationRequest=NA={}))});var UA=oe(jc=>{"use strict";Object.defineProperty(jc,"__esModule",{value:!0});jc.FoldingRangeRefreshRequest=jc.FoldingRangeRequest=void 0;var Kp=kn(),qA;(function(t){t.method="textDocument/foldingRange",t.messageDirection=Kp.MessageDirection.clientToServer,t.type=new Kp.ProtocolRequestType(t.method)})(qA||(jc.FoldingRangeRequest=qA={}));var LA;(function(t){t.method="workspace/foldingRange/refresh",t.messageDirection=Kp.MessageDirection.serverToClient,t.type=new Kp.ProtocolRequestType0(t.method)})(LA||(jc.FoldingRangeRefreshRequest=LA={}))});var jA=oe(Zp=>{"use strict";Object.defineProperty(Zp,"__esModule",{value:!0});Zp.DeclarationRequest=void 0;var WA=kn(),HA;(function(t){t.method="textDocument/declaration",t.messageDirection=WA.MessageDirection.clientToServer,t.type=new WA.ProtocolRequestType(t.method)})(HA||(Zp.DeclarationRequest=HA={}))});var GA=oe(Vp=>{"use strict";Object.defineProperty(Vp,"__esModule",{value:!0});Vp.SelectionRangeRequest=void 0;var XA=kn(),BA;(function(t){t.method="textDocument/selectionRange",t.messageDirection=XA.MessageDirection.clientToServer,t.type=new XA.ProtocolRequestType(t.method)})(BA||(Vp.SelectionRangeRequest=BA={}))});var VA=oe(Go=>{"use strict";Object.defineProperty(Go,"__esModule",{value:!0});Go.WorkDoneProgressCancelNotification=Go.WorkDoneProgressCreateRequest=Go.WorkDoneProgress=void 0;var W9=Da(),Yp=kn(),zA;(function(t){t.type=new W9.ProgressType;function e(n){return n===t.type}t.is=e})(zA||(Go.WorkDoneProgress=zA={}));var KA;(function(t){t.method="window/workDoneProgress/create",t.messageDirection=Yp.MessageDirection.serverToClient,t.type=new Yp.ProtocolRequestType(t.method)})(KA||(Go.WorkDoneProgressCreateRequest=KA={}));var ZA;(function(t){t.method="window/workDoneProgress/cancel",t.messageDirection=Yp.MessageDirection.clientToServer,t.type=new Yp.ProtocolNotificationType(t.method)})(ZA||(Go.WorkDoneProgressCancelNotification=ZA={}))});var eD=oe(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.CallHierarchyOutgoingCallsRequest=zo.CallHierarchyIncomingCallsRequest=zo.CallHierarchyPrepareRequest=void 0;var Xc=kn(),YA;(function(t){t.method="textDocument/prepareCallHierarchy",t.messageDirection=Xc.MessageDirection.clientToServer,t.type=new Xc.ProtocolRequestType(t.method)})(YA||(zo.CallHierarchyPrepareRequest=YA={}));var JA;(function(t){t.method="callHierarchy/incomingCalls",t.messageDirection=Xc.MessageDirection.clientToServer,t.type=new Xc.ProtocolRequestType(t.method)})(JA||(zo.CallHierarchyIncomingCallsRequest=JA={}));var QA;(function(t){t.method="callHierarchy/outgoingCalls",t.messageDirection=Xc.MessageDirection.clientToServer,t.type=new Xc.ProtocolRequestType(t.method)})(QA||(zo.CallHierarchyOutgoingCallsRequest=QA={}))});var oD=oe(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.SemanticTokensRefreshRequest=fi.SemanticTokensRangeRequest=fi.SemanticTokensDeltaRequest=fi.SemanticTokensRequest=fi.SemanticTokensRegistrationType=fi.TokenFormat=void 0;var uo=kn(),tD;(function(t){t.Relative="relative"})(tD||(fi.TokenFormat=tD={}));var Ru;(function(t){t.method="textDocument/semanticTokens",t.type=new uo.RegistrationType(t.method)})(Ru||(fi.SemanticTokensRegistrationType=Ru={}));var nD;(function(t){t.method="textDocument/semanticTokens/full",t.messageDirection=uo.MessageDirection.clientToServer,t.type=new uo.ProtocolRequestType(t.method),t.registrationMethod=Ru.method})(nD||(fi.SemanticTokensRequest=nD={}));var rD;(function(t){t.method="textDocument/semanticTokens/full/delta",t.messageDirection=uo.MessageDirection.clientToServer,t.type=new uo.ProtocolRequestType(t.method),t.registrationMethod=Ru.method})(rD||(fi.SemanticTokensDeltaRequest=rD={}));var iD;(function(t){t.method="textDocument/semanticTokens/range",t.messageDirection=uo.MessageDirection.clientToServer,t.type=new uo.ProtocolRequestType(t.method),t.registrationMethod=Ru.method})(iD||(fi.SemanticTokensRangeRequest=iD={}));var sD;(function(t){t.method="workspace/semanticTokens/refresh",t.messageDirection=uo.MessageDirection.serverToClient,t.type=new uo.ProtocolRequestType0(t.method)})(sD||(fi.SemanticTokensRefreshRequest=sD={}))});var lD=oe(Jp=>{"use strict";Object.defineProperty(Jp,"__esModule",{value:!0});Jp.ShowDocumentRequest=void 0;var aD=kn(),cD;(function(t){t.method="window/showDocument",t.messageDirection=aD.MessageDirection.serverToClient,t.type=new aD.ProtocolRequestType(t.method)})(cD||(Jp.ShowDocumentRequest=cD={}))});var fD=oe(Qp=>{"use strict";Object.defineProperty(Qp,"__esModule",{value:!0});Qp.LinkedEditingRangeRequest=void 0;var uD=kn(),dD;(function(t){t.method="textDocument/linkedEditingRange",t.messageDirection=uD.MessageDirection.clientToServer,t.type=new uD.ProtocolRequestType(t.method)})(dD||(Qp.LinkedEditingRangeRequest=dD={}))});var wD=oe(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.WillDeleteFilesRequest=Fr.DidDeleteFilesNotification=Fr.DidRenameFilesNotification=Fr.WillRenameFilesRequest=Fr.DidCreateFilesNotification=Fr.WillCreateFilesRequest=Fr.FileOperationPatternKind=void 0;var ts=kn(),pD;(function(t){t.file="file",t.folder="folder"})(pD||(Fr.FileOperationPatternKind=pD={}));var hD;(function(t){t.method="workspace/willCreateFiles",t.messageDirection=ts.MessageDirection.clientToServer,t.type=new ts.ProtocolRequestType(t.method)})(hD||(Fr.WillCreateFilesRequest=hD={}));var mD;(function(t){t.method="workspace/didCreateFiles",t.messageDirection=ts.MessageDirection.clientToServer,t.type=new ts.ProtocolNotificationType(t.method)})(mD||(Fr.DidCreateFilesNotification=mD={}));var gD;(function(t){t.method="workspace/willRenameFiles",t.messageDirection=ts.MessageDirection.clientToServer,t.type=new ts.ProtocolRequestType(t.method)})(gD||(Fr.WillRenameFilesRequest=gD={}));var _D;(function(t){t.method="workspace/didRenameFiles",t.messageDirection=ts.MessageDirection.clientToServer,t.type=new ts.ProtocolNotificationType(t.method)})(_D||(Fr.DidRenameFilesNotification=_D={}));var vD;(function(t){t.method="workspace/didDeleteFiles",t.messageDirection=ts.MessageDirection.clientToServer,t.type=new ts.ProtocolNotificationType(t.method)})(vD||(Fr.DidDeleteFilesNotification=vD={}));var yD;(function(t){t.method="workspace/willDeleteFiles",t.messageDirection=ts.MessageDirection.clientToServer,t.type=new ts.ProtocolRequestType(t.method)})(yD||(Fr.WillDeleteFilesRequest=yD={}))});var ED=oe(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.MonikerRequest=Ko.MonikerKind=Ko.UniquenessLevel=void 0;var bD=kn(),xD;(function(t){t.document="document",t.project="project",t.group="group",t.scheme="scheme",t.global="global"})(xD||(Ko.UniquenessLevel=xD={}));var TD;(function(t){t.$import="import",t.$export="export",t.local="local"})(TD||(Ko.MonikerKind=TD={}));var RD;(function(t){t.method="textDocument/moniker",t.messageDirection=bD.MessageDirection.clientToServer,t.type=new bD.ProtocolRequestType(t.method)})(RD||(Ko.MonikerRequest=RD={}))});var PD=oe(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.TypeHierarchySubtypesRequest=Zo.TypeHierarchySupertypesRequest=Zo.TypeHierarchyPrepareRequest=void 0;var Bc=kn(),SD;(function(t){t.method="textDocument/prepareTypeHierarchy",t.messageDirection=Bc.MessageDirection.clientToServer,t.type=new Bc.ProtocolRequestType(t.method)})(SD||(Zo.TypeHierarchyPrepareRequest=SD={}));var CD;(function(t){t.method="typeHierarchy/supertypes",t.messageDirection=Bc.MessageDirection.clientToServer,t.type=new Bc.ProtocolRequestType(t.method)})(CD||(Zo.TypeHierarchySupertypesRequest=CD={}));var kD;(function(t){t.method="typeHierarchy/subtypes",t.messageDirection=Bc.MessageDirection.clientToServer,t.type=new Bc.ProtocolRequestType(t.method)})(kD||(Zo.TypeHierarchySubtypesRequest=kD={}))});var ID=oe(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});Gc.InlineValueRefreshRequest=Gc.InlineValueRequest=void 0;var eh=kn(),AD;(function(t){t.method="textDocument/inlineValue",t.messageDirection=eh.MessageDirection.clientToServer,t.type=new eh.ProtocolRequestType(t.method)})(AD||(Gc.InlineValueRequest=AD={}));var DD;(function(t){t.method="workspace/inlineValue/refresh",t.messageDirection=eh.MessageDirection.serverToClient,t.type=new eh.ProtocolRequestType0(t.method)})(DD||(Gc.InlineValueRefreshRequest=DD={}))});var ND=oe(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.InlayHintRefreshRequest=Vo.InlayHintResolveRequest=Vo.InlayHintRequest=void 0;var zc=kn(),$D;(function(t){t.method="textDocument/inlayHint",t.messageDirection=zc.MessageDirection.clientToServer,t.type=new zc.ProtocolRequestType(t.method)})($D||(Vo.InlayHintRequest=$D={}));var OD;(function(t){t.method="inlayHint/resolve",t.messageDirection=zc.MessageDirection.clientToServer,t.type=new zc.ProtocolRequestType(t.method)})(OD||(Vo.InlayHintResolveRequest=OD={}));var FD;(function(t){t.method="workspace/inlayHint/refresh",t.messageDirection=zc.MessageDirection.serverToClient,t.type=new zc.ProtocolRequestType0(t.method)})(FD||(Vo.InlayHintRefreshRequest=FD={}))});var jD=oe(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.DiagnosticRefreshRequest=ns.WorkspaceDiagnosticRequest=ns.DocumentDiagnosticRequest=ns.DocumentDiagnosticReportKind=ns.DiagnosticServerCancellationData=void 0;var HD=Da(),H9=Hp(),Kc=kn(),MD;(function(t){function e(n){let r=n;return r&&H9.boolean(r.retriggerRequest)}t.is=e})(MD||(ns.DiagnosticServerCancellationData=MD={}));var qD;(function(t){t.Full="full",t.Unchanged="unchanged"})(qD||(ns.DocumentDiagnosticReportKind=qD={}));var LD;(function(t){t.method="textDocument/diagnostic",t.messageDirection=Kc.MessageDirection.clientToServer,t.type=new Kc.ProtocolRequestType(t.method),t.partialResult=new HD.ProgressType})(LD||(ns.DocumentDiagnosticRequest=LD={}));var UD;(function(t){t.method="workspace/diagnostic",t.messageDirection=Kc.MessageDirection.clientToServer,t.type=new Kc.ProtocolRequestType(t.method),t.partialResult=new HD.ProgressType})(UD||(ns.WorkspaceDiagnosticRequest=UD={}));var WD;(function(t){t.method="workspace/diagnostic/refresh",t.messageDirection=Kc.MessageDirection.serverToClient,t.type=new Kc.ProtocolRequestType0(t.method)})(WD||(ns.DiagnosticRefreshRequest=WD={}))});var VD=oe(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.DidCloseNotebookDocumentNotification=jn.DidSaveNotebookDocumentNotification=jn.DidChangeNotebookDocumentNotification=jn.NotebookCellArrayChange=jn.DidOpenNotebookDocumentNotification=jn.NotebookDocumentSyncRegistrationType=jn.NotebookDocument=jn.NotebookCell=jn.ExecutionSummary=jn.NotebookCellKind=void 0;var Eu=Wp(),Ts=Hp(),Ls=kn(),Ky;(function(t){t.Markup=1,t.Code=2;function e(n){return n===1||n===2}t.is=e})(Ky||(jn.NotebookCellKind=Ky={}));var Zy;(function(t){function e(s,a){let c={executionOrder:s};return(a===!0||a===!1)&&(c.success=a),c}t.create=e;function n(s){let a=s;return Ts.objectLiteral(a)&&Eu.uinteger.is(a.executionOrder)&&(a.success===void 0||Ts.boolean(a.success))}t.is=n;function r(s,a){return s===a?!0:s==null||a===null||a===void 0?!1:s.executionOrder===a.executionOrder&&s.success===a.success}t.equals=r})(Zy||(jn.ExecutionSummary=Zy={}));var th;(function(t){function e(a,c){return{kind:a,document:c}}t.create=e;function n(a){let c=a;return Ts.objectLiteral(c)&&Ky.is(c.kind)&&Eu.DocumentUri.is(c.document)&&(c.metadata===void 0||Ts.objectLiteral(c.metadata))}t.is=n;function r(a,c){let l=new Set;return a.document!==c.document&&l.add("document"),a.kind!==c.kind&&l.add("kind"),a.executionSummary!==c.executionSummary&&l.add("executionSummary"),(a.metadata!==void 0||c.metadata!==void 0)&&!s(a.metadata,c.metadata)&&l.add("metadata"),(a.executionSummary!==void 0||c.executionSummary!==void 0)&&!Zy.equals(a.executionSummary,c.executionSummary)&&l.add("executionSummary"),l}t.diff=r;function s(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;let l=Array.isArray(a),d=Array.isArray(c);if(l!==d)return!1;if(l&&d){if(a.length!==c.length)return!1;for(let f=0;f<a.length;f++)if(!s(a[f],c[f]))return!1}if(Ts.objectLiteral(a)&&Ts.objectLiteral(c)){let f=Object.keys(a),p=Object.keys(c);if(f.length!==p.length||(f.sort(),p.sort(),!s(f,p)))return!1;for(let m=0;m<f.length;m++){let g=f[m];if(!s(a[g],c[g]))return!1}}return!0}})(th||(jn.NotebookCell=th={}));var XD;(function(t){function e(r,s,a,c){return{uri:r,notebookType:s,version:a,cells:c}}t.create=e;function n(r){let s=r;return Ts.objectLiteral(s)&&Ts.string(s.uri)&&Eu.integer.is(s.version)&&Ts.typedArray(s.cells,th.is)}t.is=n})(XD||(jn.NotebookDocument=XD={}));var Zc;(function(t){t.method="notebookDocument/sync",t.messageDirection=Ls.MessageDirection.clientToServer,t.type=new Ls.RegistrationType(t.method)})(Zc||(jn.NotebookDocumentSyncRegistrationType=Zc={}));var BD;(function(t){t.method="notebookDocument/didOpen",t.messageDirection=Ls.MessageDirection.clientToServer,t.type=new Ls.ProtocolNotificationType(t.method),t.registrationMethod=Zc.method})(BD||(jn.DidOpenNotebookDocumentNotification=BD={}));var GD;(function(t){function e(r){let s=r;return Ts.objectLiteral(s)&&Eu.uinteger.is(s.start)&&Eu.uinteger.is(s.deleteCount)&&(s.cells===void 0||Ts.typedArray(s.cells,th.is))}t.is=e;function n(r,s,a){let c={start:r,deleteCount:s};return a!==void 0&&(c.cells=a),c}t.create=n})(GD||(jn.NotebookCellArrayChange=GD={}));var zD;(function(t){t.method="notebookDocument/didChange",t.messageDirection=Ls.MessageDirection.clientToServer,t.type=new Ls.ProtocolNotificationType(t.method),t.registrationMethod=Zc.method})(zD||(jn.DidChangeNotebookDocumentNotification=zD={}));var KD;(function(t){t.method="notebookDocument/didSave",t.messageDirection=Ls.MessageDirection.clientToServer,t.type=new Ls.ProtocolNotificationType(t.method),t.registrationMethod=Zc.method})(KD||(jn.DidSaveNotebookDocumentNotification=KD={}));var ZD;(function(t){t.method="notebookDocument/didClose",t.messageDirection=Ls.MessageDirection.clientToServer,t.type=new Ls.ProtocolNotificationType(t.method),t.registrationMethod=Zc.method})(ZD||(jn.DidCloseNotebookDocumentNotification=ZD={}))});var QD=oe(nh=>{"use strict";Object.defineProperty(nh,"__esModule",{value:!0});nh.InlineCompletionRequest=void 0;var YD=kn(),JD;(function(t){t.method="textDocument/inlineCompletion",t.messageDirection=YD.MessageDirection.clientToServer,t.type=new YD.ProtocolRequestType(t.method)})(JD||(nh.InlineCompletionRequest=JD={}))});var f2=oe(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.WorkspaceSymbolRequest=O.CodeActionResolveRequest=O.CodeActionRequest=O.DocumentSymbolRequest=O.DocumentHighlightRequest=O.ReferencesRequest=O.DefinitionRequest=O.SignatureHelpRequest=O.SignatureHelpTriggerKind=O.HoverRequest=O.CompletionResolveRequest=O.CompletionRequest=O.CompletionTriggerKind=O.PublishDiagnosticsNotification=O.WatchKind=O.RelativePattern=O.FileChangeType=O.DidChangeWatchedFilesNotification=O.WillSaveTextDocumentWaitUntilRequest=O.WillSaveTextDocumentNotification=O.TextDocumentSaveReason=O.DidSaveTextDocumentNotification=O.DidCloseTextDocumentNotification=O.DidChangeTextDocumentNotification=O.TextDocumentContentChangeEvent=O.DidOpenTextDocumentNotification=O.TextDocumentSyncKind=O.TelemetryEventNotification=O.LogMessageNotification=O.ShowMessageRequest=O.ShowMessageNotification=O.MessageType=O.DidChangeConfigurationNotification=O.ExitNotification=O.ShutdownRequest=O.InitializedNotification=O.InitializeErrorCodes=O.InitializeRequest=O.WorkDoneProgressOptions=O.TextDocumentRegistrationOptions=O.StaticRegistrationOptions=O.PositionEncodingKind=O.FailureHandlingKind=O.ResourceOperationKind=O.UnregistrationRequest=O.RegistrationRequest=O.DocumentSelector=O.NotebookCellTextDocumentFilter=O.NotebookDocumentFilter=O.TextDocumentFilter=void 0;O.MonikerRequest=O.MonikerKind=O.UniquenessLevel=O.WillDeleteFilesRequest=O.DidDeleteFilesNotification=O.WillRenameFilesRequest=O.DidRenameFilesNotification=O.WillCreateFilesRequest=O.DidCreateFilesNotification=O.FileOperationPatternKind=O.LinkedEditingRangeRequest=O.ShowDocumentRequest=O.SemanticTokensRegistrationType=O.SemanticTokensRefreshRequest=O.SemanticTokensRangeRequest=O.SemanticTokensDeltaRequest=O.SemanticTokensRequest=O.TokenFormat=O.CallHierarchyPrepareRequest=O.CallHierarchyOutgoingCallsRequest=O.CallHierarchyIncomingCallsRequest=O.WorkDoneProgressCancelNotification=O.WorkDoneProgressCreateRequest=O.WorkDoneProgress=O.SelectionRangeRequest=O.DeclarationRequest=O.FoldingRangeRefreshRequest=O.FoldingRangeRequest=O.ColorPresentationRequest=O.DocumentColorRequest=O.ConfigurationRequest=O.DidChangeWorkspaceFoldersNotification=O.WorkspaceFoldersRequest=O.TypeDefinitionRequest=O.ImplementationRequest=O.ApplyWorkspaceEditRequest=O.ExecuteCommandRequest=O.PrepareRenameRequest=O.RenameRequest=O.PrepareSupportDefaultBehavior=O.DocumentOnTypeFormattingRequest=O.DocumentRangesFormattingRequest=O.DocumentRangeFormattingRequest=O.DocumentFormattingRequest=O.DocumentLinkResolveRequest=O.DocumentLinkRequest=O.CodeLensRefreshRequest=O.CodeLensResolveRequest=O.CodeLensRequest=O.WorkspaceSymbolResolveRequest=void 0;O.InlineCompletionRequest=O.DidCloseNotebookDocumentNotification=O.DidSaveNotebookDocumentNotification=O.DidChangeNotebookDocumentNotification=O.NotebookCellArrayChange=O.DidOpenNotebookDocumentNotification=O.NotebookDocumentSyncRegistrationType=O.NotebookDocument=O.NotebookCell=O.ExecutionSummary=O.NotebookCellKind=O.DiagnosticRefreshRequest=O.WorkspaceDiagnosticRequest=O.DocumentDiagnosticRequest=O.DocumentDiagnosticReportKind=O.DiagnosticServerCancellationData=O.InlayHintRefreshRequest=O.InlayHintResolveRequest=O.InlayHintRequest=O.InlineValueRefreshRequest=O.InlineValueRequest=O.TypeHierarchySupertypesRequest=O.TypeHierarchySubtypesRequest=O.TypeHierarchyPrepareRequest=void 0;var Se=kn(),eI=Wp(),hr=Hp(),j9=EA();Object.defineProperty(O,"ImplementationRequest",{enumerable:!0,get:function(){return j9.ImplementationRequest}});var X9=kA();Object.defineProperty(O,"TypeDefinitionRequest",{enumerable:!0,get:function(){return X9.TypeDefinitionRequest}});var c2=DA();Object.defineProperty(O,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return c2.WorkspaceFoldersRequest}});Object.defineProperty(O,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return c2.DidChangeWorkspaceFoldersNotification}});var B9=OA();Object.defineProperty(O,"ConfigurationRequest",{enumerable:!0,get:function(){return B9.ConfigurationRequest}});var l2=MA();Object.defineProperty(O,"DocumentColorRequest",{enumerable:!0,get:function(){return l2.DocumentColorRequest}});Object.defineProperty(O,"ColorPresentationRequest",{enumerable:!0,get:function(){return l2.ColorPresentationRequest}});var u2=UA();Object.defineProperty(O,"FoldingRangeRequest",{enumerable:!0,get:function(){return u2.FoldingRangeRequest}});Object.defineProperty(O,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return u2.FoldingRangeRefreshRequest}});var G9=jA();Object.defineProperty(O,"DeclarationRequest",{enumerable:!0,get:function(){return G9.DeclarationRequest}});var z9=GA();Object.defineProperty(O,"SelectionRangeRequest",{enumerable:!0,get:function(){return z9.SelectionRangeRequest}});var ew=VA();Object.defineProperty(O,"WorkDoneProgress",{enumerable:!0,get:function(){return ew.WorkDoneProgress}});Object.defineProperty(O,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return ew.WorkDoneProgressCreateRequest}});Object.defineProperty(O,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return ew.WorkDoneProgressCancelNotification}});var tw=eD();Object.defineProperty(O,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return tw.CallHierarchyIncomingCallsRequest}});Object.defineProperty(O,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return tw.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(O,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return tw.CallHierarchyPrepareRequest}});var Vc=oD();Object.defineProperty(O,"TokenFormat",{enumerable:!0,get:function(){return Vc.TokenFormat}});Object.defineProperty(O,"SemanticTokensRequest",{enumerable:!0,get:function(){return Vc.SemanticTokensRequest}});Object.defineProperty(O,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return Vc.SemanticTokensDeltaRequest}});Object.defineProperty(O,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return Vc.SemanticTokensRangeRequest}});Object.defineProperty(O,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return Vc.SemanticTokensRefreshRequest}});Object.defineProperty(O,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return Vc.SemanticTokensRegistrationType}});var K9=lD();Object.defineProperty(O,"ShowDocumentRequest",{enumerable:!0,get:function(){return K9.ShowDocumentRequest}});var Z9=fD();Object.defineProperty(O,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return Z9.LinkedEditingRangeRequest}});var Ia=wD();Object.defineProperty(O,"FileOperationPatternKind",{enumerable:!0,get:function(){return Ia.FileOperationPatternKind}});Object.defineProperty(O,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Ia.DidCreateFilesNotification}});Object.defineProperty(O,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Ia.WillCreateFilesRequest}});Object.defineProperty(O,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Ia.DidRenameFilesNotification}});Object.defineProperty(O,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Ia.WillRenameFilesRequest}});Object.defineProperty(O,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Ia.DidDeleteFilesNotification}});Object.defineProperty(O,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Ia.WillDeleteFilesRequest}});var nw=ED();Object.defineProperty(O,"UniquenessLevel",{enumerable:!0,get:function(){return nw.UniquenessLevel}});Object.defineProperty(O,"MonikerKind",{enumerable:!0,get:function(){return nw.MonikerKind}});Object.defineProperty(O,"MonikerRequest",{enumerable:!0,get:function(){return nw.MonikerRequest}});var rw=PD();Object.defineProperty(O,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return rw.TypeHierarchyPrepareRequest}});Object.defineProperty(O,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return rw.TypeHierarchySubtypesRequest}});Object.defineProperty(O,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return rw.TypeHierarchySupertypesRequest}});var d2=ID();Object.defineProperty(O,"InlineValueRequest",{enumerable:!0,get:function(){return d2.InlineValueRequest}});Object.defineProperty(O,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return d2.InlineValueRefreshRequest}});var iw=ND();Object.defineProperty(O,"InlayHintRequest",{enumerable:!0,get:function(){return iw.InlayHintRequest}});Object.defineProperty(O,"InlayHintResolveRequest",{enumerable:!0,get:function(){return iw.InlayHintResolveRequest}});Object.defineProperty(O,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return iw.InlayHintRefreshRequest}});var Su=jD();Object.defineProperty(O,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Su.DiagnosticServerCancellationData}});Object.defineProperty(O,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Su.DocumentDiagnosticReportKind}});Object.defineProperty(O,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Su.DocumentDiagnosticRequest}});Object.defineProperty(O,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Su.WorkspaceDiagnosticRequest}});Object.defineProperty(O,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Su.DiagnosticRefreshRequest}});var Us=VD();Object.defineProperty(O,"NotebookCellKind",{enumerable:!0,get:function(){return Us.NotebookCellKind}});Object.defineProperty(O,"ExecutionSummary",{enumerable:!0,get:function(){return Us.ExecutionSummary}});Object.defineProperty(O,"NotebookCell",{enumerable:!0,get:function(){return Us.NotebookCell}});Object.defineProperty(O,"NotebookDocument",{enumerable:!0,get:function(){return Us.NotebookDocument}});Object.defineProperty(O,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Us.NotebookDocumentSyncRegistrationType}});Object.defineProperty(O,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Us.DidOpenNotebookDocumentNotification}});Object.defineProperty(O,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Us.NotebookCellArrayChange}});Object.defineProperty(O,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Us.DidChangeNotebookDocumentNotification}});Object.defineProperty(O,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Us.DidSaveNotebookDocumentNotification}});Object.defineProperty(O,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Us.DidCloseNotebookDocumentNotification}});var V9=QD();Object.defineProperty(O,"InlineCompletionRequest",{enumerable:!0,get:function(){return V9.InlineCompletionRequest}});var Vy;(function(t){function e(n){let r=n;return hr.string(r)||hr.string(r.language)||hr.string(r.scheme)||hr.string(r.pattern)}t.is=e})(Vy||(O.TextDocumentFilter=Vy={}));var Yy;(function(t){function e(n){let r=n;return hr.objectLiteral(r)&&(hr.string(r.notebookType)||hr.string(r.scheme)||hr.string(r.pattern))}t.is=e})(Yy||(O.NotebookDocumentFilter=Yy={}));var Jy;(function(t){function e(n){let r=n;return hr.objectLiteral(r)&&(hr.string(r.notebook)||Yy.is(r.notebook))&&(r.language===void 0||hr.string(r.language))}t.is=e})(Jy||(O.NotebookCellTextDocumentFilter=Jy={}));var Qy;(function(t){function e(n){if(!Array.isArray(n))return!1;for(let r of n)if(!hr.string(r)&&!Vy.is(r)&&!Jy.is(r))return!1;return!0}t.is=e})(Qy||(O.DocumentSelector=Qy={}));var tI;(function(t){t.method="client/registerCapability",t.messageDirection=Se.MessageDirection.serverToClient,t.type=new Se.ProtocolRequestType(t.method)})(tI||(O.RegistrationRequest=tI={}));var nI;(function(t){t.method="client/unregisterCapability",t.messageDirection=Se.MessageDirection.serverToClient,t.type=new Se.ProtocolRequestType(t.method)})(nI||(O.UnregistrationRequest=nI={}));var rI;(function(t){t.Create="create",t.Rename="rename",t.Delete="delete"})(rI||(O.ResourceOperationKind=rI={}));var iI;(function(t){t.Abort="abort",t.Transactional="transactional",t.TextOnlyTransactional="textOnlyTransactional",t.Undo="undo"})(iI||(O.FailureHandlingKind=iI={}));var sI;(function(t){t.UTF8="utf-8",t.UTF16="utf-16",t.UTF32="utf-32"})(sI||(O.PositionEncodingKind=sI={}));var oI;(function(t){function e(n){let r=n;return r&&hr.string(r.id)&&r.id.length>0}t.hasId=e})(oI||(O.StaticRegistrationOptions=oI={}));var aI;(function(t){function e(n){let r=n;return r&&(r.documentSelector===null||Qy.is(r.documentSelector))}t.is=e})(aI||(O.TextDocumentRegistrationOptions=aI={}));var cI;(function(t){function e(r){let s=r;return hr.objectLiteral(s)&&(s.workDoneProgress===void 0||hr.boolean(s.workDoneProgress))}t.is=e;function n(r){let s=r;return s&&hr.boolean(s.workDoneProgress)}t.hasWorkDoneProgress=n})(cI||(O.WorkDoneProgressOptions=cI={}));var lI;(function(t){t.method="initialize",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(lI||(O.InitializeRequest=lI={}));var uI;(function(t){t.unknownProtocolVersion=1})(uI||(O.InitializeErrorCodes=uI={}));var dI;(function(t){t.method="initialized",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolNotificationType(t.method)})(dI||(O.InitializedNotification=dI={}));var fI;(function(t){t.method="shutdown",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType0(t.method)})(fI||(O.ShutdownRequest=fI={}));var pI;(function(t){t.method="exit",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolNotificationType0(t.method)})(pI||(O.ExitNotification=pI={}));var hI;(function(t){t.method="workspace/didChangeConfiguration",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolNotificationType(t.method)})(hI||(O.DidChangeConfigurationNotification=hI={}));var mI;(function(t){t.Error=1,t.Warning=2,t.Info=3,t.Log=4,t.Debug=5})(mI||(O.MessageType=mI={}));var gI;(function(t){t.method="window/showMessage",t.messageDirection=Se.MessageDirection.serverToClient,t.type=new Se.ProtocolNotificationType(t.method)})(gI||(O.ShowMessageNotification=gI={}));var _I;(function(t){t.method="window/showMessageRequest",t.messageDirection=Se.MessageDirection.serverToClient,t.type=new Se.ProtocolRequestType(t.method)})(_I||(O.ShowMessageRequest=_I={}));var vI;(function(t){t.method="window/logMessage",t.messageDirection=Se.MessageDirection.serverToClient,t.type=new Se.ProtocolNotificationType(t.method)})(vI||(O.LogMessageNotification=vI={}));var yI;(function(t){t.method="telemetry/event",t.messageDirection=Se.MessageDirection.serverToClient,t.type=new Se.ProtocolNotificationType(t.method)})(yI||(O.TelemetryEventNotification=yI={}));var wI;(function(t){t.None=0,t.Full=1,t.Incremental=2})(wI||(O.TextDocumentSyncKind=wI={}));var bI;(function(t){t.method="textDocument/didOpen",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolNotificationType(t.method)})(bI||(O.DidOpenTextDocumentNotification=bI={}));var xI;(function(t){function e(r){let s=r;return s!=null&&typeof s.text=="string"&&s.range!==void 0&&(s.rangeLength===void 0||typeof s.rangeLength=="number")}t.isIncremental=e;function n(r){let s=r;return s!=null&&typeof s.text=="string"&&s.range===void 0&&s.rangeLength===void 0}t.isFull=n})(xI||(O.TextDocumentContentChangeEvent=xI={}));var TI;(function(t){t.method="textDocument/didChange",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolNotificationType(t.method)})(TI||(O.DidChangeTextDocumentNotification=TI={}));var RI;(function(t){t.method="textDocument/didClose",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolNotificationType(t.method)})(RI||(O.DidCloseTextDocumentNotification=RI={}));var EI;(function(t){t.method="textDocument/didSave",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolNotificationType(t.method)})(EI||(O.DidSaveTextDocumentNotification=EI={}));var SI;(function(t){t.Manual=1,t.AfterDelay=2,t.FocusOut=3})(SI||(O.TextDocumentSaveReason=SI={}));var CI;(function(t){t.method="textDocument/willSave",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolNotificationType(t.method)})(CI||(O.WillSaveTextDocumentNotification=CI={}));var kI;(function(t){t.method="textDocument/willSaveWaitUntil",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(kI||(O.WillSaveTextDocumentWaitUntilRequest=kI={}));var PI;(function(t){t.method="workspace/didChangeWatchedFiles",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolNotificationType(t.method)})(PI||(O.DidChangeWatchedFilesNotification=PI={}));var AI;(function(t){t.Created=1,t.Changed=2,t.Deleted=3})(AI||(O.FileChangeType=AI={}));var DI;(function(t){function e(n){let r=n;return hr.objectLiteral(r)&&(eI.URI.is(r.baseUri)||eI.WorkspaceFolder.is(r.baseUri))&&hr.string(r.pattern)}t.is=e})(DI||(O.RelativePattern=DI={}));var II;(function(t){t.Create=1,t.Change=2,t.Delete=4})(II||(O.WatchKind=II={}));var $I;(function(t){t.method="textDocument/publishDiagnostics",t.messageDirection=Se.MessageDirection.serverToClient,t.type=new Se.ProtocolNotificationType(t.method)})($I||(O.PublishDiagnosticsNotification=$I={}));var OI;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.TriggerForIncompleteCompletions=3})(OI||(O.CompletionTriggerKind=OI={}));var FI;(function(t){t.method="textDocument/completion",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(FI||(O.CompletionRequest=FI={}));var NI;(function(t){t.method="completionItem/resolve",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(NI||(O.CompletionResolveRequest=NI={}));var MI;(function(t){t.method="textDocument/hover",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(MI||(O.HoverRequest=MI={}));var qI;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.ContentChange=3})(qI||(O.SignatureHelpTriggerKind=qI={}));var LI;(function(t){t.method="textDocument/signatureHelp",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(LI||(O.SignatureHelpRequest=LI={}));var UI;(function(t){t.method="textDocument/definition",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(UI||(O.DefinitionRequest=UI={}));var WI;(function(t){t.method="textDocument/references",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(WI||(O.ReferencesRequest=WI={}));var HI;(function(t){t.method="textDocument/documentHighlight",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(HI||(O.DocumentHighlightRequest=HI={}));var jI;(function(t){t.method="textDocument/documentSymbol",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(jI||(O.DocumentSymbolRequest=jI={}));var XI;(function(t){t.method="textDocument/codeAction",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(XI||(O.CodeActionRequest=XI={}));var BI;(function(t){t.method="codeAction/resolve",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(BI||(O.CodeActionResolveRequest=BI={}));var GI;(function(t){t.method="workspace/symbol",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(GI||(O.WorkspaceSymbolRequest=GI={}));var zI;(function(t){t.method="workspaceSymbol/resolve",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(zI||(O.WorkspaceSymbolResolveRequest=zI={}));var KI;(function(t){t.method="textDocument/codeLens",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(KI||(O.CodeLensRequest=KI={}));var ZI;(function(t){t.method="codeLens/resolve",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(ZI||(O.CodeLensResolveRequest=ZI={}));var VI;(function(t){t.method="workspace/codeLens/refresh",t.messageDirection=Se.MessageDirection.serverToClient,t.type=new Se.ProtocolRequestType0(t.method)})(VI||(O.CodeLensRefreshRequest=VI={}));var YI;(function(t){t.method="textDocument/documentLink",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(YI||(O.DocumentLinkRequest=YI={}));var JI;(function(t){t.method="documentLink/resolve",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(JI||(O.DocumentLinkResolveRequest=JI={}));var QI;(function(t){t.method="textDocument/formatting",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(QI||(O.DocumentFormattingRequest=QI={}));var e2;(function(t){t.method="textDocument/rangeFormatting",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(e2||(O.DocumentRangeFormattingRequest=e2={}));var t2;(function(t){t.method="textDocument/rangesFormatting",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(t2||(O.DocumentRangesFormattingRequest=t2={}));var n2;(function(t){t.method="textDocument/onTypeFormatting",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(n2||(O.DocumentOnTypeFormattingRequest=n2={}));var r2;(function(t){t.Identifier=1})(r2||(O.PrepareSupportDefaultBehavior=r2={}));var i2;(function(t){t.method="textDocument/rename",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(i2||(O.RenameRequest=i2={}));var s2;(function(t){t.method="textDocument/prepareRename",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(s2||(O.PrepareRenameRequest=s2={}));var o2;(function(t){t.method="workspace/executeCommand",t.messageDirection=Se.MessageDirection.clientToServer,t.type=new Se.ProtocolRequestType(t.method)})(o2||(O.ExecuteCommandRequest=o2={}));var a2;(function(t){t.method="workspace/applyEdit",t.messageDirection=Se.MessageDirection.serverToClient,t.type=new Se.ProtocolRequestType("workspace/applyEdit")})(a2||(O.ApplyWorkspaceEditRequest=a2={}))});var h2=oe(rh=>{"use strict";Object.defineProperty(rh,"__esModule",{value:!0});rh.createProtocolConnection=void 0;var p2=Da();function Y9(t,e,n,r){return p2.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,p2.createMessageConnection)(t,e,n,r)}rh.createProtocolConnection=Y9});var g2=oe(pi=>{"use strict";var J9=pi&&pi.__createBinding||(Object.create?(function(t,e,n,r){r===void 0&&(r=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,s)}):(function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]})),ih=pi&&pi.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&J9(e,t,n)};Object.defineProperty(pi,"__esModule",{value:!0});pi.LSPErrorCodes=pi.createProtocolConnection=void 0;ih(Da(),pi);ih(Wp(),pi);ih(kn(),pi);ih(f2(),pi);var Q9=h2();Object.defineProperty(pi,"createProtocolConnection",{enumerable:!0,get:function(){return Q9.createProtocolConnection}});var m2;(function(t){t.lspReservedErrorRangeStart=-32899,t.RequestFailed=-32803,t.ServerCancelled=-32802,t.ContentModified=-32801,t.RequestCancelled=-32800,t.lspReservedErrorRangeEnd=-32800})(m2||(pi.LSPErrorCodes=m2={}))});var it=oe(Ws=>{"use strict";var eW=Ws&&Ws.__createBinding||(Object.create?(function(t,e,n,r){r===void 0&&(r=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,s)}):(function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]})),_2=Ws&&Ws.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&eW(e,t,n)};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.createProtocolConnection=void 0;var tW=Hy();_2(Hy(),Ws);_2(g2(),Ws);function nW(t,e,n,r){return(0,tW.createMessageConnection)(t,e,n,r)}Ws.createProtocolConnection=nW});var sh=oe(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.forEach=Nr.mapAsync=Nr.map=Nr.clearTestMode=Nr.setTestMode=Nr.Semaphore=Nr.Delayer=void 0;var ku=it(),sw=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,n=this.defaultDelay){return this.task=e,n>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(n>=0||this.timeout===void 0)&&(this.timeout=(0,ku.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},n>=0?n:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};Nr.Delayer=sw;var ow=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((n,r)=>{this._waiting.push({thunk:e,resolve:n,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,ku.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let n=e.thunk();n instanceof Promise?n.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(n),this.runNext())}catch(n){this._active--,e.reject(n),this.runNext()}}};Nr.Semaphore=ow;var aw=!1;function rW(){aw=!0}Nr.setTestMode=rW;function iW(){aw=!1}Nr.clearTestMode=iW;var v2=15,Cu=class{constructor(e=v2){this.yieldAfter=aw===!0?Math.max(e,2):Math.max(e,v2),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,n=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||n<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function sW(t,e,n,r){if(t.length===0)return[];let s=new Array(t.length),a=new Cu(r?.yieldAfter);function c(d){a.start();for(let f=d;f<t.length;f++)if(s[f]=e(t[f]),a.shouldYield())return r?.yieldCallback&&r.yieldCallback(),f+1;return-1}let l=c(0);for(;l!==-1&&!(n!==void 0&&n.isCancellationRequested);)l=await new Promise(d=>{(0,ku.RAL)().timer.setImmediate(()=>{d(c(l))})});return s}Nr.map=sW;async function oW(t,e,n,r){if(t.length===0)return[];let s=new Array(t.length),a=new Cu(r?.yieldAfter);async function c(d){a.start();for(let f=d;f<t.length;f++)if(s[f]=await e(t[f],n),a.shouldYield())return r?.yieldCallback&&r.yieldCallback(),f+1;return-1}let l=await c(0);for(;l!==-1&&!(n!==void 0&&n.isCancellationRequested);)l=await new Promise(d=>{(0,ku.RAL)().timer.setImmediate(()=>{d(c(l))})});return s}Nr.mapAsync=oW;async function aW(t,e,n,r){if(t.length===0)return;let s=new Cu(r?.yieldAfter);function a(l){s.start();for(let d=l;d<t.length;d++)if(e(t[d]),s.shouldYield())return r?.yieldCallback&&r.yieldCallback(),d+1;return-1}let c=a(0);for(;c!==-1&&!(n!==void 0&&n.isCancellationRequested);)c=await new Promise(l=>{(0,ku.RAL)().timer.setImmediate(()=>{l(a(c))})})}Nr.forEach=aW});var uw=oe(lw=>{"use strict";Object.defineProperty(lw,"__esModule",{value:!0});var cW=require("vscode"),cw=class extends cW.CompletionItem{constructor(e){super(e)}};lw.default=cw});var pw=oe(fw=>{"use strict";Object.defineProperty(fw,"__esModule",{value:!0});var lW=require("vscode"),dw=class extends lW.CodeLens{constructor(e){super(e)}};fw.default=dw});var gw=oe(mw=>{"use strict";Object.defineProperty(mw,"__esModule",{value:!0});var uW=require("vscode"),hw=class extends uW.DocumentLink{constructor(e,n){super(e,n)}};mw.default=hw});var yw=oe(vw=>{"use strict";Object.defineProperty(vw,"__esModule",{value:!0});var dW=require("vscode"),_w=class extends dW.CodeAction{constructor(e,n){super(e),this.data=n}};vw.default=_w});var xw=oe(Yc=>{"use strict";Object.defineProperty(Yc,"__esModule",{value:!0});Yc.ProtocolDiagnostic=Yc.DiagnosticCode=void 0;var fW=require("vscode"),ww=es(),y2;(function(t){function e(n){let r=n;return r!=null&&(ww.number(r.value)||ww.string(r.value))&&ww.string(r.target)}t.is=e})(y2||(Yc.DiagnosticCode=y2={}));var bw=class extends fW.Diagnostic{constructor(e,n,r,s){super(e,n,r),this.data=s,this.hasDiagnosticCode=!1}};Yc.ProtocolDiagnostic=bw});var Ew=oe(Rw=>{"use strict";Object.defineProperty(Rw,"__esModule",{value:!0});var pW=require("vscode"),Tw=class extends pW.CallHierarchyItem{constructor(e,n,r,s,a,c,l){super(e,n,r,s,a,c),l!==void 0&&(this.data=l)}};Rw.default=Tw});var kw=oe(Cw=>{"use strict";Object.defineProperty(Cw,"__esModule",{value:!0});var hW=require("vscode"),Sw=class extends hW.TypeHierarchyItem{constructor(e,n,r,s,a,c,l){super(e,n,r,s,a,c),l!==void 0&&(this.data=l)}};Cw.default=Sw});var Dw=oe(Aw=>{"use strict";Object.defineProperty(Aw,"__esModule",{value:!0});var oh=require("vscode"),Pw=class extends oh.SymbolInformation{constructor(e,n,r,s,a){let c=!(s instanceof oh.Uri);super(e,n,r,c?s:new oh.Location(s,new oh.Range(0,0,0,0))),this.hasRange=c,a!==void 0&&(this.data=a)}};Aw.default=Pw});var Ow=oe($w=>{"use strict";Object.defineProperty($w,"__esModule",{value:!0});var mW=require("vscode"),Iw=class extends mW.InlayHint{constructor(e,n,r){super(e,n,r)}};$w.default=Iw});var T2=oe(ah=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});ah.createConverter=void 0;var rr=require("vscode"),at=it(),$a=es(),w2=sh(),gW=uw(),_W=pw(),vW=gw(),b2=yw(),x2=xw(),yW=Ew(),wW=kw(),bW=Dw(),xW=Ow(),Fw;(function(t){function e(n){let r=n;return r&&!!r.inserting&&!!r.replacing}t.is=e})(Fw||(Fw={}));function TW(t){let n=t||(R=>R.toString());function r(R){return n(R)}function s(R){return{uri:n(R.uri)}}function a(R){return{uri:n(R.uri),languageId:R.languageId,version:R.version,text:R.getText()}}function c(R){return{uri:n(R.uri),version:R.version}}function l(R){return{textDocument:a(R)}}function d(R){let te=R;return!!te.document&&!!te.contentChanges}function f(R){let te=R;return!!te.uri&&!!te.version}function p(R,te,Fe){if(f(R))return{textDocument:{uri:n(R.uri),version:R.version},contentChanges:[{text:R.getText()}]};if(d(R)){let Ot=te,z=Fe;return{textDocument:{uri:n(Ot),version:z},contentChanges:R.contentChanges.map(U=>{let W=U.range;return{range:{start:{line:W.start.line,character:W.start.character},end:{line:W.end.line,character:W.end.character}},rangeLength:U.rangeLength,text:U.text}})}}else throw Error("Unsupported text document change parameter")}function m(R){return{textDocument:s(R)}}function g(R,te=!1){let Fe={textDocument:s(R)};return te&&(Fe.text=R.getText()),Fe}function w(R){switch(R){case rr.TextDocumentSaveReason.Manual:return at.TextDocumentSaveReason.Manual;case rr.TextDocumentSaveReason.AfterDelay:return at.TextDocumentSaveReason.AfterDelay;case rr.TextDocumentSaveReason.FocusOut:return at.TextDocumentSaveReason.FocusOut}return at.TextDocumentSaveReason.Manual}function v(R){return{textDocument:s(R.document),reason:w(R.reason)}}function x(R){return{files:R.files.map(te=>({uri:n(te)}))}}function b(R){return{files:R.files.map(te=>({oldUri:n(te.oldUri),newUri:n(te.newUri)}))}}function S(R){return{files:R.files.map(te=>({uri:n(te)}))}}function k(R){return{files:R.files.map(te=>({uri:n(te)}))}}function $(R){return{files:R.files.map(te=>({oldUri:n(te.oldUri),newUri:n(te.newUri)}))}}function F(R){return{files:R.files.map(te=>({uri:n(te)}))}}function L(R,te){return{textDocument:s(R),position:ue(te)}}function H(R){switch(R){case rr.CompletionTriggerKind.TriggerCharacter:return at.CompletionTriggerKind.TriggerCharacter;case rr.CompletionTriggerKind.TriggerForIncompleteCompletions:return at.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return at.CompletionTriggerKind.Invoked}}function N(R,te,Fe){return{textDocument:s(R),position:ue(te),context:{triggerKind:H(Fe.triggerKind),triggerCharacter:Fe.triggerCharacter}}}function X(R){switch(R){case rr.SignatureHelpTriggerKind.Invoke:return at.SignatureHelpTriggerKind.Invoked;case rr.SignatureHelpTriggerKind.TriggerCharacter:return at.SignatureHelpTriggerKind.TriggerCharacter;case rr.SignatureHelpTriggerKind.ContentChange:return at.SignatureHelpTriggerKind.ContentChange}}function V(R){return{label:R.label}}function Y(R){return R.map(V)}function D(R){return{label:R.label,parameters:Y(R.parameters)}}function j(R){return R.map(D)}function ae(R){return R===void 0?R:{signatures:j(R.signatures),activeSignature:R.activeSignature,activeParameter:R.activeParameter}}function me(R,te,Fe){return{textDocument:s(R),position:ue(te),context:{isRetrigger:Fe.isRetrigger,triggerCharacter:Fe.triggerCharacter,triggerKind:X(Fe.triggerKind),activeSignatureHelp:ae(Fe.activeSignatureHelp)}}}function ue(R){return{line:R.line,character:R.character}}function _e(R){return R==null?R:{line:R.line>at.uinteger.MAX_VALUE?at.uinteger.MAX_VALUE:R.line,character:R.character>at.uinteger.MAX_VALUE?at.uinteger.MAX_VALUE:R.character}}function ke(R,te){return w2.map(R,_e,te)}function De(R){return R.map(_e)}function Ie(R){return R==null?R:{start:_e(R.start),end:_e(R.end)}}function Ce(R){return R.map(Ie)}function Ge(R){return R==null?R:at.Location.create(r(R.uri),Ie(R.range))}function Re(R){switch(R){case rr.DiagnosticSeverity.Error:return at.DiagnosticSeverity.Error;case rr.DiagnosticSeverity.Warning:return at.DiagnosticSeverity.Warning;case rr.DiagnosticSeverity.Information:return at.DiagnosticSeverity.Information;case rr.DiagnosticSeverity.Hint:return at.DiagnosticSeverity.Hint}}function Oe(R){if(!R)return;let te=[];for(let Fe of R){let Ot=mt(Fe);Ot!==void 0&&te.push(Ot)}return te.length>0?te:void 0}function mt(R){switch(R){case rr.DiagnosticTag.Unnecessary:return at.DiagnosticTag.Unnecessary;case rr.DiagnosticTag.Deprecated:return at.DiagnosticTag.Deprecated;default:return}}function ze(R){return{message:R.message,location:Ge(R.location)}}function Xe(R){return R.map(ze)}function tt(R){if(R!=null)return $a.number(R)||$a.string(R)?R:{value:R.value,target:r(R.target)}}function We(R){let te=at.Diagnostic.create(Ie(R.range),R.message),Fe=R instanceof x2.ProtocolDiagnostic?R:void 0;Fe!==void 0&&Fe.data!==void 0&&(te.data=Fe.data);let Ot=tt(R.code);return x2.DiagnosticCode.is(Ot)?Fe!==void 0&&Fe.hasDiagnosticCode?te.code=Ot:(te.code=Ot.value,te.codeDescription={href:Ot.target}):te.code=Ot,$a.number(R.severity)&&(te.severity=Re(R.severity)),Array.isArray(R.tags)&&(te.tags=Oe(R.tags)),R.relatedInformation&&(te.relatedInformation=Xe(R.relatedInformation)),R.source&&(te.source=R.source),te}function rn(R,te){return R==null?R:w2.map(R,We,te)}function sn(R){return R==null?R:R.map(We)}function Bn(R,te){switch(R){case"$string":return te;case at.MarkupKind.PlainText:return{kind:R,value:te};case at.MarkupKind.Markdown:return{kind:R,value:te.value};default:return`Unsupported Markup content received. Kind is: ${R}`}}function Ye(R){switch(R){case rr.CompletionItemTag.Deprecated:return at.CompletionItemTag.Deprecated}}function Yt(R){if(R===void 0)return R;let te=[];for(let Fe of R){let Ot=Ye(Fe);Ot!==void 0&&te.push(Ot)}return te}function ln(R,te){return te!==void 0?te:R+1}function rt(R,te=!1){let Fe,Ot;$a.string(R.label)?Fe=R.label:(Fe=R.label.label,te&&(R.label.detail!==void 0||R.label.description!==void 0)&&(Ot={detail:R.label.detail,description:R.label.description}));let z={label:Fe};Ot!==void 0&&(z.labelDetails=Ot);let E=R instanceof gW.default?R:void 0;R.detail&&(z.detail=R.detail),R.documentation&&(!E||E.documentationFormat==="$string"?z.documentation=R.documentation:z.documentation=Bn(E.documentationFormat,R.documentation)),R.filterText&&(z.filterText=R.filterText),Nt(z,R),$a.number(R.kind)&&(z.kind=ln(R.kind,E&&E.originalItemKind)),R.sortText&&(z.sortText=R.sortText),R.additionalTextEdits&&(z.additionalTextEdits=st(R.additionalTextEdits)),R.commitCharacters&&(z.commitCharacters=R.commitCharacters.slice()),R.command&&(z.command=Pe(R.command)),(R.preselect===!0||R.preselect===!1)&&(z.preselect=R.preselect);let U=Yt(R.tags);if(E){if(E.data!==void 0&&(z.data=E.data),E.deprecated===!0||E.deprecated===!1){if(E.deprecated===!0&&U!==void 0&&U.length>0){let W=U.indexOf(rr.CompletionItemTag.Deprecated);W!==-1&&U.splice(W,1)}z.deprecated=E.deprecated}E.insertTextMode!==void 0&&(z.insertTextMode=E.insertTextMode)}return U!==void 0&&U.length>0&&(z.tags=U),z.insertTextMode===void 0&&R.keepWhitespace===!0&&(z.insertTextMode=at.InsertTextMode.adjustIndentation),z}function Nt(R,te){let Fe=at.InsertTextFormat.PlainText,Ot,z;te.textEdit?(Ot=te.textEdit.newText,z=te.textEdit.range):te.insertText instanceof rr.SnippetString?(Fe=at.InsertTextFormat.Snippet,Ot=te.insertText.value):Ot=te.insertText,te.range&&(z=te.range),R.insertTextFormat=Fe,te.fromEdit&&Ot!==void 0&&z!==void 0?R.textEdit=tn(Ot,z):R.insertText=Ot}function tn(R,te){return Fw.is(te)?at.InsertReplaceEdit.create(R,Ie(te.inserting),Ie(te.replacing)):{newText:R,range:Ie(te)}}function Jt(R){return{range:Ie(R.range),newText:R.newText}}function st(R){return R==null?R:R.map(Jt)}function At(R){return R<=rr.SymbolKind.TypeParameter?R+1:at.SymbolKind.Property}function St(R){return R}function xn(R){return R.map(St)}function pn(R,te,Fe){return{textDocument:s(R),position:ue(te),context:{includeDeclaration:Fe.includeDeclaration}}}async function Sr(R,te){let Fe=at.CodeAction.create(R.title);if(R instanceof b2.default&&R.data!==void 0&&(Fe.data=R.data),R.kind!==void 0&&(Fe.kind=q(R.kind)),R.diagnostics!==void 0&&(Fe.diagnostics=await rn(R.diagnostics,te)),R.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return R.command!==void 0&&(Fe.command=Pe(R.command)),R.isPreferred!==void 0&&(Fe.isPreferred=R.isPreferred),R.disabled!==void 0&&(Fe.disabled={reason:R.disabled.reason}),Fe}function Zn(R){let te=at.CodeAction.create(R.title);if(R instanceof b2.default&&R.data!==void 0&&(te.data=R.data),R.kind!==void 0&&(te.kind=q(R.kind)),R.diagnostics!==void 0&&(te.diagnostics=sn(R.diagnostics)),R.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return R.command!==void 0&&(te.command=Pe(R.command)),R.isPreferred!==void 0&&(te.isPreferred=R.isPreferred),R.disabled!==void 0&&(te.disabled={reason:R.disabled.reason}),te}async function Un(R,te){if(R==null)return R;let Fe;return R.only&&$a.string(R.only.value)&&(Fe=[R.only.value]),at.CodeActionContext.create(await rn(R.diagnostics,te),Fe,Dn(R.triggerKind))}function Gt(R){if(R==null)return R;let te;return R.only&&$a.string(R.only.value)&&(te=[R.only.value]),at.CodeActionContext.create(sn(R.diagnostics),te,Dn(R.triggerKind))}function Dn(R){switch(R){case rr.CodeActionTriggerKind.Invoke:return at.CodeActionTriggerKind.Invoked;case rr.CodeActionTriggerKind.Automatic:return at.CodeActionTriggerKind.Automatic;default:return}}function q(R){if(R!=null)return R.value}function ie(R){return R==null?R:at.InlineValueContext.create(R.frameId,Ie(R.stoppedLocation))}function xe(R,te,Fe){return{context:at.InlineCompletionContext.create(Fe.triggerKind,Fe.selectedCompletionInfo),textDocument:s(R),position:_e(te)}}function Pe(R){let te=at.Command.create(R.title,R.command);return R.arguments&&(te.arguments=R.arguments),te}function vt(R){let te=at.CodeLens.create(Ie(R.range));return R.command&&(te.command=Pe(R.command)),R instanceof _W.default&&R.data&&(te.data=R.data),te}function Q(R,te){let Fe={tabSize:R.tabSize,insertSpaces:R.insertSpaces};return te.trimTrailingWhitespace&&(Fe.trimTrailingWhitespace=!0),te.trimFinalNewlines&&(Fe.trimFinalNewlines=!0),te.insertFinalNewline&&(Fe.insertFinalNewline=!0),Fe}function se(R){return{textDocument:s(R)}}function ne(R){return{textDocument:s(R)}}function re(R){let te=at.DocumentLink.create(Ie(R.range));R.target&&(te.target=r(R.target)),R.tooltip!==void 0&&(te.tooltip=R.tooltip);let Fe=R instanceof vW.default?R:void 0;return Fe&&Fe.data&&(te.data=Fe.data),te}function ye(R){return{textDocument:s(R)}}function Ee(R){let te={name:R.name,kind:At(R.kind),uri:r(R.uri),range:Ie(R.range),selectionRange:Ie(R.selectionRange)};return R.detail!==void 0&&R.detail.length>0&&(te.detail=R.detail),R.tags!==void 0&&(te.tags=xn(R.tags)),R instanceof yW.default&&R.data!==void 0&&(te.data=R.data),te}function Le(R){let te={name:R.name,kind:At(R.kind),uri:r(R.uri),range:Ie(R.range),selectionRange:Ie(R.selectionRange)};return R.detail!==void 0&&R.detail.length>0&&(te.detail=R.detail),R.tags!==void 0&&(te.tags=xn(R.tags)),R instanceof wW.default&&R.data!==void 0&&(te.data=R.data),te}function gt(R){let te=R instanceof bW.default?{name:R.name,kind:At(R.kind),location:R.hasRange?Ge(R.location):{uri:n(R.location.uri)},data:R.data}:{name:R.name,kind:At(R.kind),location:Ge(R.location)};return R.tags!==void 0&&(te.tags=xn(R.tags)),R.containerName!==""&&(te.containerName=R.containerName),te}function Lt(R){let te=typeof R.label=="string"?R.label:R.label.map(ni),Fe=at.InlayHint.create(_e(R.position),te);return R.kind!==void 0&&(Fe.kind=R.kind),R.textEdits!==void 0&&(Fe.textEdits=st(R.textEdits)),R.tooltip!==void 0&&(Fe.tooltip=vi(R.tooltip)),R.paddingLeft!==void 0&&(Fe.paddingLeft=R.paddingLeft),R.paddingRight!==void 0&&(Fe.paddingRight=R.paddingRight),R instanceof xW.default&&R.data!==void 0&&(Fe.data=R.data),Fe}function ni(R){let te=at.InlayHintLabelPart.create(R.value);return R.location!==void 0&&(te.location=Ge(R.location)),R.command!==void 0&&(te.command=Pe(R.command)),R.tooltip!==void 0&&(te.tooltip=vi(R.tooltip)),te}function vi(R){return typeof R=="string"?R:{kind:at.MarkupKind.Markdown,value:R.value}}return{asUri:r,asTextDocumentIdentifier:s,asTextDocumentItem:a,asVersionedTextDocumentIdentifier:c,asOpenTextDocumentParams:l,asChangeTextDocumentParams:p,asCloseTextDocumentParams:m,asSaveTextDocumentParams:g,asWillSaveTextDocumentParams:v,asDidCreateFilesParams:x,asDidRenameFilesParams:b,asDidDeleteFilesParams:S,asWillCreateFilesParams:k,asWillRenameFilesParams:$,asWillDeleteFilesParams:F,asTextDocumentPositionParams:L,asCompletionParams:N,asSignatureHelpParams:me,asWorkerPosition:ue,asRange:Ie,asRanges:Ce,asPosition:_e,asPositions:ke,asPositionsSync:De,asLocation:Ge,asDiagnosticSeverity:Re,asDiagnosticTag:mt,asDiagnostic:We,asDiagnostics:rn,asDiagnosticsSync:sn,asCompletionItem:rt,asTextEdit:Jt,asSymbolKind:At,asSymbolTag:St,asSymbolTags:xn,asReferenceParams:pn,asCodeAction:Sr,asCodeActionSync:Zn,asCodeActionContext:Un,asCodeActionContextSync:Gt,asInlineValueContext:ie,asCommand:Pe,asCodeLens:vt,asFormattingOptions:Q,asDocumentSymbolParams:se,asCodeLensParams:ne,asDocumentLink:re,asDocumentLinkParams:ye,asCallHierarchyItem:Ee,asTypeHierarchyItem:Le,asInlayHint:Lt,asWorkspaceSymbol:gt,asInlineCompletionParams:xe}}ah.createConverter=TW});var S2=oe(lh=>{"use strict";Object.defineProperty(lh,"__esModule",{value:!0});lh.createConverter=void 0;var Ae=require("vscode"),et=it(),rs=es(),qt=sh(),RW=uw(),EW=pw(),SW=gw(),CW=yw(),R2=xw(),kW=Ew(),PW=kw(),AW=Dw(),DW=Ow(),E2=it(),ch;(function(t){function e(n){let r=n;return r&&rs.string(r.language)&&rs.string(r.value)}t.is=e})(ch||(ch={}));function IW(t,e,n){let s=t||(_=>Ae.Uri.parse(_));function a(_){return s(_)}function c(_){let G=[];for(let de of _)if(typeof de=="string")G.push(de);else if(E2.NotebookCellTextDocumentFilter.is(de))if(typeof de.notebook=="string")G.push({notebookType:de.notebook,language:de.language});else{let Ue=de.notebook.notebookType??"*";G.push({notebookType:Ue,scheme:de.notebook.scheme,pattern:de.notebook.pattern,language:de.language})}else E2.TextDocumentFilter.is(de)&&G.push({language:de.language,scheme:de.scheme,pattern:de.pattern});return G}async function l(_,G){return qt.map(_,f,G)}function d(_){let G=new Array(_.length);for(let de=0;de<_.length;de++)G[de]=f(_[de]);return G}function f(_){let G=new R2.ProtocolDiagnostic(v(_.range),_.message,b(_.severity),_.data);if(_.code!==void 0){if(typeof _.code=="string"||typeof _.code=="number")et.CodeDescription.is(_.codeDescription)?G.code={value:_.code,target:a(_.codeDescription.href)}:G.code=_.code;else if(R2.DiagnosticCode.is(_.code)){G.hasDiagnosticCode=!0;let de=_.code;G.code={value:de.value,target:a(de.target)}}}return _.source&&(G.source=_.source),_.relatedInformation&&(G.relatedInformation=p(_.relatedInformation)),Array.isArray(_.tags)&&(G.tags=m(_.tags)),G}function p(_){let G=new Array(_.length);for(let de=0;de<_.length;de++){let Ue=_[de];G[de]=new Ae.DiagnosticRelatedInformation(Re(Ue.location),Ue.message)}return G}function m(_){if(!_)return;let G=[];for(let de of _){let Ue=g(de);Ue!==void 0&&G.push(Ue)}return G.length>0?G:void 0}function g(_){switch(_){case et.DiagnosticTag.Unnecessary:return Ae.DiagnosticTag.Unnecessary;case et.DiagnosticTag.Deprecated:return Ae.DiagnosticTag.Deprecated;default:return}}function w(_){return _?new Ae.Position(_.line,_.character):void 0}function v(_){return _?new Ae.Range(_.start.line,_.start.character,_.end.line,_.end.character):void 0}async function x(_,G){return qt.map(_,de=>new Ae.Range(de.start.line,de.start.character,de.end.line,de.end.character),G)}function b(_){if(_==null)return Ae.DiagnosticSeverity.Error;switch(_){case et.DiagnosticSeverity.Error:return Ae.DiagnosticSeverity.Error;case et.DiagnosticSeverity.Warning:return Ae.DiagnosticSeverity.Warning;case et.DiagnosticSeverity.Information:return Ae.DiagnosticSeverity.Information;case et.DiagnosticSeverity.Hint:return Ae.DiagnosticSeverity.Hint}return Ae.DiagnosticSeverity.Error}function S(_){if(rs.string(_))return $(_);if(ch.is(_))return $().appendCodeblock(_.value,_.language);if(Array.isArray(_)){let G=[];for(let de of _){let Ue=$();ch.is(de)?Ue.appendCodeblock(de.value,de.language):Ue.appendMarkdown(de),G.push(Ue)}return G}else return $(_)}function k(_){if(rs.string(_))return _;switch(_.kind){case et.MarkupKind.Markdown:return $(_.value);case et.MarkupKind.PlainText:return _.value;default:return`Unsupported Markup content received. Kind is: ${_.kind}`}}function $(_){let G;if(_===void 0||typeof _=="string")G=new Ae.MarkdownString(_);else switch(_.kind){case et.MarkupKind.Markdown:G=new Ae.MarkdownString(_.value);break;case et.MarkupKind.PlainText:G=new Ae.MarkdownString,G.appendText(_.value);break;default:G=new Ae.MarkdownString,G.appendText(`Unsupported Markup content received. Kind is: ${_.kind}`);break}return G.isTrusted=e,G.supportHtml=n,G}function F(_){if(_)return new Ae.Hover(S(_.contents),v(_.range))}async function L(_,G,de){if(!_)return;if(Array.isArray(_))return qt.map(_,Ui=>Y(Ui,G),de);let Ue=_,{defaultRange:In,commitCharacters:ir}=H(Ue,G),Ut=await qt.map(Ue.items,Ui=>Y(Ui,ir,In,Ue.itemDefaults?.insertTextMode,Ue.itemDefaults?.insertTextFormat,Ue.itemDefaults?.data),de);return new Ae.CompletionList(Ut,Ue.isIncomplete)}function H(_,G){let de=_.itemDefaults?.editRange,Ue=_.itemDefaults?.commitCharacters??G;return et.Range.is(de)?{defaultRange:v(de),commitCharacters:Ue}:de!==void 0?{defaultRange:{inserting:v(de.insert),replacing:v(de.replace)},commitCharacters:Ue}:{defaultRange:void 0,commitCharacters:Ue}}function N(_){return et.CompletionItemKind.Text<=_&&_<=et.CompletionItemKind.TypeParameter?[_-1,void 0]:[Ae.CompletionItemKind.Text,_]}function X(_){switch(_){case et.CompletionItemTag.Deprecated:return Ae.CompletionItemTag.Deprecated}}function V(_){if(_==null)return[];let G=[];for(let de of _){let Ue=X(de);Ue!==void 0&&G.push(Ue)}return G}function Y(_,G,de,Ue,In,ir){let Ut=V(_.tags),Ui=D(_),Kt=new RW.default(Ui);_.detail&&(Kt.detail=_.detail),_.documentation&&(Kt.documentation=k(_.documentation),Kt.documentationFormat=rs.string(_.documentation)?"$string":_.documentation.kind),_.filterText&&(Kt.filterText=_.filterText);let sa=j(_,de,In);if(sa&&(Kt.insertText=sa.text,Kt.range=sa.range,Kt.fromEdit=sa.fromEdit),rs.number(_.kind)){let[dm,id]=N(_.kind);Kt.kind=dm,id&&(Kt.originalItemKind=id)}_.sortText&&(Kt.sortText=_.sortText),_.additionalTextEdits&&(Kt.additionalTextEdits=_e(_.additionalTextEdits));let dl=_.commitCharacters!==void 0?rs.stringArray(_.commitCharacters)?_.commitCharacters:void 0:G;dl&&(Kt.commitCharacters=dl.slice()),_.command&&(Kt.command=st(_.command)),(_.deprecated===!0||_.deprecated===!1)&&(Kt.deprecated=_.deprecated,_.deprecated===!0&&Ut.push(Ae.CompletionItemTag.Deprecated)),(_.preselect===!0||_.preselect===!1)&&(Kt.preselect=_.preselect);let rd=_.data??ir;rd!==void 0&&(Kt.data=rd),Ut.length>0&&(Kt.tags=Ut);let fl=_.insertTextMode??Ue;return fl!==void 0&&(Kt.insertTextMode=fl,fl===et.InsertTextMode.asIs&&(Kt.keepWhitespace=!0)),Kt}function D(_){return et.CompletionItemLabelDetails.is(_.labelDetails)?{label:_.label,detail:_.labelDetails.detail,description:_.labelDetails.description}:_.label}function j(_,G,de){let Ue=_.insertTextFormat??de;if(_.textEdit!==void 0||G!==void 0){let[In,ir]=_.textEdit!==void 0?ae(_.textEdit):[G,_.textEditText??_.label];return Ue===et.InsertTextFormat.Snippet?{text:new Ae.SnippetString(ir),range:In,fromEdit:!0}:{text:ir,range:In,fromEdit:!0}}else return _.insertText?Ue===et.InsertTextFormat.Snippet?{text:new Ae.SnippetString(_.insertText),fromEdit:!1}:{text:_.insertText,fromEdit:!1}:void 0}function ae(_){return et.InsertReplaceEdit.is(_)?[{inserting:v(_.insert),replacing:v(_.replace)},_.newText]:[v(_.range),_.newText]}function me(_){if(_)return new Ae.TextEdit(v(_.range),_.newText)}async function ue(_,G){if(_)return qt.map(_,me,G)}function _e(_){if(!_)return;let G=new Array(_.length);for(let de=0;de<_.length;de++)G[de]=me(_[de]);return G}async function ke(_,G){if(!_)return;let de=new Ae.SignatureHelp;return rs.number(_.activeSignature)?de.activeSignature=_.activeSignature:de.activeSignature=0,rs.number(_.activeParameter)?de.activeParameter=_.activeParameter:de.activeParameter=0,_.signatures&&(de.signatures=await De(_.signatures,G)),de}async function De(_,G){return qt.mapAsync(_,Ie,G)}async function Ie(_,G){let de=new Ae.SignatureInformation(_.label);return _.documentation!==void 0&&(de.documentation=k(_.documentation)),_.parameters!==void 0&&(de.parameters=await Ce(_.parameters,G)),_.activeParameter!==void 0&&(de.activeParameter=_.activeParameter),de}function Ce(_,G){return qt.map(_,Ge,G)}function Ge(_){let G=new Ae.ParameterInformation(_.label);return _.documentation&&(G.documentation=k(_.documentation)),G}function Re(_){return _?new Ae.Location(s(_.uri),v(_.range)):void 0}async function Oe(_,G){if(_)return Xe(_,G)}async function mt(_,G){if(_)return Xe(_,G)}function ze(_){if(!_)return;let G={targetUri:s(_.targetUri),targetRange:v(_.targetRange),originSelectionRange:v(_.originSelectionRange),targetSelectionRange:v(_.targetSelectionRange)};if(!G.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return G}async function Xe(_,G){if(_)if(rs.array(_)){if(_.length===0)return[];if(et.LocationLink.is(_[0])){let de=_;return qt.map(de,ze,G)}else{let de=_;return qt.map(de,Re,G)}}else return et.LocationLink.is(_)?[ze(_)]:Re(_)}async function tt(_,G){if(_)return qt.map(_,Re,G)}async function We(_,G){if(_)return qt.map(_,rn,G)}function rn(_){let G=new Ae.DocumentHighlight(v(_.range));return rs.number(_.kind)&&(G.kind=sn(_.kind)),G}function sn(_){switch(_){case et.DocumentHighlightKind.Text:return Ae.DocumentHighlightKind.Text;case et.DocumentHighlightKind.Read:return Ae.DocumentHighlightKind.Read;case et.DocumentHighlightKind.Write:return Ae.DocumentHighlightKind.Write}return Ae.DocumentHighlightKind.Text}async function Bn(_,G){if(_)return qt.map(_,rt,G)}function Ye(_){return _<=et.SymbolKind.TypeParameter?_-1:Ae.SymbolKind.Property}function Yt(_){switch(_){case et.SymbolTag.Deprecated:return Ae.SymbolTag.Deprecated;default:return}}function ln(_){if(_==null)return;let G=[];for(let de of _){let Ue=Yt(de);Ue!==void 0&&G.push(Ue)}return G.length===0?void 0:G}function rt(_){let G=_.data,de=_.location,Ue=de.range===void 0||G!==void 0?new AW.default(_.name,Ye(_.kind),_.containerName??"",de.range===void 0?s(de.uri):new Ae.Location(s(_.location.uri),v(de.range)),G):new Ae.SymbolInformation(_.name,Ye(_.kind),_.containerName??"",new Ae.Location(s(_.location.uri),v(de.range)));return Jt(Ue,_),Ue}async function Nt(_,G){if(_!=null)return qt.map(_,tn,G)}function tn(_){let G=new Ae.DocumentSymbol(_.name,_.detail||"",Ye(_.kind),v(_.range),v(_.selectionRange));if(Jt(G,_),_.children!==void 0&&_.children.length>0){let de=[];for(let Ue of _.children)de.push(tn(Ue));G.children=de}return G}function Jt(_,G){_.tags=ln(G.tags),G.deprecated&&(_.tags?_.tags.includes(Ae.SymbolTag.Deprecated)||(_.tags=_.tags.concat(Ae.SymbolTag.Deprecated)):_.tags=[Ae.SymbolTag.Deprecated])}function st(_){let G={title:_.title,command:_.command};return _.arguments&&(G.arguments=_.arguments),G}async function At(_,G){if(_)return qt.map(_,st,G)}let St=new Map;St.set(et.CodeActionKind.Empty,Ae.CodeActionKind.Empty),St.set(et.CodeActionKind.QuickFix,Ae.CodeActionKind.QuickFix),St.set(et.CodeActionKind.Refactor,Ae.CodeActionKind.Refactor),St.set(et.CodeActionKind.RefactorExtract,Ae.CodeActionKind.RefactorExtract),St.set(et.CodeActionKind.RefactorInline,Ae.CodeActionKind.RefactorInline),St.set(et.CodeActionKind.RefactorRewrite,Ae.CodeActionKind.RefactorRewrite),St.set(et.CodeActionKind.Source,Ae.CodeActionKind.Source),St.set(et.CodeActionKind.SourceOrganizeImports,Ae.CodeActionKind.SourceOrganizeImports);function xn(_){if(_==null)return;let G=St.get(_);if(G)return G;let de=_.split(".");G=Ae.CodeActionKind.Empty;for(let Ue of de)G=G.append(Ue);return G}function pn(_){if(_!=null)return _.map(G=>xn(G))}async function Sr(_,G){if(_==null)return;let de=new CW.default(_.title,_.data);return _.kind!==void 0&&(de.kind=xn(_.kind)),_.diagnostics!==void 0&&(de.diagnostics=d(_.diagnostics)),_.edit!==void 0&&(de.edit=await Dn(_.edit,G)),_.command!==void 0&&(de.command=st(_.command)),_.isPreferred!==void 0&&(de.isPreferred=_.isPreferred),_.disabled!==void 0&&(de.disabled={reason:_.disabled.reason}),de}function Zn(_,G){return qt.mapAsync(_,async de=>et.Command.is(de)?st(de):Sr(de,G),G)}function Un(_){if(!_)return;let G=new EW.default(v(_.range));return _.command&&(G.command=st(_.command)),_.data!==void 0&&_.data!==null&&(G.data=_.data),G}async function Gt(_,G){if(_)return qt.map(_,Un,G)}async function Dn(_,G){if(!_)return;let de=new Map;if(_.changeAnnotations!==void 0){let ir=_.changeAnnotations;await qt.forEach(Object.keys(ir),Ut=>{let Ui=q(ir[Ut]);de.set(Ut,Ui)},G)}let Ue=ir=>{if(ir!==void 0)return de.get(ir)},In=new Ae.WorkspaceEdit;if(_.documentChanges){let ir=_.documentChanges;await qt.forEach(ir,Ut=>{if(et.CreateFile.is(Ut))In.createFile(s(Ut.uri),Ut.options,Ue(Ut.annotationId));else if(et.RenameFile.is(Ut))In.renameFile(s(Ut.oldUri),s(Ut.newUri),Ut.options,Ue(Ut.annotationId));else if(et.DeleteFile.is(Ut))In.deleteFile(s(Ut.uri),Ut.options,Ue(Ut.annotationId));else if(et.TextDocumentEdit.is(Ut)){let Ui=s(Ut.textDocument.uri);for(let Kt of Ut.edits)et.AnnotatedTextEdit.is(Kt)?In.replace(Ui,v(Kt.range),Kt.newText,Ue(Kt.annotationId)):In.replace(Ui,v(Kt.range),Kt.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Ut,void 0,4)}`)},G)}else if(_.changes){let ir=_.changes;await qt.forEach(Object.keys(ir),Ut=>{In.set(s(Ut),_e(ir[Ut]))},G)}return In}function q(_){if(_!==void 0)return{label:_.label,needsConfirmation:!!_.needsConfirmation,description:_.description}}function ie(_){let G=v(_.range),de=_.target?a(_.target):void 0,Ue=new SW.default(G,de);return _.tooltip!==void 0&&(Ue.tooltip=_.tooltip),_.data!==void 0&&_.data!==null&&(Ue.data=_.data),Ue}async function xe(_,G){if(_)return qt.map(_,ie,G)}function Pe(_){return new Ae.Color(_.red,_.green,_.blue,_.alpha)}function vt(_){return new Ae.ColorInformation(v(_.range),Pe(_.color))}async function Q(_,G){if(_)return qt.map(_,vt,G)}function se(_){let G=new Ae.ColorPresentation(_.label);return G.additionalTextEdits=_e(_.additionalTextEdits),_.textEdit&&(G.textEdit=me(_.textEdit)),G}async function ne(_,G){if(_)return qt.map(_,se,G)}function re(_){if(_)switch(_){case et.FoldingRangeKind.Comment:return Ae.FoldingRangeKind.Comment;case et.FoldingRangeKind.Imports:return Ae.FoldingRangeKind.Imports;case et.FoldingRangeKind.Region:return Ae.FoldingRangeKind.Region}}function ye(_){return new Ae.FoldingRange(_.startLine,_.endLine,re(_.kind))}async function Ee(_,G){if(_)return qt.map(_,ye,G)}function Le(_){return new Ae.SelectionRange(v(_.range),_.parent?Le(_.parent):void 0)}async function gt(_,G){return Array.isArray(_)?qt.map(_,Le,G):[]}function Lt(_){return et.InlineValueText.is(_)?new Ae.InlineValueText(v(_.range),_.text):et.InlineValueVariableLookup.is(_)?new Ae.InlineValueVariableLookup(v(_.range),_.variableName,_.caseSensitiveLookup):new Ae.InlineValueEvaluatableExpression(v(_.range),_.expression)}async function ni(_,G){return Array.isArray(_)?qt.map(_,Lt,G):[]}async function vi(_,G){let de=typeof _.label=="string"?_.label:await qt.map(_.label,R,G),Ue=new DW.default(w(_.position),de);return _.kind!==void 0&&(Ue.kind=_.kind),_.textEdits!==void 0&&(Ue.textEdits=await ue(_.textEdits,G)),_.tooltip!==void 0&&(Ue.tooltip=te(_.tooltip)),_.paddingLeft!==void 0&&(Ue.paddingLeft=_.paddingLeft),_.paddingRight!==void 0&&(Ue.paddingRight=_.paddingRight),_.data!==void 0&&(Ue.data=_.data),Ue}function R(_){let G=new Ae.InlayHintLabelPart(_.value);return _.location!==void 0&&(G.location=Re(_.location)),_.tooltip!==void 0&&(G.tooltip=te(_.tooltip)),_.command!==void 0&&(G.command=st(_.command)),G}function te(_){return typeof _=="string"?_:$(_)}async function Fe(_,G){if(Array.isArray(_))return qt.mapAsync(_,vi,G)}function Ot(_){if(_===null)return;let G=new kW.default(Ye(_.kind),_.name,_.detail||"",a(_.uri),v(_.range),v(_.selectionRange),_.data);return _.tags!==void 0&&(G.tags=ln(_.tags)),G}async function z(_,G){if(_!==null)return qt.map(_,Ot,G)}async function E(_,G){return new Ae.CallHierarchyIncomingCall(Ot(_.from),await x(_.fromRanges,G))}async function U(_,G){if(_!==null)return qt.mapAsync(_,E,G)}async function W(_,G){return new Ae.CallHierarchyOutgoingCall(Ot(_.to),await x(_.fromRanges,G))}async function I(_,G){if(_!==null)return qt.mapAsync(_,W,G)}async function T(_,G){if(_!=null)return new Ae.SemanticTokens(new Uint32Array(_.data),_.resultId)}function J(_){return new Ae.SemanticTokensEdit(_.start,_.deleteCount,_.data!==void 0?new Uint32Array(_.data):void 0)}async function fe(_,G){if(_!=null)return new Ae.SemanticTokensEdits(_.edits.map(J),_.resultId)}function nt(_){return _}async function un(_,G){if(_!=null)return new Ae.LinkedEditingRanges(await x(_.ranges,G),zt(_.wordPattern))}function zt(_){if(_!=null)return new RegExp(_)}function _r(_){if(_===null)return;let G=new PW.default(Ye(_.kind),_.name,_.detail||"",a(_.uri),v(_.range),v(_.selectionRange),_.data);return _.tags!==void 0&&(G.tags=ln(_.tags)),G}async function Wr(_,G){if(_!==null)return qt.map(_,_r,G)}function yi(_){if(rs.string(_))return _;if(et.RelativePattern.is(_)){if(et.URI.is(_.baseUri))return new Ae.RelativePattern(a(_.baseUri),_.pattern);if(et.WorkspaceFolder.is(_.baseUri)){let G=Ae.workspace.getWorkspaceFolder(a(_.baseUri.uri));return G!==void 0?new Ae.RelativePattern(G,_.pattern):void 0}}}async function yt(_,G){if(!_)return;if(Array.isArray(_))return qt.map(_,In=>Li(In),G);let de=_,Ue=await qt.map(de.items,In=>Li(In),G);return new Ae.InlineCompletionList(Ue)}function Li(_){let G;typeof _.insertText=="string"?G=_.insertText:G=new Ae.SnippetString(_.insertText.value);let de;_.command&&(de=st(_.command));let Ue=new Ae.InlineCompletionItem(G,v(_.range),de);return _.filterText&&(Ue.filterText=_.filterText),Ue}return{asUri:a,asDocumentSelector:c,asDiagnostics:l,asDiagnostic:f,asRange:v,asRanges:x,asPosition:w,asDiagnosticSeverity:b,asDiagnosticTag:g,asHover:F,asCompletionResult:L,asCompletionItem:Y,asTextEdit:me,asTextEdits:ue,asSignatureHelp:ke,asSignatureInformations:De,asSignatureInformation:Ie,asParameterInformations:Ce,asParameterInformation:Ge,asDeclarationResult:Oe,asDefinitionResult:mt,asLocation:Re,asReferences:tt,asDocumentHighlights:We,asDocumentHighlight:rn,asDocumentHighlightKind:sn,asSymbolKind:Ye,asSymbolTag:Yt,asSymbolTags:ln,asSymbolInformations:Bn,asSymbolInformation:rt,asDocumentSymbols:Nt,asDocumentSymbol:tn,asCommand:st,asCommands:At,asCodeAction:Sr,asCodeActionKind:xn,asCodeActionKinds:pn,asCodeActionResult:Zn,asCodeLens:Un,asCodeLenses:Gt,asWorkspaceEdit:Dn,asDocumentLink:ie,asDocumentLinks:xe,asFoldingRangeKind:re,asFoldingRange:ye,asFoldingRanges:Ee,asColor:Pe,asColorInformation:vt,asColorInformations:Q,asColorPresentation:se,asColorPresentations:ne,asSelectionRange:Le,asSelectionRanges:gt,asInlineValue:Lt,asInlineValues:ni,asInlayHint:vi,asInlayHints:Fe,asSemanticTokensLegend:nt,asSemanticTokens:T,asSemanticTokensEdit:J,asSemanticTokensEdits:fe,asCallHierarchyItem:Ot,asCallHierarchyItems:z,asCallHierarchyIncomingCall:E,asCallHierarchyIncomingCalls:U,asCallHierarchyOutgoingCall:W,asCallHierarchyOutgoingCalls:I,asLinkedEditingRanges:un,asTypeHierarchyItem:_r,asTypeHierarchyItems:Wr,asGlobPattern:yi,asInlineCompletionResult:yt,asInlineCompletionItem:Li}}lh.createConverter=IW});var Pn=oe(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.generateUuid=is.parse=is.isUUID=is.v4=is.empty=void 0;var Pu=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},Au=class t extends Pu{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return t._oneOf(t._chars)}constructor(){super([t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-","4",t._randomHex(),t._randomHex(),t._randomHex(),"-",t._oneOf(t._timeHighBits),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex()].join(""))}};Au._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];Au._timeHighBits=["8","9","a","b"];is.empty=new Pu("00000000-0000-0000-0000-000000000000");function C2(){return new Au}is.v4=C2;var $W=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function k2(t){return $W.test(t)}is.isUUID=k2;function OW(t){if(!k2(t))throw new Error("invalid uuid");return new Pu(t)}is.parse=OW;function FW(){return C2().asHex()}is.generateUuid=FW});var Mw=oe(uh=>{"use strict";Object.defineProperty(uh,"__esModule",{value:!0});uh.ProgressPart=void 0;var P2=require("vscode"),A2=it(),D2=es(),Nw=class{constructor(e,n,r){this._client=e,this._token=n,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(A2.WorkDoneProgress.type,this._token,s=>{switch(s.kind){case"begin":this.begin(s);break;case"report":this.report(s);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&P2.window.withProgress({location:P2.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(n,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=n,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(A2.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((s,a)=>{this._resolve=s,this._reject=a})})}report(e){if(this._infinite&&D2.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(D2.number(e.percentage)){let n=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,n-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};uh.ProgressPart=Nw});var Ft=oe(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.WorkspaceFeature=mr.TextDocumentLanguageFeature=mr.TextDocumentEventFeature=mr.DynamicDocumentFeature=mr.DynamicFeature=mr.StaticFeature=mr.ensure=mr.LSPCancellationError=void 0;var Oa=require("vscode"),qw=it(),Qr=es(),I2=Pn(),Lw=class extends Oa.CancellationError{constructor(e){super(),this.data=e}};mr.LSPCancellationError=Lw;function NW(t,e){return t[e]===void 0&&(t[e]={}),t[e]}mr.ensure=NW;var $2;(function(t){function e(n){let r=n;return r!=null&&Qr.func(r.fillClientCapabilities)&&Qr.func(r.initialize)&&Qr.func(r.getState)&&Qr.func(r.clear)&&(r.fillInitializeParams===void 0||Qr.func(r.fillInitializeParams))}t.is=e})($2||(mr.StaticFeature=$2={}));var O2;(function(t){function e(n){let r=n;return r!=null&&Qr.func(r.fillClientCapabilities)&&Qr.func(r.initialize)&&Qr.func(r.getState)&&Qr.func(r.clear)&&(r.fillInitializeParams===void 0||Qr.func(r.fillInitializeParams))&&Qr.func(r.register)&&Qr.func(r.unregister)&&r.registrationType!==void 0}t.is=e})(O2||(mr.DynamicFeature=O2={}));var Du=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),n=0;for(let s of e){n++;for(let a of Oa.workspace.textDocuments)if(Oa.languages.match(s,a)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let r=n>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}};mr.DynamicDocumentFeature=Du;var Uw=class extends Du{static textDocumentFilter(e,n){for(let r of e)if(Oa.languages.match(r,n)>0)return!0;return!1}constructor(e,n,r,s,a,c,l){super(e),this._event=n,this._type=r,this._middleware=s,this._createParams=a,this._textDocument=c,this._selectorFilter=l,this._selectors=new Map,this._onNotificationSent=new Oa.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(n=>{this.callback(n).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let n=async r=>{let s=this._createParams(r);await this._client.sendNotification(this._type,s),this.notificationSent(this.getTextDocument(r),this._type,s)};if(this.matches(e)){let r=this._middleware();return r?r(e,s=>n(s)):n(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,n,r){this._onNotificationSent.fire({textDocument:e,type:n,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let n of this._selectors.values())if(Oa.languages.match(n,e)>0)return{send:r=>this.callback(r)}}};mr.TextDocumentEventFeature=Uw;var Ww=class extends Du{constructor(e,n){super(e),this._registrationType=n,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let n=e.data.registerOptions.documentSelector;n!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(n))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let n=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:n[0],data:e,provider:n[1]})}unregister(e){let n=this._registrations.get(e);n!==void 0&&n.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,n){if(n){if(qw.TextDocumentRegistrationOptions.is(n)){let r=qw.StaticRegistrationOptions.hasId(n)?n.id:I2.generateUuid(),s=n.documentSelector??e;if(s)return[r,Object.assign({},n,{documentSelector:s})]}else if(Qr.boolean(n)&&n===!0||qw.WorkDoneProgressOptions.is(n)){if(!e)return[void 0,void 0];let r=Qr.boolean(n)&&n===!0?{documentSelector:e}:Object.assign({},n,{documentSelector:e});return[I2.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,n){if(!(!e||!n))return Qr.boolean(n)&&n===!0?{documentSelector:e}:Object.assign({},n,{documentSelector:e})}getProvider(e){for(let n of this._registrations.values()){let r=n.data.registerOptions.documentSelector;if(r!==null&&Oa.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return n.provider}}getAllProviders(){let e=[];for(let n of this._registrations.values())e.push(n.provider);return e}};mr.TextDocumentLanguageFeature=Ww;var Hw=class{constructor(e,n){this._client=e,this._registrationType=n,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let n=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:n[0],provider:n[1]})}unregister(e){let n=this._registrations.get(e);n!==void 0&&n.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let n of this._registrations.values())e.push(n.provider);return e}};mr.WorkspaceFeature=Hw});var N2=oe((vte,F2)=>{var MW=typeof process=="object"&&process&&process.platform==="win32";F2.exports=MW?{sep:"\\"}:{sep:"/"}});var W2=oe((yte,U2)=>{"use strict";U2.exports=q2;function q2(t,e,n){t instanceof RegExp&&(t=M2(t,n)),e instanceof RegExp&&(e=M2(e,n));var r=L2(t,e,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+t.length,r[1]),post:n.slice(r[1]+e.length)}}function M2(t,e){var n=e.match(t);return n?n[0]:null}q2.range=L2;function L2(t,e,n){var r,s,a,c,l,d=n.indexOf(t),f=n.indexOf(e,d+1),p=d;if(d>=0&&f>0){if(t===e)return[d,f];for(r=[],a=n.length;p>=0&&!l;)p==d?(r.push(p),d=n.indexOf(t,p+1)):r.length==1?l=[r.pop(),f]:(s=r.pop(),s<a&&(a=s,c=f),f=n.indexOf(e,p+1)),p=d<f&&d>=0?d:f;r.length&&(l=[a,c])}return l}});var Z2=oe((wte,K2)=>{var H2=W2();K2.exports=UW;var j2="\0SLASH"+Math.random()+"\0",X2="\0OPEN"+Math.random()+"\0",Xw="\0CLOSE"+Math.random()+"\0",B2="\0COMMA"+Math.random()+"\0",G2="\0PERIOD"+Math.random()+"\0";function jw(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function qW(t){return t.split("\\\\").join(j2).split("\\{").join(X2).split("\\}").join(Xw).split("\\,").join(B2).split("\\.").join(G2)}function LW(t){return t.split(j2).join("\\").split(X2).join("{").split(Xw).join("}").split(B2).join(",").split(G2).join(".")}function z2(t){if(!t)return[""];var e=[],n=H2("{","}",t);if(!n)return t.split(",");var r=n.pre,s=n.body,a=n.post,c=r.split(",");c[c.length-1]+="{"+s+"}";var l=z2(a);return a.length&&(c[c.length-1]+=l.shift(),c.push.apply(c,l)),e.push.apply(e,c),e}function UW(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),Iu(qW(t),!0).map(LW)):[]}function WW(t){return"{"+t+"}"}function HW(t){return/^-?0\d/.test(t)}function jW(t,e){return t<=e}function XW(t,e){return t>=e}function Iu(t,e){var n=[],r=H2("{","}",t);if(!r)return[t];var s=r.pre,a=r.post.length?Iu(r.post,!1):[""];if(/\$$/.test(r.pre))for(var c=0;c<a.length;c++){var l=s+"{"+r.body+"}"+a[c];n.push(l)}else{var d=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),f=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),p=d||f,m=r.body.indexOf(",")>=0;if(!p&&!m)return r.post.match(/,(?!,).*\}/)?(t=r.pre+"{"+r.body+Xw+r.post,Iu(t)):[t];var g;if(p)g=r.body.split(/\.\./);else if(g=z2(r.body),g.length===1&&(g=Iu(g[0],!1).map(WW),g.length===1))return a.map(function(Y){return r.pre+g[0]+Y});var w;if(p){var v=jw(g[0]),x=jw(g[1]),b=Math.max(g[0].length,g[1].length),S=g.length==3?Math.abs(jw(g[2])):1,k=jW,$=x<v;$&&(S*=-1,k=XW);var F=g.some(HW);w=[];for(var L=v;k(L,x);L+=S){var H;if(f)H=String.fromCharCode(L),H==="\\"&&(H="");else if(H=String(L),F){var N=b-H.length;if(N>0){var X=new Array(N+1).join("0");L<0?H="-"+X+H.slice(1):H=X+H}}w.push(H)}}else{w=[];for(var V=0;V<g.length;V++)w.push.apply(w,Iu(g[V],!1))}for(var V=0;V<w.length;V++)for(var c=0;c<a.length;c++){var l=s+w[V]+a[c];(!e||p||l)&&n.push(l)}}return n}});var fh=oe((xte,Zw)=>{var Fi=Zw.exports=(t,e,n={})=>(dh(e),!n.nocomment&&e.charAt(0)==="#"?!1:new Jc(e,n).match(t));Zw.exports=Fi;var zw=N2();Fi.sep=zw.sep;var Rs=Symbol("globstar **");Fi.GLOBSTAR=Rs;var BW=Z2(),V2={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Kw="[^/]",Bw=Kw+"*?",GW="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",zW="(?:(?!(?:\\/|^)\\.).)*?",Q2=t=>t.split("").reduce((e,n)=>(e[n]=!0,e),{}),Y2=Q2("().*{}+?[]^$\\!"),KW=Q2("[.("),J2=/\/+/;Fi.filter=(t,e={})=>(n,r,s)=>Fi(n,t,e);var Yo=(t,e={})=>{let n={};return Object.keys(t).forEach(r=>n[r]=t[r]),Object.keys(e).forEach(r=>n[r]=e[r]),n};Fi.defaults=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return Fi;let e=Fi,n=(r,s,a)=>e(r,s,Yo(t,a));return n.Minimatch=class extends e.Minimatch{constructor(s,a){super(s,Yo(t,a))}},n.Minimatch.defaults=r=>e.defaults(Yo(t,r)).Minimatch,n.filter=(r,s)=>e.filter(r,Yo(t,s)),n.defaults=r=>e.defaults(Yo(t,r)),n.makeRe=(r,s)=>e.makeRe(r,Yo(t,s)),n.braceExpand=(r,s)=>e.braceExpand(r,Yo(t,s)),n.match=(r,s,a)=>e.match(r,s,Yo(t,a)),n};Fi.braceExpand=(t,e)=>e$(t,e);var e$=(t,e={})=>(dh(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:BW(t)),ZW=1024*64,dh=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>ZW)throw new TypeError("pattern is too long")},Gw=Symbol("subparse");Fi.makeRe=(t,e)=>new Jc(t,e||{}).makeRe();Fi.match=(t,e,n={})=>{let r=new Jc(e,n);return t=t.filter(s=>r.match(s)),r.options.nonull&&!t.length&&t.push(e),t};var VW=t=>t.replace(/\\(.)/g,"$1"),YW=t=>t.replace(/\\([^-\]])/g,"$1"),JW=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),QW=t=>t.replace(/[[\]\\]/g,"\\$&"),Jc=class{constructor(e,n){dh(e),n||(n={}),this.options=n,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!n.windowsPathsNoEscape||n.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!n.partial,this.make()}debug(){}make(){let e=this.pattern,n=this.options;if(!n.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();n.debug&&(this.debug=(...s)=>console.error(...s)),this.debug(this.pattern,r),r=this.globParts=r.map(s=>s.split(J2)),this.debug(this.pattern,r),r=r.map((s,a,c)=>s.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(s=>s.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,n=!1,r=0;for(let s=0;s<e.length&&e.charAt(s)==="!";s++)n=!n,r++;r&&(this.pattern=e.slice(r)),this.negate=n}matchOne(e,n,r){var s=this.options;this.debug("matchOne",{this:this,file:e,pattern:n}),this.debug("matchOne",e.length,n.length);for(var a=0,c=0,l=e.length,d=n.length;a<l&&c<d;a++,c++){this.debug("matchOne loop");var f=n[c],p=e[a];if(this.debug(n,f,p),f===!1)return!1;if(f===Rs){this.debug("GLOBSTAR",[n,f,p]);var m=a,g=c+1;if(g===d){for(this.debug("** at the end");a<l;a++)if(e[a]==="."||e[a]===".."||!s.dot&&e[a].charAt(0)===".")return!1;return!0}for(;m<l;){var w=e[m];if(this.debug(`
globstar while`,e,m,n,g,w),this.matchOne(e.slice(m),n.slice(g),r))return this.debug("globstar found match!",m,l,w),!0;if(w==="."||w===".."||!s.dot&&w.charAt(0)==="."){this.debug("dot detected!",e,m,n,g);break}this.debug("globstar swallow a segment, and continue"),m++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,m,n,g),m===l))}var v;if(typeof f=="string"?(v=p===f,this.debug("string match",f,p,v)):(v=p.match(f),this.debug("pattern match",f,p,v)),!v)return!1}if(a===l&&c===d)return!0;if(a===l)return r;if(c===d)return a===l-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return e$(this.pattern,this.options)}parse(e,n){dh(e);let r=this.options;if(e==="**")if(r.noglobstar)e="*";else return Rs;if(e==="")return"";let s="",a=!1,c=!1,l=[],d=[],f,p=!1,m=-1,g=-1,w,v,x,b=e.charAt(0)===".",S=r.dot||b,k=()=>b?"":S?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",$=N=>N.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",F=()=>{if(f){switch(f){case"*":s+=Bw,a=!0;break;case"?":s+=Kw,a=!0;break;default:s+="\\"+f;break}this.debug("clearStateChar %j %j",f,s),f=!1}};for(let N=0,X;N<e.length&&(X=e.charAt(N));N++){if(this.debug("%s	%s %s %j",e,N,s,X),c){if(X==="/")return!1;Y2[X]&&(s+="\\"),s+=X,c=!1;continue}switch(X){case"/":return!1;case"\\":if(p&&e.charAt(N+1)==="-"){s+=X;continue}F(),c=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,N,s,X),p){this.debug("  in class"),X==="!"&&N===g+1&&(X="^"),s+=X;continue}this.debug("call clearStateChar %j",f),F(),f=X,r.noext&&F();continue;case"(":{if(p){s+="(";continue}if(!f){s+="\\(";continue}let V={type:f,start:N-1,reStart:s.length,open:V2[f].open,close:V2[f].close};this.debug(this.pattern,"	",V),l.push(V),s+=V.open,V.start===0&&V.type!=="!"&&(b=!0,s+=$(e.slice(N+1))),this.debug("plType %j %j",f,s),f=!1;continue}case")":{let V=l[l.length-1];if(p||!V){s+="\\)";continue}l.pop(),F(),a=!0,v=V,s+=v.close,v.type==="!"&&d.push(Object.assign(v,{reEnd:s.length}));continue}case"|":{let V=l[l.length-1];if(p||!V){s+="\\|";continue}F(),s+="|",V.start===0&&V.type!=="!"&&(b=!0,s+=$(e.slice(N+1)));continue}case"[":if(F(),p){s+="\\"+X;continue}p=!0,g=N,m=s.length,s+=X;continue;case"]":if(N===g+1||!p){s+="\\"+X;continue}w=e.substring(g+1,N);try{RegExp("["+QW(YW(w))+"]"),s+=X}catch{s=s.substring(0,m)+"(?:$.)"}a=!0,p=!1;continue;default:F(),Y2[X]&&!(X==="^"&&p)&&(s+="\\"),s+=X;break}}for(p&&(w=e.slice(g+1),x=this.parse(w,Gw),s=s.substring(0,m)+"\\["+x[0],a=a||x[1]),v=l.pop();v;v=l.pop()){let N;N=s.slice(v.reStart+v.open.length),this.debug("setting tail",s,v),N=N.replace(/((?:\\{2}){0,64})(\\?)\|/g,(V,Y,D)=>(D||(D="\\"),Y+Y+D+"|")),this.debug(`tail=%j
   %s`,N,N,v,s);let X=v.type==="*"?Bw:v.type==="?"?Kw:"\\"+v.type;a=!0,s=s.slice(0,v.reStart)+X+"\\("+N}F(),c&&(s+="\\\\");let L=KW[s.charAt(0)];for(let N=d.length-1;N>-1;N--){let X=d[N],V=s.slice(0,X.reStart),Y=s.slice(X.reStart,X.reEnd-8),D=s.slice(X.reEnd),j=s.slice(X.reEnd-8,X.reEnd)+D,ae=V.split(")").length,me=V.split("(").length-ae,ue=D;for(let ke=0;ke<me;ke++)ue=ue.replace(/\)[+*?]?/,"");D=ue;let _e=D===""&&n!==Gw?"(?:$|\\/)":"";s=V+Y+D+_e+j}if(s!==""&&a&&(s="(?=.)"+s),L&&(s=k()+s),n===Gw)return[s,a];if(r.nocase&&!a&&(a=e.toUpperCase()!==e.toLowerCase()),!a)return VW(e);let H=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+s+"$",H),{_glob:e,_src:s})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let n=this.options,r=n.noglobstar?Bw:n.dot?GW:zW,s=n.nocase?"i":"",a=e.map(c=>(c=c.map(l=>typeof l=="string"?JW(l):l===Rs?Rs:l._src).reduce((l,d)=>(l[l.length-1]===Rs&&d===Rs||l.push(d),l),[]),c.forEach((l,d)=>{l!==Rs||c[d-1]===Rs||(d===0?c.length>1?c[d+1]="(?:\\/|"+r+"\\/)?"+c[d+1]:c[d]=r:d===c.length-1?c[d-1]+="(?:\\/|"+r+")?":(c[d-1]+="(?:\\/|\\/"+r+"\\/)"+c[d+1],c[d+1]=Rs))}),c.filter(l=>l!==Rs).join("/"))).join("|");a="^(?:"+a+")$",this.negate&&(a="^(?!"+a+").*$");try{this.regexp=new RegExp(a,s)}catch{this.regexp=!1}return this.regexp}match(e,n=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&n)return!0;let r=this.options;zw.sep!=="/"&&(e=e.split(zw.sep).join("/")),e=e.split(J2),this.debug(this.pattern,"split",e);let s=this.set;this.debug(this.pattern,"set",s);let a;for(let c=e.length-1;c>=0&&(a=e[c],!a);c--);for(let c=0;c<s.length;c++){let l=s[c],d=e;if(r.matchBase&&l.length===1&&(d=[a]),this.matchOne(d,l,n))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return Fi.defaults(e).Minimatch}};Fi.Minimatch=Jc});var rb=oe(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:!0});Jo.DiagnosticFeature=Jo.DiagnosticPullMode=Jo.vsdiag=void 0;var eH=fh(),kt=require("vscode"),Xn=it(),tH=Pn(),Vw=Ft();function ph(t,e){return t[e]===void 0&&(t[e]={}),t[e]}var ss;(function(t){let e;(function(n){n.full="full",n.unChanged="unChanged"})(e=t.DocumentDiagnosticReportKind||(t.DocumentDiagnosticReportKind={}))})(ss||(Jo.vsdiag=ss={}));var hh;(function(t){t.onType="onType",t.onSave="onSave"})(hh||(Jo.DiagnosticPullMode=hh={}));var Mr;(function(t){t.active="open",t.reschedule="reschedule",t.outDated="drop"})(Mr||(Mr={}));var Yw=class t{constructor(){this.open=new Set,this._onOpen=new kt.EventEmitter,this._onClose=new kt.EventEmitter,t.fillTabResources(this.open);let e=n=>{if(n.closed.length===0&&n.opened.length===0)return;let r=this.open,s=new Set;t.fillTabResources(s);let a=new Set,c=new Set(s);for(let l of r.values())s.has(l)?c.delete(l):a.add(l);if(this.open=s,a.size>0){let l=new Set;for(let d of a)l.add(kt.Uri.parse(d));this._onClose.fire(l)}if(c.size>0){let l=new Set;for(let d of c)l.add(kt.Uri.parse(d));this._onOpen.fire(l)}};kt.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=kt.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof kt.Uri?kt.window.activeTextEditor?.document.uri===e:kt.window.activeTextEditor?.document===e}isVisible(e){let n=e instanceof kt.Uri?e:e.uri;return this.open.has(n.toString())}getTabResources(){let e=new Set;return t.fillTabResources(new Set,e),e}static fillTabResources(e,n){let r=e??new Set;for(let s of kt.window.tabGroups.all)for(let a of s.tabs){let c=a.input,l;c instanceof kt.TabInputText?l=c.uri:c instanceof kt.TabInputTextDiff?l=c.modified:c instanceof kt.TabInputCustom&&(l=c.uri),l!==void 0&&!r.has(l.toString())&&(r.add(l.toString()),n!==void 0&&n.add(l))}}},ar;(function(t){t[t.document=1]="document",t[t.workspace=2]="workspace"})(ar||(ar={}));var fo;(function(t){function e(n){return n instanceof kt.Uri?n.toString():n.uri.toString()}t.asKey=e})(fo||(fo={}));var Jw=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,n,r){let s=e===ar.document?this.documentPullStates:this.workspacePullStates,[a,c,l]=n instanceof kt.Uri?[n.toString(),n,r]:[n.uri.toString(),n.uri,n.version],d=s.get(a);return d===void 0&&(d={document:c,pulledVersion:l,resultId:void 0},s.set(a,d)),d}update(e,n,r,s){let a=e===ar.document?this.documentPullStates:this.workspacePullStates,[c,l,d,f]=n instanceof kt.Uri?[n.toString(),n,r,s]:[n.uri.toString(),n.uri,n.version,r],p=a.get(c);p===void 0?(p={document:l,pulledVersion:d,resultId:f},a.set(c,p)):(p.pulledVersion=d,p.resultId=f)}unTrack(e,n){let r=fo.asKey(n);(e===ar.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,n){let r=fo.asKey(n);return(e===ar.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,n){let r=fo.asKey(n);return(e===ar.document?this.documentPullStates:this.workspacePullStates).get(r)?.resultId}getAllResultIds(){let e=[];for(let[n,r]of this.workspacePullStates)this.documentPullStates.has(n)&&(r=this.documentPullStates.get(n)),r.resultId!==void 0&&e.push({uri:n,value:r.resultId});return e}},Qw=class{constructor(e,n,r){this.client=e,this.tabs=n,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new kt.EventEmitter,this.provider=this.createProvider(),this.diagnostics=kt.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new Jw,this.workspaceErrorCounter=0}knows(e,n){let r=n instanceof kt.Uri?n:n.uri;return this.documentStates.tracks(e,n)||this.openRequests.has(r.toString())}forget(e,n){this.documentStates.unTrack(e,n)}pull(e,n){if(this.isDisposed)return;let r=e instanceof kt.Uri?e:e.uri;this.pullAsync(e).then(()=>{n&&n()},s=>{this.client.error(`Document pull failed for text document ${r.toString()}`,s,!1)})}async pullAsync(e,n){if(this.isDisposed)return;let r=e instanceof kt.Uri,s=r?e:e.uri,a=s.toString();n=r?n:e.version;let c=this.openRequests.get(a),l=r?this.documentStates.track(ar.document,e,n):this.documentStates.track(ar.document,e);if(c===void 0){let d=new kt.CancellationTokenSource;this.openRequests.set(a,{state:Mr.active,document:e,version:n,tokenSource:d});let f,p;try{f=await this.provider.provideDiagnostics(e,l.resultId,d.token)??{kind:ss.DocumentDiagnosticReportKind.full,items:[]}}catch(m){if(m instanceof Vw.LSPCancellationError&&Xn.DiagnosticServerCancellationData.is(m.data)&&m.data.retriggerRequest===!1&&(p={state:Mr.outDated,document:e}),p===void 0&&m instanceof kt.CancellationError)p={state:Mr.reschedule,document:e};else throw m}if(p=p??this.openRequests.get(a),p===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${a}`),this.diagnostics.delete(s);return}if(this.openRequests.delete(a),!this.tabs.isVisible(e)){this.documentStates.unTrack(ar.document,e);return}if(p.state===Mr.outDated)return;f!==void 0&&(f.kind===ss.DocumentDiagnosticReportKind.full&&this.diagnostics.set(s,f.items),l.pulledVersion=n,l.resultId=f.resultId),p.state===Mr.reschedule&&this.pull(e)}else c.state===Mr.active?(c.tokenSource.cancel(),this.openRequests.set(a,{state:Mr.reschedule,document:c.document})):c.state===Mr.outDated&&this.openRequests.set(a,{state:Mr.reschedule,document:c.document})}forgetDocument(e){let n=e instanceof kt.Uri?e:e.uri,r=n.toString(),s=this.openRequests.get(r);this.options.workspaceDiagnostics?s!==void 0?this.openRequests.set(r,{state:Mr.reschedule,document:e}):this.pull(e,()=>{this.forget(ar.document,e)}):(s!==void 0&&(s.state===Mr.active&&s.tokenSource.cancel(),this.openRequests.set(r,{state:Mr.outDated,document:e})),this.diagnostics.delete(n),this.forget(ar.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Xn.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof Vw.LSPCancellationError)&&!Xn.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Xn.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new kt.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(n=>({uri:this.client.protocol2CodeConverter.asUri(n.uri),value:n.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,n=>{if(!(!n||this.isDisposed))for(let r of n.items)r.kind===ss.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(ar.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(ar.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(n,r,s)=>{let a=(l,d,f)=>{let p={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(l instanceof kt.Uri?l:l.uri)},previousResultId:d};return this.isDisposed===!0||!this.client.isRunning()?{kind:ss.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(Xn.DocumentDiagnosticRequest.type,p,f).then(async m=>m==null||this.isDisposed||f.isCancellationRequested?{kind:ss.DocumentDiagnosticReportKind.full,items:[]}:m.kind===Xn.DocumentDiagnosticReportKind.Full?{kind:ss.DocumentDiagnosticReportKind.full,resultId:m.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(m.items,f)}:{kind:ss.DocumentDiagnosticReportKind.unChanged,resultId:m.resultId},m=>this.client.handleFailedRequest(Xn.DocumentDiagnosticRequest.type,f,m,{kind:ss.DocumentDiagnosticReportKind.full,items:[]}))},c=this.client.middleware;return c.provideDiagnostics?c.provideDiagnostics(n,r,s,a):a(n,r,s)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(n,r,s)=>{let a=async f=>f.kind===Xn.DocumentDiagnosticReportKind.Full?{kind:ss.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(f.uri),resultId:f.resultId,version:f.version,items:await this.client.protocol2CodeConverter.asDiagnostics(f.items,r)}:{kind:ss.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(f.uri),resultId:f.resultId,version:f.version},c=f=>{let p=[];for(let m of f)p.push({uri:this.client.code2ProtocolConverter.asUri(m.uri),value:m.value});return p},l=(f,p)=>{let m=(0,tH.generateUuid)(),g=this.client.onProgress(Xn.WorkspaceDiagnosticRequest.partialResult,m,async v=>{if(v==null){s(null);return}let x={items:[]};for(let b of v.items)try{x.items.push(await a(b))}catch(S){this.client.error("Converting workspace diagnostics failed.",S)}s(x)}),w={identifier:this.options.identifier,previousResultIds:c(f),partialResultToken:m};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(Xn.WorkspaceDiagnosticRequest.type,w,p).then(async v=>{if(p.isCancellationRequested)return{items:[]};let x={items:[]};for(let b of v.items)x.items.push(await a(b));return g.dispose(),s(x),{items:[]}},v=>(g.dispose(),this.client.handleFailedRequest(Xn.DocumentDiagnosticRequest.type,p,v,{items:[]})))},d=this.client.middleware;return d.provideWorkspaceDiagnostics?d.provideWorkspaceDiagnostics(n,r,s,l):l(n,r,s)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(let[e,n]of this.openRequests)n.state===Mr.active&&n.tokenSource.cancel(),this.openRequests.set(e,{state:Mr.outDated,document:n.document});this.diagnostics.dispose()}},eb=class{constructor(e){this.diagnosticRequestor=e,this.documents=new Xn.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let n=fo.asKey(e);this.documents.has(n)||(this.documents.set(n,e,Xn.Touch.Last),this.trigger())}remove(e){let n=fo.asKey(e);this.documents.delete(n),this.documents.size===0?this.stop():n===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Xn.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let n=fo.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(n,e,Xn.Touch.Last),n===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?fo.asKey(this.endDocument):void 0}},tb=class{constructor(e,n,r){let s=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},a=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),c=[],l=v=>{let x=r.documentSelector;if(s.match!==void 0)return s.match(x,v);for(let b of x)if(Xn.TextDocumentFilter.is(b)){if(typeof b=="string"||b.language!==void 0&&b.language!=="*"||b.scheme!==void 0&&b.scheme!=="*"&&b.scheme!==v.scheme)return!1;if(b.pattern!==void 0){let S=new eH.Minimatch(b.pattern,{noext:!0});if(!S.makeRe()||!S.match(v.fsPath))return!1}}return!0},d=v=>v instanceof kt.Uri?l(v):kt.languages.match(a,v)>0&&n.isVisible(v),f=v=>v instanceof kt.Uri?this.activeTextDocument?.uri.toString()===v.toString():this.activeTextDocument===v;this.diagnosticRequestor=new Qw(e,n,r),this.backgroundScheduler=new eb(this.diagnosticRequestor);let p=v=>{!d(v)||!r.interFileDependencies||f(v)||this.backgroundScheduler.add(v)};this.activeTextDocument=kt.window.activeTextEditor?.document,kt.window.onDidChangeActiveTextEditor(v=>{let x=this.activeTextDocument;this.activeTextDocument=v?.document,x!==void 0&&p(x),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let m=e.getFeature(Xn.DidOpenTextDocumentNotification.method);c.push(m.onNotificationSent(v=>{let x=v.textDocument;this.diagnosticRequestor.knows(ar.document,x)||d(x)&&this.diagnosticRequestor.pull(x,()=>{p(x)})})),c.push(n.onOpen(v=>{for(let x of v){if(this.diagnosticRequestor.knows(ar.document,x))continue;let b=x.toString(),S;for(let k of kt.workspace.textDocuments)if(b===k.uri.toString()){S=k;break}S!==void 0&&d(S)&&this.diagnosticRequestor.pull(S,()=>{p(S)})}}));let g=new Set;for(let v of kt.workspace.textDocuments)d(v)&&(this.diagnosticRequestor.pull(v,()=>{p(v)}),g.add(v.uri.toString()));if(s.onTabs===!0)for(let v of n.getTabResources())!g.has(v.toString())&&d(v)&&this.diagnosticRequestor.pull(v,()=>{p(v)});if(s.onChange===!0){let v=e.getFeature(Xn.DidChangeTextDocumentNotification.method);c.push(v.onNotificationSent(async x=>{let b=x.textDocument;(s.filter===void 0||!s.filter(b,hh.onType))&&this.diagnosticRequestor.knows(ar.document,b)&&this.diagnosticRequestor.pull(b,()=>{this.backgroundScheduler.trigger()})}))}if(s.onSave===!0){let v=e.getFeature(Xn.DidSaveTextDocumentNotification.method);c.push(v.onNotificationSent(x=>{let b=x.textDocument;(s.filter===void 0||!s.filter(b,hh.onSave))&&this.diagnosticRequestor.knows(ar.document,b)&&this.diagnosticRequestor.pull(x.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let w=e.getFeature(Xn.DidCloseTextDocumentNotification.method);c.push(w.onNotificationSent(v=>{this.cleanUpDocument(v.textDocument)})),n.onClose(v=>{for(let x of v)this.cleanUpDocument(x)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let v of kt.workspace.textDocuments)d(v)&&this.diagnosticRequestor.pull(v)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=kt.Disposable.from(...c,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(ar.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},nb=class extends Vw.TextDocumentLanguageFeature{constructor(e){super(e,Xn.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let n=ph(ph(e,"textDocument"),"diagnostic");n.dynamicRegistration=!0,n.relatedDocumentSupport=!1,ph(ph(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,n){this._client.onRequest(Xn.DiagnosticRefreshRequest.type,async()=>{for(let c of this.getAllProviders())c.onDidChangeDiagnosticsEmitter.fire()});let[s,a]=this.getRegistration(n,e.diagnosticProvider);!s||!a||this.register({id:s,registerOptions:a})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new Yw);let n=new tb(this._client,this.tabs,e);return[n.disposable,n]}};Jo.DiagnosticFeature=nb});var r$=oe(vh=>{"use strict";Object.defineProperty(vh,"__esModule",{value:!0});vh.NotebookDocumentSyncFeature=void 0;var qr=require("vscode"),nH=fh(),po=it(),rH=Pn(),t$=es();function n$(t,e){return t[e]===void 0&&(t[e]={}),t[e]}var Qc;(function(t){let e;(function(n){function r(g,w){return{version:g.version,uri:w.asUri(g.uri)}}n.asVersionedNotebookDocumentIdentifier=r;function s(g,w,v){let x=po.NotebookDocument.create(v.asUri(g.uri),g.notebookType,g.version,a(w,v));return Object.keys(g.metadata).length>0&&(x.metadata=c(g.metadata)),x}n.asNotebookDocument=s;function a(g,w){return g.map(v=>l(v,w))}n.asNotebookCells=a;function c(g){return f(new Set,g)}n.asMetadata=c;function l(g,w){let v=po.NotebookCell.create(d(g.kind),w.asUri(g.document.uri));return Object.keys(g.metadata).length>0&&(v.metadata=c(g.metadata)),g.executionSummary!==void 0&&t$.number(g.executionSummary.executionOrder)&&t$.boolean(g.executionSummary.success)&&(v.executionSummary={executionOrder:g.executionSummary.executionOrder,success:g.executionSummary.success}),v}n.asNotebookCell=l;function d(g){switch(g){case qr.NotebookCellKind.Markup:return po.NotebookCellKind.Markup;case qr.NotebookCellKind.Code:return po.NotebookCellKind.Code}}function f(g,w){if(g.has(w))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(w)){let v=[];for(let x of w)if(x!==null&&typeof x=="object"||Array.isArray(x))v.push(f(g,x));else{if(x instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");v.push(x)}return v}else{let v=Object.keys(w),x=Object.create(null);for(let b of v){let S=w[b];if(S!==null&&typeof S=="object"||Array.isArray(S))x[b]=f(g,S);else{if(S instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");x[b]=S}}return x}}function p(g,w){let v=w.asChangeTextDocumentParams(g,g.document.uri,g.document.version);return{document:v.textDocument,changes:v.contentChanges}}n.asTextContentChange=p;function m(g,w){let v=Object.create(null);if(g.metadata&&(v.metadata=t.c2p.asMetadata(g.metadata)),g.cells!==void 0){let x=Object.create(null),b=g.cells;b.structure&&(x.structure={array:{start:b.structure.array.start,deleteCount:b.structure.array.deleteCount,cells:b.structure.array.cells!==void 0?b.structure.array.cells.map(S=>t.c2p.asNotebookCell(S,w)):void 0},didOpen:b.structure.didOpen!==void 0?b.structure.didOpen.map(S=>w.asOpenTextDocumentParams(S.document).textDocument):void 0,didClose:b.structure.didClose!==void 0?b.structure.didClose.map(S=>w.asCloseTextDocumentParams(S.document).textDocument):void 0}),b.data!==void 0&&(x.data=b.data.map(S=>t.c2p.asNotebookCell(S,w))),b.textContent!==void 0&&(x.textContent=b.textContent.map(S=>t.c2p.asTextContentChange(S,w))),Object.keys(x).length>0&&(v.cells=x)}return v}n.asNotebookDocumentChangeEvent=m})(e=t.c2p||(t.c2p={}))})(Qc||(Qc={}));var ib;(function(t){function e(l,d,f){let p=l.length,m=d.length,g=0;for(;g<m&&g<p&&n(l[g],d[g],f);)g++;if(g<m&&g<p){let w=p-1,v=m-1;for(;w>=0&&v>=0&&n(l[w],d[v],f);)w--,v--;let x=w+1-g,b=g===v+1?void 0:d.slice(g,v+1);return b!==void 0?{start:g,deleteCount:x,cells:b}:{start:g,deleteCount:x}}else return g<m?{start:g,deleteCount:0,cells:d.slice(g)}:g<p?{start:g,deleteCount:p-g}:void 0}t.computeDiff=e;function n(l,d,f=!0){return l.kind!==d.kind||l.document.uri.toString()!==d.document.uri.toString()||l.document.languageId!==d.document.languageId||!r(l.executionSummary,d.executionSummary)?!1:!f||f&&a(l.metadata,d.metadata)}function r(l,d){return l===d?!0:l===void 0||d===void 0?!1:l.executionOrder===d.executionOrder&&l.success===d.success&&s(l.timing,d.timing)}function s(l,d){return l===d?!0:l===void 0||d===void 0?!1:l.startTime===d.startTime&&l.endTime===d.endTime}function a(l,d){if(l===d)return!0;if(l==null||d===null||d===void 0||typeof l!=typeof d||typeof l!="object")return!1;let f=Array.isArray(l),p=Array.isArray(d);if(f!==p)return!1;if(f&&p){if(l.length!==d.length)return!1;for(let m=0;m<l.length;m++)if(!a(l[m],d[m]))return!1}if(c(l)&&c(d)){let m=Object.keys(l),g=Object.keys(d);if(m.length!==g.length||(m.sort(),g.sort(),!a(m,g)))return!1;for(let w=0;w<m.length;w++){let v=m[w];if(!a(l[v],d[v]))return!1}return!0}return!1}function c(l){return l!==null&&typeof l=="object"}t.isObjectLiteral=c})(ib||(ib={}));var sb;(function(t){function e(n,r){if(typeof n=="string")return n==="*"||r.notebookType===n;if(n.notebookType!==void 0&&n.notebookType!=="*"&&r.notebookType!==n.notebookType)return!1;let s=r.uri;if(n.scheme!==void 0&&n.scheme!=="*"&&s.scheme!==n.scheme)return!1;if(n.pattern!==void 0){let a=new nH.Minimatch(n.pattern,{noext:!0});if(!a.makeRe()||!a.match(s.fsPath))return!1}return!0}t.matchNotebook=e})(sb||(sb={}));var mh;(function(t){function e(r){let s=r.notebookSelector,a=[];for(let c of s){let l=(typeof c.notebook=="string"?c.notebook:c.notebook?.notebookType)??"*",d=typeof c.notebook=="string"?void 0:c.notebook?.scheme,f=typeof c.notebook=="string"?void 0:c.notebook?.pattern;if(c.cells!==void 0)for(let p of c.cells)a.push(n(l,d,f,p.language));else a.push(n(l,d,f,void 0))}return a}t.asDocumentSelector=e;function n(r,s,a,c){return s===void 0&&a===void 0?{notebook:r,language:c}:{notebook:{notebookType:r,scheme:s,pattern:a},language:c}}})(mh||(mh={}));var gh;(function(t){function e(n){return{cells:n,uris:new Set(n.map(r=>r.document.uri.toString()))}}t.create=e})(gh||(gh={}));var el=class{constructor(e,n){this.client=e,this.options=n,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(mh.asDocumentSelector(n)),qr.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of qr.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);qr.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&qr.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),qr.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(let e of qr.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return qr.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,n){if(qr.languages.match(this.selector,n.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),s=this.cellMatches(e,n);if(r!==void 0){let a=r.uris.has(n.document.uri.toString());if(s&&a||!s&&!a)return;if(s){let c=this.getMatchingCells(e);if(c!==void 0){let l=this.asNotebookDocumentChangeEvent(e,void 0,r,c);l!==void 0&&this.doSendChange(l,c).catch(()=>{})}}}else s&&this.doSendOpen(e,[n]).catch(()=>{})}didChangeNotebookCellTextDocument(e,n){qr.languages.match(this.selector,n.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[n]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,n){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let s=n.document.uri,a=r.cells.findIndex(c=>c.document.uri.toString()===s.toString());if(a!==-1)if(a===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let c=r.cells.slice(),l=c.splice(a,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:a,deleteCount:1},didClose:l}}},c).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,n=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(n!==void 0){let s=this.asNotebookDocumentChangeEvent(e,void 0,r,n);s!==void 0&&this.doSendChange(s,n).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(n===void 0)return;this.doSendOpen(e,n).catch(()=>{})}}didChangeNotebookDocument(e){let n=e.notebook,r=this.notebookSyncInfo.get(n.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let s=this.getMatchingCells(n);if(s===void 0)return;this.didOpen(n,s,r)}else{let s=this.getMatchingCells(n);if(s===void 0){this.didClose(n,r);return}let a=this.asNotebookDocumentChangeEvent(e.notebook,e,r,s);a!==void 0&&this.doSendChange(a,s).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,n=this.notebookSyncInfo.get(e.uri.toString())){if(n===void 0)return;let r=e.getCells().filter(s=>n.uris.has(s.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let n=this.getMatchingCells(e);if(n!==void 0)return this.doSendOpen(e,n)}async doSendOpen(e,n){let r=async(a,c)=>{let l=Qc.c2p.asNotebookDocument(a,c,this.client.code2ProtocolConverter),d=c.map(f=>this.client.code2ProtocolConverter.asTextDocumentItem(f.document));try{await this.client.sendNotification(po.DidOpenNotebookDocumentNotification.type,{notebookDocument:l,cellTextDocuments:d})}catch(f){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",f),f}},s=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),gh.create(n)),s?.didOpen!==void 0?s.didOpen(e,n,r):r(e,n)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,n=this.getMatchingCells(e.notebook)){let r=async a=>{try{await this.client.sendNotification(po.DidChangeNotebookDocumentNotification.type,{notebookDocument:Qc.c2p.asVersionedNotebookDocumentIdentifier(a.notebook,this.client.code2ProtocolConverter),change:Qc.c2p.asNotebookDocumentChangeEvent(a,this.client.code2ProtocolConverter)})}catch(c){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",c),c}},s=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),gh.create(n??[])),s?.didChange!==void 0?s?.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){let n=async s=>{try{await this.client.sendNotification(po.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)}})}catch(a){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",a),a}},r=this.client.middleware?.notebooks;return r?.didSave!==void 0?r.didSave(e,n):n(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,n){let r=async(a,c)=>{try{await this.client.sendNotification(po.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(a.uri)},cellTextDocuments:c.map(l=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(l.document))})}catch(l){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",l),l}},s=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),s?.didClose!==void 0?s.didClose(e,n,r):r(e,n)}asNotebookDocumentChangeEvent(e,n,r,s){if(n!==void 0&&n.notebook!==e)throw new Error("Notebook must be identical");let a={notebook:e};n?.metadata!==void 0&&(a.metadata=Qc.c2p.asMetadata(n.metadata));let c;if(n?.cellChanges!==void 0&&n.cellChanges.length>0){let l=[];c=new Set(s.map(d=>d.document.uri.toString()));for(let d of n.cellChanges)c.has(d.cell.document.uri.toString())&&(d.executionSummary!==void 0||d.metadata!==void 0)&&l.push(d.cell);l.length>0&&(a.cells=a.cells??{},a.cells.data=l)}if((n?.contentChanges!==void 0&&n.contentChanges.length>0||n===void 0)&&r!==void 0&&s!==void 0){let l=r.cells,d=s,f=ib.computeDiff(l,d,!1),p,m;if(f!==void 0){p=f.cells===void 0?new Map:new Map(f.cells.map(v=>[v.document.uri.toString(),v])),m=f.deleteCount===0?new Map:new Map(l.slice(f.start,f.start+f.deleteCount).map(v=>[v.document.uri.toString(),v]));for(let v of Array.from(m.keys()))p.has(v)&&(m.delete(v),p.delete(v));a.cells=a.cells??{};let g=[],w=[];if(p.size>0||m.size>0){for(let v of p.values())g.push(v);for(let v of m.values())w.push(v)}a.cells.structure={array:f,didOpen:g,didClose:w}}}return Object.keys(a).length>1?a:void 0}getMatchingCells(e,n=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0||sb.matchNotebook(r.notebook,e)){let s=this.filterCells(e,n,r.cells);return s.length===0?void 0:s}}}cellMatches(e,n){let r=this.getMatchingCells(e,[n]);return r!==void 0&&r[0]===n}filterCells(e,n,r){let s=r!==void 0?n.filter(a=>{let c=a.document.languageId;return r.some((l=>l.language==="*"||c===l.language))}):n;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,s):s}},_h=class t{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=po.NotebookDocumentSyncRegistrationType.type,qr.workspace.onDidOpenTextDocument(n=>{if(n.uri.scheme!==t.CellScheme)return;let[r,s]=this.findNotebookDocumentAndCell(n);if(!(r===void 0||s===void 0))for(let a of this.registrations.values())a instanceof el&&a.didOpenNotebookCellTextDocument(r,s)}),qr.workspace.onDidChangeTextDocument(n=>{if(n.contentChanges.length===0)return;let r=n.document;if(r.uri.scheme!==t.CellScheme)return;let[s]=this.findNotebookDocumentAndCell(r);if(s!==void 0)for(let a of this.registrations.values())a instanceof el&&a.didChangeNotebookCellTextDocument(s,n)}),qr.workspace.onDidCloseTextDocument(n=>{if(n.uri.scheme!==t.CellScheme)return;let[r,s]=this.findNotebookDocumentAndCell(n);if(!(r===void 0||s===void 0))for(let a of this.registrations.values())a instanceof el&&a.didCloseNotebookCellTextDocument(r,s)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let n=e.getState();if(n.kind==="document"&&n.registrations===!0&&n.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let n=n$(n$(e,"notebookDocument"),"synchronization");n.dynamicRegistration=!0,n.executionSummarySupport=!0}preInitialize(e){let n=e.notebookDocumentSync;n!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(mh.asDocumentSelector(n)))}initialize(e){let n=e.notebookDocumentSync;if(n===void 0)return;let r=n.id??rH.generateUuid();this.register({id:r,registerOptions:n})}register(e){let n=new el(this.client,e.registerOptions);this.registrations.set(e.id,n)}unregister(e){let n=this.registrations.get(e);n&&n.dispose()}clear(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==t.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&qr.languages.match(this.dedicatedChannel,e)>0)return!0;for(let n of this.registrations.values())if(n.handles(e))return!0;return!1}getProvider(e){for(let n of this.registrations.values())if(n.handles(e.document))return n}findNotebookDocumentAndCell(e){let n=e.uri.toString();for(let r of qr.workspace.notebookDocuments)for(let s of r.getCells())if(s.document.uri.toString()===n)return[r,s];return[void 0,void 0]}};vh.NotebookDocumentSyncFeature=_h;_h.CellScheme="vscode-notebook-cell"});var s$=oe(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.SyncConfigurationFeature=Qo.toJSONObject=Qo.ConfigurationFeature=void 0;var tl=require("vscode"),$u=it(),iH=es(),sH=Pn(),i$=Ft(),ob=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest($u.ConfigurationRequest.type,(n,r)=>{let s=c=>{let l=[];for(let d of c.items){let f=d.scopeUri!==void 0&&d.scopeUri!==null?this._client.protocol2CodeConverter.asUri(d.scopeUri):void 0;l.push(this.getConfiguration(f,d.section!==null?d.section:void 0))}return l},a=e.middleware.workspace;return a&&a.configuration?a.configuration(n,r,s):s(n,r)})}getConfiguration(e,n){let r=null;if(n){let s=n.lastIndexOf(".");if(s===-1)r=Fa(tl.workspace.getConfiguration(void 0,e).get(n));else{let a=tl.workspace.getConfiguration(n.substr(0,s),e);a&&(r=Fa(a.get(n.substr(s+1))))}}else{let s=tl.workspace.getConfiguration(void 0,e);r={};for(let a of Object.keys(s))s.has(a)&&(r[a]=Fa(s.get(a)))}return r===void 0&&(r=null),r}clear(){}};Qo.ConfigurationFeature=ob;function Fa(t){if(t){if(Array.isArray(t))return t.map(Fa);if(typeof t=="object"){let e=Object.create(null);for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Fa(t[n]));return e}}return t}Qo.toJSONObject=Fa;var ab=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return $u.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,i$.ensure)((0,i$.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:sH.generateUuid(),registerOptions:{section:e}})}register(e){let n=tl.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,n),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let n=this._listeners.get(e);n&&(this._listeners.delete(e),n.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,n){if(this.isCleared)return;let r;if(iH.string(e)?r=[e]:r=e,r!==void 0&&n!==void 0&&!r.some(l=>n.affectsConfiguration(l)))return;let s=async c=>c===void 0?this._client.sendNotification($u.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification($u.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(c)}),a=this._client.middleware.workspace?.didChangeConfiguration;(a?a(r,s):s(r)).catch(c=>{this._client.error(`Sending notification ${$u.DidChangeConfigurationNotification.type.method} failed`,c)})}extractSettingsInformation(e){function n(a,c){let l=a;for(let d=0;d<c.length-1;d++){let f=l[c[d]];f||(f=Object.create(null),l[c[d]]=f),l=f}return l}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,s=Object.create(null);for(let a=0;a<e.length;a++){let c=e[a],l=c.indexOf("."),d=null;if(l>=0?d=tl.workspace.getConfiguration(c.substr(0,l),r).get(c.substr(l+1)):d=tl.workspace.getConfiguration(void 0,r).get(c),d){let f=e[a].split(".");n(s,f)[f[f.length-1]]=Fa(d)}}return s}};Qo.SyncConfigurationFeature=ab});var o$=oe(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.DidSaveTextDocumentFeature=hi.WillSaveWaitUntilFeature=hi.WillSaveFeature=hi.DidChangeTextDocumentFeature=hi.DidCloseTextDocumentFeature=hi.DidOpenTextDocumentFeature=void 0;var Ni=require("vscode"),cn=it(),Mn=Ft(),nl=Pn(),cb=class extends Mn.TextDocumentEventFeature{constructor(e,n){super(e,Ni.workspace.onDidOpenTextDocument,cn.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,Mn.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=n}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Mn.ensure)((0,Mn.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,n){let r=e.resolvedTextDocumentSync;n&&r&&r.openClose&&this.register({id:nl.generateUuid(),registerOptions:{documentSelector:n}})}get registrationType(){return cn.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let n=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);Ni.workspace.textDocuments.forEach(r=>{let s=r.uri.toString();if(!this._syncedDocuments.has(s)&&Ni.languages.match(n,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let a=this._client.middleware,c=l=>this._client.sendNotification(this._type,this._createParams(l));(a.didOpen?a.didOpen(r,c):c(r)).catch(l=>{this._client.error(`Sending document notification ${this._type.method} failed`,l)}),this._syncedDocuments.set(s,r)}})}getTextDocument(e){return e}notificationSent(e,n,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,n,r)}};hi.DidOpenTextDocumentFeature=cb;var lb=class extends Mn.TextDocumentEventFeature{constructor(e,n,r){super(e,Ni.workspace.onDidCloseTextDocument,cn.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,s=>e.code2ProtocolConverter.asCloseTextDocumentParams(s),s=>s,Mn.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=n,this._pendingTextDocumentChanges=r}get registrationType(){return cn.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Mn.ensure)((0,Mn.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,n){let r=e.resolvedTextDocumentSync;n&&r&&r.openClose&&this.register({id:nl.generateUuid(),registerOptions:{documentSelector:n}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,n,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,n,r)}unregister(e){let n=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(s=>{if(Ni.languages.match(n,s)>0&&!this._selectorFilter(r,s)&&!this._client.hasDedicatedTextSynchronizationFeature(s)){let a=this._client.middleware,c=l=>this._client.sendNotification(this._type,this._createParams(l));this._syncedDocuments.delete(s.uri.toString()),(a.didClose?a.didClose(s,c):c(s)).catch(l=>{this._client.error(`Sending document notification ${this._type.method} failed`,l)})}})}};hi.DidCloseTextDocumentFeature=lb;var ub=class extends Mn.DynamicDocumentFeature{constructor(e,n){super(e),this._changeData=new Map,this._onNotificationSent=new Ni.EventEmitter,this._onPendingChangeAdded=new Ni.EventEmitter,this._pendingTextDocumentChanges=n,this._syncKind=cn.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return cn.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Mn.ensure)((0,Mn.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,n){let r=e.resolvedTextDocumentSync;n&&r&&r.change!==void 0&&r.change!==cn.TextDocumentSyncKind.None&&this.register({id:nl.generateUuid(),registerOptions:Object.assign({},{documentSelector:n},{syncKind:r.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=Ni.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let n=e.document.uri,r=e.document.version,s=[];for(let a of this._changeData.values())if(Ni.languages.match(a.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let c=this._client.middleware;if(a.syncKind===cn.TextDocumentSyncKind.Incremental){let l=async d=>{let f=this._client.code2ProtocolConverter.asChangeTextDocumentParams(d,n,r);await this._client.sendNotification(cn.DidChangeTextDocumentNotification.type,f),this.notificationSent(d.document,cn.DidChangeTextDocumentNotification.type,f)};s.push(c.didChange?c.didChange(e,d=>l(d)):l(e))}else if(a.syncKind===cn.TextDocumentSyncKind.Full){let l=async d=>{let f=d.document.uri.toString();this._pendingTextDocumentChanges.set(f,d.document),this._onPendingChangeAdded.fire()};s.push(c.didChange?c.didChange(e,d=>l(d)):l(e))}}return Promise.all(s).then(void 0,a=>{throw this._client.error(`Sending document notification ${cn.DidChangeTextDocumentNotification.type.method} failed`,a),a})}notificationSent(e,n,r){this._onNotificationSent.fire({textDocument:e,type:n,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=cn.TextDocumentSyncKind.None;else{this._syncKind=cn.TextDocumentSyncKind.None;for(let n of this._changeData.values())if(this.updateSyncKind(n.syncKind),this._syncKind===cn.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=cn.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let n;if(e.size===0)n=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{n=[];for(let r of this._pendingTextDocumentChanges)e.has(r[0])||(n.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return n}getProvider(e){for(let n of this._changeData.values())if(Ni.languages.match(n.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==cn.TextDocumentSyncKind.Full)switch(e){case cn.TextDocumentSyncKind.Full:this._syncKind=e;break;case cn.TextDocumentSyncKind.Incremental:this._syncKind===cn.TextDocumentSyncKind.None&&(this._syncKind=cn.TextDocumentSyncKind.Incremental);break}}};hi.DidChangeTextDocumentFeature=ub;var db=class extends Mn.TextDocumentEventFeature{constructor(e){super(e,Ni.workspace.onWillSaveTextDocument,cn.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,n=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(n),n=>n.document,(n,r)=>Mn.TextDocumentEventFeature.textDocumentFilter(n,r.document))}get registrationType(){return cn.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let n=(0,Mn.ensure)((0,Mn.ensure)(e,"textDocument"),"synchronization");n.willSave=!0}initialize(e,n){let r=e.resolvedTextDocumentSync;n&&r&&r.willSave&&this.register({id:nl.generateUuid(),registerOptions:{documentSelector:n}})}getTextDocument(e){return e.document}};hi.WillSaveFeature=db;var fb=class extends Mn.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return cn.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let n=(0,Mn.ensure)((0,Mn.ensure)(e,"textDocument"),"synchronization");n.willSaveWaitUntil=!0}initialize(e,n){let r=e.resolvedTextDocumentSync;n&&r&&r.willSaveWaitUntil&&this.register({id:nl.generateUuid(),registerOptions:{documentSelector:n}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=Ni.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Mn.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let n=this._client.middleware,r=s=>this._client.sendRequest(cn.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(s)).then(async a=>{let c=await this._client.protocol2CodeConverter.asTextEdits(a);return c===void 0?[]:c});e.waitUntil(n.willSaveWaitUntil?n.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};hi.WillSaveWaitUntilFeature=fb;var pb=class extends Mn.TextDocumentEventFeature{constructor(e){super(e,Ni.workspace.onDidSaveTextDocument,cn.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,n=>e.code2ProtocolConverter.asSaveTextDocumentParams(n,this._includeText),n=>n,Mn.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return cn.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Mn.ensure)((0,Mn.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,n){let r=e.resolvedTextDocumentSync;if(n&&r&&r.save){let s=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:nl.generateUuid(),registerOptions:Object.assign({},{documentSelector:n},s)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};hi.DidSaveTextDocumentFeature=pb});var a$=oe(yh=>{"use strict";Object.defineProperty(yh,"__esModule",{value:!0});yh.CompletionItemFeature=void 0;var oH=require("vscode"),Pt=it(),hb=Ft(),aH=Pn(),cH=[Pt.CompletionItemKind.Text,Pt.CompletionItemKind.Method,Pt.CompletionItemKind.Function,Pt.CompletionItemKind.Constructor,Pt.CompletionItemKind.Field,Pt.CompletionItemKind.Variable,Pt.CompletionItemKind.Class,Pt.CompletionItemKind.Interface,Pt.CompletionItemKind.Module,Pt.CompletionItemKind.Property,Pt.CompletionItemKind.Unit,Pt.CompletionItemKind.Value,Pt.CompletionItemKind.Enum,Pt.CompletionItemKind.Keyword,Pt.CompletionItemKind.Snippet,Pt.CompletionItemKind.Color,Pt.CompletionItemKind.File,Pt.CompletionItemKind.Reference,Pt.CompletionItemKind.Folder,Pt.CompletionItemKind.EnumMember,Pt.CompletionItemKind.Constant,Pt.CompletionItemKind.Struct,Pt.CompletionItemKind.Event,Pt.CompletionItemKind.Operator,Pt.CompletionItemKind.TypeParameter],mb=class extends hb.TextDocumentLanguageFeature{constructor(e){super(e,Pt.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let n=(0,hb.ensure)((0,hb.ensure)(e,"textDocument"),"completion");n.dynamicRegistration=!0,n.contextSupport=!0,n.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[Pt.MarkupKind.Markdown,Pt.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[Pt.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[Pt.InsertTextMode.asIs,Pt.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},n.insertTextMode=Pt.InsertTextMode.adjustIndentation,n.completionItemKind={valueSet:cH},n.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,n){let r=this.getRegistrationOptions(n,e.completionProvider);r&&this.register({id:aH.generateUuid(),registerOptions:r})}registerLanguageProvider(e,n){this.labelDetailsSupport.set(n,!!e.completionItem?.labelDetailsSupport);let r=e.triggerCharacters??[],s=e.allCommitCharacters,a=e.documentSelector,c={provideCompletionItems:(l,d,f,p)=>{let m=this._client,g=this._client.middleware,w=(v,x,b,S)=>m.sendRequest(Pt.CompletionRequest.type,m.code2ProtocolConverter.asCompletionParams(v,x,b),S).then(k=>S.isCancellationRequested?null:m.protocol2CodeConverter.asCompletionResult(k,s,S),k=>m.handleFailedRequest(Pt.CompletionRequest.type,S,k,null));return g.provideCompletionItem?g.provideCompletionItem(l,d,p,f,w):w(l,d,p,f)},resolveCompletionItem:e.resolveProvider?(l,d)=>{let f=this._client,p=this._client.middleware,m=(g,w)=>f.sendRequest(Pt.CompletionResolveRequest.type,f.code2ProtocolConverter.asCompletionItem(g,!!this.labelDetailsSupport.get(n)),w).then(v=>w.isCancellationRequested?null:f.protocol2CodeConverter.asCompletionItem(v),v=>f.handleFailedRequest(Pt.CompletionResolveRequest.type,w,v,g));return p.resolveCompletionItem?p.resolveCompletionItem(l,d,m):m(l,d)}:void 0};return[oH.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(a),c,...r),c]}};yh.CompletionItemFeature=mb});var c$=oe(wh=>{"use strict";Object.defineProperty(wh,"__esModule",{value:!0});wh.HoverFeature=void 0;var lH=require("vscode"),Ou=it(),gb=Ft(),uH=Pn(),_b=class extends gb.TextDocumentLanguageFeature{constructor(e){super(e,Ou.HoverRequest.type)}fillClientCapabilities(e){let n=(0,gb.ensure)((0,gb.ensure)(e,"textDocument"),"hover");n.dynamicRegistration=!0,n.contentFormat=[Ou.MarkupKind.Markdown,Ou.MarkupKind.PlainText]}initialize(e,n){let r=this.getRegistrationOptions(n,e.hoverProvider);r&&this.register({id:uH.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideHover:(s,a,c)=>{let l=this._client,d=(p,m,g)=>l.sendRequest(Ou.HoverRequest.type,l.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(w=>g.isCancellationRequested?null:l.protocol2CodeConverter.asHover(w),w=>l.handleFailedRequest(Ou.HoverRequest.type,g,w,null)),f=l.middleware;return f.provideHover?f.provideHover(s,a,c,d):d(s,a,c)}};return[this.registerProvider(n,r),r]}registerProvider(e,n){return lH.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};wh.HoverFeature=_b});var l$=oe(bh=>{"use strict";Object.defineProperty(bh,"__esModule",{value:!0});bh.DefinitionFeature=void 0;var dH=require("vscode"),vb=it(),yb=Ft(),fH=Pn(),wb=class extends yb.TextDocumentLanguageFeature{constructor(e){super(e,vb.DefinitionRequest.type)}fillClientCapabilities(e){let n=(0,yb.ensure)((0,yb.ensure)(e,"textDocument"),"definition");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.definitionProvider);r&&this.register({id:fH.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideDefinition:(s,a,c)=>{let l=this._client,d=(p,m,g)=>l.sendRequest(vb.DefinitionRequest.type,l.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(w=>g.isCancellationRequested?null:l.protocol2CodeConverter.asDefinitionResult(w,g),w=>l.handleFailedRequest(vb.DefinitionRequest.type,g,w,null)),f=l.middleware;return f.provideDefinition?f.provideDefinition(s,a,c,d):d(s,a,c)}};return[this.registerProvider(n,r),r]}registerProvider(e,n){return dH.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};bh.DefinitionFeature=wb});var d$=oe(xh=>{"use strict";Object.defineProperty(xh,"__esModule",{value:!0});xh.SignatureHelpFeature=void 0;var u$=require("vscode"),Fu=it(),bb=Ft(),pH=Pn(),xb=class extends bb.TextDocumentLanguageFeature{constructor(e){super(e,Fu.SignatureHelpRequest.type)}fillClientCapabilities(e){let n=(0,bb.ensure)((0,bb.ensure)(e,"textDocument"),"signatureHelp");n.dynamicRegistration=!0,n.signatureInformation={documentationFormat:[Fu.MarkupKind.Markdown,Fu.MarkupKind.PlainText]},n.signatureInformation.parameterInformation={labelOffsetSupport:!0},n.signatureInformation.activeParameterSupport=!0,n.contextSupport=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.signatureHelpProvider);r&&this.register({id:pH.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n={provideSignatureHelp:(r,s,a,c)=>{let l=this._client,d=(p,m,g,w)=>l.sendRequest(Fu.SignatureHelpRequest.type,l.code2ProtocolConverter.asSignatureHelpParams(p,m,g),w).then(v=>w.isCancellationRequested?null:l.protocol2CodeConverter.asSignatureHelp(v,w),v=>l.handleFailedRequest(Fu.SignatureHelpRequest.type,w,v,null)),f=l.middleware;return f.provideSignatureHelp?f.provideSignatureHelp(r,s,c,a,d):d(r,s,c,a)}};return[this.registerProvider(e,n),n]}registerProvider(e,n){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let s=e.triggerCharacters||[];return u$.languages.registerSignatureHelpProvider(r,n,...s)}else{let s={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return u$.languages.registerSignatureHelpProvider(r,n,s)}}};xh.SignatureHelpFeature=xb});var f$=oe(Th=>{"use strict";Object.defineProperty(Th,"__esModule",{value:!0});Th.DocumentHighlightFeature=void 0;var hH=require("vscode"),Tb=it(),Rb=Ft(),mH=Pn(),Eb=class extends Rb.TextDocumentLanguageFeature{constructor(e){super(e,Tb.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,Rb.ensure)((0,Rb.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.documentHighlightProvider);r&&this.register({id:mH.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideDocumentHighlights:(s,a,c)=>{let l=this._client,d=(p,m,g)=>l.sendRequest(Tb.DocumentHighlightRequest.type,l.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(w=>g.isCancellationRequested?null:l.protocol2CodeConverter.asDocumentHighlights(w,g),w=>l.handleFailedRequest(Tb.DocumentHighlightRequest.type,g,w,null)),f=l.middleware;return f.provideDocumentHighlights?f.provideDocumentHighlights(s,a,c,d):d(s,a,c)}};return[hH.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r),r]}};Th.DocumentHighlightFeature=Eb});var kb=oe(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});Hs.DocumentSymbolFeature=Hs.SupportedSymbolTags=Hs.SupportedSymbolKinds=void 0;var gH=require("vscode"),Bt=it(),Sb=Ft(),_H=Pn();Hs.SupportedSymbolKinds=[Bt.SymbolKind.File,Bt.SymbolKind.Module,Bt.SymbolKind.Namespace,Bt.SymbolKind.Package,Bt.SymbolKind.Class,Bt.SymbolKind.Method,Bt.SymbolKind.Property,Bt.SymbolKind.Field,Bt.SymbolKind.Constructor,Bt.SymbolKind.Enum,Bt.SymbolKind.Interface,Bt.SymbolKind.Function,Bt.SymbolKind.Variable,Bt.SymbolKind.Constant,Bt.SymbolKind.String,Bt.SymbolKind.Number,Bt.SymbolKind.Boolean,Bt.SymbolKind.Array,Bt.SymbolKind.Object,Bt.SymbolKind.Key,Bt.SymbolKind.Null,Bt.SymbolKind.EnumMember,Bt.SymbolKind.Struct,Bt.SymbolKind.Event,Bt.SymbolKind.Operator,Bt.SymbolKind.TypeParameter];Hs.SupportedSymbolTags=[Bt.SymbolTag.Deprecated];var Cb=class extends Sb.TextDocumentLanguageFeature{constructor(e){super(e,Bt.DocumentSymbolRequest.type)}fillClientCapabilities(e){let n=(0,Sb.ensure)((0,Sb.ensure)(e,"textDocument"),"documentSymbol");n.dynamicRegistration=!0,n.symbolKind={valueSet:Hs.SupportedSymbolKinds},n.hierarchicalDocumentSymbolSupport=!0,n.tagSupport={valueSet:Hs.SupportedSymbolTags},n.labelSupport=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.documentSymbolProvider);r&&this.register({id:_H.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideDocumentSymbols:(a,c)=>{let l=this._client,d=async(p,m)=>{try{let g=await l.sendRequest(Bt.DocumentSymbolRequest.type,l.code2ProtocolConverter.asDocumentSymbolParams(p),m);if(m.isCancellationRequested||g===void 0||g===null)return null;if(g.length===0)return[];{let w=g[0];return Bt.DocumentSymbol.is(w)?await l.protocol2CodeConverter.asDocumentSymbols(g,m):await l.protocol2CodeConverter.asSymbolInformations(g,m)}}catch(g){return l.handleFailedRequest(Bt.DocumentSymbolRequest.type,m,g,null)}},f=l.middleware;return f.provideDocumentSymbols?f.provideDocumentSymbols(a,c,d):d(a,c)}},s=e.label!==void 0?{label:e.label}:void 0;return[gH.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r,s),r]}};Hs.DocumentSymbolFeature=Cb});var h$=oe(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.WorkspaceSymbolFeature=void 0;var vH=require("vscode"),Nu=it(),Pb=Ft(),p$=kb(),yH=Pn(),Ab=class extends Pb.WorkspaceFeature{constructor(e){super(e,Nu.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let n=(0,Pb.ensure)((0,Pb.ensure)(e,"workspace"),"symbol");n.dynamicRegistration=!0,n.symbolKind={valueSet:p$.SupportedSymbolKinds},n.tagSupport={valueSet:p$.SupportedSymbolTags},n.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:yH.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let n={provideWorkspaceSymbols:(r,s)=>{let a=this._client,c=(d,f)=>a.sendRequest(Nu.WorkspaceSymbolRequest.type,{query:d},f).then(p=>f.isCancellationRequested?null:a.protocol2CodeConverter.asSymbolInformations(p,f),p=>a.handleFailedRequest(Nu.WorkspaceSymbolRequest.type,f,p,null)),l=a.middleware;return l.provideWorkspaceSymbols?l.provideWorkspaceSymbols(r,s,c):c(r,s)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,s)=>{let a=this._client,c=(d,f)=>a.sendRequest(Nu.WorkspaceSymbolResolveRequest.type,a.code2ProtocolConverter.asWorkspaceSymbol(d),f).then(p=>f.isCancellationRequested?null:a.protocol2CodeConverter.asSymbolInformation(p),p=>a.handleFailedRequest(Nu.WorkspaceSymbolResolveRequest.type,f,p,null)),l=a.middleware;return l.resolveWorkspaceSymbol?l.resolveWorkspaceSymbol(r,s,c):c(r,s)}:void 0};return[vH.languages.registerWorkspaceSymbolProvider(n),n]}};Rh.WorkspaceSymbolFeature=Ab});var m$=oe(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});Eh.ReferencesFeature=void 0;var wH=require("vscode"),Db=it(),Ib=Ft(),bH=Pn(),$b=class extends Ib.TextDocumentLanguageFeature{constructor(e){super(e,Db.ReferencesRequest.type)}fillClientCapabilities(e){(0,Ib.ensure)((0,Ib.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.referencesProvider);r&&this.register({id:bH.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideReferences:(s,a,c,l)=>{let d=this._client,f=(m,g,w,v)=>d.sendRequest(Db.ReferencesRequest.type,d.code2ProtocolConverter.asReferenceParams(m,g,w),v).then(x=>v.isCancellationRequested?null:d.protocol2CodeConverter.asReferences(x,v),x=>d.handleFailedRequest(Db.ReferencesRequest.type,v,x,null)),p=d.middleware;return p.provideReferences?p.provideReferences(s,a,c,l,f):f(s,a,c,l)}};return[this.registerProvider(n,r),r]}registerProvider(e,n){return wH.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};Eh.ReferencesFeature=$b});var g$=oe(Sh=>{"use strict";Object.defineProperty(Sh,"__esModule",{value:!0});Sh.CodeActionFeature=void 0;var xH=require("vscode"),Mi=it(),TH=Pn(),Ob=Ft(),Fb=class extends Ob.TextDocumentLanguageFeature{constructor(e){super(e,Mi.CodeActionRequest.type)}fillClientCapabilities(e){let n=(0,Ob.ensure)((0,Ob.ensure)(e,"textDocument"),"codeAction");n.dynamicRegistration=!0,n.isPreferredSupport=!0,n.disabledSupport=!0,n.dataSupport=!0,n.resolveSupport={properties:["edit"]},n.codeActionLiteralSupport={codeActionKind:{valueSet:[Mi.CodeActionKind.Empty,Mi.CodeActionKind.QuickFix,Mi.CodeActionKind.Refactor,Mi.CodeActionKind.RefactorExtract,Mi.CodeActionKind.RefactorInline,Mi.CodeActionKind.RefactorRewrite,Mi.CodeActionKind.Source,Mi.CodeActionKind.SourceOrganizeImports]}},n.honorsChangeAnnotations=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.codeActionProvider);r&&this.register({id:TH.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideCodeActions:(s,a,c,l)=>{let d=this._client,f=async(m,g,w,v)=>{let x={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(m),range:d.code2ProtocolConverter.asRange(g),context:d.code2ProtocolConverter.asCodeActionContextSync(w)};return d.sendRequest(Mi.CodeActionRequest.type,x,v).then(b=>v.isCancellationRequested||b===null||b===void 0?null:d.protocol2CodeConverter.asCodeActionResult(b,v),b=>d.handleFailedRequest(Mi.CodeActionRequest.type,v,b,null))},p=d.middleware;return p.provideCodeActions?p.provideCodeActions(s,a,c,l,f):f(s,a,c,l)},resolveCodeAction:e.resolveProvider?(s,a)=>{let c=this._client,l=this._client.middleware,d=async(f,p)=>c.sendRequest(Mi.CodeActionResolveRequest.type,c.code2ProtocolConverter.asCodeActionSync(f),p).then(m=>p.isCancellationRequested?f:c.protocol2CodeConverter.asCodeAction(m,p),m=>c.handleFailedRequest(Mi.CodeActionResolveRequest.type,p,m,f));return l.resolveCodeAction?l.resolveCodeAction(s,a,d):d(s,a)}:void 0};return[xH.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}};Sh.CodeActionFeature=Fb});var v$=oe(Ch=>{"use strict";Object.defineProperty(Ch,"__esModule",{value:!0});Ch.CodeLensFeature=void 0;var _$=require("vscode"),rl=it(),RH=Pn(),Mu=Ft(),Nb=class extends Mu.TextDocumentLanguageFeature{constructor(e){super(e,rl.CodeLensRequest.type)}fillClientCapabilities(e){(0,Mu.ensure)((0,Mu.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,Mu.ensure)((0,Mu.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,n){this._client.onRequest(rl.CodeLensRefreshRequest.type,async()=>{for(let a of this.getAllProviders())a.onDidChangeCodeLensEmitter.fire()});let s=this.getRegistrationOptions(n,e.codeLensProvider);s&&this.register({id:RH.generateUuid(),registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r=new _$.EventEmitter,s={onDidChangeCodeLenses:r.event,provideCodeLenses:(a,c)=>{let l=this._client,d=(p,m)=>l.sendRequest(rl.CodeLensRequest.type,l.code2ProtocolConverter.asCodeLensParams(p),m).then(g=>m.isCancellationRequested?null:l.protocol2CodeConverter.asCodeLenses(g,m),g=>l.handleFailedRequest(rl.CodeLensRequest.type,m,g,null)),f=l.middleware;return f.provideCodeLenses?f.provideCodeLenses(a,c,d):d(a,c)},resolveCodeLens:e.resolveProvider?(a,c)=>{let l=this._client,d=(p,m)=>l.sendRequest(rl.CodeLensResolveRequest.type,l.code2ProtocolConverter.asCodeLens(p),m).then(g=>m.isCancellationRequested?p:l.protocol2CodeConverter.asCodeLens(g),g=>l.handleFailedRequest(rl.CodeLensResolveRequest.type,m,g,p)),f=l.middleware;return f.resolveCodeLens?f.resolveCodeLens(a,c,d):d(a,c)}:void 0};return[_$.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),s),{provider:s,onDidChangeCodeLensEmitter:r}]}};Ch.CodeLensFeature=Nb});var y$=oe(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.DocumentOnTypeFormattingFeature=ea.DocumentRangeFormattingFeature=ea.DocumentFormattingFeature=void 0;var kh=require("vscode"),Es=it(),Ub=Pn(),ho=Ft(),il;(function(t){function e(n){let r=kh.workspace.getConfiguration("files",n);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}t.fromConfiguration=e})(il||(il={}));var Mb=class extends ho.TextDocumentLanguageFeature{constructor(e){super(e,Es.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,ho.ensure)((0,ho.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.documentFormattingProvider);r&&this.register({id:Ub.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideDocumentFormattingEdits:(s,a,c)=>{let l=this._client,d=(p,m,g)=>{let w={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(p),options:l.code2ProtocolConverter.asFormattingOptions(m,il.fromConfiguration(p))};return l.sendRequest(Es.DocumentFormattingRequest.type,w,g).then(v=>g.isCancellationRequested?null:l.protocol2CodeConverter.asTextEdits(v,g),v=>l.handleFailedRequest(Es.DocumentFormattingRequest.type,g,v,null))},f=l.middleware;return f.provideDocumentFormattingEdits?f.provideDocumentFormattingEdits(s,a,c,d):d(s,a,c)}};return[kh.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r),r]}};ea.DocumentFormattingFeature=Mb;var qb=class extends ho.TextDocumentLanguageFeature{constructor(e){super(e,Es.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){let n=(0,ho.ensure)((0,ho.ensure)(e,"textDocument"),"rangeFormatting");n.dynamicRegistration=!0,n.rangesSupport=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.documentRangeFormattingProvider);r&&this.register({id:Ub.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideDocumentRangeFormattingEdits:(s,a,c,l)=>{let d=this._client,f=(m,g,w,v)=>{let x={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(m),range:d.code2ProtocolConverter.asRange(g),options:d.code2ProtocolConverter.asFormattingOptions(w,il.fromConfiguration(m))};return d.sendRequest(Es.DocumentRangeFormattingRequest.type,x,v).then(b=>v.isCancellationRequested?null:d.protocol2CodeConverter.asTextEdits(b,v),b=>d.handleFailedRequest(Es.DocumentRangeFormattingRequest.type,v,b,null))},p=d.middleware;return p.provideDocumentRangeFormattingEdits?p.provideDocumentRangeFormattingEdits(s,a,c,l,f):f(s,a,c,l)}};return e.rangesSupport&&(r.provideDocumentRangesFormattingEdits=(s,a,c,l)=>{let d=this._client,f=(m,g,w,v)=>{let x={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(m),ranges:d.code2ProtocolConverter.asRanges(g),options:d.code2ProtocolConverter.asFormattingOptions(w,il.fromConfiguration(m))};return d.sendRequest(Es.DocumentRangesFormattingRequest.type,x,v).then(b=>v.isCancellationRequested?null:d.protocol2CodeConverter.asTextEdits(b,v),b=>d.handleFailedRequest(Es.DocumentRangesFormattingRequest.type,v,b,null))},p=d.middleware;return p.provideDocumentRangesFormattingEdits?p.provideDocumentRangesFormattingEdits(s,a,c,l,f):f(s,a,c,l)}),[kh.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r),r]}};ea.DocumentRangeFormattingFeature=qb;var Lb=class extends ho.TextDocumentLanguageFeature{constructor(e){super(e,Es.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,ho.ensure)((0,ho.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.documentOnTypeFormattingProvider);r&&this.register({id:Ub.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideOnTypeFormattingEdits:(a,c,l,d,f)=>{let p=this._client,m=(w,v,x,b,S)=>{let k={textDocument:p.code2ProtocolConverter.asTextDocumentIdentifier(w),position:p.code2ProtocolConverter.asPosition(v),ch:x,options:p.code2ProtocolConverter.asFormattingOptions(b,il.fromConfiguration(w))};return p.sendRequest(Es.DocumentOnTypeFormattingRequest.type,k,S).then($=>S.isCancellationRequested?null:p.protocol2CodeConverter.asTextEdits($,S),$=>p.handleFailedRequest(Es.DocumentOnTypeFormattingRequest.type,S,$,null))},g=p.middleware;return g.provideOnTypeFormattingEdits?g.provideOnTypeFormattingEdits(a,c,l,d,f,m):m(a,c,l,d,f)}},s=e.moreTriggerCharacter||[];return[kh.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r,e.firstTriggerCharacter,...s),r]}};ea.DocumentOnTypeFormattingFeature=Lb});var b$=oe(Ph=>{"use strict";Object.defineProperty(Ph,"__esModule",{value:!0});Ph.RenameFeature=void 0;var EH=require("vscode"),Na=it(),SH=Pn(),w$=es(),Wb=Ft(),Hb=class extends Wb.TextDocumentLanguageFeature{constructor(e){super(e,Na.RenameRequest.type)}fillClientCapabilities(e){let n=(0,Wb.ensure)((0,Wb.ensure)(e,"textDocument"),"rename");n.dynamicRegistration=!0,n.prepareSupport=!0,n.prepareSupportDefaultBehavior=Na.PrepareSupportDefaultBehavior.Identifier,n.honorsChangeAnnotations=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.renameProvider);r&&(w$.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:SH.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let n=e.documentSelector,r={provideRenameEdits:(s,a,c,l)=>{let d=this._client,f=(m,g,w,v)=>{let x={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(m),position:d.code2ProtocolConverter.asPosition(g),newName:w};return d.sendRequest(Na.RenameRequest.type,x,v).then(b=>v.isCancellationRequested?null:d.protocol2CodeConverter.asWorkspaceEdit(b,v),b=>d.handleFailedRequest(Na.RenameRequest.type,v,b,null,!1))},p=d.middleware;return p.provideRenameEdits?p.provideRenameEdits(s,a,c,l,f):f(s,a,c,l)},prepareRename:e.prepareProvider?(s,a,c)=>{let l=this._client,d=(p,m,g)=>{let w={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(p),position:l.code2ProtocolConverter.asPosition(m)};return l.sendRequest(Na.PrepareRenameRequest.type,w,g).then(v=>g.isCancellationRequested?null:Na.Range.is(v)?l.protocol2CodeConverter.asRange(v):this.isDefaultBehavior(v)?v.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):v&&Na.Range.is(v.range)?{range:l.protocol2CodeConverter.asRange(v.range),placeholder:v.placeholder}:Promise.reject(new Error("The element can't be renamed.")),v=>{throw typeof v.message=="string"?new Error(v.message):new Error("The element can't be renamed.")})},f=l.middleware;return f.prepareRename?f.prepareRename(s,a,c,d):d(s,a,c)}:void 0};return[this.registerProvider(n,r),r]}registerProvider(e,n){return EH.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}isDefaultBehavior(e){let n=e;return n&&w$.boolean(n.defaultBehavior)}};Ph.RenameFeature=Hb});var x$=oe(Ah=>{"use strict";Object.defineProperty(Ah,"__esModule",{value:!0});Ah.DocumentLinkFeature=void 0;var CH=require("vscode"),qu=it(),jb=Ft(),kH=Pn(),Xb=class extends jb.TextDocumentLanguageFeature{constructor(e){super(e,qu.DocumentLinkRequest.type)}fillClientCapabilities(e){let n=(0,jb.ensure)((0,jb.ensure)(e,"textDocument"),"documentLink");n.dynamicRegistration=!0,n.tooltipSupport=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.documentLinkProvider);r&&this.register({id:kH.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideDocumentLinks:(s,a)=>{let c=this._client,l=(f,p)=>c.sendRequest(qu.DocumentLinkRequest.type,c.code2ProtocolConverter.asDocumentLinkParams(f),p).then(m=>p.isCancellationRequested?null:c.protocol2CodeConverter.asDocumentLinks(m,p),m=>c.handleFailedRequest(qu.DocumentLinkRequest.type,p,m,null)),d=c.middleware;return d.provideDocumentLinks?d.provideDocumentLinks(s,a,l):l(s,a)},resolveDocumentLink:e.resolveProvider?(s,a)=>{let c=this._client,l=(f,p)=>c.sendRequest(qu.DocumentLinkResolveRequest.type,c.code2ProtocolConverter.asDocumentLink(f),p).then(m=>p.isCancellationRequested?f:c.protocol2CodeConverter.asDocumentLink(m),m=>c.handleFailedRequest(qu.DocumentLinkResolveRequest.type,p,m,f)),d=c.middleware;return d.resolveDocumentLink?d.resolveDocumentLink(s,a,l):l(s,a)}:void 0};return[CH.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r),r]}};Ah.DocumentLinkFeature=Xb});var R$=oe(Dh=>{"use strict";Object.defineProperty(Dh,"__esModule",{value:!0});Dh.ExecuteCommandFeature=void 0;var PH=require("vscode"),Bb=it(),AH=Pn(),T$=Ft(),Gb=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return Bb.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,T$.ensure)((0,T$.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:AH.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let n=this._client,r=n.middleware,s=(a,c)=>{let l={command:a,arguments:c};return n.sendRequest(Bb.ExecuteCommandRequest.type,l).then(void 0,d=>n.handleFailedRequest(Bb.ExecuteCommandRequest.type,void 0,d,void 0))};if(e.registerOptions.commands){let a=[];for(let c of e.registerOptions.commands)a.push(PH.commands.registerCommand(c,(...l)=>r.executeCommand?r.executeCommand(c,l,s):s(c,l)));this._commands.set(e.id,a)}}unregister(e){let n=this._commands.get(e);n&&n.forEach(r=>r.dispose())}clear(){this._commands.forEach(e=>{e.forEach(n=>n.dispose())}),this._commands.clear()}};Dh.ExecuteCommandFeature=Gb});var E$=oe($h=>{"use strict";Object.defineProperty($h,"__esModule",{value:!0});$h.FileSystemWatcherFeature=void 0;var DH=require("vscode"),Ma=it(),Ih=Ft(),zb=class{constructor(e,n){this._client=e,this._notifyFileEvent=n,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return Ma.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,Ih.ensure)((0,Ih.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,Ih.ensure)((0,Ih.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,n){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let n=[];for(let r of e.registerOptions.watchers){let s=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(s===void 0)continue;let a=!0,c=!0,l=!0;r.kind!==void 0&&r.kind!==null&&(a=(r.kind&Ma.WatchKind.Create)!==0,c=(r.kind&Ma.WatchKind.Change)!==0,l=(r.kind&Ma.WatchKind.Delete)!==0);let d=DH.workspace.createFileSystemWatcher(s,!a,!c,!l);this.hookListeners(d,a,c,l,n),n.push(d)}this._watchers.set(e.id,n)}registerRaw(e,n){let r=[];for(let s of n)this.hookListeners(s,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,n,r,s,a){n&&e.onDidCreate(c=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(c),type:Ma.FileChangeType.Created}),null,a),r&&e.onDidChange(c=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(c),type:Ma.FileChangeType.Changed}),null,a),s&&e.onDidDelete(c=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(c),type:Ma.FileChangeType.Deleted}),null,a)}unregister(e){let n=this._watchers.get(e);if(n)for(let r of n)r.dispose()}clear(){this._watchers.forEach(e=>{for(let n of e)n.dispose()}),this._watchers.clear()}};$h.FileSystemWatcherFeature=zb});var S$=oe(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});Oh.ColorProviderFeature=void 0;var IH=require("vscode"),Lu=it(),Kb=Ft(),Zb=class extends Kb.TextDocumentLanguageFeature{constructor(e){super(e,Lu.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Kb.ensure)((0,Kb.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,n){let[r,s]=this.getRegistration(n,e.colorProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r={provideColorPresentations:(s,a,c)=>{let l=this._client,d=(p,m,g)=>{let w={color:p,textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(m.document),range:l.code2ProtocolConverter.asRange(m.range)};return l.sendRequest(Lu.ColorPresentationRequest.type,w,g).then(v=>g.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(v,g),v=>l.handleFailedRequest(Lu.ColorPresentationRequest.type,g,v,null))},f=l.middleware;return f.provideColorPresentations?f.provideColorPresentations(s,a,c,d):d(s,a,c)},provideDocumentColors:(s,a)=>{let c=this._client,l=(f,p)=>{let m={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(f)};return c.sendRequest(Lu.DocumentColorRequest.type,m,p).then(g=>p.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(g,p),g=>c.handleFailedRequest(Lu.DocumentColorRequest.type,p,g,null))},d=c.middleware;return d.provideDocumentColors?d.provideDocumentColors(s,a,l):l(s,a)}};return[IH.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r),r]}};Oh.ColorProviderFeature=Zb});var C$=oe(Fh=>{"use strict";Object.defineProperty(Fh,"__esModule",{value:!0});Fh.ImplementationFeature=void 0;var $H=require("vscode"),Vb=it(),Yb=Ft(),Jb=class extends Yb.TextDocumentLanguageFeature{constructor(e){super(e,Vb.ImplementationRequest.type)}fillClientCapabilities(e){let n=(0,Yb.ensure)((0,Yb.ensure)(e,"textDocument"),"implementation");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(e,n){let[r,s]=this.getRegistration(n,e.implementationProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r={provideImplementation:(s,a,c)=>{let l=this._client,d=(p,m,g)=>l.sendRequest(Vb.ImplementationRequest.type,l.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(w=>g.isCancellationRequested?null:l.protocol2CodeConverter.asDefinitionResult(w,g),w=>l.handleFailedRequest(Vb.ImplementationRequest.type,g,w,null)),f=l.middleware;return f.provideImplementation?f.provideImplementation(s,a,c,d):d(s,a,c)}};return[this.registerProvider(n,r),r]}registerProvider(e,n){return $H.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};Fh.ImplementationFeature=Jb});var k$=oe(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});Nh.TypeDefinitionFeature=void 0;var OH=require("vscode"),Qb=it(),Uu=Ft(),e0=class extends Uu.TextDocumentLanguageFeature{constructor(e){super(e,Qb.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,Uu.ensure)((0,Uu.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let n=(0,Uu.ensure)((0,Uu.ensure)(e,"textDocument"),"typeDefinition");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(e,n){let[r,s]=this.getRegistration(n,e.typeDefinitionProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r={provideTypeDefinition:(s,a,c)=>{let l=this._client,d=(p,m,g)=>l.sendRequest(Qb.TypeDefinitionRequest.type,l.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(w=>g.isCancellationRequested?null:l.protocol2CodeConverter.asDefinitionResult(w,g),w=>l.handleFailedRequest(Qb.TypeDefinitionRequest.type,g,w,null)),f=l.middleware;return f.provideTypeDefinition?f.provideTypeDefinition(s,a,c,d):d(s,a,c)}};return[this.registerProvider(n,r),r]}registerProvider(e,n){return OH.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};Nh.TypeDefinitionFeature=e0});var P$=oe(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});sl.WorkspaceFoldersFeature=sl.arrayDiff=void 0;var FH=Pn(),Mh=require("vscode"),Wu=it();function t0(t,e){if(t!=null)return t[e]}function n0(t,e){return t.filter(n=>e.indexOf(n)<0)}sl.arrayDiff=n0;var r0=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Wu.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let n=Mh.workspace.workspaceFolders;this.initializeWithFolders(n),n===void 0?e.workspaceFolders=null:e.workspaceFolders=n.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let n=this._client;n.onRequest(Wu.WorkspaceFoldersRequest.type,a=>{let c=()=>{let d=Mh.workspace.workspaceFolders;return d===void 0?null:d.map(p=>this.asProtocol(p))},l=n.middleware.workspace;return l&&l.workspaceFolders?l.workspaceFolders(a,c):c(a)});let r=t0(t0(t0(e,"workspace"),"workspaceFolders"),"changeNotifications"),s;typeof r=="string"?s=r:r===!0&&(s=FH.generateUuid()),s&&this.register({id:s,registerOptions:void 0})}sendInitialEvent(e){let n;if(this._initialFolders&&e){let r=n0(this._initialFolders,e),s=n0(e,this._initialFolders);(s.length>0||r.length>0)&&(n=this.doSendEvent(s,r))}else this._initialFolders?n=this.doSendEvent([],this._initialFolders):e&&(n=this.doSendEvent(e,[]));n!==void 0&&n.catch(r=>{this._client.error(`Sending notification ${Wu.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,n){let r={event:{added:e.map(s=>this.asProtocol(s)),removed:n.map(s=>this.asProtocol(s))}};return this._client.sendNotification(Wu.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let n=e.id,r=this._client,s=Mh.workspace.onDidChangeWorkspaceFolders(a=>{let c=f=>this.doSendEvent(f.added,f.removed),l=r.middleware.workspace;(l&&l.didChangeWorkspaceFolders?l.didChangeWorkspaceFolders(a,c):c(a)).catch(f=>{this._client.error(`Sending notification ${Wu.DidChangeWorkspaceFoldersNotification.type.method} failed`,f)})});this._listeners.set(n,s),this.sendInitialEvent(Mh.workspace.workspaceFolders)}unregister(e){let n=this._listeners.get(e);n!==void 0&&(this._listeners.delete(e),n.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};sl.WorkspaceFoldersFeature=r0});var D$=oe(qh=>{"use strict";Object.defineProperty(qh,"__esModule",{value:!0});qh.FoldingRangeFeature=void 0;var A$=require("vscode"),qa=it(),Hu=Ft(),i0=class extends Hu.TextDocumentLanguageFeature{constructor(e){super(e,qa.FoldingRangeRequest.type)}fillClientCapabilities(e){let n=(0,Hu.ensure)((0,Hu.ensure)(e,"textDocument"),"foldingRange");n.dynamicRegistration=!0,n.rangeLimit=5e3,n.lineFoldingOnly=!0,n.foldingRangeKind={valueSet:[qa.FoldingRangeKind.Comment,qa.FoldingRangeKind.Imports,qa.FoldingRangeKind.Region]},n.foldingRange={collapsedText:!1},(0,Hu.ensure)((0,Hu.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,n){this._client.onRequest(qa.FoldingRangeRefreshRequest.type,async()=>{for(let a of this.getAllProviders())a.onDidChangeFoldingRange.fire()});let[r,s]=this.getRegistration(n,e.foldingRangeProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r=new A$.EventEmitter,s={onDidChangeFoldingRanges:r.event,provideFoldingRanges:(a,c,l)=>{let d=this._client,f=(m,g,w)=>{let v={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(m)};return d.sendRequest(qa.FoldingRangeRequest.type,v,w).then(x=>w.isCancellationRequested?null:d.protocol2CodeConverter.asFoldingRanges(x,w),x=>d.handleFailedRequest(qa.FoldingRangeRequest.type,w,x,null))},p=d.middleware;return p.provideFoldingRanges?p.provideFoldingRanges(a,c,l,f):f(a,c,l)}};return[A$.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),s),{provider:s,onDidChangeFoldingRange:r}]}};qh.FoldingRangeFeature=i0});var I$=oe(Lh=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});Lh.DeclarationFeature=void 0;var NH=require("vscode"),s0=it(),o0=Ft(),a0=class extends o0.TextDocumentLanguageFeature{constructor(e){super(e,s0.DeclarationRequest.type)}fillClientCapabilities(e){let n=(0,o0.ensure)((0,o0.ensure)(e,"textDocument"),"declaration");n.dynamicRegistration=!0,n.linkSupport=!0}initialize(e,n){let[r,s]=this.getRegistration(n,e.declarationProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r={provideDeclaration:(s,a,c)=>{let l=this._client,d=(p,m,g)=>l.sendRequest(s0.DeclarationRequest.type,l.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(w=>g.isCancellationRequested?null:l.protocol2CodeConverter.asDeclarationResult(w,g),w=>l.handleFailedRequest(s0.DeclarationRequest.type,g,w,null)),f=l.middleware;return f.provideDeclaration?f.provideDeclaration(s,a,c,d):d(s,a,c)}};return[this.registerProvider(n,r),r]}registerProvider(e,n){return NH.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};Lh.DeclarationFeature=a0});var $$=oe(Uh=>{"use strict";Object.defineProperty(Uh,"__esModule",{value:!0});Uh.SelectionRangeFeature=void 0;var MH=require("vscode"),c0=it(),l0=Ft(),u0=class extends l0.TextDocumentLanguageFeature{constructor(e){super(e,c0.SelectionRangeRequest.type)}fillClientCapabilities(e){let n=(0,l0.ensure)((0,l0.ensure)(e,"textDocument"),"selectionRange");n.dynamicRegistration=!0}initialize(e,n){let[r,s]=this.getRegistration(n,e.selectionRangeProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r={provideSelectionRanges:(s,a,c)=>{let l=this._client,d=async(p,m,g)=>{let w={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(p),positions:l.code2ProtocolConverter.asPositionsSync(m,g)};return l.sendRequest(c0.SelectionRangeRequest.type,w,g).then(v=>g.isCancellationRequested?null:l.protocol2CodeConverter.asSelectionRanges(v,g),v=>l.handleFailedRequest(c0.SelectionRangeRequest.type,g,v,null))},f=l.middleware;return f.provideSelectionRanges?f.provideSelectionRanges(s,a,c,d):d(s,a,c)}};return[this.registerProvider(n,r),r]}registerProvider(e,n){return MH.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};Uh.SelectionRangeFeature=u0});var F$=oe(Wh=>{"use strict";Object.defineProperty(Wh,"__esModule",{value:!0});Wh.ProgressFeature=void 0;var O$=it(),qH=Mw();function LH(t,e){return t[e]===void 0&&(t[e]=Object.create(null)),t[e]}var d0=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:O$.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){LH(e,"window").workDoneProgress=!0}initialize(){let e=this._client,n=s=>{this.activeParts.delete(s)},r=s=>{this.activeParts.add(new qH.ProgressPart(this._client,s.token,n))};e.onRequest(O$.WorkDoneProgressCreateRequest.type,r)}clear(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};Wh.ProgressFeature=d0});var N$=oe(Hh=>{"use strict";Object.defineProperty(Hh,"__esModule",{value:!0});Hh.CallHierarchyFeature=void 0;var UH=require("vscode"),La=it(),f0=Ft(),p0=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,n,r){let s=this.client,a=this.middleware,c=(l,d,f)=>{let p=s.code2ProtocolConverter.asTextDocumentPositionParams(l,d);return s.sendRequest(La.CallHierarchyPrepareRequest.type,p,f).then(m=>f.isCancellationRequested?null:s.protocol2CodeConverter.asCallHierarchyItems(m,f),m=>s.handleFailedRequest(La.CallHierarchyPrepareRequest.type,f,m,null))};return a.prepareCallHierarchy?a.prepareCallHierarchy(e,n,r,c):c(e,n,r)}provideCallHierarchyIncomingCalls(e,n){let r=this.client,s=this.middleware,a=(c,l)=>{let d={item:r.code2ProtocolConverter.asCallHierarchyItem(c)};return r.sendRequest(La.CallHierarchyIncomingCallsRequest.type,d,l).then(f=>l.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(f,l),f=>r.handleFailedRequest(La.CallHierarchyIncomingCallsRequest.type,l,f,null))};return s.provideCallHierarchyIncomingCalls?s.provideCallHierarchyIncomingCalls(e,n,a):a(e,n)}provideCallHierarchyOutgoingCalls(e,n){let r=this.client,s=this.middleware,a=(c,l)=>{let d={item:r.code2ProtocolConverter.asCallHierarchyItem(c)};return r.sendRequest(La.CallHierarchyOutgoingCallsRequest.type,d,l).then(f=>l.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(f,l),f=>r.handleFailedRequest(La.CallHierarchyOutgoingCallsRequest.type,l,f,null))};return s.provideCallHierarchyOutgoingCalls?s.provideCallHierarchyOutgoingCalls(e,n,a):a(e,n)}},h0=class extends f0.TextDocumentLanguageFeature{constructor(e){super(e,La.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let n=e,r=(0,f0.ensure)((0,f0.ensure)(n,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,n){let[r,s]=this.getRegistration(n,e.callHierarchyProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=this._client,r=new p0(n);return[UH.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Hh.CallHierarchyFeature=h0});var M$=oe(Xh=>{"use strict";Object.defineProperty(Xh,"__esModule",{value:!0});Xh.SemanticTokensFeature=void 0;var jh=require("vscode"),ut=it(),ju=Ft(),WH=es(),m0=class extends ju.TextDocumentLanguageFeature{constructor(e){super(e,ut.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let n=(0,ju.ensure)((0,ju.ensure)(e,"textDocument"),"semanticTokens");n.dynamicRegistration=!0,n.tokenTypes=[ut.SemanticTokenTypes.namespace,ut.SemanticTokenTypes.type,ut.SemanticTokenTypes.class,ut.SemanticTokenTypes.enum,ut.SemanticTokenTypes.interface,ut.SemanticTokenTypes.struct,ut.SemanticTokenTypes.typeParameter,ut.SemanticTokenTypes.parameter,ut.SemanticTokenTypes.variable,ut.SemanticTokenTypes.property,ut.SemanticTokenTypes.enumMember,ut.SemanticTokenTypes.event,ut.SemanticTokenTypes.function,ut.SemanticTokenTypes.method,ut.SemanticTokenTypes.macro,ut.SemanticTokenTypes.keyword,ut.SemanticTokenTypes.modifier,ut.SemanticTokenTypes.comment,ut.SemanticTokenTypes.string,ut.SemanticTokenTypes.number,ut.SemanticTokenTypes.regexp,ut.SemanticTokenTypes.operator,ut.SemanticTokenTypes.decorator],n.tokenModifiers=[ut.SemanticTokenModifiers.declaration,ut.SemanticTokenModifiers.definition,ut.SemanticTokenModifiers.readonly,ut.SemanticTokenModifiers.static,ut.SemanticTokenModifiers.deprecated,ut.SemanticTokenModifiers.abstract,ut.SemanticTokenModifiers.async,ut.SemanticTokenModifiers.modification,ut.SemanticTokenModifiers.documentation,ut.SemanticTokenModifiers.defaultLibrary],n.formats=[ut.TokenFormat.Relative],n.requests={range:!0,full:{delta:!0}},n.multilineTokenSupport=!1,n.overlappingTokenSupport=!1,n.serverCancelSupport=!0,n.augmentsSyntaxTokens=!0,(0,ju.ensure)((0,ju.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,n){this._client.onRequest(ut.SemanticTokensRefreshRequest.type,async()=>{for(let c of this.getAllProviders())c.onDidChangeSemanticTokensEmitter.fire()});let[s,a]=this.getRegistration(n,e.semanticTokensProvider);!s||!a||this.register({id:s,registerOptions:a})}registerLanguageProvider(e){let n=e.documentSelector,r=WH.boolean(e.full)?e.full:e.full!==void 0,s=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,a=new jh.EventEmitter,c=r?{onDidChangeSemanticTokens:a.event,provideDocumentSemanticTokens:(w,v)=>{let x=this._client,b=x.middleware,S=(k,$)=>{let F={textDocument:x.code2ProtocolConverter.asTextDocumentIdentifier(k)};return x.sendRequest(ut.SemanticTokensRequest.type,F,$).then(L=>$.isCancellationRequested?null:x.protocol2CodeConverter.asSemanticTokens(L,$),L=>x.handleFailedRequest(ut.SemanticTokensRequest.type,$,L,null))};return b.provideDocumentSemanticTokens?b.provideDocumentSemanticTokens(w,v,S):S(w,v)},provideDocumentSemanticTokensEdits:s?(w,v,x)=>{let b=this._client,S=b.middleware,k=($,F,L)=>{let H={textDocument:b.code2ProtocolConverter.asTextDocumentIdentifier($),previousResultId:F};return b.sendRequest(ut.SemanticTokensDeltaRequest.type,H,L).then(async N=>L.isCancellationRequested?null:ut.SemanticTokens.is(N)?await b.protocol2CodeConverter.asSemanticTokens(N,L):await b.protocol2CodeConverter.asSemanticTokensEdits(N,L),N=>b.handleFailedRequest(ut.SemanticTokensDeltaRequest.type,L,N,null))};return S.provideDocumentSemanticTokensEdits?S.provideDocumentSemanticTokensEdits(w,v,x,k):k(w,v,x)}:void 0}:void 0,d=e.range===!0?{provideDocumentRangeSemanticTokens:(w,v,x)=>{let b=this._client,S=b.middleware,k=($,F,L)=>{let H={textDocument:b.code2ProtocolConverter.asTextDocumentIdentifier($),range:b.code2ProtocolConverter.asRange(F)};return b.sendRequest(ut.SemanticTokensRangeRequest.type,H,L).then(N=>L.isCancellationRequested?null:b.protocol2CodeConverter.asSemanticTokens(N,L),N=>b.handleFailedRequest(ut.SemanticTokensRangeRequest.type,L,N,null))};return S.provideDocumentRangeSemanticTokens?S.provideDocumentRangeSemanticTokens(w,v,x,k):k(w,v,x)}}:void 0,f=[],p=this._client,m=p.protocol2CodeConverter.asSemanticTokensLegend(e.legend),g=p.protocol2CodeConverter.asDocumentSelector(n);return c!==void 0&&f.push(jh.languages.registerDocumentSemanticTokensProvider(g,c,m)),d!==void 0&&f.push(jh.languages.registerDocumentRangeSemanticTokensProvider(g,d,m)),[new jh.Disposable(()=>f.forEach(w=>w.dispose())),{range:d,full:c,onDidChangeSemanticTokensEmitter:a}]}};Xh.SemanticTokensFeature=m0});var U$=oe(mi=>{"use strict";Object.defineProperty(mi,"__esModule",{value:!0});mi.WillDeleteFilesFeature=mi.WillRenameFilesFeature=mi.WillCreateFilesFeature=mi.DidDeleteFilesFeature=mi.DidRenameFilesFeature=mi.DidCreateFilesFeature=void 0;var os=require("vscode"),HH=fh(),mo=it(),jH=Pn();function q$(t,e){return t[e]===void 0&&(t[e]={}),t[e]}function XH(t,e){return t[e]}function L$(t,e,n){t[e]=n}var Xu=class t{constructor(e,n,r,s,a){this._client=e,this._event=n,this._registrationType=r,this._clientCapability=s,this._serverCapability=a,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let n=q$(q$(e,"workspace"),"fileOperations");L$(n,"dynamicRegistration",!0),L$(n,this._clientCapability,!0)}initialize(e){let n=e.workspace?.fileOperations,r=n!==void 0?XH(n,this._serverCapability):void 0;if(r?.filters!==void 0)try{this.register({id:jH.generateUuid(),registerOptions:{filters:r.filters}})}catch(s){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${s}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let n=e.registerOptions.filters.map(r=>{let s=new HH.Minimatch(r.pattern.glob,t.asMinimatchOptions(r.pattern.options));if(!s.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:s,kind:r.pattern.matches}});this._filters.set(e.id,n)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return t.getFileType(e)}async filter(e,n){let r=await Promise.all(e.files.map(async a=>{let c=n(a),l=c.fsPath.replace(/\\/g,"/");for(let d of this._filters.values())for(let f of d)if(!(f.scheme!==void 0&&f.scheme!==c.scheme)){if(f.matcher.match(l)){if(f.kind===void 0)return!0;let p=await this.getFileType(c);if(p===void 0)return this._client.error(`Failed to determine file type for ${c.toString()}.`),!0;if(p===os.FileType.File&&f.kind===mo.FileOperationPatternKind.file||p===os.FileType.Directory&&f.kind===mo.FileOperationPatternKind.folder)return!0}else if(f.kind===mo.FileOperationPatternKind.folder&&await t.getFileType(c)===os.FileType.Directory&&f.matcher.match(`${l}/`))return!0}return!1})),s=e.files.filter((a,c)=>r[c]);return{...e,files:s}}static async getFileType(e){try{return(await os.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){let n={dot:!0};return e?.ignoreCase===!0&&(n.nocase=!0),n}},Bh=class extends Xu{constructor(e,n,r,s,a,c,l){super(e,n,r,s,a),this._notificationType=r,this._accessUri=c,this._createParams=l}async send(e){let n=await this.filter(e,this._accessUri);if(n.files.length){let r=async s=>this._client.sendNotification(this._notificationType,this._createParams(s));return this.doSend(n,r)}}},Gh=class extends Bh{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let n=e.fsPath;if(this._fsPathFileTypes.has(n))return this._fsPathFileTypes.get(n);let r=await Xu.getFileType(e);return r&&this._fsPathFileTypes.set(n,r),r}async cacheFileTypes(e,n){await this.filter(e,n)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},g0=class extends Bh{constructor(e){super(e,os.workspace.onDidCreateFiles,mo.DidCreateFilesNotification.type,"didCreate","didCreate",n=>n,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,n){let r=this._client.middleware.workspace;return r?.didCreateFiles?r.didCreateFiles(e,n):n(e)}};mi.DidCreateFilesFeature=g0;var _0=class extends Gh{constructor(e){super(e,os.workspace.onDidRenameFiles,mo.DidRenameFilesNotification.type,"didRename","didRename",n=>n.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=os.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,n=>n.oldUri))}doSend(e,n){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didRenameFiles?r.didRenameFiles(e,n):n(e)}};mi.DidRenameFilesFeature=_0;var v0=class extends Gh{constructor(e){super(e,os.workspace.onDidDeleteFiles,mo.DidDeleteFilesNotification.type,"didDelete","didDelete",n=>n,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=os.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,n=>n))}doSend(e,n){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didDeleteFiles?r.didDeleteFiles(e,n):n(e)}};mi.DidDeleteFilesFeature=v0;var Bu=class extends Xu{constructor(e,n,r,s,a,c,l){super(e,n,r,s,a),this._requestType=r,this._accessUri=c,this._createParams=l}async send(e){let n=this.waitUntil(e);e.waitUntil(n)}async waitUntil(e){let n=await this.filter(e,this._accessUri);if(n.files.length){let r=s=>this._client.sendRequest(this._requestType,this._createParams(s),s.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(n,r)}else return}},y0=class extends Bu{constructor(e){super(e,os.workspace.onWillCreateFiles,mo.WillCreateFilesRequest.type,"willCreate","willCreate",n=>n,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,n){let r=this._client.middleware.workspace;return r?.willCreateFiles?r.willCreateFiles(e,n):n(e)}};mi.WillCreateFilesFeature=y0;var w0=class extends Bu{constructor(e){super(e,os.workspace.onWillRenameFiles,mo.WillRenameFilesRequest.type,"willRename","willRename",n=>n.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,n){let r=this._client.middleware.workspace;return r?.willRenameFiles?r.willRenameFiles(e,n):n(e)}};mi.WillRenameFilesFeature=w0;var b0=class extends Bu{constructor(e){super(e,os.workspace.onWillDeleteFiles,mo.WillDeleteFilesRequest.type,"willDelete","willDelete",n=>n,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,n){let r=this._client.middleware.workspace;return r?.willDeleteFiles?r.willDeleteFiles(e,n):n(e)}};mi.WillDeleteFilesFeature=b0});var W$=oe(zh=>{"use strict";Object.defineProperty(zh,"__esModule",{value:!0});zh.LinkedEditingFeature=void 0;var BH=require("vscode"),x0=it(),T0=Ft(),R0=class extends T0.TextDocumentLanguageFeature{constructor(e){super(e,x0.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let n=(0,T0.ensure)((0,T0.ensure)(e,"textDocument"),"linkedEditingRange");n.dynamicRegistration=!0}initialize(e,n){let[r,s]=this.getRegistration(n,e.linkedEditingRangeProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r={provideLinkedEditingRanges:(s,a,c)=>{let l=this._client,d=(p,m,g)=>l.sendRequest(x0.LinkedEditingRangeRequest.type,l.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(w=>g.isCancellationRequested?null:l.protocol2CodeConverter.asLinkedEditingRanges(w,g),w=>l.handleFailedRequest(x0.LinkedEditingRangeRequest.type,g,w,null)),f=l.middleware;return f.provideLinkedEditingRange?f.provideLinkedEditingRange(s,a,c,d):d(s,a,c)}};return[this.registerProvider(n,r),r]}registerProvider(e,n){return BH.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};zh.LinkedEditingFeature=R0});var H$=oe(Kh=>{"use strict";Object.defineProperty(Kh,"__esModule",{value:!0});Kh.TypeHierarchyFeature=void 0;var GH=require("vscode"),Ua=it(),E0=Ft(),S0=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,n,r){let s=this.client,a=this.middleware,c=(l,d,f)=>{let p=s.code2ProtocolConverter.asTextDocumentPositionParams(l,d);return s.sendRequest(Ua.TypeHierarchyPrepareRequest.type,p,f).then(m=>f.isCancellationRequested?null:s.protocol2CodeConverter.asTypeHierarchyItems(m,f),m=>s.handleFailedRequest(Ua.TypeHierarchyPrepareRequest.type,f,m,null))};return a.prepareTypeHierarchy?a.prepareTypeHierarchy(e,n,r,c):c(e,n,r)}provideTypeHierarchySupertypes(e,n){let r=this.client,s=this.middleware,a=(c,l)=>{let d={item:r.code2ProtocolConverter.asTypeHierarchyItem(c)};return r.sendRequest(Ua.TypeHierarchySupertypesRequest.type,d,l).then(f=>l.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(f,l),f=>r.handleFailedRequest(Ua.TypeHierarchySupertypesRequest.type,l,f,null))};return s.provideTypeHierarchySupertypes?s.provideTypeHierarchySupertypes(e,n,a):a(e,n)}provideTypeHierarchySubtypes(e,n){let r=this.client,s=this.middleware,a=(c,l)=>{let d={item:r.code2ProtocolConverter.asTypeHierarchyItem(c)};return r.sendRequest(Ua.TypeHierarchySubtypesRequest.type,d,l).then(f=>l.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(f,l),f=>r.handleFailedRequest(Ua.TypeHierarchySubtypesRequest.type,l,f,null))};return s.provideTypeHierarchySubtypes?s.provideTypeHierarchySubtypes(e,n,a):a(e,n)}},C0=class extends E0.TextDocumentLanguageFeature{constructor(e){super(e,Ua.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let n=(0,E0.ensure)((0,E0.ensure)(e,"textDocument"),"typeHierarchy");n.dynamicRegistration=!0}initialize(e,n){let[r,s]=this.getRegistration(n,e.typeHierarchyProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=this._client,r=new S0(n);return[GH.languages.registerTypeHierarchyProvider(n.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Kh.TypeHierarchyFeature=C0});var X$=oe(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});Vh.InlineValueFeature=void 0;var j$=require("vscode"),Zh=it(),Gu=Ft(),k0=class extends Gu.TextDocumentLanguageFeature{constructor(e){super(e,Zh.InlineValueRequest.type)}fillClientCapabilities(e){(0,Gu.ensure)((0,Gu.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,Gu.ensure)((0,Gu.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,n){this._client.onRequest(Zh.InlineValueRefreshRequest.type,async()=>{for(let a of this.getAllProviders())a.onDidChangeInlineValues.fire()});let[r,s]=this.getRegistration(n,e.inlineValueProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r=new j$.EventEmitter,s={onDidChangeInlineValues:r.event,provideInlineValues:(a,c,l,d)=>{let f=this._client,p=(g,w,v,x)=>{let b={textDocument:f.code2ProtocolConverter.asTextDocumentIdentifier(g),range:f.code2ProtocolConverter.asRange(w),context:f.code2ProtocolConverter.asInlineValueContext(v)};return f.sendRequest(Zh.InlineValueRequest.type,b,x).then(S=>x.isCancellationRequested?null:f.protocol2CodeConverter.asInlineValues(S,x),S=>f.handleFailedRequest(Zh.InlineValueRequest.type,x,S,null))},m=f.middleware;return m.provideInlineValues?m.provideInlineValues(a,c,l,d,p):p(a,c,l,d)}};return[this.registerProvider(n,s),{provider:s,onDidChangeInlineValues:r}]}registerProvider(e,n){return j$.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};Vh.InlineValueFeature=k0});var G$=oe(Yh=>{"use strict";Object.defineProperty(Yh,"__esModule",{value:!0});Yh.InlayHintsFeature=void 0;var B$=require("vscode"),ol=it(),zu=Ft(),P0=class extends zu.TextDocumentLanguageFeature{constructor(e){super(e,ol.InlayHintRequest.type)}fillClientCapabilities(e){let n=(0,zu.ensure)((0,zu.ensure)(e,"textDocument"),"inlayHint");n.dynamicRegistration=!0,n.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,zu.ensure)((0,zu.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,n){this._client.onRequest(ol.InlayHintRefreshRequest.type,async()=>{for(let a of this.getAllProviders())a.onDidChangeInlayHints.fire()});let[r,s]=this.getRegistration(n,e.inlayHintProvider);!r||!s||this.register({id:r,registerOptions:s})}registerLanguageProvider(e){let n=e.documentSelector,r=new B$.EventEmitter,s={onDidChangeInlayHints:r.event,provideInlayHints:(a,c,l)=>{let d=this._client,f=async(m,g,w)=>{let v={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(m),range:d.code2ProtocolConverter.asRange(g)};try{let x=await d.sendRequest(ol.InlayHintRequest.type,v,w);return w.isCancellationRequested?null:d.protocol2CodeConverter.asInlayHints(x,w)}catch(x){return d.handleFailedRequest(ol.InlayHintRequest.type,w,x,null)}},p=d.middleware;return p.provideInlayHints?p.provideInlayHints(a,c,l,f):f(a,c,l)}};return s.resolveInlayHint=e.resolveProvider===!0?(a,c)=>{let l=this._client,d=async(p,m)=>{try{let g=await l.sendRequest(ol.InlayHintResolveRequest.type,l.code2ProtocolConverter.asInlayHint(p),m);if(m.isCancellationRequested)return null;let w=l.protocol2CodeConverter.asInlayHint(g,m);return m.isCancellationRequested?null:w}catch(g){return l.handleFailedRequest(ol.InlayHintResolveRequest.type,m,g,null)}},f=l.middleware;return f.resolveInlayHint?f.resolveInlayHint(a,c,d):d(a,c)}:void 0,[this.registerProvider(n,s),{provider:s,onDidChangeInlayHints:r}]}registerProvider(e,n){return B$.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),n)}};Yh.InlayHintsFeature=P0});var z$=oe(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.InlineCompletionItemFeature=void 0;var zH=require("vscode"),A0=it(),D0=Ft(),KH=Pn(),I0=class extends D0.TextDocumentLanguageFeature{constructor(e){super(e,A0.InlineCompletionRequest.type)}fillClientCapabilities(e){let n=(0,D0.ensure)((0,D0.ensure)(e,"textDocument"),"inlineCompletion");n.dynamicRegistration=!0}initialize(e,n){let r=this.getRegistrationOptions(n,e.inlineCompletionProvider);r&&this.register({id:KH.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let n=e.documentSelector,r={provideInlineCompletionItems:(s,a,c,l)=>{let d=this._client,f=this._client.middleware,p=(m,g,w,v)=>d.sendRequest(A0.InlineCompletionRequest.type,d.code2ProtocolConverter.asInlineCompletionParams(m,g,w),v).then(x=>v.isCancellationRequested?null:d.protocol2CodeConverter.asInlineCompletionResult(x,v),x=>d.handleFailedRequest(A0.InlineCompletionRequest.type,v,x,null));return f.provideInlineCompletionItems?f.provideInlineCompletionItems(s,a,c,l,p):p(s,a,c,l)}};return[zH.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(n),r),r]}};Jh.InlineCompletionItemFeature=I0});var q0=oe(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.ProposedFeatures=gr.BaseLanguageClient=gr.MessageTransports=gr.SuspendMode=gr.State=gr.CloseAction=gr.ErrorAction=gr.RevealOutputChannelOn=void 0;var Vt=require("vscode"),be=it(),ZH=T2(),VH=S2(),Cs=es(),Qh=sh(),K$=Pn(),YH=Mw(),Ss=Ft(),JH=rb(),Z$=r$(),V$=s$(),al=o$(),QH=a$(),e7=c$(),t7=l$(),n7=d$(),r7=f$(),i7=kb(),s7=h$(),o7=m$(),a7=g$(),c7=v$(),$0=y$(),l7=b$(),u7=x$(),d7=R$(),f7=E$(),p7=S$(),h7=C$(),m7=k$(),g7=P$(),_7=D$(),v7=I$(),y7=$$(),w7=F$(),b7=N$(),x7=M$(),cl=U$(),T7=W$(),R7=H$(),E7=X$(),S7=G$(),C7=z$(),Wa;(function(t){t[t.Debug=0]="Debug",t[t.Info=1]="Info",t[t.Warn=2]="Warn",t[t.Error=3]="Error",t[t.Never=4]="Never"})(Wa||(gr.RevealOutputChannelOn=Wa={}));var Zu;(function(t){t[t.Continue=1]="Continue",t[t.Shutdown=2]="Shutdown"})(Zu||(gr.ErrorAction=Zu={}));var ta;(function(t){t[t.DoNotRestart=1]="DoNotRestart",t[t.Restart=2]="Restart"})(ta||(gr.CloseAction=ta={}));var Ku;(function(t){t[t.Stopped=1]="Stopped",t[t.Starting=3]="Starting",t[t.Running=2]="Running"})(Ku||(gr.State=Ku={}));var Y$;(function(t){t.off="off",t.on="on"})(Y$||(gr.SuspendMode=Y$={}));var O0;(function(t){function e(n){return n==null?!1:typeof n=="boolean"||typeof n=="object"&&n!==null&&Cs.stringArray(n.enabledCommands)?n:!1}t.sanitizeIsTrusted=e})(O0||(O0={}));var F0=class{constructor(e,n){this.client=e,this.maxRestartCount=n,this.restarts=[]}error(e,n,r){return r&&r<=3?{action:Zu.Continue}:{action:Zu.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:ta.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=180*1e3?{action:ta.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:ta.Restart})}},bt;(function(t){t.Initial="initial",t.Starting="starting",t.StartFailed="startFailed",t.Running="running",t.Stopping="stopping",t.Stopped="stopped"})(bt||(bt={}));var J$;(function(t){function e(n){return n&&be.MessageReader.is(n.reader)&&be.MessageWriter.is(n.writer)}t.is=e})(J$||(gr.MessageTransports=J$={}));var Vu=class t{constructor(e,n,r){this._traceFormat=be.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new Qh.Semaphore(1),this._id=e,this._name=n,r=r||{};let s={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(s.isTrusted=O0.sanitizeIsTrusted(r.markdown.isTrusted),s.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??Wa.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler(r.connectionOptions?.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:s,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=bt.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new Qh.Semaphore(1),this._pendingChangeDelayer=new Qh.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new Qh.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new be.Emitter,this._stateChangeEmitter=new be.Emitter,this._trace=be.Trace.Off,this._tracer={log:(a,c)=>{Cs.string(a)?this.logTrace(a,c):this.logObjectTrace(a)}},this._c2p=ZH.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=VH.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=Vt.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let n=this.getPublicState();this._state=e;let r=this.getPublicState();r!==n&&this._stateChangeEmitter.fire({oldState:n,newState:r})}getPublicState(){switch(this.$state){case bt.Starting:return Ku.Starting;case bt.Running:return Ku.Running;default:return Ku.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...n){if(this.$state===bt.StartFailed||this.$state===bt.Stopping||this.$state===bt.Stopped)return Promise.reject(new be.ResponseError(be.ErrorCodes.ConnectionInactive,"Client is not running"));let r=await this.$start();this._didChangeTextDocumentFeature.syncKind===be.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r);let s=this._clientOptions.middleware?.sendRequest;if(s!==void 0){let a,c;return n.length===1?be.CancellationToken.is(n[0])?c=n[0]:a=n[0]:n.length===2&&(a=n[0],c=n[1]),s(e,a,c,(l,d,f)=>{let p=[];return d!==void 0&&p.push(d),f!==void 0&&p.push(f),r.sendRequest(l,...p)})}else return r.sendRequest(e,...n)}onRequest(e,n){let r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,n);let s=this.activeConnection(),a;return s!==void 0?(this._requestDisposables.set(r,s.onRequest(e,n)),a={dispose:()=>{let c=this._requestDisposables.get(r);c!==void 0&&(c.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,n),a={dispose:()=>{this._pendingRequestHandlers.delete(r);let c=this._requestDisposables.get(r);c!==void 0&&(c.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),a.dispose()}}}async sendNotification(e,n){if(this.$state===bt.StartFailed||this.$state===bt.Stopping||this.$state===bt.Stopped)return Promise.reject(new be.ResponseError(be.ErrorCodes.ConnectionInactive,"Client is not running"));let r=this._didChangeTextDocumentFeature.syncKind===be.TextDocumentSyncKind.Full,s;r&&typeof e!="string"&&e.method===be.DidOpenTextDocumentNotification.method&&(s=n?.textDocument.uri,this._pendingOpenNotifications.add(s));let a=await this.$start();r&&await this.sendPendingFullTextDocumentChanges(a),s!==void 0&&this._pendingOpenNotifications.delete(s);let c=this._clientOptions.middleware?.sendNotification;return c?c(e,a.sendNotification.bind(a),n):a.sendNotification(e,n)}onNotification(e,n){let r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,n);let s=this.activeConnection(),a;return s!==void 0?(this._notificationDisposables.set(r,s.onNotification(e,n)),a={dispose:()=>{let c=this._notificationDisposables.get(r);c!==void 0&&(c.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,n),a={dispose:()=>{this._pendingNotificationHandlers.delete(r);let c=this._notificationDisposables.get(r);c!==void 0&&(c.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),a.dispose()}}}async sendProgress(e,n,r){if(this.$state===bt.StartFailed||this.$state===bt.Stopping||this.$state===bt.Stopped)return Promise.reject(new be.ResponseError(be.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,n,r)}catch(s){throw this.error(`Sending progress for token ${n} failed.`,s),s}}onProgress(e,n,r){this._progressHandlers.set(n,{type:e,handler:r});let s=this.activeConnection(),a,c=this._clientOptions.middleware?.handleWorkDoneProgress,l=be.WorkDoneProgress.is(e)&&c!==void 0?d=>{c(n,d,()=>r(d))}:r;return s!==void 0?(this._progressDisposables.set(n,s.onProgress(e,n,l)),a={dispose:()=>{let d=this._progressDisposables.get(n);d!==void 0&&(d.dispose(),this._progressDisposables.delete(n))}}):(this._pendingProgressHandlers.set(n,{type:e,handler:r}),a={dispose:()=>{this._pendingProgressHandlers.delete(n);let d=this._progressDisposables.get(n);d!==void 0&&(d.dispose(),this._progressDisposables.delete(n))}}),{dispose:()=>{this._progressHandlers.delete(n),a.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new F0(this,e??4)}async setTrace(e){this._trace=e;let n=this.activeConnection();n!==void 0&&await n.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof be.ResponseError){let n=e;return`  Message: ${n.message}
  Code: ${n.code} ${n.data?`
`+n.data.toString():""}`}return e instanceof Error?Cs.string(e.stack)?e.stack:e.message:Cs.string(e)?e:e.toString()}debug(e,n,r=!0){this.logOutputMessage(be.MessageType.Debug,Wa.Debug,"Debug",e,n,r)}info(e,n,r=!0){this.logOutputMessage(be.MessageType.Info,Wa.Info,"Info",e,n,r)}warn(e,n,r=!0){this.logOutputMessage(be.MessageType.Warning,Wa.Warn,"Warn",e,n,r)}error(e,n,r=!0){this.logOutputMessage(be.MessageType.Error,Wa.Error,"Error",e,n,r)}logOutputMessage(e,n,r,s,a,c){this.outputChannel.appendLine(`[${r.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${s}`),a!=null&&this.outputChannel.appendLine(this.data2String(a)),(c==="force"||c&&this._clientOptions.revealOutputChannelOn<=n)&&this.showNotificationMessage(e,s)}showNotificationMessage(e,n){n=n??"A request has failed. See the output for more information.",(e===be.MessageType.Error?Vt.window.showErrorMessage:e===be.MessageType.Warning?Vt.window.showWarningMessage:Vt.window.showInformationMessage)(n,"Go to output").then(s=>{s!==void 0&&this.outputChannel.show(!0)})}logTrace(e,n){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),n&&this.traceOutputChannel.appendLine(this.data2String(n))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===bt.Initial||this.$state===bt.Stopping||this.$state===bt.Stopped}needsStop(){return this.$state===bt.Starting||this.$state===bt.Running}activeConnection(){return this.$state===bt.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===bt.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===bt.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,n,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?Vt.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):Vt.languages.createDiagnosticCollection());for(let[s,a]of this._notificationHandlers)this._pendingNotificationHandlers.has(s)||this._pendingNotificationHandlers.set(s,a);for(let[s,a]of this._requestHandlers)this._pendingRequestHandlers.has(s)||this._pendingRequestHandlers.set(s,a);for(let[s,a]of this._progressHandlers)this._pendingProgressHandlers.has(s)||this._pendingProgressHandlers.set(s,a);this.$state=bt.Starting;try{let s=await this.createConnection();s.onNotification(be.LogMessageNotification.type,a=>{switch(a.type){case be.MessageType.Error:this.error(a.message,void 0,!1);break;case be.MessageType.Warning:this.warn(a.message,void 0,!1);break;case be.MessageType.Info:this.info(a.message,void 0,!1);break;case be.MessageType.Debug:this.debug(a.message,void 0,!1);break;default:this.outputChannel.appendLine(a.message)}}),s.onNotification(be.ShowMessageNotification.type,a=>{switch(a.type){case be.MessageType.Error:Vt.window.showErrorMessage(a.message);break;case be.MessageType.Warning:Vt.window.showWarningMessage(a.message);break;case be.MessageType.Info:Vt.window.showInformationMessage(a.message);break;default:Vt.window.showInformationMessage(a.message)}}),s.onRequest(be.ShowMessageRequest.type,a=>{let c;switch(a.type){case be.MessageType.Error:c=Vt.window.showErrorMessage;break;case be.MessageType.Warning:c=Vt.window.showWarningMessage;break;case be.MessageType.Info:c=Vt.window.showInformationMessage;break;default:c=Vt.window.showInformationMessage}let l=a.actions||[];return c(a.message,...l)}),s.onNotification(be.TelemetryEventNotification.type,a=>{this._telemetryEmitter.fire(a)}),s.onRequest(be.ShowDocumentRequest.type,async a=>{let c=async d=>{let f=this.protocol2CodeConverter.asUri(d.uri);try{if(d.external===!0)return{success:await Vt.env.openExternal(f)};{let p={};return d.selection!==void 0&&(p.selection=this.protocol2CodeConverter.asRange(d.selection)),d.takeFocus===void 0||d.takeFocus===!1?p.preserveFocus=!0:d.takeFocus===!0&&(p.preserveFocus=!1),await Vt.window.showTextDocument(f,p),{success:!0}}}catch{return{success:!1}}},l=this._clientOptions.middleware.window?.showDocument;return l!==void 0?l(a,c):c(a)}),s.listen(),await this.initialize(s),n()}catch(s){this.$state=bt.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,s,"force"),r(s)}return this._onStart}createOnStartPromise(){let e,n;return[new Promise((s,a)=>{e=s,n=a}),e,n]}async initialize(e){this.refreshTrace(e,!1);let n=this._clientOptions.initializationOptions,[r,s]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],a={processId:null,clientInfo:{name:Vt.env.appName,version:Vt.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(Vt.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:Cs.func(n)?n():n,trace:be.Trace.toString(this._trace),workspaceFolders:s};if(this.fillInitializeParams(a),this._clientOptions.progressOnInitialization){let c=K$.generateUuid(),l=new YH.ProgressPart(e,c);a.workDoneToken=c;try{let d=await this.doInitialize(e,a);return l.done(),d}catch(d){throw l.cancel(),d}}else return this.doInitialize(e,a)}async doInitialize(e,n){try{let r=await e.initialize(n);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==be.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=bt.Running;let s;Cs.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===be.TextDocumentSyncKind.None?s={openClose:!1,change:be.TextDocumentSyncKind.None,save:void 0}:s={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(s=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:s}),e.onNotification(be.PublishDiagnosticsNotification.type,a=>this.handleDiagnostics(a)),e.onRequest(be.RegistrationRequest.type,a=>this.handleRegistrationRequest(a)),e.onRequest("client/registerFeature",a=>this.handleRegistrationRequest(a)),e.onRequest(be.UnregistrationRequest.type,a=>this.handleUnregistrationRequest(a)),e.onRequest("client/unregisterFeature",a=>this.handleUnregistrationRequest(a)),e.onRequest(be.ApplyWorkspaceEditRequest.type,a=>this.handleApplyWorkspaceEdit(a));for(let[a,c]of this._pendingNotificationHandlers)this._notificationDisposables.set(a,e.onNotification(a,c));this._pendingNotificationHandlers.clear();for(let[a,c]of this._pendingRequestHandlers)this._requestDisposables.set(a,e.onRequest(a,c));this._pendingRequestHandlers.clear();for(let[a,c]of this._pendingProgressHandlers)this._progressDisposables.set(a,e.onProgress(c.type,a,c.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(be.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof be.ResponseError&&r.data&&r.data.retry?Vt.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(s=>{s&&s.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&Vt.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=Vt.workspace.workspaceFolders;if(!e||e.length===0)return;let n=e[0];if(n.uri.scheme==="file")return n.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,n){if(this.$state===bt.Stopped||this.$state===bt.Initial)return;if(this.$state===bt.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let r=this.activeConnection();if(r===void 0||this.$state!==bt.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=bt.Stopping,this.cleanUp(e);let s=new Promise(c=>{(0,be.RAL)().timer.setTimeout(c,n)}),a=(async c=>(await c.shutdown(),await c.exit(),c))(r);return this._onStop=Promise.race([s,a]).then(c=>{if(c!==void 0)c.end(),c.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},c=>{throw this.error("Stopping server failed",c,!1),c}).finally(()=>{this.$state=bt.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let n=this._listeners.splice(0,this._listeners.length);for(let r of n)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(s=>s[1]).reverse())r.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){let n=this;async function r(a){return n._fileEvents.push(a),n._fileEventDelayer.trigger(async()=>{await n.sendNotification(be.DidChangeWatchedFilesNotification.type,{changes:n._fileEvents}),n._fileEvents=[]})}let s=this.clientOptions.middleware?.workspace;(s?.didChangeWatchedFile?s.didChangeWatchedFile(e,r):r(e)).catch(a=>{n.error("Notify file events failed.",a)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let n=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(n.length===0)return;for(let r of n){let s=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification(be.DidChangeTextDocumentNotification.type,s),this._didChangeTextDocumentFeature.notificationSent(r,be.DidChangeTextDocumentNotification.type,s)}}catch(n){throw this.error("Sending pending changes failed",n,!1),n}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let n=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===n&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,be.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[n,r]=e.value;this._diagnosticQueue.delete(n);let s=new Vt.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:n,tokenSource:s},this._p2c.asDiagnostics(r,s.token).then(a=>{if(!s.token.isCancellationRequested){let c=this._p2c.asUri(n),l=this.clientOptions.middleware;l.handleDiagnostics?l.handleDiagnostics(c,a,(d,f)=>this.setDiagnostics(d,f)):this.setDiagnostics(c,a)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,n){this._diagnostics&&this._diagnostics.set(e,n)}getLocale(){return Vt.env.language}async $start(){if(this.$state===bt.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(s,a,c)=>{this.handleConnectionError(s,a,c).catch(l=>this.error("Handling connection error failed",l))},n=()=>{this.handleConnectionClosed().catch(s=>this.error("Handling connection close failed",s))},r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=k7(r.reader,r.writer,e,n,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===bt.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:ta.DoNotRestart};if(this.$state!==bt.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===ta.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===bt.Starting?this.$state=bt.StartFailed:this.$state=bt.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===ta.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=bt.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(n=>this.error("Restarting server failed",n,"force")))}async handleConnectionError(e,n,r){let s=await this._clientOptions.errorHandler.error(e,n,r);s.action===Zu.Shutdown?(this.error(s.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,s.handled===!0?!1:"force"),this.stop().catch(a=>{this.error("Stopping server failed",a,!1)})):this.error(s.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,s.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(Vt.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,n=!1){let r=Vt.workspace.getConfiguration(this._id),s=be.Trace.Off,a=be.TraceFormat.Text;if(r){let c=r.get("trace.server","off");typeof c=="string"?s=be.Trace.fromString(c):(s=be.Trace.fromString(r.get("trace.server.verbosity","off")),a=be.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=s,this._traceFormat=a,e.trace(this._trace,this._tracer,{sendNotification:n,traceFormat:this._traceFormat}).catch(c=>{this.error("Updating trace failed with error",c,!1)})}hookFileEvents(e){let n=this._clientOptions.synchronize.fileEvents;if(!n)return;let r;Cs.array(n)?r=n:r=[n],r&&this._dynamicFeatures.get(be.DidChangeWatchedFilesNotification.type.method).registerRaw(K$.generateUuid(),r)}registerFeatures(e){for(let n of e)this.registerFeature(n)}registerFeature(e){if(this._features.push(e),Ss.DynamicFeature.is(e)){let n=e.registrationType;this._dynamicFeatures.set(n.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let n=this.getFeature(be.NotebookDocumentSyncRegistrationType.method);return n===void 0||!(n instanceof Z$.NotebookDocumentSyncFeature)?!1:n.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new V$.ConfigurationFeature(this)),this.registerFeature(new al.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new al.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new al.WillSaveFeature(this)),this.registerFeature(new al.WillSaveWaitUntilFeature(this)),this.registerFeature(new al.DidSaveTextDocumentFeature(this)),this.registerFeature(new al.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new f7.FileSystemWatcherFeature(this,n=>this.notifyFileEvent(n))),this.registerFeature(new QH.CompletionItemFeature(this)),this.registerFeature(new e7.HoverFeature(this)),this.registerFeature(new n7.SignatureHelpFeature(this)),this.registerFeature(new t7.DefinitionFeature(this)),this.registerFeature(new o7.ReferencesFeature(this)),this.registerFeature(new r7.DocumentHighlightFeature(this)),this.registerFeature(new i7.DocumentSymbolFeature(this)),this.registerFeature(new s7.WorkspaceSymbolFeature(this)),this.registerFeature(new a7.CodeActionFeature(this)),this.registerFeature(new c7.CodeLensFeature(this)),this.registerFeature(new $0.DocumentFormattingFeature(this)),this.registerFeature(new $0.DocumentRangeFormattingFeature(this)),this.registerFeature(new $0.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new l7.RenameFeature(this)),this.registerFeature(new u7.DocumentLinkFeature(this)),this.registerFeature(new d7.ExecuteCommandFeature(this)),this.registerFeature(new V$.SyncConfigurationFeature(this)),this.registerFeature(new m7.TypeDefinitionFeature(this)),this.registerFeature(new h7.ImplementationFeature(this)),this.registerFeature(new p7.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new g7.WorkspaceFoldersFeature(this)),this.registerFeature(new _7.FoldingRangeFeature(this)),this.registerFeature(new v7.DeclarationFeature(this)),this.registerFeature(new y7.SelectionRangeFeature(this)),this.registerFeature(new w7.ProgressFeature(this)),this.registerFeature(new b7.CallHierarchyFeature(this)),this.registerFeature(new x7.SemanticTokensFeature(this)),this.registerFeature(new T7.LinkedEditingFeature(this)),this.registerFeature(new cl.DidCreateFilesFeature(this)),this.registerFeature(new cl.DidRenameFilesFeature(this)),this.registerFeature(new cl.DidDeleteFilesFeature(this)),this.registerFeature(new cl.WillCreateFilesFeature(this)),this.registerFeature(new cl.WillRenameFilesFeature(this)),this.registerFeature(new cl.WillDeleteFilesFeature(this)),this.registerFeature(new R7.TypeHierarchyFeature(this)),this.registerFeature(new E7.InlineValueFeature(this)),this.registerFeature(new S7.InlayHintsFeature(this)),this.registerFeature(new JH.DiagnosticFeature(this)),this.registerFeature(new Z$.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(M0.createAll(this))}fillInitializeParams(e){for(let n of this._features)Cs.func(n.fillInitializeParams)&&n.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,Ss.ensure)(e,"workspace").applyEdit=!0;let n=(0,Ss.ensure)((0,Ss.ensure)(e,"workspace"),"workspaceEdit");n.documentChanges=!0,n.resourceOperations=[be.ResourceOperationKind.Create,be.ResourceOperationKind.Rename,be.ResourceOperationKind.Delete],n.failureHandling=be.FailureHandlingKind.TextOnlyTransactional,n.normalizesLineEndings=!0,n.changeAnnotationSupport={groupsOnLabel:!0};let r=(0,Ss.ensure)((0,Ss.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[be.DiagnosticTag.Unnecessary,be.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let s=(0,Ss.ensure)(e,"window"),a=(0,Ss.ensure)(s,"showMessage");a.messageActionItem={additionalPropertiesSupport:!0};let c=(0,Ss.ensure)(s,"showDocument");c.support=!0;let l=(0,Ss.ensure)(e,"general");l.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(t.RequestsToCancelOnContentModified)},l.regularExpressions={engine:"ECMAScript",version:"ES2020"},l.markdown={parser:"marked",version:"1.1.0"},l.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(l.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let d of this._features)d.fillClientCapabilities(e);return e}initializeFeatures(e){let n=this._clientOptions.documentSelector;for(let r of this._features)Cs.func(r.preInitialize)&&r.preInitialize(this._capabilities,n);for(let r of this._features)r.initialize(this._capabilities,n)}async handleRegistrationRequest(e){let n=this.clientOptions.middleware?.handleRegisterCapability;return n?n(e,r=>this.doRegisterCapability(r)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(let n of e.registrations)this._ignoredRegistrations.add(n.id);return}for(let n of e.registrations){let r=this._dynamicFeatures.get(n.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${n.method} found. Registration failed.`));let s=n.registerOptions??{};s.documentSelector=s.documentSelector??this._clientOptions.documentSelector;let a={id:n.id,registerOptions:s};try{r.register(a)}catch(c){return Promise.reject(c)}}}async handleUnregistrationRequest(e){let n=this.clientOptions.middleware?.handleUnregisterCapability;return n?n(e,r=>this.doUnregisterCapability(r)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(let n of e.unregisterations){if(this._ignoredRegistrations.has(n.id))continue;let r=this._dynamicFeatures.get(n.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${n.method} found. Unregistration failed.`));r.unregister(n.id)}}async handleApplyWorkspaceEdit(e){let n=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(n)),s=new Map;Vt.workspace.textDocuments.forEach(c=>s.set(c.uri.toString(),c));let a=!1;if(n.documentChanges){for(let c of n.documentChanges)if(be.TextDocumentEdit.is(c)&&c.textDocument.version&&c.textDocument.version>=0){let l=this._p2c.asUri(c.textDocument.uri).toString(),d=s.get(l);if(d&&d.version!==c.textDocument.version){a=!0;break}}}return a?Promise.resolve({applied:!1}):Cs.asPromise(Vt.workspace.applyEdit(r).then(c=>({applied:c})))}handleFailedRequest(e,n,r,s,a=!0){if(r instanceof be.ResponseError){if(r.code===be.ErrorCodes.PendingResponseRejected||r.code===be.ErrorCodes.ConnectionInactive)return s;if(r.code===be.LSPErrorCodes.RequestCancelled||r.code===be.LSPErrorCodes.ServerCancelled){if(n!==void 0&&n.isCancellationRequested)return s;throw r.data!==void 0?new Ss.LSPCancellationError(r.data):new Vt.CancellationError}else if(r.code===be.LSPErrorCodes.ContentModified){if(t.RequestsToCancelOnContentModified.has(e.method)||t.CancellableResolveCalls.has(e.method))throw new Vt.CancellationError;return s}}throw this.error(`Request ${e.method} failed.`,r,a),r}};gr.BaseLanguageClient=Vu;Vu.RequestsToCancelOnContentModified=new Set([be.SemanticTokensRequest.method,be.SemanticTokensRangeRequest.method,be.SemanticTokensDeltaRequest.method]);Vu.CancellableResolveCalls=new Set([be.CompletionResolveRequest.method,be.CodeLensResolveRequest.method,be.CodeActionResolveRequest.method,be.InlayHintResolveRequest.method,be.DocumentLinkResolveRequest.method,be.WorkspaceSymbolResolveRequest.method]);var N0=class{error(e){(0,be.RAL)().console.error(e)}warn(e){(0,be.RAL)().console.warn(e)}info(e){(0,be.RAL)().console.info(e)}log(e){(0,be.RAL)().console.log(e)}};function k7(t,e,n,r,s){let a=new N0,c=(0,be.createProtocolConnection)(t,e,a,s);return c.onError(d=>{n(d[0],d[1],d[2])}),c.onClose(r),{listen:()=>c.listen(),sendRequest:c.sendRequest,onRequest:c.onRequest,hasPendingResponse:c.hasPendingResponse,sendNotification:c.sendNotification,onNotification:c.onNotification,onProgress:c.onProgress,sendProgress:c.sendProgress,trace:(d,f,p)=>{let m={sendNotification:!1,traceFormat:be.TraceFormat.Text};return p===void 0?c.trace(d,f,m):(Cs.boolean(p),c.trace(d,f,p))},initialize:d=>c.sendRequest(be.InitializeRequest.type,d),shutdown:()=>c.sendRequest(be.ShutdownRequest.type,void 0),exit:()=>c.sendNotification(be.ExitNotification.type),end:()=>c.end(),dispose:()=>c.dispose()}}var M0;(function(t){function e(n){return[new C7.InlineCompletionItemFeature(n)]}t.createAll=e})(M0||(gr.ProposedFeatures=M0={}))});var eO=oe(em=>{"use strict";Object.defineProperty(em,"__esModule",{value:!0});em.terminate=void 0;var Q$=require("child_process"),P7=require("path"),A7=process.platform==="win32",D7=process.platform==="darwin",I7=process.platform==="linux";function $7(t,e){if(A7)try{let s={stdio:["pipe","pipe","ignore"]};return e&&(s.cwd=e),Q$.execFileSync("taskkill",["/T","/F","/PID",t.pid.toString()],s),!0}catch{return!1}else if(I7||D7)try{var n=(0,P7.join)(__dirname,"terminateProcess.sh"),r=Q$.spawnSync(n,[t.pid.toString()]);return!r.error}catch{return!1}else return t.kill("SIGKILL"),!0}em.terminate=$7});var L0=oe((one,tO)=>{"use strict";tO.exports=it()});var Yu=oe((ane,nO)=>{"use strict";var O7=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};nO.exports=O7});var tm=oe((cne,rO)=>{"use strict";var F7="2.0.0",N7=Number.MAX_SAFE_INTEGER||9007199254740991,M7=16,q7=250,L7=["major","premajor","minor","preminor","patch","prepatch","prerelease"];rO.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:M7,MAX_SAFE_BUILD_LENGTH:q7,MAX_SAFE_INTEGER:N7,RELEASE_TYPES:L7,SEMVER_SPEC_VERSION:F7,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var nm=oe((js,iO)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:U0,MAX_SAFE_BUILD_LENGTH:U7,MAX_LENGTH:W7}=tm(),H7=Yu();js=iO.exports={};var j7=js.re=[],X7=js.safeRe=[],Ne=js.src=[],B7=js.safeSrc=[],Me=js.t={},G7=0,W0="[a-zA-Z0-9-]",z7=[["\\s",1],["\\d",W7],[W0,U7]],K7=t=>{for(let[e,n]of z7)t=t.split(`${e}*`).join(`${e}{0,${n}}`).split(`${e}+`).join(`${e}{1,${n}}`);return t},dt=(t,e,n)=>{let r=K7(e),s=G7++;H7(t,s,e),Me[t]=s,Ne[s]=e,B7[s]=r,j7[s]=new RegExp(e,n?"g":void 0),X7[s]=new RegExp(r,n?"g":void 0)};dt("NUMERICIDENTIFIER","0|[1-9]\\d*");dt("NUMERICIDENTIFIERLOOSE","\\d+");dt("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${W0}*`);dt("MAINVERSION",`(${Ne[Me.NUMERICIDENTIFIER]})\\.(${Ne[Me.NUMERICIDENTIFIER]})\\.(${Ne[Me.NUMERICIDENTIFIER]})`);dt("MAINVERSIONLOOSE",`(${Ne[Me.NUMERICIDENTIFIERLOOSE]})\\.(${Ne[Me.NUMERICIDENTIFIERLOOSE]})\\.(${Ne[Me.NUMERICIDENTIFIERLOOSE]})`);dt("PRERELEASEIDENTIFIER",`(?:${Ne[Me.NONNUMERICIDENTIFIER]}|${Ne[Me.NUMERICIDENTIFIER]})`);dt("PRERELEASEIDENTIFIERLOOSE",`(?:${Ne[Me.NONNUMERICIDENTIFIER]}|${Ne[Me.NUMERICIDENTIFIERLOOSE]})`);dt("PRERELEASE",`(?:-(${Ne[Me.PRERELEASEIDENTIFIER]}(?:\\.${Ne[Me.PRERELEASEIDENTIFIER]})*))`);dt("PRERELEASELOOSE",`(?:-?(${Ne[Me.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${Ne[Me.PRERELEASEIDENTIFIERLOOSE]})*))`);dt("BUILDIDENTIFIER",`${W0}+`);dt("BUILD",`(?:\\+(${Ne[Me.BUILDIDENTIFIER]}(?:\\.${Ne[Me.BUILDIDENTIFIER]})*))`);dt("FULLPLAIN",`v?${Ne[Me.MAINVERSION]}${Ne[Me.PRERELEASE]}?${Ne[Me.BUILD]}?`);dt("FULL",`^${Ne[Me.FULLPLAIN]}$`);dt("LOOSEPLAIN",`[v=\\s]*${Ne[Me.MAINVERSIONLOOSE]}${Ne[Me.PRERELEASELOOSE]}?${Ne[Me.BUILD]}?`);dt("LOOSE",`^${Ne[Me.LOOSEPLAIN]}$`);dt("GTLT","((?:<|>)?=?)");dt("XRANGEIDENTIFIERLOOSE",`${Ne[Me.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);dt("XRANGEIDENTIFIER",`${Ne[Me.NUMERICIDENTIFIER]}|x|X|\\*`);dt("XRANGEPLAIN",`[v=\\s]*(${Ne[Me.XRANGEIDENTIFIER]})(?:\\.(${Ne[Me.XRANGEIDENTIFIER]})(?:\\.(${Ne[Me.XRANGEIDENTIFIER]})(?:${Ne[Me.PRERELEASE]})?${Ne[Me.BUILD]}?)?)?`);dt("XRANGEPLAINLOOSE",`[v=\\s]*(${Ne[Me.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Ne[Me.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Ne[Me.XRANGEIDENTIFIERLOOSE]})(?:${Ne[Me.PRERELEASELOOSE]})?${Ne[Me.BUILD]}?)?)?`);dt("XRANGE",`^${Ne[Me.GTLT]}\\s*${Ne[Me.XRANGEPLAIN]}$`);dt("XRANGELOOSE",`^${Ne[Me.GTLT]}\\s*${Ne[Me.XRANGEPLAINLOOSE]}$`);dt("COERCEPLAIN",`(^|[^\\d])(\\d{1,${U0}})(?:\\.(\\d{1,${U0}}))?(?:\\.(\\d{1,${U0}}))?`);dt("COERCE",`${Ne[Me.COERCEPLAIN]}(?:$|[^\\d])`);dt("COERCEFULL",Ne[Me.COERCEPLAIN]+`(?:${Ne[Me.PRERELEASE]})?(?:${Ne[Me.BUILD]})?(?:$|[^\\d])`);dt("COERCERTL",Ne[Me.COERCE],!0);dt("COERCERTLFULL",Ne[Me.COERCEFULL],!0);dt("LONETILDE","(?:~>?)");dt("TILDETRIM",`(\\s*)${Ne[Me.LONETILDE]}\\s+`,!0);js.tildeTrimReplace="$1~";dt("TILDE",`^${Ne[Me.LONETILDE]}${Ne[Me.XRANGEPLAIN]}$`);dt("TILDELOOSE",`^${Ne[Me.LONETILDE]}${Ne[Me.XRANGEPLAINLOOSE]}$`);dt("LONECARET","(?:\\^)");dt("CARETTRIM",`(\\s*)${Ne[Me.LONECARET]}\\s+`,!0);js.caretTrimReplace="$1^";dt("CARET",`^${Ne[Me.LONECARET]}${Ne[Me.XRANGEPLAIN]}$`);dt("CARETLOOSE",`^${Ne[Me.LONECARET]}${Ne[Me.XRANGEPLAINLOOSE]}$`);dt("COMPARATORLOOSE",`^${Ne[Me.GTLT]}\\s*(${Ne[Me.LOOSEPLAIN]})$|^$`);dt("COMPARATOR",`^${Ne[Me.GTLT]}\\s*(${Ne[Me.FULLPLAIN]})$|^$`);dt("COMPARATORTRIM",`(\\s*)${Ne[Me.GTLT]}\\s*(${Ne[Me.LOOSEPLAIN]}|${Ne[Me.XRANGEPLAIN]})`,!0);js.comparatorTrimReplace="$1$2$3";dt("HYPHENRANGE",`^\\s*(${Ne[Me.XRANGEPLAIN]})\\s+-\\s+(${Ne[Me.XRANGEPLAIN]})\\s*$`);dt("HYPHENRANGELOOSE",`^\\s*(${Ne[Me.XRANGEPLAINLOOSE]})\\s+-\\s+(${Ne[Me.XRANGEPLAINLOOSE]})\\s*$`);dt("STAR","(<|>)?=?\\s*\\*");dt("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");dt("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var rm=oe((lne,sO)=>{"use strict";var Z7=Object.freeze({loose:!0}),V7=Object.freeze({}),Y7=t=>t?typeof t!="object"?Z7:t:V7;sO.exports=Y7});var lO=oe((une,cO)=>{"use strict";var oO=/^[0-9]+$/,aO=(t,e)=>{if(typeof t=="number"&&typeof e=="number")return t===e?0:t<e?-1:1;let n=oO.test(t),r=oO.test(e);return n&&r&&(t=+t,e=+e),t===e?0:n&&!r?-1:r&&!n?1:t<e?-1:1},J7=(t,e)=>aO(e,t);cO.exports={compareIdentifiers:aO,rcompareIdentifiers:J7}});var Ju=oe((dne,dO)=>{"use strict";var im=Yu(),{MAX_LENGTH:uO,MAX_SAFE_INTEGER:sm}=tm(),{safeRe:om,t:am}=nm(),Q7=rm(),{compareIdentifiers:H0}=lO(),j0=class t{constructor(e,n){if(n=Q7(n),e instanceof t){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>uO)throw new TypeError(`version is longer than ${uO} characters`);im("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;let r=e.trim().match(n.loose?om[am.LOOSE]:om[am.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>sm||this.major<0)throw new TypeError("Invalid major version");if(this.minor>sm||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>sm||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){let a=+s;if(a>=0&&a<sm)return a}return s}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(im("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let n=0;do{let r=this.prerelease[n],s=e.prerelease[n];if(im("prerelease compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r===s)continue;return H0(r,s)}while(++n)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let n=0;do{let r=this.build[n],s=e.build[n];if(im("build compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r===s)continue;return H0(r,s)}while(++n)}inc(e,n,r){if(e.startsWith("pre")){if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(n){let s=`-${n}`.match(this.options.loose?om[am.PRERELEASELOOSE]:om[am.PRERELEASE]);if(!s||s[1]!==n)throw new Error(`invalid identifier: ${n}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let s=Number(r)?1:0;if(this.prerelease.length===0)this.prerelease=[s];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(n){let a=[n,s];r===!1&&(a=[n]),H0(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};dO.exports=j0});var hO=oe((fne,pO)=>{"use strict";var fO=Ju(),ej=(t,e,n=!1)=>{if(t instanceof fO)return t;try{return new fO(t,e)}catch(r){if(!n)return null;throw r}};pO.exports=ej});var gO=oe((pne,mO)=>{"use strict";var X0=class{constructor(){this.max=1e3,this.map=new Map}get(e){let n=this.map.get(e);if(n!==void 0)return this.map.delete(e),this.map.set(e,n),n}delete(e){return this.map.delete(e)}set(e,n){if(!this.delete(e)&&n!==void 0){if(this.map.size>=this.max){let s=this.map.keys().next().value;this.delete(s)}this.map.set(e,n)}return this}};mO.exports=X0});var Ha=oe((hne,vO)=>{"use strict";var _O=Ju(),tj=(t,e,n)=>new _O(t,n).compare(new _O(e,n));vO.exports=tj});var wO=oe((mne,yO)=>{"use strict";var nj=Ha(),rj=(t,e,n)=>nj(t,e,n)===0;yO.exports=rj});var xO=oe((gne,bO)=>{"use strict";var ij=Ha(),sj=(t,e,n)=>ij(t,e,n)!==0;bO.exports=sj});var RO=oe((_ne,TO)=>{"use strict";var oj=Ha(),aj=(t,e,n)=>oj(t,e,n)>0;TO.exports=aj});var SO=oe((vne,EO)=>{"use strict";var cj=Ha(),lj=(t,e,n)=>cj(t,e,n)>=0;EO.exports=lj});var kO=oe((yne,CO)=>{"use strict";var uj=Ha(),dj=(t,e,n)=>uj(t,e,n)<0;CO.exports=dj});var AO=oe((wne,PO)=>{"use strict";var fj=Ha(),pj=(t,e,n)=>fj(t,e,n)<=0;PO.exports=pj});var IO=oe((bne,DO)=>{"use strict";var hj=wO(),mj=xO(),gj=RO(),_j=SO(),vj=kO(),yj=AO(),wj=(t,e,n,r)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t===n;case"!==":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t!==n;case"":case"=":case"==":return hj(t,n,r);case"!=":return mj(t,n,r);case">":return gj(t,n,r);case">=":return _j(t,n,r);case"<":return vj(t,n,r);case"<=":return yj(t,n,r);default:throw new TypeError(`Invalid operator: ${e}`)}};DO.exports=wj});var LO=oe((xne,qO)=>{"use strict";var Qu=Symbol("SemVer ANY"),z0=class t{static get ANY(){return Qu}constructor(e,n){if(n=$O(n),e instanceof t){if(e.loose===!!n.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),G0("comparator",e,n),this.options=n,this.loose=!!n.loose,this.parse(e),this.semver===Qu?this.value="":this.value=this.operator+this.semver.version,G0("comp",this)}parse(e){let n=this.options.loose?OO[FO.COMPARATORLOOSE]:OO[FO.COMPARATOR],r=e.match(n);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new NO(r[2],this.options.loose):this.semver=Qu}toString(){return this.value}test(e){if(G0("Comparator.test",e,this.options.loose),this.semver===Qu||e===Qu)return!0;if(typeof e=="string")try{e=new NO(e,this.options)}catch{return!1}return B0(e,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new MO(e.value,n).test(this.value):e.operator===""?e.value===""?!0:new MO(this.value,n).test(e.semver):(n=$O(n),n.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!n.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||B0(this.semver,"<",e.semver,n)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||B0(this.semver,">",e.semver,n)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};qO.exports=z0;var $O=rm(),{safeRe:OO,t:FO}=nm(),B0=IO(),G0=Yu(),NO=Ju(),MO=K0()});var K0=oe((Tne,jO)=>{"use strict";var bj=/\s+/g,Z0=class t{constructor(e,n){if(n=Tj(n),e instanceof t)return e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease?e:new t(e.raw,n);if(e instanceof V0)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=e.trim().replace(bj," "),this.set=this.raw.split("||").map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(s=>!WO(s[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let s of this.set)if(s.length===1&&Aj(s[0])){this.set=[s];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let n=this.set[e];for(let r=0;r<n.length;r++)r>0&&(this.formatted+=" "),this.formatted+=n[r].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let r=((this.options.includePrerelease&&kj)|(this.options.loose&&Pj))+":"+e,s=UO.get(r);if(s)return s;let a=this.options.loose,c=a?ei[Lr.HYPHENRANGELOOSE]:ei[Lr.HYPHENRANGE];e=e.replace(c,Uj(this.options.includePrerelease)),bn("hyphen replace",e),e=e.replace(ei[Lr.COMPARATORTRIM],Ej),bn("comparator trim",e),e=e.replace(ei[Lr.TILDETRIM],Sj),bn("tilde trim",e),e=e.replace(ei[Lr.CARETTRIM],Cj),bn("caret trim",e);let l=e.split(" ").map(m=>Dj(m,this.options)).join(" ").split(/\s+/).map(m=>Lj(m,this.options));a&&(l=l.filter(m=>(bn("loose invalid filter",m,this.options),!!m.match(ei[Lr.COMPARATORLOOSE])))),bn("range list",l);let d=new Map,f=l.map(m=>new V0(m,this.options));for(let m of f){if(WO(m))return[m];d.set(m.value,m)}d.size>1&&d.has("")&&d.delete("");let p=[...d.values()];return UO.set(r,p),p}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(r=>HO(r,n)&&e.set.some(s=>HO(s,n)&&r.every(a=>s.every(c=>a.intersects(c,n)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new Rj(e,this.options)}catch{return!1}for(let n=0;n<this.set.length;n++)if(Wj(this.set[n],e,this.options))return!0;return!1}};jO.exports=Z0;var xj=gO(),UO=new xj,Tj=rm(),V0=LO(),bn=Yu(),Rj=Ju(),{safeRe:ei,t:Lr,comparatorTrimReplace:Ej,tildeTrimReplace:Sj,caretTrimReplace:Cj}=nm(),{FLAG_INCLUDE_PRERELEASE:kj,FLAG_LOOSE:Pj}=tm(),WO=t=>t.value==="<0.0.0-0",Aj=t=>t.value==="",HO=(t,e)=>{let n=!0,r=t.slice(),s=r.pop();for(;n&&r.length;)n=r.every(a=>s.intersects(a,e)),s=r.pop();return n},Dj=(t,e)=>(t=t.replace(ei[Lr.BUILD],""),bn("comp",t,e),t=Oj(t,e),bn("caret",t),t=Ij(t,e),bn("tildes",t),t=Nj(t,e),bn("xrange",t),t=qj(t,e),bn("stars",t),t),ti=t=>!t||t.toLowerCase()==="x"||t==="*",Ij=(t,e)=>t.trim().split(/\s+/).map(n=>$j(n,e)).join(" "),$j=(t,e)=>{let n=e.loose?ei[Lr.TILDELOOSE]:ei[Lr.TILDE];return t.replace(n,(r,s,a,c,l)=>{bn("tilde",t,r,s,a,c,l);let d;return ti(s)?d="":ti(a)?d=`>=${s}.0.0 <${+s+1}.0.0-0`:ti(c)?d=`>=${s}.${a}.0 <${s}.${+a+1}.0-0`:l?(bn("replaceTilde pr",l),d=`>=${s}.${a}.${c}-${l} <${s}.${+a+1}.0-0`):d=`>=${s}.${a}.${c} <${s}.${+a+1}.0-0`,bn("tilde return",d),d})},Oj=(t,e)=>t.trim().split(/\s+/).map(n=>Fj(n,e)).join(" "),Fj=(t,e)=>{bn("caret",t,e);let n=e.loose?ei[Lr.CARETLOOSE]:ei[Lr.CARET],r=e.includePrerelease?"-0":"";return t.replace(n,(s,a,c,l,d)=>{bn("caret",t,s,a,c,l,d);let f;return ti(a)?f="":ti(c)?f=`>=${a}.0.0${r} <${+a+1}.0.0-0`:ti(l)?a==="0"?f=`>=${a}.${c}.0${r} <${a}.${+c+1}.0-0`:f=`>=${a}.${c}.0${r} <${+a+1}.0.0-0`:d?(bn("replaceCaret pr",d),a==="0"?c==="0"?f=`>=${a}.${c}.${l}-${d} <${a}.${c}.${+l+1}-0`:f=`>=${a}.${c}.${l}-${d} <${a}.${+c+1}.0-0`:f=`>=${a}.${c}.${l}-${d} <${+a+1}.0.0-0`):(bn("no pr"),a==="0"?c==="0"?f=`>=${a}.${c}.${l}${r} <${a}.${c}.${+l+1}-0`:f=`>=${a}.${c}.${l}${r} <${a}.${+c+1}.0-0`:f=`>=${a}.${c}.${l} <${+a+1}.0.0-0`),bn("caret return",f),f})},Nj=(t,e)=>(bn("replaceXRanges",t,e),t.split(/\s+/).map(n=>Mj(n,e)).join(" ")),Mj=(t,e)=>{t=t.trim();let n=e.loose?ei[Lr.XRANGELOOSE]:ei[Lr.XRANGE];return t.replace(n,(r,s,a,c,l,d)=>{bn("xRange",t,r,s,a,c,l,d);let f=ti(a),p=f||ti(c),m=p||ti(l),g=m;return s==="="&&g&&(s=""),d=e.includePrerelease?"-0":"",f?s===">"||s==="<"?r="<0.0.0-0":r="*":s&&g?(p&&(c=0),l=0,s===">"?(s=">=",p?(a=+a+1,c=0,l=0):(c=+c+1,l=0)):s==="<="&&(s="<",p?a=+a+1:c=+c+1),s==="<"&&(d="-0"),r=`${s+a}.${c}.${l}${d}`):p?r=`>=${a}.0.0${d} <${+a+1}.0.0-0`:m&&(r=`>=${a}.${c}.0${d} <${a}.${+c+1}.0-0`),bn("xRange return",r),r})},qj=(t,e)=>(bn("replaceStars",t,e),t.trim().replace(ei[Lr.STAR],"")),Lj=(t,e)=>(bn("replaceGTE0",t,e),t.trim().replace(ei[e.includePrerelease?Lr.GTE0PRE:Lr.GTE0],"")),Uj=t=>(e,n,r,s,a,c,l,d,f,p,m,g)=>(ti(r)?n="":ti(s)?n=`>=${r}.0.0${t?"-0":""}`:ti(a)?n=`>=${r}.${s}.0${t?"-0":""}`:c?n=`>=${n}`:n=`>=${n}${t?"-0":""}`,ti(f)?d="":ti(p)?d=`<${+f+1}.0.0-0`:ti(m)?d=`<${f}.${+p+1}.0-0`:g?d=`<=${f}.${p}.${m}-${g}`:t?d=`<${f}.${p}.${+m+1}-0`:d=`<=${d}`,`${n} ${d}`.trim()),Wj=(t,e,n)=>{for(let r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let r=0;r<t.length;r++)if(bn(t[r].semver),t[r].semver!==V0.ANY&&t[r].semver.prerelease.length>0){let s=t[r].semver;if(s.major===e.major&&s.minor===e.minor&&s.patch===e.patch)return!0}return!1}return!0}});var BO=oe((Rne,XO)=>{"use strict";var Hj=K0(),jj=(t,e,n)=>{try{e=new Hj(e,n)}catch{return!1}return e.test(t)};XO.exports=jj});var zO=oe(qi=>{"use strict";var Xj=qi&&qi.__createBinding||(Object.create?(function(t,e,n,r){r===void 0&&(r=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,s)}):(function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]})),Y0=qi&&qi.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Xj(e,t,n)};Object.defineProperty(qi,"__esModule",{value:!0});qi.DiagnosticPullMode=qi.vsdiag=void 0;Y0(it(),qi);Y0(Ft(),qi);var GO=rb();Object.defineProperty(qi,"vsdiag",{enumerable:!0,get:function(){return GO.vsdiag}});Object.defineProperty(qi,"DiagnosticPullMode",{enumerable:!0,get:function(){return GO.DiagnosticPullMode}});Y0(q0(),qi)});var YO=oe(gi=>{"use strict";var Bj=gi&&gi.__createBinding||(Object.create?(function(t,e,n,r){r===void 0&&(r=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,s)}):(function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]})),VO=gi&&gi.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Bj(e,t,n)};Object.defineProperty(gi,"__esModule",{value:!0});gi.SettingMonitor=gi.LanguageClient=gi.TransportKind=void 0;var go=require("child_process"),J0=require("fs"),Q0=require("path"),ra=require("vscode"),An=es(),KO=q0(),Gj=eO(),qn=L0(),zj=hO(),Kj=BO();VO(L0(),gi);VO(zO(),gi);var ZO="^1.82.0",Ln;(function(t){t[t.stdio=0]="stdio",t[t.ipc=1]="ipc",t[t.pipe=2]="pipe",t[t.socket=3]="socket"})(Ln||(gi.TransportKind=Ln={}));var na;(function(t){function e(n){let r=n;return r&&r.kind===Ln.socket&&An.number(r.port)}t.isSocket=e})(na||(na={}));var ex;(function(t){function e(n){return An.string(n.command)}t.is=e})(ex||(ex={}));var tx;(function(t){function e(n){return An.string(n.module)}t.is=e})(tx||(tx={}));var nx;(function(t){function e(n){let r=n;return r&&r.writer!==void 0&&r.reader!==void 0}t.is=e})(nx||(nx={}));var rx;(function(t){function e(n){let r=n;return r&&r.process!==void 0&&typeof r.detached=="boolean"}t.is=e})(rx||(rx={}));var ix=class extends KO.BaseLanguageClient{constructor(e,n,r,s,a){let c,l,d,f,p;An.string(n)?(c=e,l=n,d=r,f=s,p=!!a):(c=e.toLowerCase(),l=e,d=n,f=r,p=s),p===void 0&&(p=!1),super(c,l,f),this._serverOptions=d,this._forceDebug=p,this._isInDebugMode=p;try{this.checkVersion()}catch(m){throw An.string(m.message)&&this.outputChannel.appendLine(m.message),m}}checkVersion(){let e=zj(ra.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${ra.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!Kj(e,ZO))throw new Error(`The language client requires VS Code version ${ZO} but received version ${ra.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),await this.start()):await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let n=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(n),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,Gj.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function n(p,m){if(!p&&!m)return;let g=Object.create(null);return Object.keys(process.env).forEach(w=>g[w]=process.env[w]),m&&(g.ELECTRON_RUN_AS_NODE="1",g.ELECTRON_NO_ASAR="1"),p&&Object.keys(p).forEach(w=>g[w]=p[w]),g}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],s=["--debug","--debug-brk","--inspect","--inspect-brk"];function a(){let p=process.execArgv;return p?p.some(m=>r.some(g=>m.startsWith(g))||s.some(g=>m===g)):!1}function c(p){if(p.stdin===null||p.stdout===null||p.stderr===null)throw new Error("Process created without stdio streams")}let l=this._serverOptions;if(An.func(l))return l().then(p=>{if(KO.MessageTransports.is(p))return this._isDetached=!!p.detached,p;if(nx.is(p))return this._isDetached=!!p.detached,{reader:new qn.StreamMessageReader(p.reader),writer:new qn.StreamMessageWriter(p.writer)};{let m;return rx.is(p)?(m=p.process,this._isDetached=p.detached):(m=p,this._isDetached=!1),m.stderr.on("data",g=>this.outputChannel.append(An.string(g)?g:g.toString(e))),{reader:new qn.StreamMessageReader(m.stdout),writer:new qn.StreamMessageWriter(m.stdin)}}});let d,f=l;return f.run||f.debug?this._forceDebug||a()?(d=f.debug,this._isInDebugMode=!0):(d=f.run,this._isInDebugMode=!1):d=l,this._getServerWorkingDir(d.options).then(p=>{if(tx.is(d)&&d.module){let m=d,g=m.transport||Ln.stdio;if(m.runtime){let w=[],v=m.options??Object.create(null);v.execArgv&&v.execArgv.forEach(k=>w.push(k)),w.push(m.module),m.args&&m.args.forEach(k=>w.push(k));let x=Object.create(null);x.cwd=p,x.env=n(v.env,!1);let b=this._getRuntimePath(m.runtime,p),S;if(g===Ln.ipc?(x.stdio=[null,null,null,"ipc"],w.push("--node-ipc")):g===Ln.stdio?w.push("--stdio"):g===Ln.pipe?(S=(0,qn.generateRandomPipeName)(),w.push(`--pipe=${S}`)):na.isSocket(g)&&w.push(`--socket=${g.port}`),w.push(`--clientProcessId=${process.pid.toString()}`),g===Ln.ipc||g===Ln.stdio){let k=go.spawn(b,w,x);return!k||!k.pid?ll(k,`Launching server using runtime ${b} failed.`):(this._serverProcess=k,k.stderr.on("data",$=>this.outputChannel.append(An.string($)?$:$.toString(e))),g===Ln.ipc?(k.stdout.on("data",$=>this.outputChannel.append(An.string($)?$:$.toString(e))),Promise.resolve({reader:new qn.IPCMessageReader(k),writer:new qn.IPCMessageWriter(k)})):Promise.resolve({reader:new qn.StreamMessageReader(k.stdout),writer:new qn.StreamMessageWriter(k.stdin)}))}else{if(g===Ln.pipe)return(0,qn.createClientPipeTransport)(S).then(k=>{let $=go.spawn(b,w,x);return!$||!$.pid?ll($,`Launching server using runtime ${b} failed.`):(this._serverProcess=$,$.stderr.on("data",F=>this.outputChannel.append(An.string(F)?F:F.toString(e))),$.stdout.on("data",F=>this.outputChannel.append(An.string(F)?F:F.toString(e))),k.onConnected().then(F=>({reader:F[0],writer:F[1]})))});if(na.isSocket(g))return(0,qn.createClientSocketTransport)(g.port).then(k=>{let $=go.spawn(b,w,x);return!$||!$.pid?ll($,`Launching server using runtime ${b} failed.`):(this._serverProcess=$,$.stderr.on("data",F=>this.outputChannel.append(An.string(F)?F:F.toString(e))),$.stdout.on("data",F=>this.outputChannel.append(An.string(F)?F:F.toString(e))),k.onConnected().then(F=>({reader:F[0],writer:F[1]})))})}}else{let w;return new Promise((v,x)=>{let b=(m.args&&m.args.slice())??[];g===Ln.ipc?b.push("--node-ipc"):g===Ln.stdio?b.push("--stdio"):g===Ln.pipe?(w=(0,qn.generateRandomPipeName)(),b.push(`--pipe=${w}`)):na.isSocket(g)&&b.push(`--socket=${g.port}`),b.push(`--clientProcessId=${process.pid.toString()}`);let S=m.options??Object.create(null);if(S.env=n(S.env,!0),S.execArgv=S.execArgv||[],S.cwd=p,S.silent=!0,g===Ln.ipc||g===Ln.stdio){let k=go.fork(m.module,b||[],S);c(k),this._serverProcess=k,k.stderr.on("data",$=>this.outputChannel.append(An.string($)?$:$.toString(e))),g===Ln.ipc?(k.stdout.on("data",$=>this.outputChannel.append(An.string($)?$:$.toString(e))),v({reader:new qn.IPCMessageReader(this._serverProcess),writer:new qn.IPCMessageWriter(this._serverProcess)})):v({reader:new qn.StreamMessageReader(k.stdout),writer:new qn.StreamMessageWriter(k.stdin)})}else g===Ln.pipe?(0,qn.createClientPipeTransport)(w).then(k=>{let $=go.fork(m.module,b||[],S);c($),this._serverProcess=$,$.stderr.on("data",F=>this.outputChannel.append(An.string(F)?F:F.toString(e))),$.stdout.on("data",F=>this.outputChannel.append(An.string(F)?F:F.toString(e))),k.onConnected().then(F=>{v({reader:F[0],writer:F[1]})},x)},x):na.isSocket(g)&&(0,qn.createClientSocketTransport)(g.port).then(k=>{let $=go.fork(m.module,b||[],S);c($),this._serverProcess=$,$.stderr.on("data",F=>this.outputChannel.append(An.string(F)?F:F.toString(e))),$.stdout.on("data",F=>this.outputChannel.append(An.string(F)?F:F.toString(e))),k.onConnected().then(F=>{v({reader:F[0],writer:F[1]})},x)},x)})}}else if(ex.is(d)&&d.command){let m=d,g=d.args!==void 0?d.args.slice(0):[],w,v=d.transport;if(v===Ln.stdio)g.push("--stdio");else if(v===Ln.pipe)w=(0,qn.generateRandomPipeName)(),g.push(`--pipe=${w}`);else if(na.isSocket(v))g.push(`--socket=${v.port}`);else if(v===Ln.ipc)throw new Error("Transport kind ipc is not support for command executable");let x=Object.assign({},m.options);if(x.cwd=x.cwd||p,v===void 0||v===Ln.stdio){let b=go.spawn(m.command,g,x);return!b||!b.pid?ll(b,`Launching server using command ${m.command} failed.`):(b.stderr.on("data",S=>this.outputChannel.append(An.string(S)?S:S.toString(e))),this._serverProcess=b,this._isDetached=!!x.detached,Promise.resolve({reader:new qn.StreamMessageReader(b.stdout),writer:new qn.StreamMessageWriter(b.stdin)}))}else{if(v===Ln.pipe)return(0,qn.createClientPipeTransport)(w).then(b=>{let S=go.spawn(m.command,g,x);return!S||!S.pid?ll(S,`Launching server using command ${m.command} failed.`):(this._serverProcess=S,this._isDetached=!!x.detached,S.stderr.on("data",k=>this.outputChannel.append(An.string(k)?k:k.toString(e))),S.stdout.on("data",k=>this.outputChannel.append(An.string(k)?k:k.toString(e))),b.onConnected().then(k=>({reader:k[0],writer:k[1]})))});if(na.isSocket(v))return(0,qn.createClientSocketTransport)(v.port).then(b=>{let S=go.spawn(m.command,g,x);return!S||!S.pid?ll(S,`Launching server using command ${m.command} failed.`):(this._serverProcess=S,this._isDetached=!!x.detached,S.stderr.on("data",k=>this.outputChannel.append(An.string(k)?k:k.toString(e))),S.stdout.on("data",k=>this.outputChannel.append(An.string(k)?k:k.toString(e))),b.onConnected().then(k=>({reader:k[0],writer:k[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(l,null,4)))}).finally(()=>{this._serverProcess!==void 0&&this._serverProcess.on("exit",(p,m)=>{p!==null&&this.error(`Server process exited with code ${p}.`,void 0,!1),m!==null&&this.error(`Server process exited with signal ${m}.`,void 0,!1)})})}_getRuntimePath(e,n){if(Q0.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let s=Q0.join(r,e);if(J0.existsSync(s))return s}if(n!==void 0){let s=Q0.join(n,e);if(J0.existsSync(s))return s}return e}_mainGetRootPath(){let e=ra.workspace.workspaceFolders;if(!e||e.length===0)return;let n=e[0];if(n.uri.scheme==="file")return n.uri.fsPath}_getServerWorkingDir(e){let n=e&&e.cwd;return n||(n=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),n?new Promise(r=>{J0.lstat(n,(s,a)=>{r(!s&&a.isDirectory()?n:void 0)})}):Promise.resolve(void 0)}};gi.LanguageClient=ix;var sx=class{constructor(e,n){this._client=e,this._setting=n,this._listeners=[]}start(){return ra.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new ra.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),n=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,s=r?ra.workspace.getConfiguration(n).get(r,!1):ra.workspace.getConfiguration(n);s&&this._client.needsStart()?this._client.start().catch(a=>this._client.error("Start failed after configuration change",a,"force")):!s&&this._client.needsStop()&&this._client.stop().catch(a=>this._client.error("Stop failed after configuration change",a,"force"))}};gi.SettingMonitor=sx;function ll(t,e){return t===null?Promise.reject(e):new Promise((n,r)=>{t.on("error",s=>{r(`${e} ${s}`)}),setImmediate(()=>r(e))})}});var QO=oe((Cne,JO)=>{"use strict";JO.exports=YO()});var eX={};_U(eX,{activate:()=>Jj,deactivate:()=>Qj});module.exports=vU(eX);var mx=we(require("vscode"));var Br=we(require("vscode"));var en=we(require("vscode"));var Vn=we(require("vscode")),UR=require("crypto"),WR=require("path");async function xg(t){try{let e=typeof t=="string"?Vn.Uri.file(t):t;return await Vn.workspace.fs.stat(e)}catch{return!1}}async function kl(t){let e=typeof t=="string"?Vn.Uri.file(t):t;return Vn.workspace.fs.stat(e)}async function Tg(t){return(await kl(t)).type===Vn.FileType.Directory}async function Yn(t){let e=typeof t=="string"?Vn.Uri.file(t):t;return Vn.workspace.fs.createDirectory(e)}async function Rg(t){let e=typeof t=="string"?Vn.Uri.file(t):t;return(await Vn.workspace.fs.readDirectory(e)).map(r=>r[0])}async function Pr(t,e){let n=typeof t=="string"?Vn.Uri.file(t):t,r=typeof e=="string"?Buffer.from(e):e;await Vn.workspace.fs.writeFile(n,r)}async function Ds(t,e="utf8"){let n=typeof t=="string"?Vn.Uri.file(t):t,r=await Vn.workspace.fs.readFile(n);return Buffer.from(r).toString(e)}async function Gd(t){let e=typeof t=="string"?Vn.Uri.file(t):t;return await Vn.workspace.fs.delete(e)}function ds(t){let e=(0,UR.createHash)("sha256");return e.update(t),e.digest("hex")}function HR(...t){let e=Vn.workspace.workspaceFolders;if(!e)throw new Error("No workspace folders found, please open a workspace");return Vn.Uri.file((0,WR.join)(e[0].uri.fsPath,...t))}var Zi=we(mn());var jR=we(require("vscode")),kg=require("path");var ic=require("fs"),Dl=require("path"),zd=we(require("vscode")),Eg=zd.workspace.workspaceFolders,ge=Eg&&Eg.length?Eg[0].uri.fsPath:"",Kd=(0,Dl.join)(ge,".xano"),Zd=(0,Dl.join)(Kd,"objects.json"),Il=(0,Dl.join)(Kd,"stash.json"),Sg=(0,Dl.join)(Kd,"config.json"),Al={instanceName:"",workspaceId:0,branch:"",paths:{functions:"functions",tables:"tables",apis:"apis",tasks:"tasks",tools:"tools",workflowTests:"workflow_tests",agents:"agents",agentTriggers:"agents/triggers",mcpServers:"mcp_servers",mcpServerTriggers:"mcp_servers/triggers",tableTriggers:"tables/triggers",addOns:"addons",middlewares:"middlewares",realtimeChannels:"realtime",realtimeTriggers:"realtime/triggers"}},Cg=class{constructor(){this.__config={...Al};this.__change_callback=[];this.hasUnsavedChanges=!1;this.load()}load(){try{let e=(0,ic.readFileSync)(Sg,"utf8"),n=JSON.parse(e);this.__config={...Al,...n,paths:{...Al.paths,...n.paths||{}}}}catch{console.error(`Could not read Xano config from ${Sg}, using default config`)}}onChange(e,n=!1){return this.__change_callback.push(e),n&&this.safeFireCallback(e),new zd.Disposable(()=>{this.__change_callback=this.__change_callback.filter(r=>r!==e)})}fireChange(){this.__change_callback.forEach(e=>this.safeFireCallback(e))}safeFireCallback(e){try{e(this)}catch(n){console.error("Error in config change callback",n)}}async save(){(0,ic.mkdirSync)(Kd,{recursive:!0}),(0,ic.writeFileSync)(Sg,Buffer.from(JSON.stringify({instanceName:this.__config.instanceName,workspaceId:this.__config.workspaceId,branch:this.__config.branch,paths:{functions:this.__config.paths.functions,tables:this.__config.paths.tables,apis:this.__config.paths.apis,tasks:this.__config.paths.tasks}},null,2))),this.hasUnsavedChanges=!1}get instanceName(){return this.__config.instanceName}set instanceName(e){e!==this.__config.instanceName&&(console.log("setting instanceName",e),this.__config.workspaceId=Al.workspaceId,this.__config.branch=Al.branch,this.__config.instanceName=e,this.hasUnsavedChanges=!0,this.fireChange())}isXanoManagedPath(e){return Object.values(this.__config.paths).some(n=>e.startsWith(n+"/"))}get workspaceId(){return this.__config.workspaceId}set workspaceId(e){e!==this.__config.workspaceId&&(console.log("setting workspaceId",e),this.__config.branch="",this.__config.workspaceId=e,this.hasUnsavedChanges=!0),this.fireChange()}get branch(){return this.__config.branch}set branch(e){e!==this.__config.branch&&(console.log("setting branch",e),this.__config.branch=e,this.hasUnsavedChanges=!0,this.fireChange())}get paths(){return this.__config.paths}set paths(e){this.__config.paths=e,this.fireChange()}get isReady(){return!!(this.__config.workspaceId&&this.__config.instanceName&&this.__config.branch)}},A=new Cg;var Vd=null;async function Ht(){return Vd||oc()}async function oc(){if(A?.isReady)try{let t=await Ds(Zd),e=JSON.parse(t.toString());return Vd=e,e}catch(t){return t instanceof jR.FileSystemError&&t.code==="ENOENT"?(await Pr(Zd,JSON.stringify([])),[]):[]}else return console.error("readRegistry(): Xano extension has not been initialized in your current workspace"),[]}async function gn(t){if(A.isReady)try{let e=JSON.stringify(t,null,2);await Pr(Zd,e),Vd=t}catch(e){console.error("saveRegistry(): Error writing registry file",e);return}else throw new Error("saveRegistry(): Xano extension has not been initialized in your current workspace")}async function yU(t){return t.endsWith(".xs")?t.startsWith(A.paths.functions)?"function":t.startsWith(A.paths.tableTriggers)?"table_trigger":t.startsWith(A.paths.tables)?"table":t.startsWith(A.paths.apis)?t.endsWith("api_group.xs")?"api_group":"api_endpoint":t.startsWith(A.paths.tasks)?"task":t.startsWith(A.paths.tools)?"tool":t.startsWith(A.paths.workflowTests)?"workflow_test":t.startsWith(A.paths.agentTriggers)?"agent_trigger":t.startsWith(A.paths.agents)?"agent":t.startsWith(A.paths.mcpServerTriggers)?"mcp_server_trigger":t.startsWith(A.paths.mcpServers)?"mcp_server":t.startsWith(A.paths.addOns)?"add_on":t.startsWith(A.paths.middlewares)?"middleware":t.startsWith(A.paths.realtimeTriggers)?"realtime_trigger":t.startsWith(A.paths.realtimeChannels)?"realtime_channel":"unknown":"unknown"}async function wU(t){try{return await kl((0,kg.join)(ge,t)),!0}catch(e){return console.error("pathExists(): Error checking if file exists",e),!1}}async function ac(t){try{return await Ds((0,kg.join)(ge,t))}catch(e){return console.error("fileContent(): Error reading file content",e),""}}async function nn(t){let e=await oc();for(let n of t)console.log("Scanning file: ",n),e=await On(e,n);return await gn(e),e}async function On(t,e){let n=t.findIndex(s=>e===s.path),r=t[n];if(r){let s=await wU(e);if(r.status==="new"&&!s)return t.splice(n,1),t;if(s){let a=await ac(e),c=ds(a.toString());return r.id===0?(r.status="new",t):c!==r.sha256?(r.status="changed",t):(r.status="unchanged",r.staged=!1,t)}else return r.id===0?(t.splice(n,1),t):(r.status="notfound",t)}else{let s={id:0,path:e,status:"new",type:await yU(e),staged:!1};return t.push(s),t}}function ma(t,e,n){let r=t.findIndex(a=>e===a.path),s=t[r];return s&&Object.assign(s,n),t}function Pg(t,e){let n=t.findIndex(s=>e===s.path);return t[n]&&t.splice(n,1),t}function fs(t,e){let n=t.findIndex(r=>e===r.path);return t[n]}function bU(t){let e=t.split(`
`)[0]?.trim();if(!e)return null;let n=/^(api_group|table|function|api|task|tool|agent|query|middleware|add_on|workflow_test|table_trigger|agent_trigger|mcp_server|mcp_server_trigger|realtime_trigger|realtime_channel)\s+(?:"([^"]+)"|([^\s({]+))/,r=e.match(n);return r&&(r[2]||r[3])||null}async function eo(){let t=await Ht(),e={};for(let n of t){if(n.type==="unknown"||n.status==="notfound")continue;let r=n.type;e[r]||(e[r]=[]);try{let s=await ac(n.path),a=bU(s);a&&e[r].push({path:n.path,name:a,input:{}})}catch(s){console.error(`getRegistryIndex(): Error reading file ${n.path}`,s)}}return e}var Ag=class{constructor(){this.contents=new Map}updateContent(e,n){this.contents.set(e,n)}provideTextDocumentContent(e){let n=e.path;return this.contents.get(n)||""}},Yd=new Ag;var Dg=class{constructor(){this._onDidChangeTreeData=new en.EventEmitter;this.onDidChangeTreeData=this._onDidChangeTreeData.event;this.changes={staged:[],changed:[]};this.refresh()}refresh(){this.getChangedRecord().then(e=>{this.changes=e,this._onDidChangeTreeData.fire()})}getChild([e,n,r,s,a]){return n===en.FileType.Directory?new Jd(e):new Ig(e,r,s,a)}async getChildren(e){if(!A.isReady)return[];if(!e)return(0,Zi.map)([["staged",en.FileType.Directory,!0,"unknown","unchanged"],["changed",en.FileType.Directory,!1,"unknown","unchanged"]],this.getChild);if(e instanceof Jd){if(e.path==="staged")return(0,Zi.map)(this.changes.staged,this.getChild);if(e.path==="changed")return(0,Zi.map)(this.changes.changed,this.getChild)}return[]}getTreeItem(e){return e}async getChangedRecord(){let n=(await Ht()).filter(a=>a.status==="changed"||a.status==="new"||a.status==="notfound");for(let a of n)if(a.original){let c=Buffer.from(a.original,"base64").toString("utf-8");Yd.updateContent(a.path,c)}let[r,s]=(0,Zi.partition)(n,a=>!!a.staged);return{staged:(0,Zi.map)(r,a=>[a.path,en.FileType.File,!0,a.type,a.status]),changed:(0,Zi.map)(s,a=>[a.path,en.FileType.File,!1,a.type,a.status])}}},Jd=class extends en.TreeItem{constructor(n){let r=n.split("/").slice(-1)[0];super(r,en.TreeItemCollapsibleState.Expanded);this.path=n;this.contextValue=`change-folder-${n}`}},Ig=class extends en.TreeItem{constructor(n,r=!1,s="unknown",a="unchanged"){let c=n.split("/").slice(-1)[0];super(c,en.TreeItemCollapsibleState.None);this.path=n;this.staged=r;this.objType=s;this.status=a;this.id=n,this.resourceUri=HR(ge,n),this.description=n,this.contextValue=r?"stagedFile":"changedFile";let l=new en.ThemeColor("editor.foreground");switch(a==="new"?l=new en.ThemeColor("gitDecoration.addedResourceForeground"):a==="changed"?l=new en.ThemeColor("gitDecoration.modifiedResourceForeground"):a==="notfound"&&(l=new en.ThemeColor("gitDecoration.deletedResourceForeground")),s){case"function":this.iconPath=new en.ThemeIcon("symbol-method",l);break;case"api_endpoint":this.iconPath=new en.ThemeIcon("plug",l);break;case"api_group":this.iconPath=new en.ThemeIcon("folder-opened",l);break;case"table":this.iconPath=new en.ThemeIcon("database",l);break;case"task":this.iconPath=new en.ThemeIcon("calendar",l);break;case"workflow_test":this.iconPath=new en.ThemeIcon("beaker",l);break}let d=a==="notfound"?"Deleted":(0,Zi.capitalize)(a),f=(0,Zi.startCase)(s);r?this.tooltip=new en.MarkdownString(`${d} ${f} \`${c}\` is **staged** and will be sent to Xano during the next push $(repo-push)`,!0):this.tooltip=new en.MarkdownString(`${d} ${f} \`${c}\`, stage it $(plus) to send it to Xano `,!0),a!=="notfound"&&(this.command={command:"xanoscript.viewChangeDiff",title:"View Changes",arguments:[this.path]})}},je=new Dg;var GR=we(require("vscode"));var $l=we(require("vscode"));async function cc(t){let r=`${$l.workspace.getConfiguration("xanoscript").get("xanoUrl","https://app.xano.com")}/api:meta/auth/me`,s=await fetch(r,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!s.ok)throw $l.window.showErrorMessage(`Failed to login ${r}: ${s.statusText}`),new Error(s.statusText);try{return await s.json()}catch{throw $l.window.showErrorMessage(`Failed to parse JSON response from ${r}: ${s.statusText}`),new Error(s.statusText)}}var $g=class{constructor(e){this.secrets=e}set(e,n){return this.secrets.store(e,n)}get(e){return this.secrets.get(e)}},Og;function XR(t){Og=new $g(t)}var BR="XanoApiToken";function ga(){return Og.get(BR)}function Qd(t){return Og.set(BR,t)}var xU={username:"",instance:"",workspace:"",instanceName:""},lc="xanoscript:state",Fg=class{constructor(){this.context=null;this._username="";this._instance="";this._instanceName="";this._workspace="";this.__change_callback=[]}initialize(e){ga().then(n=>{n&&cc(n).then(r=>{this._username=r.name,this.fireChange()})}),this.context=e,this.loadFromContext()}isAuthenticated(){return!!this._username}logout(){this._username="",this._instance="",this._instanceName="",this._workspace="",this.context&&this.context.workspaceState.update(lc,this.getState()),this.fireChange()}loadFromContext(){if(this.context){let e=this.context.workspaceState.get(lc,{...xU});console.log("loaded state",e),e.username&&(console.log("setting up username",e.username),this._username=e.username),e.instance&&(console.log("setting up instance",e.instance),this._instance=e.instance),e.instanceName&&(console.log("setting up instance name",e.instanceName),this._instanceName=e.instanceName),e.workspace&&(console.log("setting up workspace",e.workspace),this._workspace=e.workspace),this.fireChange()}}onChange(e,n=!1){return this.__change_callback.push(e),n&&this.safeFireCallback(e),new GR.Disposable(()=>{this.__change_callback=this.__change_callback.filter(r=>r!==e)})}fireChange(){this.__change_callback.forEach(e=>this.safeFireCallback(e))}safeFireCallback(e){try{e(this)}catch(n){console.error("Error in config change callback",n)}}getState(){return{username:this._username,instance:this._instance,workspace:this._workspace,instanceName:this._instanceName}}get username(){return this._username||""}set username(e){e!==this._username&&(this._username=e,this.context&&this.context.workspaceState.update(lc,this.getState()),this.fireChange())}get instance(){return this._instance||""}set instance(e){this._instance!==e&&(this._instance=e,this.context&&this.context.workspaceState.update(lc,this.getState()),this.fireChange())}get instanceName(){return this._instanceName||""}set instanceName(e){this._instanceName!==e&&(this._instanceName=e,this.context&&this.context.workspaceState.update(lc,this.getState()),this.fireChange())}get workspace(){return this._workspace?this._workspace:""}set workspace(e){this._workspace!==e&&(this._workspace=e,this.context&&this.context.workspaceState.update(lc,this.getState()),this.fireChange())}},an=new Fg;function zR(t){let e=new Ng(t),n=[Br.window.registerTreeDataProvider("changes",je),Br.window.registerWebviewViewProvider("files",e)];t.subscriptions.push(...n)}var Ng=class{constructor(e){this._context=e;let n=Br.workspace.getConfiguration("xanoscript");this.apiUrl=n.get("xanoUrl","https://app.xano.com")}static{this.viewType="files"}resolveWebviewView(e){this._webviewView=e,e.webview.options={enableScripts:!0,localResourceRoots:[this._context.extensionUri]},this._updateWebviewContent();let n=an.onChange(()=>{this._updateWebviewContent()});e.webview.onDidReceiveMessage(r=>{switch(r.command){case"resetAndPull":Br.commands.executeCommand("xanoscript.resetAndPull");break;case"uploadStatic":Br.commands.executeCommand("xanoscript.uploadStatic");break;case"pullChanges":Br.commands.executeCommand("xanoscript.pullChanges");break;case"login":Br.commands.executeCommand("xanoscript.login");break;case"setupAgentInstructions":Br.commands.executeCommand("xanoscript.setupAgentInstructions");break;case"register":Br.env.openExternal(Br.Uri.parse(`${this.apiUrl}/signup?source=vscode`));break}},void 0,this._context.subscriptions),e.onDidDispose(()=>{n.dispose()})}_updateWebviewContent(){this._webviewView&&(this._webviewView.webview.html=this._getHtmlForWebview())}_getHtmlForWebview(){return an.isAuthenticated()?this._getAuthenticatedHtml():this._getUnauthenticatedHtml()}_getUnauthenticatedHtml(){return`<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>XanoScript</title>
        <style>
            ${this._getCommonStyles()}
            .login-container {
                text-align: center;
                padding: 20px;
            }
            .login-message {
                color: var(--vscode-descriptionForeground);
                margin-bottom: 20px;
                line-height: 1.4;
            }
            .primary-button {
                background: var(--vscode-button-background);
                color: var(--vscode-button-foreground);
                border: 1px solid var(--vscode-button-border);
                padding: 6px 12px;
                border-radius: 2px;
                cursor: pointer;
                font-size: 14px;
                font-weight: 500;
                margin-bottom: 10px;
                display: block;
                width: 100%;
                text-decoration: none;
            }
            .primary-button:hover {
                background: var(--vscode-button-hoverBackground);
            }
            
        </style>
    </head>
    <body>
        <div class="login-container">
            <p class="login-message">
                Connect to your Xano workspace to start working with XanoScript files.
            </p>
            <button class="shortcut-button" onclick="sendCommand('login')">
                Get Started
            </button>
            <button class="shortcut-button" onclick="sendCommand('register')">
                Create Xano Account
            </button>            
        </div>
        <script>
            const vscode = acquireVsCodeApi();
            
            function sendCommand(command) {
                vscode.postMessage({ command: command });
            }
        </script>
    </body>
    </html>`}_getAuthenticatedHtml(){return`<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>XanoScript Shortcuts</title>
        <style>
            ${this._getCommonStyles()}
        </style>
    </head>
    <body>
        <p class="description">Pull changes from your remote Xano workspace.</p>
        <button class="shortcut-button" onclick="sendCommand('pullChanges')">
        Pull Changes
        </button>
        
        <p class="description">Upload and build your web content stored in the static/ folder</p>
        <button class="shortcut-button" onclick="sendCommand('uploadStatic')">
        Upload Static Files
        </button>

        <p class="description">Install or update the local documentation files in your workspace for AI agents</p>
        <button class="shortcut-button" onclick="sendCommand('setupAgentInstructions')">
        Setup Agent Instructions
        </button>
        
        <p class="description">Delete all local changes and pull your remote Xano Workspace</p>
        <button class="shortcut-button danger" onclick="sendCommand('resetAndPull')">
        Reset & Sync Workspace
        </button>
        <script>
            const vscode = acquireVsCodeApi();
            
            function sendCommand(command) {
                vscode.postMessage({ command: command });
            }
        </script>
    </body>
    </html>`}_getCommonStyles(){return`
            body {
                font-family: var(--vscode-font-family);
                font-size: var(--vscode-font-size);
                color: var(--vscode-foreground);
                background: var(--vscode-editor-background);
                padding: 16px;
                margin: 0;
            }
            .shortcut-button {
                display: block;
                width: 100%;
                padding: 6px 12px;
                margin: 8px 0;
                background: var(--vscode-button-background);
                color: var(--vscode-button-foreground);
                border: 1px solid var(--vscode-button-border);
                border-radius: 2px;
                cursor: pointer;
                text-decoration: none;
                font-size: 13px;
                transition: background-color 0.2s ease;
                margin-bottom: 18px;
            }
            .shortcut-button.danger {
                background: oklch(66.6% 0.179 58.318);
            }
            .shortcut-button:hover.danger {
                background: oklch(76.9% 0.188 70.08);
            }
            .shortcut-button:hover {
                background: var(--vscode-button-hoverBackground);
            }
            .shortcut-button:active {
                background: var(--vscode-button-secondaryBackground);
            }
            .description {
                font-size: 12px;
                color: var(--vscode-descriptionForeground);
                margin-bottom: 6px;
                line-height: 1.4;
            }
            .user-info {
                margin-bottom: 20px;
                padding-bottom: 10px;
                border-bottom: 1px solid var(--vscode-panel-border);
                flex-shrink: 0;
            }
    `}};var pt=we(require("vscode"));var mf=we(require("vscode"));var nf=we(require("vscode"));var TU=600*1e3,KR=new Map;async function ef(t){let e=KR.get(t);if(e&&e.ttl>Date.now())return e.url;let n=await tf(t);return KR.set(t,{url:n.xano_domain,ttl:Date.now()+TU}),n.xano_domain}async function Te(t,e,n){if(!t)throw new Error("metadataInstanceRequest(): No instance name provided");let r=await ef(t),a=`${r.startsWith("localhost")?"http":"https"}://${r}/api:meta/${e}`;return ZR(a,n)}async function Mg(t,e){let s=`${nf.workspace.getConfiguration("xanoscript").get("xanoUrl","https://app.xano.com")}/api:meta/${t}`;return ZR(s,e)}async function ZR(t,e){let n=await ga(),s=await(e?.body instanceof FormData?fetch(t,{...e,headers:{Authorization:`Bearer ${n}`}}):fetch(t,{...e,headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json",...e?.headers}}));if(!s.ok)if(s.headers.get("content-type")?.includes("application/json")){let a=await s.json();throw a&&a.code==="ERROR_CODE_SYNTAX_ERROR"?new uc("Syntax error",a):s.status===404?new Ol(`Resource not found: ${t}: [HTTP-${s.status}] ${s.statusText} ${JSON.stringify(a)}`):a.message?(console.log("API Error fetching",t),new Error(a.message)):new Error(`Failed to fetch ${t}: [HTTP-${s.status}] ${s.statusText} ${JSON.stringify(a)}`)}else{let a=await s.text();throw console.log("API Error fetching",t,a),new Error(`Unknown Error: ${t}: [HTTP-${s.status}] ${s.statusText} ${a}`)}try{return await s.json()}catch{throw nf.window.showErrorMessage(`Failed to parse JSON response from ${t}: ${s.statusText} 
 ${s.text()}`),new Error(s.statusText)}}var uc=class extends Error{constructor(n,r){super(n);this.syntaxError=r;this.name="SyntaxError"}},Ol=class extends Error{constructor(e){super(e),this.name="NotFoundError"}};async function qg(){return Mg("instance")}async function tf(t){try{return await Mg(`instance/${t}`)}catch(e){let r=(await qg()).find(s=>s.name===t);if(r)return r;throw e}}async function VR(t,e){return Te(t,`workspace/${e}`)}async function YR(t){return Te(t,"workspace")}async function Lg(t,e){return Te(t,`workspace/${e}/branch`)}async function JR(t,e,n){let s=(await Lg(t,e)).find(a=>a.label===n);if(s)return s;throw new Error(`Branch ${n} not found`)}var BE=we(mn());var ki=we(require("vscode"));var Jn=require("path");async function Ug(t,e=[]){let n=(0,Jn.join)(ge,A.paths.functions||"functions");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function RU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.tables||"tables");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function EU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.workflowTests||"workflow_tests");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function SU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.tasks||"tasks");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function CU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.tools||"tools");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function Wg(t,e=[]){let n=(0,Jn.join)(ge,A.paths.apis||"apis");await Yn(n);let r=await qU(n);for(let s of r){let a=(0,Jn.join)(s,"api_group.xs");await xg(a)&&(t=await On(t,a),e.push(s))}return t}async function kU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.apis||"apis");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function PU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.agents||"agents");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function AU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.tableTriggers||"tables/triggers");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function DU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.mcpServers||"mcp_servers");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function IU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.addOns||"addons");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function $U(t,e=[]){let n=(0,Jn.join)(ge,A.paths.middlewares||"middlewares");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function OU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.agentTriggers||"agents/triggers");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function FU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.mcpServerTriggers||"mcp_servers/triggers");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function NU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.realtimeChannels||"realtime/channels");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function MU(t,e=[]){let n=(0,Jn.join)(ge,A.paths.realtimeTriggers||"realtime/triggers");await Yn(n);let r=await Gr(n);for(let s of r)t=await On(t,s),e.push(s);return t}async function Si(){if(!A.isReady)return[];let t=await oc(),e=[];t=await Ug(t,e),t=await RU(t,e),t=await SU(t,e),t=await CU(t,e),t=await Wg(t,e),t=await kU(t,e),t=await EU(t,e),t=await PU(t,e),t=await OU(t,e),t=await AU(t,e),t=await DU(t,e),t=await FU(t,e),t=await IU(t,e),t=await $U(t,e),t=await NU(t,e),t=await MU(t,e);for(let n=t.length-1;n>=0;n--){let r=t[n];if(!e.includes(r.path))if(r.id===0)t.splice(n,1);else if(r.original){let s=Buffer.from(r.original,"base64").toString().split(`
`)[0].trim(),a=-1;for(let c=0;c<t.length;c++){let l=t[c];if(l.id===0){let f=(await ac(l.path)).split(`
`)[0].trim();if(s===f){a=c;break}}}a>-1?(t[a]={...r,path:t[a].path},t.splice(n,1)):r.status="notfound"}else r.status="notfound"}return await gn(t),je.refresh(),t}async function qU(t){let e=[],n=await Rg(t);for(let r of n){let s=(0,Jn.join)(t,r);await Tg(s)&&e.push(ge?s.slice(ge.length+1):s)}return e}async function Gr(t){let e=[];async function n(r){let s=await Rg(r);for(let a of s){let c=(0,Jn.join)(r,a);await Tg(c)?await n(c):c.endsWith(".xs")&&e.push(c.slice(ge.length+1))}}try{await xg(t)}catch{return await Yn(t),console.info(`Folder did not exist ${t}, created`),e}return await n(t),e}var Tt=we(require("vscode"));var Rn=require("path");var LU=we(require("vscode"));var UU=we(mn());function WU(t,e,n){let r=new URLSearchParams;return r.set("include_xanoscript","true"),Te(t,`workspace/${e}/table/${n}?${r.toString()}`)}function QR(t,e,n,r){let s=new URLSearchParams;return s.set("include_xanoscript","true"),Te(t,`workspace/${e}/table/${n}?${s.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function rf(t,e,n=!0){let r=1,s=[],a=new URLSearchParams;for(a.set("include_xanoscript",n?"true":"false"),a.set("per_page","20");r;){a.set("page",r.toString());let c=await Te(t,`workspace/${e}/table?${a.toString()}`);s.push(...c.items),r=c.nextPage}return s}async function e1(t,e,n){let r=new URLSearchParams;r.set("include_xanoscript","true");let s=await Te(t,`workspace/${e}/table?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}});if(!s)throw new Error("Table creation failed");return WU(t,e,s.id)}async function t1(t,e,n){await Te(t,`workspace/${e}/table/${n}`,{method:"DELETE"})}async function n1(t,e,n,r,s){return await Te(t,`workspace/${e}/table/${r}/content/bulk`,{method:"POST",body:JSON.stringify({items:s,allow_id_field:!1}),headers:{"x-data-source":n,"Content-Type":"application/json"}})}var sf=we(require("vscode"));async function r1(t,e){let n=1,r=[],a=sf.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),c.set("per_page","20"),c.set("branch",encodeURIComponent(A.branch));n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/function?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function HU(t,e,n){let s=sf.workspace.getConfiguration("xanoscript").get("draftMode",!1),a=new URLSearchParams;return a.set("include_draft",s?"true":"false"),a.set("include_xanoscript","true"),Te(t,`workspace/${e}/function/${n}?${a.toString()}`)}async function i1(t,e,n,r){let a=sf.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_xanoscript","true"),c.set("include_draft",a?"true":"false"),await Te(t,`workspace/${e}/function/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}}),HU(t,e,n)}async function s1(t,e,n){let r=new URLSearchParams;return r.set("branch",encodeURIComponent(A.branch)),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/function?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function o1(t,e,n){return Te(t,`workspace/${e}/function/${n}`,{method:"DELETE"})}var Hg=we(require("vscode"));async function a1(t,e,n,r){let a=Hg.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),Te(t,`workspace/${e}/task/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function c1(t,e){let n=1,r=[],a=Hg.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("per_page","20"),c.set("branch",encodeURIComponent(A.branch)),c.set("include_xanoscript","true");n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/task?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function l1(t,e,n){let r=new URLSearchParams;return r.set("branch",A.branch),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/task?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function u1(t,e,n){await Te(t,`workspace/${e}/task/${n}`,{method:"DELETE"})}var jg=we(require("vscode"));async function d1(t,e,n,r){let a=jg.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),Te(t,`workspace/${e}/tool/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function f1(t,e){let n=1,r=[],a=jg.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("per_page","20"),c.set("branch",encodeURIComponent(A.branch)),c.set("include_xanoscript","true");n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/tool?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function p1(t,e,n){let r=new URLSearchParams;return r.set("branch",A.branch),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/tool?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function h1(t,e,n){await Te(t,`workspace/${e}/tool/${n}`,{method:"DELETE"})}var Xg=we(require("vscode"));async function _a(t,e){let n=1,r=[],s=new URLSearchParams;for(s.set("per_page","20"),s.set("branch",A.branch),s.set("include_xanoscript","true");n;){s.set("page",n.toString());let a=await Te(t,`workspace/${e}/apigroup?${s.toString()}`);r.push(...a.items),n=a.nextPage}return r}async function jU(t,e,n){let r=1,s=[],c=Xg.workspace.getConfiguration("xanoscript").get("draftMode",!1),l=new URLSearchParams;for(l.set("include_draft",c?"true":"false"),l.set("per_page","20"),l.set("include_xanoscript","true");r;){l.set("page",r.toString());let d=await Te(t,`workspace/${e}/apigroup/${n}/api?${l.toString()}`);s.push(...d.items),r=d.nextPage}return s}async function m1(t,e){let n=await _a(t,e),r=[];for(let s of n){let a=await jU(t,e,s.id);for(let c of a)r.push({...c,apiGroup:s})}return r}async function g1(t,e,n,r){let s=new URLSearchParams;return s.set("include_xanoscript","true"),Te(t,`workspace/${e}/apigroup/${n}?${s.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function _1(t,e,n,r,s){let c=Xg.workspace.getConfiguration("xanoscript").get("draftMode",!1),l=new URLSearchParams;return l.set("publish",c?"false":"true"),l.set("include_draft",c?"true":"false"),l.set("include_xanoscript","true"),Te(t,`workspace/${e}/apigroup/${n}/api/${r}?${l.toString()}`,{method:"PUT",body:s,headers:{"Content-Type":"text/x-xanoscript"}})}async function v1(t,e,n,r){let s=new URLSearchParams;return s.set("include_xanoscript","true"),Te(t,`workspace/${e}/apigroup/${n}/api?${s.toString()}`,{method:"POST",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function y1(t,e,n){let r=new URLSearchParams;return r.set("branch",encodeURIComponent(A.branch)),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/apigroup?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function w1(t,e,n){return Te(t,`workspace/${e}/apigroup/${n}`,{method:"DELETE"})}async function b1(t,e,n,r){return Te(t,`workspace/${e}/apigroup/${n}/api/${r}`,{method:"DELETE"})}var Ci=we(mn());var ur=we(require("vscode"));var Fl=we(require("vscode")),x1=we(mn());var va=we(require("vscode"));async function ps(){if(!va.workspace.workspaceFolders||va.workspace.workspaceFolders.length==0){if(await va.window.showErrorMessage("A workspace folder must be opened to use XanoScript. Do you want to open a folder?",{modal:!0},"Open Folder")!=="Open Folder")throw new Error("A workspace folder must be opened to use XanoScript.");await va.commands.executeCommand("workbench.action.files.openFolder")}}async function T1(){await ps();try{let t=await Bg();t&&(an.instance=t.name,an.instanceName=t.display,A.instanceName=t.name,await Gg(t.name)),Fl.commands.executeCommand("xanoscript.selectWorkspace")}catch(t){Fl.window.showErrorMessage(`Instance selection is required: ${t}`)}}async function Bg(){let t=(0,x1.keyBy)(await qg(),n=>`${n.display} (${n.name})`),e=await Fl.window.showQuickPick(Object.keys(t),{placeHolder:"Select the instance to switch to"});if(!e)throw new Error("No instance selected");return t[e]}async function Nl(){let t;if(A.instanceName)try{t=await tf(A.instanceName)}catch(e){t=await Bg(),console.error("Error fetching instance:",e)}else t=await Bg();t&&(an.instance=t.name,an.instanceName=t.display,A.instanceName=t.name,await Gg(t.name))}async function R1(){await ps();try{let t=await ga(),e=[{label:"Login to Xano",description:"Authenticate with Xano via your web browser",id:"login"},{label:"Enter Access Token",description:"Provide an Access Token",id:"access_token"}];t&&(e.push({label:"Select Instance",description:"Select an instance",id:"instance"}),e.push({label:"Logout",description:"Logout and remove the saved Access Token",id:"logout"}));let n=await ur.window.showQuickPick(e,{placeHolder:t?"You are logged in. What would you like to do?":"You are not logged in. Do you want to update your access token?",ignoreFocusOut:!0});if(n)if(n.id==="access_token"){let r=await XU();an.username=r.name,Nl()}else if(n.id==="logout")await Qd(""),an.logout(),ur.window.showInformationMessage("Logged out successfully.");else if(n.id==="instance")Nl();else{let r=await zg();an.username=r.name,Nl()}}catch(t){ur.window.showErrorMessage(`Invalid Access Token ${t}`)}}async function XU(){let t=await ur.window.showInputBox({placeHolder:"Enter your Xano Access Token key",ignoreFocusOut:!0,password:!0});if(!t)throw new Error("Access Token is required");let e=await cc(t);return await Qd(t),e}async function E1(){await ps();try{let t=await zg(!0);an.username=t.name,Nl()}catch(t){ur.window.showErrorMessage(`Invalid Access Token ${t}`)}}async function zg(t=!1){let n=ur.workspace.getConfiguration("xanoscript").get("xanoUrl","https://app.xano.com"),r=new Promise((d,f)=>{let m=ur.window.registerUriHandler({handleUri(g){if(g.path==="/auth-callback"){let w=g.query.split("=")[1];w?(d(decodeURIComponent(w)),m.dispose()):(f(new Error("No token received in callback")),m.dispose())}}});setTimeout(()=>{f(new Error("Authentication timeout - no token received")),m.dispose()},3e5)}),s="xano.xanoscript",a=ur.env.uriScheme,c=encodeURIComponent(`${a}://${s}/auth-callback`),l=`${n}/${t?"signup":"login"}?dest=vscode&callback=${c}`;await ur.env.openExternal(ur.Uri.parse(l)),ur.window.showInformationMessage("Please complete the login process in your browser. The extension is waiting for your authentication...");try{let d=await r;if(!d)throw new Error("Access Token is required");let f=await cc(d);return await Qd(d),ur.window.showInformationMessage("Successfully logged in to Xano!"),f}catch(d){throw ur.window.showErrorMessage(`Authentication failed: ${d}`),d}}async function dc(){let t=await ga();try{return t?cc(t):zg()}catch(e){throw ur.window.showErrorMessage(`Failed to login to Xano. Please check your access token. ${e}`),new Error("Login failed")}}function hs(){}hs.prototype={diff:function(e,n){var r,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=s.callback;typeof s=="function"&&(a=s,s={});var c=this;function l(F){return F=c.postProcess(F,s),a?(setTimeout(function(){a(F)},0),!0):F}e=this.castInput(e,s),n=this.castInput(n,s),e=this.removeEmpty(this.tokenize(e,s)),n=this.removeEmpty(this.tokenize(n,s));var d=n.length,f=e.length,p=1,m=d+f;s.maxEditLength!=null&&(m=Math.min(m,s.maxEditLength));var g=(r=s.timeout)!==null&&r!==void 0?r:1/0,w=Date.now()+g,v=[{oldPos:-1,lastComponent:void 0}],x=this.extractCommon(v[0],n,e,0,s);if(v[0].oldPos+1>=f&&x+1>=d)return l(S1(c,v[0].lastComponent,n,e,c.useLongestToken));var b=-1/0,S=1/0;function k(){for(var F=Math.max(b,-p);F<=Math.min(S,p);F+=2){var L=void 0,H=v[F-1],N=v[F+1];H&&(v[F-1]=void 0);var X=!1;if(N){var V=N.oldPos-F;X=N&&0<=V&&V<d}var Y=H&&H.oldPos+1<f;if(!X&&!Y){v[F]=void 0;continue}if(!Y||X&&H.oldPos<N.oldPos?L=c.addToPath(N,!0,!1,0,s):L=c.addToPath(H,!1,!0,1,s),x=c.extractCommon(L,n,e,F,s),L.oldPos+1>=f&&x+1>=d)return l(S1(c,L.lastComponent,n,e,c.useLongestToken));v[F]=L,L.oldPos+1>=f&&(S=Math.min(S,F-1)),x+1>=d&&(b=Math.max(b,F+1))}p++}if(a)(function F(){setTimeout(function(){if(p>m||Date.now()>w)return a();k()||F()},0)})();else for(;p<=m&&Date.now()<=w;){var $=k();if($)return $}},addToPath:function(e,n,r,s,a){var c=e.lastComponent;return c&&!a.oneChangePerToken&&c.added===n&&c.removed===r?{oldPos:e.oldPos+s,lastComponent:{count:c.count+1,added:n,removed:r,previousComponent:c.previousComponent}}:{oldPos:e.oldPos+s,lastComponent:{count:1,added:n,removed:r,previousComponent:c}}},extractCommon:function(e,n,r,s,a){for(var c=n.length,l=r.length,d=e.oldPos,f=d-s,p=0;f+1<c&&d+1<l&&this.equals(r[d+1],n[f+1],a);)f++,d++,p++,a.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return p&&!a.oneChangePerToken&&(e.lastComponent={count:p,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=d,f},equals:function(e,n,r){return r.comparator?r.comparator(e,n):e===n||r.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function S1(t,e,n,r,s){for(var a=[],c;e;)a.push(e),c=e.previousComponent,delete e.previousComponent,e=c;a.reverse();for(var l=0,d=a.length,f=0,p=0;l<d;l++){var m=a[l];if(m.removed)m.value=t.join(r.slice(p,p+m.count)),p+=m.count;else{if(!m.added&&s){var g=n.slice(f,f+m.count);g=g.map(function(w,v){var x=r[p+v];return x.length>w.length?x:w}),m.value=t.join(g)}else m.value=t.join(n.slice(f,f+m.count));f+=m.count,m.added||(p+=m.count)}}return a}var mB=new hs;function C1(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function k1(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function Zg(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function Vg(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function Ml(t,e){return Zg(t,e,"")}function of(t,e){return Vg(t,e,"")}function P1(t,e){return e.slice(0,BU(t,e))}function BU(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var r=e.length;t.length<e.length&&(r=t.length);var s=Array(r),a=0;s[0]=0;for(var c=1;c<r;c++){for(e[c]==e[a]?s[c]=s[a]:s[c]=a;a>0&&e[c]!=e[a];)a=s[a];e[c]==e[a]&&a++}a=0;for(var l=n;l<t.length;l++){for(;a>0&&t[l]!=e[a];)a=s[a];t[l]==e[a]&&a++}return a}function GU(t){return t.includes(`\r
`)&&!t.startsWith(`
`)&&!t.match(/[^\r]\n/)}function zU(t){return!t.includes(`\r
`)&&t.includes(`
`)}var af="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",KU=new RegExp("[".concat(af,"]+|\\s+|[^").concat(af,"]"),"ug"),cf=new hs;cf.equals=function(t,e,n){return n.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t.trim()===e.trim()};cf.tokenize=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(e.intlSegmenter.segment(t),function(a){return a.segment})}else n=t.match(KU)||[];var r=[],s=null;return n.forEach(function(a){/\s/.test(a)?s==null?r.push(a):r.push(r.pop()+a):/\s/.test(s)?r[r.length-1]==s?r.push(r.pop()+a):r.push(s+a):r.push(a),s=a}),r};cf.join=function(t){return t.map(function(e,n){return n==0?e:e.replace(/^\s+/,"")}).join("")};cf.postProcess=function(t,e){if(!t||e.oneChangePerToken)return t;var n=null,r=null,s=null;return t.forEach(function(a){a.added?r=a:a.removed?s=a:((r||s)&&A1(n,s,r,a),n=a,r=null,s=null)}),(r||s)&&A1(n,s,r,null),t};function A1(t,e,n,r){if(e&&n){var s=e.value.match(/^\s*/)[0],a=e.value.match(/\s*$/)[0],c=n.value.match(/^\s*/)[0],l=n.value.match(/\s*$/)[0];if(t){var d=C1(s,c);t.value=Vg(t.value,c,d),e.value=Ml(e.value,d),n.value=Ml(n.value,d)}if(r){var f=k1(a,l);r.value=Zg(r.value,l,f),e.value=of(e.value,f),n.value=of(n.value,f)}}else if(n)t&&(n.value=n.value.replace(/^\s*/,"")),r&&(r.value=r.value.replace(/^\s*/,""));else if(t&&r){var p=r.value.match(/^\s*/)[0],m=e.value.match(/^\s*/)[0],g=e.value.match(/\s*$/)[0],w=C1(p,m);e.value=Ml(e.value,w);var v=k1(Ml(p,w),g);e.value=of(e.value,v),r.value=Zg(r.value,p,v),t.value=Vg(t.value,p,p.slice(0,p.length-v.length))}else if(r){var x=r.value.match(/^\s*/)[0],b=e.value.match(/\s*$/)[0],S=P1(b,x);e.value=of(e.value,S)}else if(t){var k=t.value.match(/\s*$/)[0],$=e.value.match(/^\s*/)[0],F=P1(k,$);e.value=Ml(e.value,F)}}var ZU=new hs;ZU.tokenize=function(t){var e=new RegExp("(\\r?\\n)|[".concat(af,"]+|[^\\S\\n\\r]+|[^").concat(af,"]"),"ug");return t.match(e)||[]};var lf=new hs;lf.tokenize=function(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var s=0;s<r.length;s++){var a=r[s];s%2&&!e.newlineIsToken?n[n.length-1]+=a:n.push(a)}return n};lf.equals=function(t,e,n){return n.ignoreWhitespace?((!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),hs.prototype.equals.call(this,t,e,n)};function D1(t,e,n){return lf.diff(t,e,n)}var VU=new hs;VU.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var YU=new hs;YU.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function I1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Vi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?I1(Object(n),!0).forEach(function(r){e5(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function JU(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QU(t){var e=JU(t,"string");return typeof e=="symbol"?e:e+""}function Yg(t){"@babel/helpers - typeof";return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yg(t)}function e5(t,e,n){return e=QU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kg(t){return t5(t)||n5(t)||r5(t)||i5()}function t5(t){if(Array.isArray(t))return Jg(t)}function n5(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function r5(t,e){if(t){if(typeof t=="string")return Jg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jg(t,e)}}function Jg(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ql=new hs;ql.useLongestToken=!0;ql.tokenize=lf.tokenize;ql.castInput=function(t,e){var n=e.undefinedReplacement,r=e.stringifyReplacer,s=r===void 0?function(a,c){return typeof c>"u"?n:c}:r;return typeof t=="string"?t:JSON.stringify(Qg(t,null,null,s),s,"  ")};ql.equals=function(t,e,n){return hs.prototype.equals.call(ql,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),n)};function Qg(t,e,n,r,s){e=e||[],n=n||[],r&&(t=r(s,t));var a;for(a=0;a<e.length;a+=1)if(e[a]===t)return n[a];var c;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),c=new Array(t.length),n.push(c),a=0;a<t.length;a+=1)c[a]=Qg(t[a],e,n,r,s);return e.pop(),n.pop(),c}if(t&&t.toJSON&&(t=t.toJSON()),Yg(t)==="object"&&t!==null){e.push(t),c={},n.push(c);var l=[],d;for(d in t)Object.prototype.hasOwnProperty.call(t,d)&&l.push(d);for(l.sort(),a=0;a<l.length;a+=1)d=l[a],c[d]=Qg(t[d],e,n,r,d);e.pop(),n.pop()}else c=t;return c}var e_=new hs;e_.tokenize=function(t){return t.slice()};e_.join=e_.removeEmpty=function(t){return t};function O1(t){return Array.isArray(t)?t.map(O1):Vi(Vi({},t),{},{hunks:t.hunks.map(function(e){return Vi(Vi({},e),{},{lines:e.lines.map(function(n,r){var s;return n.startsWith("\\")||n.endsWith("\r")||(s=e.lines[r+1])!==null&&s!==void 0&&s.startsWith("\\")?n:n+"\r"})})})})}function F1(t){return Array.isArray(t)?t.map(F1):Vi(Vi({},t),{},{hunks:t.hunks.map(function(e){return Vi(Vi({},e),{},{lines:e.lines.map(function(n){return n.endsWith("\r")?n.substring(0,n.length-1):n})})})})}function s5(t){return Array.isArray(t)||(t=[t]),!t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return!r.startsWith("\\")&&r.endsWith("\r")})})})}function o5(t){return Array.isArray(t)||(t=[t]),t.some(function(e){return e.hunks.some(function(n){return n.lines.some(function(r){return r.endsWith("\r")})})})&&t.every(function(e){return e.hunks.every(function(n){return n.lines.every(function(r,s){var a;return r.startsWith("\\")||r.endsWith("\r")||((a=n.lines[s+1])===null||a===void 0?void 0:a.startsWith("\\"))})})})}function a5(t){var e=t.split(/\n/),n=[],r=0;function s(){var l={};for(n.push(l);r<e.length;){var d=e[r];if(/^(\-\-\-|\+\+\+|@@)\s/.test(d))break;var f=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(d);f&&(l.index=f[1]),r++}for(a(l),a(l),l.hunks=[];r<e.length;){var p=e[r];if(/^(Index:\s|diff\s|\-\-\-\s|\+\+\+\s|===================================================================)/.test(p))break;if(/^@@/.test(p))l.hunks.push(c());else{if(p)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(p));r++}}}function a(l){var d=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(d){var f=d[1]==="---"?"old":"new",p=d[2].split("	",2),m=p[0].replace(/\\\\/g,"\\");/^".*"$/.test(m)&&(m=m.substr(1,m.length-2)),l[f+"FileName"]=m,l[f+"Header"]=(p[1]||"").trim(),r++}}function c(){var l=r,d=e[r++],f=d.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),p={oldStart:+f[1],oldLines:typeof f[2]>"u"?1:+f[2],newStart:+f[3],newLines:typeof f[4]>"u"?1:+f[4],lines:[]};p.oldLines===0&&(p.oldStart+=1),p.newLines===0&&(p.newStart+=1);for(var m=0,g=0;r<e.length&&(g<p.oldLines||m<p.newLines||(w=e[r])!==null&&w!==void 0&&w.startsWith("\\"));r++){var w,v=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(v==="+"||v==="-"||v===" "||v==="\\")p.lines.push(e[r]),v==="+"?m++:v==="-"?g++:v===" "&&(m++,g++);else throw new Error("Hunk at line ".concat(l+1," contained invalid line ").concat(e[r]))}if(!m&&p.newLines===1&&(p.newLines=0),!g&&p.oldLines===1&&(p.oldLines=0),m!==p.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(g!==p.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1));return p}for(;r<e.length;)s();return n}function c5(t,e,n){var r=!0,s=!1,a=!1,c=1;return function l(){if(r&&!a){if(s?c++:r=!1,t+c<=n)return t+c;a=!0}if(!s)return a||(r=!0),e<=t-c?t-c++:(s=!0,l())}}function N1(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=a5(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(GU(t)&&s5(e)?e=O1(e):zU(t)&&o5(e)&&(e=F1(e)));var r=t.split(`
`),s=e.hunks,a=n.compareLine||function(D,j,ae,me){return j===me},c=n.fuzzFactor||0,l=0;if(c<0||!Number.isInteger(c))throw new Error("fuzzFactor must be a non-negative integer");if(!s.length)return t;for(var d="",f=!1,p=!1,m=0;m<s[s.length-1].lines.length;m++){var g=s[s.length-1].lines[m];g[0]=="\\"&&(d[0]=="+"?f=!0:d[0]=="-"&&(p=!0)),d=g}if(f){if(p){if(!c&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!c)return!1}else if(p){if(r[r.length-1]!="")r.push("");else if(!c)return!1}function w(D,j,ae){for(var me=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,ue=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,_e=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[],ke=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,De=0,Ie=!1;me<D.length;me++){var Ce=D[me],Ge=Ce.length>0?Ce[0]:" ",Re=Ce.length>0?Ce.substr(1):Ce;if(Ge==="-")if(a(j+1,r[j],Ge,Re))j++,De=0;else return!ae||r[j]==null?null:(_e[ke]=r[j],w(D,j+1,ae-1,me,!1,_e,ke+1));if(Ge==="+"){if(!ue)return null;_e[ke]=Re,ke++,De=0,Ie=!0}if(Ge===" ")if(De++,_e[ke]=r[j],a(j+1,r[j],Ge,Re))ke++,ue=!0,Ie=!1,j++;else return Ie||!ae?null:r[j]&&(w(D,j+1,ae-1,me+1,!1,_e,ke+1)||w(D,j+1,ae-1,me,!1,_e,ke+1))||w(D,j,ae-1,me+1,!1,_e,ke)}return ke-=De,j-=De,_e.length=ke,{patchedLines:_e,oldLineLastI:j-1}}for(var v=[],x=0,b=0;b<s.length;b++){for(var S=s[b],k=void 0,$=r.length-S.oldLines+c,F=void 0,L=0;L<=c;L++){F=S.oldStart+x-1;for(var H=c5(F,l,$);F!==void 0&&(k=w(S.lines,F,L),!k);F=H());if(k)break}if(!k)return!1;for(var N=l;N<F;N++)v.push(r[N]);for(var X=0;X<k.patchedLines.length;X++){var V=k.patchedLines[X];v.push(V)}l=k.oldLineLastI+1,x=F+1-S.oldStart}for(var Y=l;Y<r.length;Y++)v.push(r[Y]);return v.join(`
`)}function $1(t,e,n,r,s,a,c){if(c||(c={}),typeof c=="function"&&(c={callback:c}),typeof c.context>"u"&&(c.context=4),c.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(c.callback){var l=c,d=l.callback;D1(n,r,Vi(Vi({},c),{},{callback:function(m){var g=f(m);d(g)}}))}else return f(D1(n,r,c));function f(p){if(!p)return;p.push({value:"",lines:[]});function m(X){return X.map(function(V){return" "+V})}for(var g=[],w=0,v=0,x=[],b=1,S=1,k=function(){var V=p[$],Y=V.lines||u5(V.value);if(V.lines=Y,V.added||V.removed){var D;if(!w){var j=p[$-1];w=b,v=S,j&&(x=c.context>0?m(j.lines.slice(-c.context)):[],w-=x.length,v-=x.length)}(D=x).push.apply(D,Kg(Y.map(function(ke){return(V.added?"+":"-")+ke}))),V.added?S+=Y.length:b+=Y.length}else{if(w)if(Y.length<=c.context*2&&$<p.length-2){var ae;(ae=x).push.apply(ae,Kg(m(Y)))}else{var me,ue=Math.min(Y.length,c.context);(me=x).push.apply(me,Kg(m(Y.slice(0,ue))));var _e={oldStart:w,oldLines:b-w+ue,newStart:v,newLines:S-v+ue,lines:x};g.push(_e),w=0,v=0,x=[]}b+=Y.length,S+=Y.length}},$=0;$<p.length;$++)k();for(var F=0,L=g;F<L.length;F++)for(var H=L[F],N=0;N<H.lines.length;N++)H.lines[N].endsWith(`
`)?H.lines[N]=H.lines[N].slice(0,-1):(H.lines.splice(N+1,0,"\\ No newline at end of file"),N++);return{oldFileName:t,newFileName:e,oldHeader:s,newHeader:a,hunks:g}}}function t_(t){if(Array.isArray(t))return t.map(t_).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@"),e.push.apply(e,r.lines)}return e.join(`
`)+`
`}function l5(t,e,n,r,s,a,c){var l;if(typeof c=="function"&&(c={callback:c}),(l=c)!==null&&l!==void 0&&l.callback){var f=c,p=f.callback;$1(t,e,n,r,s,a,Vi(Vi({},c),{},{callback:function(g){g?p(t_(g)):p()}}))}else{var d=$1(t,e,n,r,s,a,c);return d?t_(d):void 0}}function M1(t,e,n,r,s,a){return l5(t,t,e,n,r,s,a)}function u5(t){var e=t.endsWith(`
`),n=t.split(`
`).map(function(r){return r+`
`});return e?n.pop():n.push(n.pop().slice(0,-1)),n}var n_=class{constructor(){this.contents=new Map}updateContent(e,n){this.contents.set(e,n)}provideTextDocumentContent(e){let n=e.path;return this.contents.get(n)||""}},Ll=new n_;var Po=we(require("vscode"));var Yi=we(require("vscode"));var u_=require("path");var ms=we(require("vscode"));function d5(){return ms.languages.createDiagnosticCollection("customFunctions")}function r_(t,e,n,r,s,a){let c=new ms.Range(new ms.Position(n,r),new ms.Position(n,s)),l=new ms.Diagnostic(c,a,ms.DiagnosticSeverity.Error);t.set(e,[l])}var ya=d5();async function zr(t,e){if(!e.xanoscript)return `api_group "${e.name}" {
}
`;if(e.xanoscript.status==="ok")return e.xanoscript.value;{let n=await ef(A.instanceName),r=n.startsWith("localhost")?"http":"https",s=A.workspaceId,a=`${r}://${n}/workspace/${s}-0`;return e.name?`Error retrieving: ${e.name}
---------------------------
${e.xanoscript.message}
 ${t} ID: ${e.id}
${a}`:`Error retrieving <${t}>
---------------------------
${e.xanoscript.message}
 ${t} ID: ${e.id}
${a}`}}var uf=we(require("vscode"));async function q1(t,e){let n=1,r=[],a=uf.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("per_page","20"),c.set("branch",encodeURIComponent(A.branch));n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/workflow_test?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function f5(t,e,n){let s=uf.workspace.getConfiguration("xanoscript").get("draftMode",!1),a=new URLSearchParams;return a.set("include_draft",s?"true":"false"),a.set("include_xanoscript","true"),Te(t,`workspace/${e}/workflow_test/${n}?${a.toString()}`)}async function L1(t,e,n,r){let a=uf.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),await Te(t,`workspace/${e}/workflow_test/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}}),f5(t,e,n)}async function U1(t,e,n){let r=new URLSearchParams;return r.set("branch",A.branch),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/workflow_test?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function W1(t,e,n){let r=new URLSearchParams;return r.set("branch",A.branch),Te(t,`workspace/${e}/workflow_test/run?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript","x-data-source":""}})}async function H1(t,e,n){return Te(t,`workspace/${e}/workflow_test/${n}`,{method:"DELETE"})}var p5=we(mn());var i_=we(require("vscode"));async function j1(t,e){let n=1,r=[],a=i_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("per_page","20"),c.set("branch",encodeURIComponent(A.branch)),c.set("include_xanoscript","true");n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/agent?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function X1(t,e,n,r){let a=i_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),Te(t,`workspace/${e}/agent/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function B1(t,e,n){let r=new URLSearchParams;return r.set("branch",A.branch),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/agent?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function G1(t,e,n){return Te(t,`workspace/${e}/agent/${n}`,{method:"DELETE"})}var s_=we(require("vscode"));async function z1(t,e,n,r){let a=s_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),Te(t,`workspace/${e}/agent/trigger/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function K1(t,e){let n=1,r=[],a=s_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("per_page","20"),c.set("branch",A.branch),c.set("include_xanoscript","true");n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/agent/trigger?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function Z1(t,e,n){let r=new URLSearchParams;return r.set("branch",A.branch),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/agent/trigger?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function V1(t,e,n){await Te(t,`workspace/${e}/agent/trigger/${n}`,{method:"DELETE"})}var df=we(require("vscode"));function h5(t,e,n){let s=df.workspace.getConfiguration("xanoscript").get("draftMode",!1),a=new URLSearchParams;return a.set("include_draft",s?"true":"false"),a.set("include_xanoscript","true"),Te(t,`workspace/${e}/mcp_server/${n}?${a.toString()}`)}async function Y1(t,e,n,r){let a=df.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),await Te(t,`workspace/${e}/mcp_server/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}}),h5(t,e,n)}async function J1(t,e){let n=1,r=[],a=df.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("per_page","20"),c.set("branch",encodeURIComponent(A.branch)),c.set("include_xanoscript","true");n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/mcp_server?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function Q1(t,e,n){let r=new URLSearchParams;return r.set("branch",A.branch),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/mcp_server?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function eE(t,e,n){await Te(t,`workspace/${e}/mcp_server/${n}`,{method:"DELETE"})}var o_=we(require("vscode"));async function tE(t,e,n,r){let a=o_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),Te(t,`workspace/${e}/mcp_server/trigger/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function nE(t,e){let n=1,r=[],a=o_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("per_page","20"),c.set("branch",encodeURIComponent(A.branch)),c.set("include_xanoscript","true");n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/mcp_server/trigger?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function rE(t,e,n){let r=new URLSearchParams;return r.set("branch",A.branch),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/mcp_server/trigger?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function iE(t,e,n){await Te(t,`workspace/${e}/mcp_server/trigger/${n}`,{method:"DELETE"})}var a_=we(require("vscode")),m5=we(mn());async function sE(t,e,n,r){let a=a_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),Te(t,`workspace/${e}/table/trigger/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function oE(t,e){let n=1,r=[],a=a_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("per_page","20"),c.set("branch",encodeURIComponent(A.branch)),c.set("include_xanoscript","true");n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/table/trigger?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function aE(t,e,n){let r=new URLSearchParams;return r.set("branch",A.branch),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/table/trigger?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function cE(t,e,n){await Te(t,`workspace/${e}/table/trigger/${n}`,{method:"DELETE"})}var lE=we(require("vscode"));function g5(t,e,n){return Te(t,`workspace/${e}/addon/${n}`)}function uE(t,e,n,r){let s=new URLSearchParams;return s.set("include_xanoscript","true"),Te(t,`workspace/${e}/addon/${n}?${s.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function dE(t,e){let n=1,r=[],a=lE.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),c.set("per_page","20");n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/addon?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function fE(t,e,n){let r=await Te(t,`workspace/${e}/addon`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}});if(!r)throw new Error("Addon creation failed");return g5(t,e,r.id)}async function pE(t,e,n){await Te(t,`workspace/${e}/addon/${n}`,{method:"DELETE"})}var _5=we(mn());var c_=we(require("vscode"));async function hE(t,e){let n=1,r=[],a=c_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;for(c.set("include_draft",a?"true":"false"),c.set("per_page","20"),c.set("branch",encodeURIComponent(A.branch)),c.set("include_xanoscript","true");n;){c.set("page",n.toString());let l=await Te(t,`workspace/${e}/middleware?${c.toString()}`);r.push(...l.items),n=l.nextPage}return r}async function mE(t,e,n,r){let a=c_.workspace.getConfiguration("xanoscript").get("draftMode",!1),c=new URLSearchParams;return c.set("publish",a?"false":"true"),c.set("include_draft",a?"true":"false"),c.set("include_xanoscript","true"),Te(t,`workspace/${e}/middleware/${n}?${c.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function gE(t,e,n){let r=new URLSearchParams;return r.set("branch",encodeURIComponent(A.branch)),r.set("include_xanoscript","true"),Te(t,`workspace/${e}/middleware?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function _E(t,e,n){return Te(t,`workspace/${e}/middleware/${n}`,{method:"DELETE"})}async function vE(t,e){let n=1,r=[],s=new URLSearchParams;for(s.set("per_page","20"),s.set("include_xanoscript","true");n;){s.set("page",n.toString());let a=await Te(t,`workspace/${e}/realtime/channel?${s.toString()}`);r.push(...a.items),n=a.nextPage}return r}async function yE(t,e,n,r){let s=new URLSearchParams;return s.set("include_xanoscript","true"),Te(t,`workspace/${e}/realtime/channel/${n}?${s.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function wE(t,e,n){let r=new URLSearchParams;return r.set("include_xanoscript","true"),Te(t,`workspace/${e}/realtime/channel?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function bE(t,e,n){return Te(t,`workspace/${e}/realtime/channel/${n}`,{method:"DELETE"})}async function xE(t,e){let n=1,r=[],s=new URLSearchParams;for(s.set("per_page","20"),s.set("include_xanoscript","true");n;){s.set("page",n.toString());let a=await Te(t,`workspace/${e}/realtime/channel/trigger?${s.toString()}`);r.push(...a.items),n=a.nextPage}return r}async function TE(t,e,n,r){let s=new URLSearchParams;return s.set("include_xanoscript","true"),Te(t,`workspace/${e}/realtime/trigger/${n}?${s.toString()}`,{method:"PUT",body:r,headers:{"Content-Type":"text/x-xanoscript"}})}async function RE(t,e,n){let r=new URLSearchParams;return r.set("include_xanoscript","true"),Te(t,`workspace/${e}/realtime/trigger?${r.toString()}`,{method:"POST",body:n,headers:{"Content-Type":"text/x-xanoscript"}})}async function EE(t,e,n){return Te(t,`workspace/${e}/realtime/trigger/${n}`,{method:"DELETE"})}var ff=async(t,e)=>{switch(e.type){case"table":t=await Ar(t,e,n=>e1(A.instanceName,A.workspaceId,n),(n,r)=>QR(A.instanceName,A.workspaceId,n,r),n=>t1(A.instanceName,A.workspaceId,n));break;case"function":t=await Ar(t,e,n=>s1(A.instanceName,A.workspaceId,n),(n,r)=>i1(A.instanceName,A.workspaceId,n,r),n=>o1(A.instanceName,A.workspaceId,n));break;case"task":t=await Ar(t,e,n=>l1(A.instanceName,A.workspaceId,n),(n,r)=>a1(A.instanceName,A.workspaceId,n,r),n=>u1(A.instanceName,A.workspaceId,n));break;case"tool":t=await Ar(t,e,n=>p1(A.instanceName,A.workspaceId,n),(n,r)=>d1(A.instanceName,A.workspaceId,n,r),n=>h1(A.instanceName,A.workspaceId,n));break;case"workflow_test":t=await Ar(t,e,n=>U1(A.instanceName,A.workspaceId,n),(n,r)=>L1(A.instanceName,A.workspaceId,n,r),n=>H1(A.instanceName,A.workspaceId,n));break;case"api_group":t=await Ar(t,e,n=>y1(A.instanceName,A.workspaceId,n),(n,r)=>g1(A.instanceName,A.workspaceId,n,r),n=>w1(A.instanceName,A.workspaceId,n));break;case"api_endpoint":t=await Ar(t,e,n=>{let r=l_(t,e.path);if(!r||r.id===0)throw new Error(`API group not found for ${e.path}. Please create the API group first.`);return v1(A.instanceName,A.workspaceId,r.id,n)},(n,r)=>{let s=l_(t,e.path);if(!s||s.id===0)throw new Error(`API group not found for ${e.path}. Please create or stage its API group first.`);return _1(A.instanceName,A.workspaceId,s.id,n,r)},async n=>{let r=l_(t,e.path);if(r)return b1(A.instanceName,A.workspaceId,r?.id||0,n)});break;case"agent":t=await Ar(t,e,n=>B1(A.instanceName,A.workspaceId,n),(n,r)=>X1(A.instanceName,A.workspaceId,n,r),n=>G1(A.instanceName,A.workspaceId,n));break;case"agent_trigger":t=await Ar(t,e,n=>Z1(A.instanceName,A.workspaceId,n),(n,r)=>z1(A.instanceName,A.workspaceId,n,r),n=>V1(A.instanceName,A.workspaceId,n));break;case"mcp_server":t=await Ar(t,e,n=>Q1(A.instanceName,A.workspaceId,n),(n,r)=>Y1(A.instanceName,A.workspaceId,n,r),n=>eE(A.instanceName,A.workspaceId,n));break;case"mcp_server_trigger":t=await Ar(t,e,n=>rE(A.instanceName,A.workspaceId,n),(n,r)=>tE(A.instanceName,A.workspaceId,n,r),n=>iE(A.instanceName,A.workspaceId,n));break;case"table_trigger":t=await Ar(t,e,n=>aE(A.instanceName,A.workspaceId,n),(n,r)=>sE(A.instanceName,A.workspaceId,n,r),n=>cE(A.instanceName,A.workspaceId,n));break;case"add_on":t=await Ar(t,e,n=>fE(A.instanceName,A.workspaceId,n),(n,r)=>uE(A.instanceName,A.workspaceId,n,r),n=>pE(A.instanceName,A.workspaceId,n));break;case"middleware":t=await Ar(t,e,n=>gE(A.instanceName,A.workspaceId,n),(n,r)=>mE(A.instanceName,A.workspaceId,n,r),n=>_E(A.instanceName,A.workspaceId,n));break;case"realtime_channel":t=await Ar(t,e,n=>wE(A.instanceName,A.workspaceId,n),(n,r)=>yE(A.instanceName,A.workspaceId,n,r),n=>bE(A.instanceName,A.workspaceId,n));break;case"realtime_trigger":t=await Ar(t,e,n=>RE(A.instanceName,A.workspaceId,n),(n,r)=>TE(A.instanceName,A.workspaceId,n,r),n=>EE(A.instanceName,A.workspaceId,n));break;default:console.error(`push(): Unknown record type: ${e.type}`);break}return t};async function Ar(t,e,n,r,s){let a=Yi.Uri.file((0,u_.join)(ge,e.path));if(e.status==="new")try{let c=await Yi.workspace.fs.readFile(a);console.info(`Pushing new <${e.type}:${e.id}>`,e.path);let l=await n(c.toString());return await Yi.workspace.fs.writeFile(a,Buffer.from(await zr(e.type,l),"utf-8")),ma(t,e.path,{id:l.id,sha256:ds(await zr(e.type,l)),original:Buffer.from(await zr(e.type,l)).toString("base64"),status:"unchanged",staged:!1})}catch(c){throw c instanceof uc&&r_(ya,a,c.syntaxError.payload.line,0,c.syntaxError.payload.col,c.syntaxError.message),Yi.window.showErrorMessage(`Error creating new ${e.type} on Xano: ${c}`),c}else if(e.status==="changed")try{let c=await Yi.workspace.fs.readFile(a);console.info(`Pushing update <${e.type}:${e.id}>`,e.path);let l=await r(e.id,c.toString());return await Yi.workspace.fs.writeFile(a,Buffer.from(await zr(e.type,l),"utf-8")),ma(t,e.path,{id:l.id,sha256:ds(await zr(e.type,l)),original:Buffer.from(await zr(e.type,l)).toString("base64"),status:"unchanged",staged:!1})}catch(c){throw c instanceof uc&&r_(ya,a,c.syntaxError.payload.line,0,c.syntaxError.payload.col,c.syntaxError.message),Yi.window.showErrorMessage(`Error pushing ${e.path} changes to Xano: ${c}`),c}else if(e.status==="notfound"&&await Yi.window.showWarningMessage(`The file ${e.path} was deleted locally. Do you want to delete it from the server?`,{modal:!0},{title:"Delete"}))try{return await s(e.id),Pg(t,e.path)}catch(l){if(l instanceof Ol)return Pg(t,e.path);throw Yi.window.showErrorMessage(`Error deleting ${e.path} on Xano: ${l}`),l}return t}function l_(t,e){let n=e.split("/");return n.pop(),e=(0,u_.join)(n.join("/"),"api_group.xs"),fs(t,e)}var SE=we(require("vscode"));async function fc(){let t=await Ht(),e=t.filter(r=>!r.staged&&r.status!=="unchanged"),n=t.filter(r=>r.staged&&r.status!=="unchanged");if(e.length===0&&n.length===0)return SE.window.showInformationMessage("No changed files to stage."),!1;for(let r of e)r.staged=!0;return await gn(t),je.refresh(),!0}var pf=!1;function Ul(){return pf}function Wl(t){pf=t}var CE=["table","function","table_trigger","task","tool","api_group","api_endpoint","workflow_test","agent","agent_trigger","mcp_server","mcp_server_trigger","add_on","middleware","realtime_channel","realtime_trigger"];async function hf(t){await dc();let e={success:[],failed:[]};return Ul()?(Po.window.showWarningMessage("A push operation is already in progress. Please wait until it completes."),e):Hl()?(Po.window.showErrorMessage("Cannot push changes while pulling. Please wait until the pull is complete."),e):new Promise(n=>{Po.window.withProgress({location:Po.ProgressLocation.Notification,title:"Pushing changes to Xano",cancellable:!1},async r=>{let s=await Ht(),a=[];if(!t){if(t=s.filter(f=>f.staged&&f.status!=="unchanged"),t.length===0&&(await Po.window.showInformationMessage("No changes to push to Xano. Do you want to stage all changes and push?","Yes","No")==="Yes"&&(await fc(),t=s.filter(p=>p.staged&&p.status!=="unchanged")),t.length===0)){Po.window.showInformationMessage("No changes to push to Xano");return}t.sort((f,p)=>{let m=CE.indexOf(f.type),g=CE.indexOf(p.type);return m===g?f.status==="notfound"&&p.status!=="notfound"?1:f.status!=="notfound"&&p.status==="notfound"?-1:0:m-g})}let c=t.length,l=0;pf=!0;let d=f=>{l+=1;let p=Math.floor(l/c*100);r.report({increment:100/c,message:`${p}% completed (${f})`})};for(let f of t)try{s=await ff(s,f),d(f.path),e.success.push(f.path)}catch(p){console.error("Error pushing changes:",p),a.push(f),e.failed.push({error:p.toString(),path:f.path})}await gn(s),je.refresh(),pf=!1,n(e)})})}var Dr=t=>e=>{let n=e.match(new RegExp(`${t}\\s+["']?([a-zA-Z0-9_/ ]+)["']?\\s*{`));if(!n)throw new Error(`No ${t} found in the content: ${e.split(`
`)[0]}`);return{path:n[1].trim()}},kE=Dr("function"),PE=Dr("add_on"),AE=Dr("realtime"),DE=Dr("realtime_trigger"),IE=Dr("agent"),$E=Dr("agent_trigger"),OE=Dr("mcp_server"),FE=Dr("mcp_server_trigger"),AG=Dr("mcp_trigger"),NE=Dr("table"),ME=Dr("table_trigger"),qE=Dr("api_group"),LE=Dr("task"),UE=Dr("tool"),WE=Dr("workflow_test"),HE=Dr("middleware");function jE(t){let e=t.match(/query\s+["']?([a-zA-Z0-9_/{} ]+)["']?\s+verb=([A-Z]+)\s*{/);if(!e)throw new Error(`No API endpoint found in the content:  ${t.split(`
`)[0]}`);let n=e[1].trim();return{verb:e[2].trim(),path:n}}var Qn=!1;function Hl(){return Qn}async function pc(){if(await dc(),Hl()){Tt.window.showErrorMessage("You cannot pull changes while pulling changes from Xano. Wait until the current pull is finished.");return}await Tt.window.withProgress({location:Tt.ProgressLocation.Notification,title:"Pulling Changes from Xano",cancellable:!0},async(t,e)=>{if(Ul()){Tt.window.showErrorMessage("You cannot pull changes while pushing changes to Xano. Wait until the push is finished.");return}Qn=!0;let n=await Ht(),r={table:[],function:[],task:[],tool:[],api_endpoint:[],api_group:[],workflow_test:[],agent:[],agent_trigger:[],mcp_server:[],mcp_server_trigger:[],table_trigger:[],add_on:[],middleware:[],realtime_channel:[],realtime_trigger:[],unknown:[]},s=[],a=100/(Object.keys(r).length+1),c=0,l=D=>{c+=a,t.report({increment:a,message:`${Math.round(c)}% completed (${D})`})};l("tables");let d=await rf(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch tables: ${D.message||D}`),[]));if(e.isCancellationRequested){Qn=!1;return}l("custom functions");let f=await r1(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch custom functions: ${D.message||D}`),[]));if(e.isCancellationRequested){Qn=!1;return}l("tasks");let p=await c1(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch tasks: ${D.message||D}`),[]));if(e.isCancellationRequested){Qn=!1;return}l("tools");let m=await f1(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch tools: ${D.message||D}`),[]));if(e.isCancellationRequested){Qn=!1;return}l("api groups");let g=await _a(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch api groups: ${D.message||D}`),[]));if(e.isCancellationRequested){Qn=!1;return}l("api endpoints");let w=await m1(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch api endpoints: ${D.message||D}`),[]));if(e.isCancellationRequested){Qn=!1;return}let v=[],x=[],b=[],S=[],k=[],$=[],F=[],L=[],H=[],N=[];if(l("workflow_tests"),v=await q1(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch workflow tests: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}if(l("agents"),x=await j1(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch agents: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}if(l("agent triggers"),b=await K1(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch agent triggers: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}if(l("MCP servers"),S=await J1(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch MCP servers: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}if(l("MCP server triggers"),k=await nE(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch MCP server triggers: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}if(l("table triggers"),$=await oE(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch table triggers: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}if(l("addons"),F=await dE(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch addons: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}if(l("middlewares"),L=await hE(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch middlewares: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}if(l("realtime channels"),H=await vE(A.instanceName,A.workspaceId).catch(D=>(D.message?.startsWith("Please enable")||Tt.window.showWarningMessage(`Failed to fetch realtime channels: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}if(l("realtime triggers"),N=await xE(A.instanceName,A.workspaceId).catch(D=>(Tt.window.showWarningMessage(`Failed to fetch realtime triggers: ${D.message||D}`),[])),e.isCancellationRequested){Qn=!1;return}for(let D of g)try{await Ir(s,n,D,"api_group",j=>(0,Rn.join)(A.paths.apis,j.name,"api_group.xs")),r.api_group.push(D.id)}catch(j){console.error(`Error fetching <apiGroup:${D.id}>`,j)}for(let D of v)try{await Ir(s,n,D,"workflow_test",j=>(0,Rn.join)(A.paths.workflowTests,`${j.id}_${j.name}.xs`)),r.workflow_test.push(D.id)}catch(j){console.error(`Error fetching <workflowTest:${D.id}>`,j)}for(let D of w)try{await Ir(s,n,D,"api_endpoint",j=>(0,Rn.join)(A.paths.apis,D.apiGroup.name,`${j.id}_${(0,Ci.snakeCase)(j.name)}_${j.verb}.xs`)),r.api_endpoint.push(D.id)}catch(j){console.error(`Error fetching <api:${D.id}>`,j)}for(let D of d)try{await Ir(s,n,D,"table",j=>(0,Rn.join)(A.paths.tables,`${j.id}_${j.name}.xs`)),r.table.push(D.id)}catch(j){console.error(`Error fetching <table:${D.id}>`,j)}for(let D of f)try{await Ir(s,n,D,"function",j=>{let ae=j.name.split("/"),me=ae.pop()||"";return(0,Rn.join)(A.paths.functions,ae.join("/"),j.id+"_"+me+".xs")}),r.function.push(D.id)}catch(j){console.error(`Error fetching <function:${D.id}>`,j)}for(let D of p)try{await Ir(s,n,D,"task",j=>(0,Rn.join)(A.paths.tasks,`${j.id}_${j.name}.xs`)),r.task.push(D.id)}catch(j){console.error(`Error fetching <task:${D.id}>`,j)}for(let D of m)try{await Ir(s,n,D,"tool",j=>(0,Rn.join)(A.paths.tools,`${j.id}_${j.name}.xs`)),r.tool.push(D.id)}catch(j){console.error(`Error fetching <tool:${D.id}>`,j)}for(let D of x)try{await Ir(s,n,D,"agent",j=>(0,Rn.join)(A.paths.agents,`${j.id}_${(0,Ci.snakeCase)(j.name)}.xs`)),r.agent.push(D.id)}catch(j){console.error(`Error fetching <agent:${D.id}>`,j)}for(let D of b)try{await Ir(s,n,D,"agent_trigger",j=>(0,Rn.join)(A.paths.agentTriggers,`${j.id}_${(0,Ci.snakeCase)(j.name)}.xs`)),r.agent_trigger.push(D.id)}catch(j){console.error(`Error fetching <agentTrigger:${D.id}>`,j)}for(let D of S)try{await Ir(s,n,D,"mcp_server",j=>(0,Rn.join)(A.paths.mcpServers,`${j.id}_${(0,Ci.snakeCase)(j.name)}.xs`)),r.mcp_server.push(D.id)}catch(j){console.error(`Error fetching <server:${D.id}>`,j)}for(let D of k)try{await Ir(s,n,D,"mcp_server_trigger",j=>(0,Rn.join)(A.paths.mcpServerTriggers,`${j.id}_${(0,Ci.snakeCase)(j.name)}.xs`)),r.mcp_server_trigger.push(D.id)}catch(j){console.error(`Error fetching <mcpServerTrigger:${D.id}>`,j)}for(let D of $)try{await Ir(s,n,D,"table_trigger",j=>(0,Rn.join)(A.paths.tableTriggers,`${j.id}_${(0,Ci.snakeCase)(j.name)}.xs`)),r.table_trigger.push(D.id)}catch(j){console.error(`Error fetching <trigger:${D.id}>`,j)}for(let D of F)try{await Ir(s,n,D,"add_on",j=>(0,Rn.join)(A.paths.addOns,`${j.id}_${(0,Ci.snakeCase)(j.name)}.xs`)),r.add_on.push(D.id)}catch(j){console.error(`Error fetching <add_on:${D.id}>`,j)}for(let D of L)try{await Ir(s,n,D,"middleware",j=>(0,Rn.join)(A.paths.middlewares,`${j.id}_${(0,Ci.snakeCase)(j.name)}.xs`)),r.middleware.push(D.id)}catch(j){console.error(`Error fetching <middleware:${D.id}>`,j)}for(let D of H)try{await Ir(s,n,D,"realtime_channel",j=>(0,Rn.join)(A.paths.realtimeChannels,`${j.id}_${(0,Ci.snakeCase)(j.name)}.xs`)),r.realtime_channel.push(D.id)}catch(j){console.error(`Error fetching <realtime_channel:${D.id}>`,j)}for(let D of N)try{await Ir(s,n,D,"realtime_trigger",j=>(0,Rn.join)(A.paths.realtimeTriggers,`${j.id}_${(0,Ci.snakeCase)(j.name)}.xs`)),r.realtime_trigger.push(D.id)}catch(j){console.error(`Error fetching <realtime_trigger:${D.id}>`,j)}let X=!1,V=!1;for(let D=n.length-1;D>-1;D--){let j=n[D];if(!(j.status==="new"||r[j.type].includes(j.id)))if(j.status==="unchanged"){let me=Tt.Uri.file((0,Rn.join)(ge,j.path));try{await Gd(me.path),n.splice(D,1)}catch(ue){console.error(`Error deleting local file ${j.path}`,ue)}}else{if(V){let ue=Tt.Uri.file((0,Rn.join)(ge,j.path));await Gd(ue.path),n.splice(D,1);continue}if(X){j.status="new",j.original="",j.id=0;continue}let me=await Tt.window.showWarningMessage(`The file "${j.path}" was deleted on Xano, but you've made local changes. Would you like to keep your local version?`,{modal:!0},{title:"Keep as New File",isCloseAffordance:!1},{title:"Delete Local Changes",isCloseAffordance:!1},{title:"Keep All as New Files",isCloseAffordance:!1},{title:"Delete All Changes",isCloseAffordance:!1});if(me?.title==="Delete All Changes"&&(V=!0),me?.title==="Keep All as New Files"&&(X=!0),me?.title==="Delete All Changes"||me?.title==="Delete Local Changes"){let ue=Tt.Uri.file((0,Rn.join)(ge,j.path));await Gd(ue.path),n.splice(D,1)}else j.status="new",j.original="",j.id=0}}let Y=(0,Ci.uniqBy)(s,({filePath:D})=>D);for(let D of Y)switch(D.operation){case"update":case"create":D.fileType===Tt.FileType.Directory?await Yn(D.filePath):await Pr(D.filePath,D.content);break;case"conflict":Ll.updateContent(D.filePath,D.content),Tt.commands.executeCommand("xanoscript.viewRemoteDiff",D.filePath);break;default:console.error(`Unknown file operation ${D.operation}`)}await gn(n),je.refresh()}).then(()=>Qn=!1,()=>Qn=!1)}async function Ir(t,e,n,r,s){let a=e.findIndex(l=>l.id===n.id&&l.type===r);if(a===-1&&(a=await w5(e,n,r),a>-1)){let l=await b5(n,e[a]);e[a]={...e[a],status:l?"unchanged":"changed",id:n.id,original:Buffer.from(await zr(r,n)).toString("base64"),sha256:ds(await zr(r,n))},l||t.push({operation:"conflict",content:await zr(r,n),fileType:Tt.FileType.File,filePath:e[a].path});return}let c=e[a];if(c){let l=await y5(t,c,await zr(r,n));e[a]=l}else{let l=await v5(t,n,r,s);e.push(l)}}async function v5(t,e,n,r){typeof r=="function"?r=r(e):r=(0,Rn.join)(r,e.name+".xs");let s={id:e.id,type:n,path:r,status:"unchanged",staged:!1},a=(0,Rn.join)(ge,s.path);return s.sha256=ds(await zr(n,e)),s.original=Buffer.from(await zr(n,e)).toString("base64"),t.push({operation:"create",content:await zr(n,e),fileType:Tt.FileType.File,filePath:a}),s}async function y5(t,e,n){let r=(0,Rn.join)(ge,e.path),s=await kl(r),a="";if(s?(a=await Ds(r),e.sha256!==ds(a)?e.status="changed":e.status="unchanged"):e.status="notfound",e.status==="unchanged")e.sha256=ds(n),e.original=Buffer.from(n).toString("base64"),t.push({operation:"update",content:n,fileType:Tt.FileType.File,filePath:r});else if(e.status==="changed"||e.status==="notfound"){let c=M1(r,Buffer.from(e.original||"","base64").toString("utf-8"),a),l=N1(n,c);l?(e.sha256=ds(n),e.original=Buffer.from(n).toString("base64"),t.push({operation:"update",content:l,fileType:Tt.FileType.File,filePath:r})):(t.push({operation:"conflict",content:n,fileType:Tt.FileType.File,filePath:r}),Ll.updateContent(e.path,n),Tt.commands.executeCommand("xanoscript.viewRemoteDiff",e.path))}return e}async function w5(t,e,n){for(let r=0;r<t.length;r++){let s=t[r];if(s.type===n&&s.status==="new"){let a=await Ds(s.path),c=!1;if(n==="api_endpoint"){let{verb:l,path:d}=jE(a);c=d===e.name&&l==e.verb}else n==="table"?c=NE(a).path===e.name:n==="function"?c=kE(a).path===e.name:n==="task"?c=LE(a).path===e.name:n==="tool"?c=UE(a).path===e.name:n==="api_group"?c=qE(a).path===e.name:n==="workflow_test"?c=WE(a).path===e.name:n==="agent"?c=IE(a).path===e.name:n==="mcp_server"?c=OE(a).path===e.name:n==="agent_trigger"?c=$E(a).path===e.name:n==="table_trigger"?c=ME(a).path===e.name:n==="mcp_server_trigger"?c=FE(a).path===e.name:n==="add_on"?c=PE(a).path===e.name:n==="middleware"?c=HE(a).path===e.name:n==="realtime_channel"?c=AE(a).path===e.name:n==="realtime_trigger"&&(c=DE(a).path===e.name);if(c)return r}}return-1}async function b5(t,e){let n=(0,Rn.join)(ge,e.path),r=await Ds(n);return t.xanoscript.status==="ok"&&t.xanoscript.value===r}async function XE(){if(!A.instanceName){ki.window.showErrorMessage("Please select a Xano instance");return}if(!A.workspaceId){ki.window.showErrorMessage("Please select a Xano workspace");return}try{let t=await d_(A.instanceName,A.workspaceId);await ki.commands.executeCommand("workbench.action.closeAllEditors"),A.branch=t.label,ki.window.showInformationMessage(`Switching to branch ${t.label}`),je.refresh()}catch(t){ki.window.showErrorMessage(`Branch selection is required: ${t}`)}}async function d_(t,e){let r=(await Lg(t,e)).filter(a=>!a.backup).map(a=>({kind:ki.QuickPickItemKind.Default,label:`${a.label}`,description:a.live?"Live branch":"",id:a.label,data:a,picked:a.label===A.branch})),s=await ki.window.showQuickPick(r,{placeHolder:"Select the branch to switch to",title:"Select Xano Branch"});if(!s)throw new Error("No branch selected");return s.data}async function f_(t,e){let n;if(A.branch)try{n=await JR(t,e,A.branch)}catch(r){console.error("Error fetching branch:",r),n=await d_(t,e)}else n=await d_(t,e);n&&(A.branch=n.label,A.hasUnsavedChanges&&(await A.save(),await ki.window.showInformationMessage("Do you want to pull the latest changes from the branch?",{modal:!0},"Pull Changes","No")==="Pull Changes"&&(await pc(),await Si()),je.refresh(),await ki.window.showInformationMessage("Do you want to setup AI Agent documentation files?",{modal:!0},"Setup AI Agent Instructions","No")==="Setup AI Agent Instructions"&&await ki.commands.executeCommand("xanoscript.setupAgentInstructions")))}async function GE(){if(!A.instanceName){mf.window.showErrorMessage("Please select a Xano instance");return}try{let t=await p_(A.instanceName);A.workspaceId=t.id,an.workspace=t.name,await f_(A.instanceName,t.id)}catch(t){mf.window.showErrorMessage(`Workspace selection is required: ${t}`)}}async function p_(t){let e=(0,BE.keyBy)(await YR(t),r=>`${r.name} (#${r.id})`),n=await mf.window.showQuickPick(Object.keys(e),{placeHolder:"Select the workspace to switch to"});if(!n)throw new Error("No workspace selected");return e[n]}async function Gg(t){let e;if(A.workspaceId)try{e=await VR(t,A.workspaceId)}catch(n){console.error("Error fetching workspace:",n),e=await p_(t)}else e=await p_(t);e&&(an.workspace=e.name,A.workspaceId=e.id,await f_(t,e.id))}var Kr=we(require("vscode")),gf=we(mn());var Ao=we(require("vscode"));async function zE(t){if(t.resourceUri)try{let e=await Ao.workspace.openTextDocument(t.resourceUri);await Ao.window.showTextDocument(e)}catch(e){Ao.window.showErrorMessage(String(e))}}async function jt(t){try{let e=await Ao.workspace.openTextDocument(t);await Ao.window.showTextDocument(e)}catch(e){Ao.window.showErrorMessage(String(e))}}var KE=require("path");async function ZE(){let e=(await Ht()).filter(d=>d.type==="api_group"),n=(0,gf.keyBy)(e,d=>`${d.path.split("/").slice(-2)[0]} (#${d.id})`),r=await Kr.window.showQuickPick(Object.keys(n),{placeHolder:"Select the API Group"});if(!r){Kr.window.showErrorMessage("API Group is required");return}let s=n[r].path.split("/").slice(0,-1).join("/"),a=await Kr.window.showInputBox({prompt:"Enter the API endpoint URL",placeHolder:"e.g., api/v1/resource"});if(!a){Kr.window.showErrorMessage("URL is required");return}if(a.startsWith("/")){a=a.slice(1);return}a=a.replace(/([^a-zA-Z0-9/]+)/g,"_");let c=await Kr.window.showQuickPick(["GET","POST","PUT","DELETE","PATCH"],{placeHolder:"Select the HTTP method"});if(!c){Kr.window.showErrorMessage("HTTP method is required");return}let l=`query "${a}" verb=${c} {
  input {
  }
  
  stack {
  }

  response {
    value = null
  }
}`;try{let d=Kr.Uri.file((0,KE.join)(ge,s,`${(0,gf.snakeCase)(a)}_${c}.xs`));if(await Kr.workspace.fs.stat(d).then(p=>p,()=>null)){Kr.window.showErrorMessage("A file with the same name already exists");return}await Kr.workspace.fs.writeFile(d,Buffer.from(l)),jt(d),Kr.window.showInformationMessage(`API endpoint ${c} "${a}" created successfully`),await nn([d.path.slice(ge.length+1)]),je.refresh()}catch{Kr.window.showErrorMessage("Failed to create API endpoint");return}}var dr=we(require("vscode"));var h_=require("path");async function _f(t){if((!t||t.trim()==="")&&(t=await dr.window.showInputBox({prompt:"Enter the API Group name",placeHolder:"e.g., Webhooks"})),!t||t.trim()==="")throw dr.window.showErrorMessage("Group Name is required"),new Error("API Group Name is required");let e=dr.Uri.file((0,h_.join)(ge,A.paths.apis,t)),n=dr.Uri.file((0,h_.join)(ge,A.paths.apis,t,"api_group.xs")),r=await dr.workspace.fs.stat(e).then(s=>s,()=>null);try{if(r){if(r.type===dr.FileType.Directory)return dr.window.showErrorMessage("API group already exists"),t;if(r.type===dr.FileType.File)throw dr.window.showErrorMessage("A file with the same name already exists"),new Error("A file with the same name already exists")}else{await dr.workspace.fs.createDirectory(e),dr.window.showInformationMessage(`API group "${t}" created successfully`);let s=`api_group "${t}" {
  canonical = "${t}"
  history = "inherit"
}`;return await dr.workspace.fs.writeFile(n,Buffer.from(s)),jt(n),dr.window.showInformationMessage(`API group "${t}" created successfully`),await nn([n.path.slice(ge.length+1)]),je.refresh(),t}}catch{throw dr.window.showErrorMessage("Failed to create API group"),new Error("Failed to create API group")}return t}var yr=we(require("vscode"));var m_=require("path");async function VE(){let t=await yr.window.showInputBox({prompt:"Enter the Custom Function name",placeHolder:"e.g., foo/bar/divide"});if(!t){yr.window.showErrorMessage("Function Name is required");return}t=t.replace(/([^a-zA-Z0-9/]+)/g,"_");let e=`function "${t}" {
  input {
    text some_argument? filters=trim {
      description = "what is this argument about?"
    }
  }

  stack {
    var $some_variable {
      value = "with some value"
    }
  }

  response {
    value = $some_variable
  }
}`;try{let n=t.split("/"),r=n.pop()+".xs";await yr.workspace.fs.createDirectory(yr.Uri.file((0,m_.join)(ge,A.paths.functions,...n)));let s=yr.Uri.file((0,m_.join)(ge,A.paths.functions,...n,r)),a=await yr.workspace.fs.stat(s).then(l=>l,()=>null);if(a){if(a.type===yr.FileType.Directory){yr.window.showErrorMessage("Custom function already exists"),jt(s);return}else if(a.type===yr.FileType.File){yr.window.showErrorMessage("A file with the same name already exists");return}}await yr.workspace.fs.writeFile(s,Buffer.from(e)),jt(s),yr.window.showInformationMessage("Custom function created successfully");let c=await Ht();gn(await Ug(c)),je.refresh()}catch{yr.window.showErrorMessage("Failed to create custom function");return}}var Zr=we(require("vscode"));var YE=we(mn());var JE=require("path");async function QE(){let t=await Zr.window.showInputBox({prompt:"Enter the table name",placeHolder:"e.g., Orders"});if(!t){Zr.window.showErrorMessage("Table name is required");return}let e=await Zr.window.showInputBox({prompt:"Enter the table description (optional)",placeHolder:"e.g., Stores client orders"}),n=await Zr.window.showQuickPick([{label:"Yes",description:"Table requires authentication",value:!0},{label:"No",description:"Table does not require authentication",value:!1}],{placeHolder:"Does the table require authentication?",title:"Table Authentication"});if(!n){Zr.window.showErrorMessage("Table creation canceled");return}t=t.replace(/([^a-zA-Z0-9/]+)/g,"_"),e=(e||"").replace(/"/g,'\\"');let s=Zr.workspace.getConfiguration("xanoscript").get("tablePrimaryKeyType","int"),a=`table "${t}" {
  description = "${e||""}"
  auth = ${n.value?"true":"false"} 

  schema {
    ${s} id
    timestamp created_at?=now
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "gin", field: [{name: "xdo", op: "jsonb_path_op"}]}
    {type: "btree", field: [{name: "created_at", op: "desc"}]}
  ]
}`;try{let c=Zr.Uri.file((0,JE.join)(ge,A.paths.tables,`${(0,YE.snakeCase)(t)}.xs`));if(await Zr.workspace.fs.stat(c).then(d=>d,()=>null)){Zr.window.showErrorMessage("A file with the same name already exists");return}await Zr.workspace.fs.writeFile(c,Buffer.from(a)),jt(c),Zr.window.showInformationMessage(`Table ${t} created successfully`),await nn([c.path.slice(ge.length+1)]),je.refresh()}catch{Zr.window.showErrorMessage("Failed to create table");return}}var Pi=we(require("vscode"));var eS=require("path"),tS=we(mn());function x5(){let t=new Date,e=n=>n.toString().padStart(2,"0");return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+" "+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"+0000"}async function nS(){let t=await Pi.window.showInputBox({prompt:"Enter the task name",placeHolder:"e.g., send_email"});if(!t){Pi.window.showErrorMessage("Task name is required");return}let e=[{label:"every minute",value:60},{label:"every 5 minutes",value:300},{label:"every 30 minutes",value:1800},{label:"every hour",value:3600},{label:"every day",value:86400},{label:"every week",value:604800}],n=await Pi.window.showQuickPick(e,{placeHolder:"Select the task frequency"});if(!n){Pi.window.showErrorMessage("Task frequency is required");return}t=t.replace(/([^a-zA-Z0-9/]+)/g,"_");let r=`task "${t}" {
  active = false
  stack {
    debug.log {
      value = "This task runs ${n.label}"
    }
  }
  
  schedule {
    events = [
      {starts_on: ${x5()}, freq: ${n.value}}
    ]
  }
}`;try{let s=Pi.Uri.file((0,eS.join)(ge,A.paths.tasks,`${(0,tS.snakeCase)(t)}.xs`));if(await Pi.workspace.fs.stat(s).then(c=>c,()=>null)){Pi.window.showErrorMessage("A file with the same name already exists");return}await Pi.workspace.fs.writeFile(s,Buffer.from(r)),jt(s),Pi.window.showInformationMessage(`Task ${t} created successfully`),await nn([s.path.slice(ge.length+1)]),je.refresh()}catch{Pi.window.showErrorMessage("Failed to create task");return}}async function rS(){await ps();try{await pc(),console.info("Xano registry pulled successfully")}catch(t){console.error("Failed to pull Xano registry",t)}}async function iS(){try{return hf()}catch(t){console.error("Failed to push Xano registry",t)}}var wa=we(require("vscode"));async function sS(t){let e=t?.path;if(!e){let a=wa.window.activeTextEditor;if(!a){wa.window.showErrorMessage("Please open a file to stage");return}e=a.document.uri.path.slice(ge.length+1)}let n=await Ht(),r=fs(n,e);if(!r){wa.window.showErrorMessage("This file is not part of the xano registry");return}if(r.staged===!0){wa.window.showErrorMessage("Could not stage this file, it is already staged");return}if(r.status==="unchanged"){wa.window.showErrorMessage("Could not stage this file, it has no changes");return}if(r.status==="error"){wa.window.showErrorMessage("Could not stage this file due to an error in the registry");return}let s=ma(n,e,{staged:!0});await gn(s),je.refresh()}var jl=we(require("vscode"));async function oS(t){let e=t?.path;if(!e){let a=jl.window.activeTextEditor;if(!a){jl.window.showErrorMessage("Please open a file to unstage");return}e=a.document.uri.path.slice(ge.length+1)}let n=await Ht(),r=fs(n,e);if(!r){jl.window.showErrorMessage("This file is not part of the xano registry");return}if(r.staged===!1){jl.window.showErrorMessage("Could not unstage this file, it is already unstaged");return}let s=ma(n,e,{staged:!1});await gn(s),je.refresh()}async function aS(){await Si(),je.refresh()}var Do=we(require("vscode"));var cS=require("path");async function lS(t){if(!t){Do.window.showErrorMessage("No file selected to view diff.");return}let e=(0,cS.join)(ge,t);if(!e){Do.window.showErrorMessage("No file path provided for the modified file.");return}let n=Do.Uri.file(e),r=Do.Uri.parse(`xano-baseline:${t}`);Do.commands.executeCommand("vscode.diff",r,n,`${t.split("/").pop()} (Original \u2194 Current)`)}var ba=we(require("vscode"));var uS=require("path");async function dS(t){if(!t){ba.window.showErrorMessage("No file selected to open.");return}let e=(0,uS.join)(ge,t.path),n=ba.Uri.file(e);await ba.workspace.openTextDocument(n).then(r=>{ba.window.showTextDocument(r)})}var wr=we(require("vscode"));var vf=require("path");async function fS(t){if(!t){wr.window.showErrorMessage("No file selected to open.");return}T5(t.path)}async function T5(t){let e=await Ht(),n=fs(e,t);if(!n){wr.window.showErrorMessage("This file is not part of the xano registry");return}if(n.staged){wr.window.showErrorMessage("Could not discard changes, this file is staged");return}if(n.status==="unchanged"){wr.window.showErrorMessage("Could not discard changes, this file has no changes");return}if(console.log("restoring folder",n.status),n.type==="api_group"&&n.status==="notfound"){let r=wr.Uri.file((0,vf.join)(ge,t));await wr.workspace.fs.createDirectory(r);let s=await Ht();s=await Wg(s),await gn(s),je.refresh();return}if(n.original){if((await wr.window.showWarningMessage(n.status==="notfound"?"Are you sure you want to restore this file?":"Are you sure you want to discard the changes?",{modal:!0},{value:"yes",title:n.status==="notfound"?"Restore File":"Disard Changes"}))?.value==="yes"){let s=Buffer.from(n.original,"base64").toString("utf-8"),a=wr.Uri.file((0,vf.join)(ge,t));await wr.workspace.fs.writeFile(a,Buffer.from(s,"utf-8")),e=await On(e,t),await gn(e),je.refresh(),wr.window.showInformationMessage("Changes discarded")}}else if((await wr.window.showWarningMessage("Discarding the changes will delete this file. Are you sure?",{modal:!0},{title:"Delete this file"}))?.title==="Delete this file"){let s=wr.Uri.file((0,vf.join)(ge,t));await wr.workspace.fs.delete(s),e=await On(e,t),await gn(e),je.refresh(),wr.window.showInformationMessage("File deleted")}}var pS=we(require("vscode"));async function hS(){let t=await Ht(),e=t.filter(n=>n.staged);if(e.length===0){pS.window.showInformationMessage("No staged files to unstage.");return}for(let n of e)n.staged=!1;await gn(t),je.refresh()}var er=we(require("vscode"));var g_=require("path");async function mS(){let t=await _S();if(t.length>0){if((await er.window.showWarningMessage("Stash already exists. Do you want to overwrite it?",{modal:!0},{title:"Overwrite"},{title:"Cancel"}))?.title!=="Overwrite")return;t.length=0}let n=(await Si()).filter(r=>r.status==="changed"||r.status==="new"||r.status==="notfound");for(let r of n){let s=er.Uri.file((0,g_.join)(ge,r.path)),a=await Ds(s),c={id:r.id,type:r.type,path:r.path,status:r.status,content:a.toString()};r.original?await er.workspace.fs.writeFile(s,Buffer.from(r.original,"base64")):await er.workspace.fs.delete(s),t.push(c)}await er.workspace.fs.writeFile(er.Uri.file(Il),Buffer.from(JSON.stringify(t,null,2),"utf-8")),await Si(),je.refresh()}async function gS(){let t=await _S();if(t.length===0){er.window.showWarningMessage("No stash found");return}let e=t.length===1?"change":"changes";if((await er.window.showWarningMessage(`Do you want to apply all ${t.length} ${e}?`,{modal:!0},{title:"Apply"},{title:"Cancel"}))?.title==="Apply"){for(let r of t){let s=er.Uri.file((0,g_.join)(ge,r.path)),a=s.path.substring(0,s.path.lastIndexOf("/"));await er.workspace.fs.createDirectory(er.Uri.file(a)),await er.workspace.fs.writeFile(s,Buffer.from(r.content,"utf-8"))}await Si(),je.refresh(),await er.workspace.fs.writeFile(er.Uri.file(Il),Buffer.from(JSON.stringify([]))),er.window.showInformationMessage("Stash applied")}}async function _S(){if(A.isReady)try{let t=await Ds(Il);return JSON.parse(t.toString())}catch(t){return t instanceof er.FileSystemError&&t.code==="ENOENT"?(await Pr(Il,JSON.stringify([])),[]):(console.error("readStash(): Error reading stash file",t),[])}else return console.error("readStash(): Xano extension has not been initialized in your current workspace"),[]}async function vS(){try{await mS(),console.info("Xano registry stashed successfully")}catch(t){console.error("Failed to stash Xano registry",t)}}var pu=require("path"),Ek=we(require("vscode"));function Ef(t){return Sf(t.map(([e,n])=>new Array(e).fill(n,0,e)))}function Sf(t){return t.reduce((e,n)=>e.concat(Array.isArray(n)?Sf(n):n),[])}var yS=[0,1,2,3].concat(...Ef([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function _n(){let t=this;function e(s){let a=t.dyn_tree,c=t.stat_desc.static_tree,l=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,f=t.stat_desc.max_length,p,m,g,w,v,x,b=0;for(w=0;w<=15;w++)s.bl_count[w]=0;for(a[s.heap[s.heap_max]*2+1]=0,p=s.heap_max+1;p<573;p++)m=s.heap[p],w=a[a[m*2+1]*2+1]+1,w>f&&(w=f,b++),a[m*2+1]=w,!(m>t.max_code)&&(s.bl_count[w]++,v=0,m>=d&&(v=l[m-d]),x=a[m*2],s.opt_len+=x*(w+v),c&&(s.static_len+=x*(c[m*2+1]+v)));if(b!==0){do{for(w=f-1;s.bl_count[w]===0;)w--;s.bl_count[w]--,s.bl_count[w+1]+=2,s.bl_count[f]--,b-=2}while(b>0);for(w=f;w!==0;w--)for(m=s.bl_count[w];m!==0;)g=s.heap[--p],!(g>t.max_code)&&(a[g*2+1]!=w&&(s.opt_len+=(w-a[g*2+1])*a[g*2],a[g*2+1]=w),m--)}}function n(s,a){let c=0;do c|=s&1,s>>>=1,c<<=1;while(--a>0);return c>>>1}function r(s,a,c){let l=[],d=0,f,p,m;for(f=1;f<=15;f++)l[f]=d=d+c[f-1]<<1;for(p=0;p<=a;p++)m=s[p*2+1],m!==0&&(s[p*2]=n(l[m]++,m))}t.build_tree=function(s){let a=t.dyn_tree,c=t.stat_desc.static_tree,l=t.stat_desc.elems,d,f,p=-1,m;for(s.heap_len=0,s.heap_max=573,d=0;d<l;d++)a[d*2]!==0?(s.heap[++s.heap_len]=p=d,s.depth[d]=0):a[d*2+1]=0;for(;s.heap_len<2;)m=s.heap[++s.heap_len]=p<2?++p:0,a[m*2]=1,s.depth[m]=0,s.opt_len--,c&&(s.static_len-=c[m*2+1]);for(t.max_code=p,d=Math.floor(s.heap_len/2);d>=1;d--)s.pqdownheap(a,d);m=l;do d=s.heap[1],s.heap[1]=s.heap[s.heap_len--],s.pqdownheap(a,1),f=s.heap[1],s.heap[--s.heap_max]=d,s.heap[--s.heap_max]=f,a[m*2]=a[d*2]+a[f*2],s.depth[m]=Math.max(s.depth[d],s.depth[f])+1,a[d*2+1]=a[f*2+1]=m,s.heap[1]=m++,s.pqdownheap(a,1);while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1],e(s),r(a,t.max_code,s.bl_count)}}_n._length_code=[0,1,2,3,4,5,6,7].concat(...Ef([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]]));_n.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0];_n.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576];_n.d_code=function(t){return t<256?yS[t]:yS[256+(t>>>7)]};_n.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];_n.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];_n.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];_n.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function br(t,e,n,r,s){let a=this;a.static_tree=t,a.extra_bits=e,a.extra_base=n,a.elems=r,a.max_length=s}var R5=[12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227],E5=Ef([[144,8],[112,9],[24,7],[8,8]]);br.static_ltree=Sf(R5.map((t,e)=>[t,E5[e]]));var S5=[0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23],C5=Ef([[30,5]]);br.static_dtree=Sf(S5.map((t,e)=>[t,C5[e]]));br.static_l_desc=new br(br.static_ltree,_n.extra_lbits,257,286,15);br.static_d_desc=new br(br.static_dtree,_n.extra_dbits,0,30,15);br.static_bl_desc=new br(null,_n.extra_blbits,0,19,7);var k5=9,P5=8;function $s(t,e,n,r,s){let a=this;a.good_length=t,a.max_lazy=e,a.nice_length=n,a.max_chain=r,a.func=s}var bS=0,Tf=1,xa=2,gs=[new $s(0,0,0,0,bS),new $s(4,4,8,4,Tf),new $s(4,5,16,8,Tf),new $s(4,6,32,32,Tf),new $s(4,4,16,16,xa),new $s(8,16,32,32,xa),new $s(8,16,128,128,xa),new $s(8,32,128,256,xa),new $s(32,128,258,1024,xa),new $s(32,258,258,4096,xa)],yf=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Ji=0,wf=1,Xl=2,bf=3,A5=32,__=42,xf=113,Bl=666,v_=8,D5=0,y_=1,I5=2,En=3,Rf=258,Ai=Rf+En+1;function wS(t,e,n,r){let s=t[e*2],a=t[n*2];return s<a||s==a&&r[e]<=r[n]}function $5(){let t=this,e,n,r,s,a,c,l,d,f,p,m,g,w,v,x,b,S,k,$,F,L,H,N,X,V,Y,D,j,ae,me,ue,_e,ke,De=new _n,Ie=new _n,Ce=new _n;t.depth=[];let Ge,Re,Oe,mt,ze,Xe;t.bl_count=[],t.heap=[],ue=[],_e=[],ke=[];function tt(){f=2*a,m[w-1]=0;for(let Q=0;Q<w-1;Q++)m[Q]=0;Y=gs[D].max_lazy,ae=gs[D].good_length,me=gs[D].nice_length,V=gs[D].max_chain,L=0,S=0,N=0,k=X=En-1,F=0,g=0}function We(){let Q;for(Q=0;Q<286;Q++)ue[Q*2]=0;for(Q=0;Q<30;Q++)_e[Q*2]=0;for(Q=0;Q<19;Q++)ke[Q*2]=0;ue[256*2]=1,t.opt_len=t.static_len=0,Re=Oe=0}function rn(){De.dyn_tree=ue,De.stat_desc=br.static_l_desc,Ie.dyn_tree=_e,Ie.stat_desc=br.static_d_desc,Ce.dyn_tree=ke,Ce.stat_desc=br.static_bl_desc,ze=0,Xe=0,mt=8,We()}t.pqdownheap=function(Q,se){let ne=t.heap,re=ne[se],ye=se<<1;for(;ye<=t.heap_len&&(ye<t.heap_len&&wS(Q,ne[ye+1],ne[ye],t.depth)&&ye++,!wS(Q,re,ne[ye],t.depth));)ne[se]=ne[ye],se=ye,ye<<=1;ne[se]=re};function sn(Q,se){let ne=-1,re,ye=Q[1],Ee=0,Le=7,gt=4;ye===0&&(Le=138,gt=3),Q[(se+1)*2+1]=65535;for(let Lt=0;Lt<=se;Lt++)re=ye,ye=Q[(Lt+1)*2+1],!(++Ee<Le&&re==ye)&&(Ee<gt?ke[re*2]+=Ee:re!==0?(re!=ne&&ke[re*2]++,ke[32]++):Ee<=10?ke[34]++:ke[36]++,Ee=0,ne=re,ye===0?(Le=138,gt=3):re==ye?(Le=6,gt=3):(Le=7,gt=4))}function Bn(){let Q;for(sn(ue,De.max_code),sn(_e,Ie.max_code),Ce.build_tree(t),Q=18;Q>=3&&ke[_n.bl_order[Q]*2+1]===0;Q--);return t.opt_len+=3*(Q+1)+5+5+4,Q}function Ye(Q){t.pending_buf[t.pending++]=Q}function Yt(Q){Ye(Q&255),Ye(Q>>>8&255)}function ln(Q){Ye(Q>>8&255),Ye(Q&255&255)}function rt(Q,se){let ne,re=se;Xe>16-re?(ne=Q,ze|=ne<<Xe&65535,Yt(ze),ze=ne>>>16-Xe,Xe+=re-16):(ze|=Q<<Xe&65535,Xe+=re)}function Nt(Q,se){let ne=Q*2;rt(se[ne]&65535,se[ne+1]&65535)}function tn(Q,se){let ne,re=-1,ye,Ee=Q[1],Le=0,gt=7,Lt=4;for(Ee===0&&(gt=138,Lt=3),ne=0;ne<=se;ne++)if(ye=Ee,Ee=Q[(ne+1)*2+1],!(++Le<gt&&ye==Ee)){if(Le<Lt)do Nt(ye,ke);while(--Le!==0);else ye!==0?(ye!=re&&(Nt(ye,ke),Le--),Nt(16,ke),rt(Le-3,2)):Le<=10?(Nt(17,ke),rt(Le-3,3)):(Nt(18,ke),rt(Le-11,7));Le=0,re=ye,Ee===0?(gt=138,Lt=3):ye==Ee?(gt=6,Lt=3):(gt=7,Lt=4)}}function Jt(Q,se,ne){let re;for(rt(Q-257,5),rt(se-1,5),rt(ne-4,4),re=0;re<ne;re++)rt(ke[_n.bl_order[re]*2+1],3);tn(ue,Q-1),tn(_e,se-1)}function st(){Xe==16?(Yt(ze),ze=0,Xe=0):Xe>=8&&(Ye(ze&255),ze>>>=8,Xe-=8)}function At(){rt(y_<<1,3),Nt(256,br.static_ltree),st(),1+mt+10-Xe<9&&(rt(y_<<1,3),Nt(256,br.static_ltree),st()),mt=7}function St(Q,se){let ne,re,ye;if(t.dist_buf[Re]=Q,t.lc_buf[Re]=se&255,Re++,Q===0?ue[se*2]++:(Oe++,Q--,ue[(_n._length_code[se]+256+1)*2]++,_e[_n.d_code(Q)*2]++),(Re&8191)===0&&D>2){for(ne=Re*8,re=L-S,ye=0;ye<30;ye++)ne+=_e[ye*2]*(5+_n.extra_dbits[ye]);if(ne>>>=3,Oe<Math.floor(Re/2)&&ne<Math.floor(re/2))return!0}return Re==Ge-1}function xn(Q,se){let ne,re,ye=0,Ee,Le;if(Re!==0)do ne=t.dist_buf[ye],re=t.lc_buf[ye],ye++,ne===0?Nt(re,Q):(Ee=_n._length_code[re],Nt(Ee+256+1,Q),Le=_n.extra_lbits[Ee],Le!==0&&(re-=_n.base_length[Ee],rt(re,Le)),ne--,Ee=_n.d_code(ne),Nt(Ee,se),Le=_n.extra_dbits[Ee],Le!==0&&(ne-=_n.base_dist[Ee],rt(ne,Le)));while(ye<Re);Nt(256,Q),mt=Q[256*2+1]}function pn(){Xe>8?Yt(ze):Xe>0&&Ye(ze&255),ze=0,Xe=0}function Sr(Q,se,ne){pn(),mt=8,ne&&(Yt(se),Yt(~se)),t.pending_buf.set(d.subarray(Q,Q+se),t.pending),t.pending+=se}function Zn(Q,se,ne){rt((D5<<1)+(ne?1:0),3),Sr(Q,se,!0)}function Un(Q,se,ne){let re,ye,Ee=0;D>0?(De.build_tree(t),Ie.build_tree(t),Ee=Bn(),re=t.opt_len+3+7>>>3,ye=t.static_len+3+7>>>3,ye<=re&&(re=ye)):re=ye=se+5,se+4<=re&&Q!=-1?Zn(Q,se,ne):ye==re?(rt((y_<<1)+(ne?1:0),3),xn(br.static_ltree,br.static_dtree)):(rt((I5<<1)+(ne?1:0),3),Jt(De.max_code+1,Ie.max_code+1,Ee+1),xn(ue,_e)),We(),ne&&pn()}function Gt(Q){Un(S>=0?S:-1,L-S,Q),S=L,e.flush_pending()}function Dn(){let Q,se,ne,re;do{if(re=f-N-L,re===0&&L===0&&N===0)re=a;else if(re==-1)re--;else if(L>=a+a-Ai){d.set(d.subarray(a,a+a),0),H-=a,L-=a,S-=a,Q=w,ne=Q;do se=m[--ne]&65535,m[ne]=se>=a?se-a:0;while(--Q!==0);Q=a,ne=Q;do se=p[--ne]&65535,p[ne]=se>=a?se-a:0;while(--Q!==0);re+=a}if(e.avail_in===0)return;Q=e.read_buf(d,L+N,re),N+=Q,N>=En&&(g=d[L]&255,g=(g<<b^d[L+1]&255)&x)}while(N<Ai&&e.avail_in!==0)}function q(Q){let se=65535,ne;for(se>r-5&&(se=r-5);;){if(N<=1){if(Dn(),N===0&&Q==0)return Ji;if(N===0)break}if(L+=N,N=0,ne=S+se,(L===0||L>=ne)&&(N=L-ne,L=ne,Gt(!1),e.avail_out===0)||L-S>=a-Ai&&(Gt(!1),e.avail_out===0))return Ji}return Gt(Q==4),e.avail_out===0?Q==4?Xl:Ji:Q==4?bf:wf}function ie(Q){let se=V,ne=L,re,ye,Ee=X,Le=L>a-Ai?L-(a-Ai):0,gt=me,Lt=l,ni=L+Rf,vi=d[ne+Ee-1],R=d[ne+Ee];X>=ae&&(se>>=2),gt>N&&(gt=N);do if(re=Q,!(d[re+Ee]!=R||d[re+Ee-1]!=vi||d[re]!=d[ne]||d[++re]!=d[ne+1])){ne+=2,re++;do;while(d[++ne]==d[++re]&&d[++ne]==d[++re]&&d[++ne]==d[++re]&&d[++ne]==d[++re]&&d[++ne]==d[++re]&&d[++ne]==d[++re]&&d[++ne]==d[++re]&&d[++ne]==d[++re]&&ne<ni);if(ye=Rf-(ni-ne),ne=ni-Rf,ye>Ee){if(H=Q,Ee=ye,ye>=gt)break;vi=d[ne+Ee-1],R=d[ne+Ee]}}while((Q=p[Q&Lt]&65535)>Le&&--se!==0);return Ee<=N?Ee:N}function xe(Q){let se=0,ne;for(;;){if(N<Ai){if(Dn(),N<Ai&&Q==0)return Ji;if(N===0)break}if(N>=En&&(g=(g<<b^d[L+(En-1)]&255)&x,se=m[g]&65535,p[L&l]=m[g],m[g]=L),se!==0&&(L-se&65535)<=a-Ai&&j!=2&&(k=ie(se)),k>=En)if(ne=St(L-H,k-En),N-=k,k<=Y&&N>=En){k--;do L++,g=(g<<b^d[L+(En-1)]&255)&x,se=m[g]&65535,p[L&l]=m[g],m[g]=L;while(--k!==0);L++}else L+=k,k=0,g=d[L]&255,g=(g<<b^d[L+1]&255)&x;else ne=St(0,d[L]&255),N--,L++;if(ne&&(Gt(!1),e.avail_out===0))return Ji}return Gt(Q==4),e.avail_out===0?Q==4?Xl:Ji:Q==4?bf:wf}function Pe(Q){let se=0,ne,re;for(;;){if(N<Ai){if(Dn(),N<Ai&&Q==0)return Ji;if(N===0)break}if(N>=En&&(g=(g<<b^d[L+(En-1)]&255)&x,se=m[g]&65535,p[L&l]=m[g],m[g]=L),X=k,$=H,k=En-1,se!==0&&X<Y&&(L-se&65535)<=a-Ai&&(j!=2&&(k=ie(se)),k<=5&&(j==1||k==En&&L-H>4096)&&(k=En-1)),X>=En&&k<=X){re=L+N-En,ne=St(L-1-$,X-En),N-=X-1,X-=2;do++L<=re&&(g=(g<<b^d[L+(En-1)]&255)&x,se=m[g]&65535,p[L&l]=m[g],m[g]=L);while(--X!==0);if(F=0,k=En-1,L++,ne&&(Gt(!1),e.avail_out===0))return Ji}else if(F!==0){if(ne=St(0,d[L-1]&255),ne&&Gt(!1),L++,N--,e.avail_out===0)return Ji}else F=1,L++,N--}return F!==0&&(ne=St(0,d[L-1]&255),F=0),Gt(Q==4),e.avail_out===0?Q==4?Xl:Ji:Q==4?bf:wf}function vt(Q){return Q.total_in=Q.total_out=0,Q.msg=null,t.pending=0,t.pending_out=0,n=xf,s=0,rn(),tt(),0}t.deflateInit=function(Q,se,ne,re,ye,Ee){return re||(re=v_),ye||(ye=P5),Ee||(Ee=0),Q.msg=null,se==-1&&(se=6),ye<1||ye>k5||re!=v_||ne<9||ne>15||se<0||se>9||Ee<0||Ee>2?-2:(Q.dstate=t,c=ne,a=1<<c,l=a-1,v=ye+7,w=1<<v,x=w-1,b=Math.floor((v+En-1)/En),d=new Uint8Array(a*2),p=[],m=[],Ge=1<<ye+6,t.pending_buf=new Uint8Array(Ge*4),r=Ge*4,t.dist_buf=new Uint16Array(Ge),t.lc_buf=new Uint8Array(Ge),D=se,j=Ee,vt(Q))},t.deflateEnd=function(){return n!=__&&n!=xf&&n!=Bl?-2:(t.lc_buf=null,t.dist_buf=null,t.pending_buf=null,m=null,p=null,d=null,t.dstate=null,n==xf?-3:0)},t.deflateParams=function(Q,se,ne){let re=0;return se==-1&&(se=6),se<0||se>9||ne<0||ne>2?-2:(gs[D].func!=gs[se].func&&Q.total_in!==0&&(re=Q.deflate(1)),D!=se&&(D=se,Y=gs[D].max_lazy,ae=gs[D].good_length,me=gs[D].nice_length,V=gs[D].max_chain),j=ne,re)},t.deflateSetDictionary=function(Q,se,ne){let re=ne,ye,Ee=0;if(!se||n!=__)return-2;if(re<En)return 0;for(re>a-Ai&&(re=a-Ai,Ee=ne-re),d.set(se.subarray(Ee,Ee+re),0),L=re,S=re,g=d[0]&255,g=(g<<b^d[1]&255)&x,ye=0;ye<=re-En;ye++)g=(g<<b^d[ye+(En-1)]&255)&x,p[ye&l]=m[g],m[g]=ye;return 0},t.deflate=function(Q,se){let ne,re,ye,Ee,Le;if(se>4||se<0)return-2;if(!Q.next_out||!Q.next_in&&Q.avail_in!==0||n==Bl&&se!=4)return Q.msg=yf[4],-2;if(Q.avail_out===0)return Q.msg=yf[7],-5;if(e=Q,Ee=s,s=se,n==__&&(re=v_+(c-8<<4)<<8,ye=(D-1&255)>>1,ye>3&&(ye=3),re|=ye<<6,L!==0&&(re|=A5),re+=31-re%31,n=xf,ln(re)),t.pending!==0){if(e.flush_pending(),e.avail_out===0)return s=-1,0}else if(e.avail_in===0&&se<=Ee&&se!=4)return e.msg=yf[7],-5;if(n==Bl&&e.avail_in!==0)return Q.msg=yf[7],-5;if(e.avail_in!==0||N!==0||se!=0&&n!=Bl){switch(Le=-1,gs[D].func){case bS:Le=q(se);break;case Tf:Le=xe(se);break;case xa:Le=Pe(se);break;default:}if((Le==Xl||Le==bf)&&(n=Bl),Le==Ji||Le==Xl)return e.avail_out===0&&(s=-1),0;if(Le==wf){if(se==1)At();else if(Zn(0,0,!1),se==3)for(ne=0;ne<w;ne++)m[ne]=0;if(e.flush_pending(),e.avail_out===0)return s=-1,0}}return se!=4?0:1}}function xS(){let t=this;t.next_in_index=0,t.next_out_index=0,t.avail_in=0,t.total_in=0,t.avail_out=0,t.total_out=0}xS.prototype={deflateInit(t,e){let n=this;return n.dstate=new $5,e||(e=15),n.dstate.deflateInit(n,t,e)},deflate(t){let e=this;return e.dstate?e.dstate.deflate(e,t):-2},deflateEnd(){let t=this;if(!t.dstate)return-2;let e=t.dstate.deflateEnd();return t.dstate=null,e},deflateParams(t,e){let n=this;return n.dstate?n.dstate.deflateParams(n,t,e):-2},deflateSetDictionary(t,e){let n=this;return n.dstate?n.dstate.deflateSetDictionary(n,t,e):-2},read_buf(t,e,n){let r=this,s=r.avail_in;return s>n&&(s=n),s===0?0:(r.avail_in-=s,t.set(r.next_in.subarray(r.next_in_index,r.next_in_index+s),e),r.next_in_index+=s,r.total_in+=s,s)},flush_pending(){let t=this,e=t.dstate.pending;e>t.avail_out&&(e=t.avail_out),e!==0&&(t.next_out.set(t.dstate.pending_buf.subarray(t.dstate.pending_out,t.dstate.pending_out+e),t.next_out_index),t.next_out_index+=e,t.dstate.pending_out+=e,t.total_out+=e,t.avail_out-=e,t.dstate.pending-=e,t.dstate.pending===0&&(t.dstate.pending_out=0))}};function TS(t){let e=this,n=new xS,r=O5(t&&t.chunkSize?t.chunkSize:64*1024),s=0,a=new Uint8Array(r),c=t?t.level:-1;typeof c>"u"&&(c=-1),n.deflateInit(c),n.next_out=a,e.append=function(l,d){let f,p,m=0,g=0,w=0,v=[];if(l.length){n.next_in_index=0,n.next_in=l,n.avail_in=l.length;do{if(n.next_out_index=0,n.avail_out=r,f=n.deflate(s),f!=0)throw new Error("deflating: "+n.msg);n.next_out_index&&(n.next_out_index==r?v.push(new Uint8Array(a)):v.push(a.subarray(0,n.next_out_index))),w+=n.next_out_index,d&&n.next_in_index>0&&n.next_in_index!=m&&(d(n.next_in_index),m=n.next_in_index)}while(n.avail_in>0||n.avail_out===0);return v.length>1?(p=new Uint8Array(w),v.forEach(function(x){p.set(x,g),g+=x.length})):p=v[0]?new Uint8Array(v[0]):new Uint8Array,p}},e.flush=function(){let l,d,f=0,p=0,m=[];do{if(n.next_out_index=0,n.avail_out=r,l=n.deflate(4),l!=1&&l!=0)throw new Error("deflating: "+n.msg);r-n.avail_out>0&&m.push(a.slice(0,n.next_out_index)),p+=n.next_out_index}while(n.avail_in>0||n.avail_out===0);return n.deflateEnd(),d=new Uint8Array(p),m.forEach(function(g){d.set(g,f),f+=g.length}),d}}function O5(t){return t+5*(Math.floor(t/16383)+1)}var Di=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],jS=1440,F5=0,N5=4,M5=9,q5=5,L5=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],U5=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],W5=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],H5=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],j5=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],X5=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Io=15;function T_(){let t=this,e,n,r,s,a,c;function l(f,p,m,g,w,v,x,b,S,k,$){let F,L,H,N,X,V,Y,D,j,ae,me,ue,_e,ke,De;ae=0,X=m;do r[f[p+ae]]++,ae++,X--;while(X!==0);if(r[0]==m)return x[0]=-1,b[0]=0,0;for(D=b[0],V=1;V<=Io&&r[V]===0;V++);for(Y=V,D<V&&(D=V),X=Io;X!==0&&r[X]===0;X--);for(H=X,D>X&&(D=X),b[0]=D,ke=1<<V;V<X;V++,ke<<=1)if((ke-=r[V])<0)return-3;if((ke-=r[X])<0)return-3;for(r[X]+=ke,c[1]=V=0,ae=1,_e=2;--X!==0;)c[_e]=V+=r[ae],_e++,ae++;X=0,ae=0;do(V=f[p+ae])!==0&&($[c[V]++]=X),ae++;while(++X<m);for(m=c[H],c[0]=X=0,ae=0,N=-1,ue=-D,a[0]=0,me=0,De=0;Y<=H;Y++)for(F=r[Y];F--!==0;){for(;Y>ue+D;){if(N++,ue+=D,De=H-ue,De=De>D?D:De,(L=1<<(V=Y-ue))>F+1&&(L-=F+1,_e=Y,V<De))for(;++V<De&&!((L<<=1)<=r[++_e]);)L-=r[_e];if(De=1<<V,k[0]+De>jS)return-3;a[N]=me=k[0],k[0]+=De,N!==0?(c[N]=X,s[0]=V,s[1]=D,V=X>>>ue-D,s[2]=me-a[N-1]-V,S.set(s,(a[N-1]+V)*3)):x[0]=me}for(s[1]=Y-ue,ae>=m?s[0]=192:$[ae]<g?(s[0]=$[ae]<256?0:96,s[2]=$[ae++]):(s[0]=v[$[ae]-g]+16+64,s[2]=w[$[ae++]-g]),L=1<<Y-ue,V=X>>>ue;V<De;V+=L)S.set(s,(me+V)*3);for(V=1<<Y-1;(X&V)!==0;V>>>=1)X^=V;for(X^=V,j=(1<<ue)-1;(X&j)!=c[N];)N--,ue-=D,j=(1<<ue)-1}return ke!==0&&H!=1?-5:0}function d(f){let p;for(e||(e=[],n=[],r=new Int32Array(Io+1),s=[],a=new Int32Array(Io),c=new Int32Array(Io+1)),n.length<f&&(n=[]),p=0;p<f;p++)n[p]=0;for(p=0;p<Io+1;p++)r[p]=0;for(p=0;p<3;p++)s[p]=0;a.set(r.subarray(0,Io),0),c.set(r.subarray(0,Io+1),0)}t.inflate_trees_bits=function(f,p,m,g,w){let v;return d(19),e[0]=0,v=l(f,0,19,19,null,null,m,p,g,e,n),v==-3?w.msg="oversubscribed dynamic bit lengths tree":(v==-5||p[0]===0)&&(w.msg="incomplete dynamic bit lengths tree",v=-3),v},t.inflate_trees_dynamic=function(f,p,m,g,w,v,x,b,S){let k;return d(288),e[0]=0,k=l(m,0,f,257,W5,H5,v,g,b,e,n),k!=0||g[0]===0?(k==-3?S.msg="oversubscribed literal/length tree":k!=-4&&(S.msg="incomplete literal/length tree",k=-3),k):(d(288),k=l(m,f,p,0,j5,X5,x,w,b,e,n),k!=0||w[0]===0&&f>257?(k==-3?S.msg="oversubscribed distance tree":k==-5?(S.msg="incomplete distance tree",k=-3):k!=-4&&(S.msg="empty distance tree with lengths",k=-3),k):0)}}T_.inflate_trees_fixed=function(t,e,n,r){return t[0]=M5,e[0]=q5,n[0]=L5,r[0]=U5,0};var Cf=0,RS=1,ES=2,SS=3,CS=4,kS=5,PS=6,w_=7,AS=8,kf=9;function B5(){let t=this,e,n=0,r,s=0,a=0,c=0,l=0,d=0,f=0,p=0,m,g=0,w,v=0;function x(b,S,k,$,F,L,H,N){let X,V,Y,D,j,ae,me,ue,_e,ke,De,Ie,Ce,Ge,Re,Oe;me=N.next_in_index,ue=N.avail_in,j=H.bitb,ae=H.bitk,_e=H.write,ke=_e<H.read?H.read-_e-1:H.end-_e,De=Di[b],Ie=Di[S];do{for(;ae<20;)ue--,j|=(N.read_byte(me++)&255)<<ae,ae+=8;if(X=j&De,V=k,Y=$,Oe=(Y+X)*3,(D=V[Oe])===0){j>>=V[Oe+1],ae-=V[Oe+1],H.win[_e++]=V[Oe+2],ke--;continue}do{if(j>>=V[Oe+1],ae-=V[Oe+1],(D&16)!==0){for(D&=15,Ce=V[Oe+2]+(j&Di[D]),j>>=D,ae-=D;ae<15;)ue--,j|=(N.read_byte(me++)&255)<<ae,ae+=8;X=j&Ie,V=F,Y=L,Oe=(Y+X)*3,D=V[Oe];do if(j>>=V[Oe+1],ae-=V[Oe+1],(D&16)!==0){for(D&=15;ae<D;)ue--,j|=(N.read_byte(me++)&255)<<ae,ae+=8;if(Ge=V[Oe+2]+(j&Di[D]),j>>=D,ae-=D,ke-=Ce,_e>=Ge)Re=_e-Ge,_e-Re>0&&2>_e-Re?(H.win[_e++]=H.win[Re++],H.win[_e++]=H.win[Re++],Ce-=2):(H.win.set(H.win.subarray(Re,Re+2),_e),_e+=2,Re+=2,Ce-=2);else{Re=_e-Ge;do Re+=H.end;while(Re<0);if(D=H.end-Re,Ce>D){if(Ce-=D,_e-Re>0&&D>_e-Re)do H.win[_e++]=H.win[Re++];while(--D!==0);else H.win.set(H.win.subarray(Re,Re+D),_e),_e+=D,Re+=D,D=0;Re=0}}if(_e-Re>0&&Ce>_e-Re)do H.win[_e++]=H.win[Re++];while(--Ce!==0);else H.win.set(H.win.subarray(Re,Re+Ce),_e),_e+=Ce,Re+=Ce,Ce=0;break}else if((D&64)===0)X+=V[Oe+2],X+=j&Di[D],Oe=(Y+X)*3,D=V[Oe];else return N.msg="invalid distance code",Ce=N.avail_in-ue,Ce=ae>>3<Ce?ae>>3:Ce,ue+=Ce,me-=Ce,ae-=Ce<<3,H.bitb=j,H.bitk=ae,N.avail_in=ue,N.total_in+=me-N.next_in_index,N.next_in_index=me,H.write=_e,-3;while(!0);break}if((D&64)===0){if(X+=V[Oe+2],X+=j&Di[D],Oe=(Y+X)*3,(D=V[Oe])===0){j>>=V[Oe+1],ae-=V[Oe+1],H.win[_e++]=V[Oe+2],ke--;break}}else return(D&32)!==0?(Ce=N.avail_in-ue,Ce=ae>>3<Ce?ae>>3:Ce,ue+=Ce,me-=Ce,ae-=Ce<<3,H.bitb=j,H.bitk=ae,N.avail_in=ue,N.total_in+=me-N.next_in_index,N.next_in_index=me,H.write=_e,1):(N.msg="invalid literal/length code",Ce=N.avail_in-ue,Ce=ae>>3<Ce?ae>>3:Ce,ue+=Ce,me-=Ce,ae-=Ce<<3,H.bitb=j,H.bitk=ae,N.avail_in=ue,N.total_in+=me-N.next_in_index,N.next_in_index=me,H.write=_e,-3)}while(!0)}while(ke>=258&&ue>=10);return Ce=N.avail_in-ue,Ce=ae>>3<Ce?ae>>3:Ce,ue+=Ce,me-=Ce,ae-=Ce<<3,H.bitb=j,H.bitk=ae,N.avail_in=ue,N.total_in+=me-N.next_in_index,N.next_in_index=me,H.write=_e,0}t.init=function(b,S,k,$,F,L){e=Cf,f=b,p=S,m=k,g=$,w=F,v=L,r=null},t.proc=function(b,S,k){let $,F,L,H=0,N=0,X=0,V,Y,D,j;for(X=S.next_in_index,V=S.avail_in,H=b.bitb,N=b.bitk,Y=b.write,D=Y<b.read?b.read-Y-1:b.end-Y;;)switch(e){case Cf:if(D>=258&&V>=10&&(b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,k=x(f,p,m,g,w,v,b,S),X=S.next_in_index,V=S.avail_in,H=b.bitb,N=b.bitk,Y=b.write,D=Y<b.read?b.read-Y-1:b.end-Y,k!=0)){e=k==1?w_:kf;break}a=f,r=m,s=g,e=RS;case RS:for($=a;N<$;){if(V!==0)k=0;else return b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);V--,H|=(S.read_byte(X++)&255)<<N,N+=8}if(F=(s+(H&Di[$]))*3,H>>>=r[F+1],N-=r[F+1],L=r[F],L===0){c=r[F+2],e=PS;break}if((L&16)!==0){l=L&15,n=r[F+2],e=ES;break}if((L&64)===0){a=L,s=F/3+r[F+2];break}if((L&32)!==0){e=w_;break}return e=kf,S.msg="invalid literal/length code",k=-3,b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);case ES:for($=l;N<$;){if(V!==0)k=0;else return b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);V--,H|=(S.read_byte(X++)&255)<<N,N+=8}n+=H&Di[$],H>>=$,N-=$,a=p,r=w,s=v,e=SS;case SS:for($=a;N<$;){if(V!==0)k=0;else return b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);V--,H|=(S.read_byte(X++)&255)<<N,N+=8}if(F=(s+(H&Di[$]))*3,H>>=r[F+1],N-=r[F+1],L=r[F],(L&16)!==0){l=L&15,d=r[F+2],e=CS;break}if((L&64)===0){a=L,s=F/3+r[F+2];break}return e=kf,S.msg="invalid distance code",k=-3,b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);case CS:for($=l;N<$;){if(V!==0)k=0;else return b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);V--,H|=(S.read_byte(X++)&255)<<N,N+=8}d+=H&Di[$],H>>=$,N-=$,e=kS;case kS:for(j=Y-d;j<0;)j+=b.end;for(;n!==0;){if(D===0&&(Y==b.end&&b.read!==0&&(Y=0,D=Y<b.read?b.read-Y-1:b.end-Y),D===0&&(b.write=Y,k=b.inflate_flush(S,k),Y=b.write,D=Y<b.read?b.read-Y-1:b.end-Y,Y==b.end&&b.read!==0&&(Y=0,D=Y<b.read?b.read-Y-1:b.end-Y),D===0)))return b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);b.win[Y++]=b.win[j++],D--,j==b.end&&(j=0),n--}e=Cf;break;case PS:if(D===0&&(Y==b.end&&b.read!==0&&(Y=0,D=Y<b.read?b.read-Y-1:b.end-Y),D===0&&(b.write=Y,k=b.inflate_flush(S,k),Y=b.write,D=Y<b.read?b.read-Y-1:b.end-Y,Y==b.end&&b.read!==0&&(Y=0,D=Y<b.read?b.read-Y-1:b.end-Y),D===0)))return b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);k=0,b.win[Y++]=c,D--,e=Cf;break;case w_:if(N>7&&(N-=8,V++,X--),b.write=Y,k=b.inflate_flush(S,k),Y=b.write,D=Y<b.read?b.read-Y-1:b.end-Y,b.read!=b.write)return b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);e=AS;case AS:return k=1,b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);case kf:return k=-3,b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k);default:return k=-2,b.bitb=H,b.bitk=N,S.avail_in=V,S.total_in+=X-S.next_in_index,S.next_in_index=X,b.write=Y,b.inflate_flush(S,k)}},t.free=function(){}}var DS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],hc=0,b_=1,IS=2,$S=3,OS=4,FS=5,Pf=6,Af=7,NS=8,Ta=9;function G5(t,e){let n=this,r=hc,s=0,a=0,c=0,l,d=[0],f=[0],p=new B5,m=0,g=new Int32Array(jS*3),w=0,v=new T_;n.bitk=0,n.bitb=0,n.win=new Uint8Array(e),n.end=e,n.read=0,n.write=0,n.reset=function(x,b){b&&(b[0]=w),r==Pf&&p.free(x),r=hc,n.bitk=0,n.bitb=0,n.read=n.write=0},n.reset(t,null),n.inflate_flush=function(x,b){let S,k,$;return k=x.next_out_index,$=n.read,S=($<=n.write?n.write:n.end)-$,S>x.avail_out&&(S=x.avail_out),S!==0&&b==-5&&(b=0),x.avail_out-=S,x.total_out+=S,x.next_out.set(n.win.subarray($,$+S),k),k+=S,$+=S,$==n.end&&($=0,n.write==n.end&&(n.write=0),S=n.write-$,S>x.avail_out&&(S=x.avail_out),S!==0&&b==-5&&(b=0),x.avail_out-=S,x.total_out+=S,x.next_out.set(n.win.subarray($,$+S),k),k+=S,$+=S),x.next_out_index=k,n.read=$,b},n.proc=function(x,b){let S,k,$,F,L,H,N,X;for(F=x.next_in_index,L=x.avail_in,k=n.bitb,$=n.bitk,H=n.write,N=H<n.read?n.read-H-1:n.end-H;;){let V,Y,D,j,ae,me,ue,_e;switch(r){case hc:for(;$<3;){if(L!==0)b=0;else return n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);L--,k|=(x.read_byte(F++)&255)<<$,$+=8}switch(S=k&7,m=S&1,S>>>1){case 0:k>>>=3,$-=3,S=$&7,k>>>=S,$-=S,r=b_;break;case 1:V=[],Y=[],D=[[]],j=[[]],T_.inflate_trees_fixed(V,Y,D,j),p.init(V[0],Y[0],D[0],0,j[0],0),k>>>=3,$-=3,r=Pf;break;case 2:k>>>=3,$-=3,r=$S;break;case 3:return k>>>=3,$-=3,r=Ta,x.msg="invalid block type",b=-3,n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b)}break;case b_:for(;$<32;){if(L!==0)b=0;else return n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);L--,k|=(x.read_byte(F++)&255)<<$,$+=8}if((~k>>>16&65535)!=(k&65535))return r=Ta,x.msg="invalid stored block lengths",b=-3,n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);s=k&65535,k=$=0,r=s!==0?IS:m!==0?Af:hc;break;case IS:if(L===0||N===0&&(H==n.end&&n.read!==0&&(H=0,N=H<n.read?n.read-H-1:n.end-H),N===0&&(n.write=H,b=n.inflate_flush(x,b),H=n.write,N=H<n.read?n.read-H-1:n.end-H,H==n.end&&n.read!==0&&(H=0,N=H<n.read?n.read-H-1:n.end-H),N===0)))return n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);if(b=0,S=s,S>L&&(S=L),S>N&&(S=N),n.win.set(x.read_buf(F,S),H),F+=S,L-=S,H+=S,N-=S,(s-=S)!==0)break;r=m!==0?Af:hc;break;case $S:for(;$<14;){if(L!==0)b=0;else return n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);L--,k|=(x.read_byte(F++)&255)<<$,$+=8}if(a=S=k&16383,(S&31)>29||(S>>5&31)>29)return r=Ta,x.msg="too many length or distance symbols",b=-3,n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);if(S=258+(S&31)+(S>>5&31),!l||l.length<S)l=[];else for(X=0;X<S;X++)l[X]=0;k>>>=14,$-=14,c=0,r=OS;case OS:for(;c<4+(a>>>10);){for(;$<3;){if(L!==0)b=0;else return n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);L--,k|=(x.read_byte(F++)&255)<<$,$+=8}l[DS[c++]]=k&7,k>>>=3,$-=3}for(;c<19;)l[DS[c++]]=0;if(d[0]=7,S=v.inflate_trees_bits(l,d,f,g,x),S!=0)return b=S,b==-3&&(l=null,r=Ta),n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);c=0,r=FS;case FS:for(;S=a,!(c>=258+(S&31)+(S>>5&31));){let ke,De;for(S=d[0];$<S;){if(L!==0)b=0;else return n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);L--,k|=(x.read_byte(F++)&255)<<$,$+=8}if(S=g[(f[0]+(k&Di[S]))*3+1],De=g[(f[0]+(k&Di[S]))*3+2],De<16)k>>>=S,$-=S,l[c++]=De;else{for(X=De==18?7:De-14,ke=De==18?11:3;$<S+X;){if(L!==0)b=0;else return n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);L--,k|=(x.read_byte(F++)&255)<<$,$+=8}if(k>>>=S,$-=S,ke+=k&Di[X],k>>>=X,$-=X,X=c,S=a,X+ke>258+(S&31)+(S>>5&31)||De==16&&X<1)return l=null,r=Ta,x.msg="invalid bit length repeat",b=-3,n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);De=De==16?l[X-1]:0;do l[X++]=De;while(--ke!==0);c=X}}if(f[0]=-1,ae=[],me=[],ue=[],_e=[],ae[0]=9,me[0]=6,S=a,S=v.inflate_trees_dynamic(257+(S&31),1+(S>>5&31),l,ae,me,ue,_e,g,x),S!=0)return S==-3&&(l=null,r=Ta),b=S,n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);p.init(ae[0],me[0],g,ue[0],g,_e[0]),r=Pf;case Pf:if(n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,(b=p.proc(n,x,b))!=1)return n.inflate_flush(x,b);if(b=0,p.free(x),F=x.next_in_index,L=x.avail_in,k=n.bitb,$=n.bitk,H=n.write,N=H<n.read?n.read-H-1:n.end-H,m===0){r=hc;break}r=Af;case Af:if(n.write=H,b=n.inflate_flush(x,b),H=n.write,N=H<n.read?n.read-H-1:n.end-H,n.read!=n.write)return n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);r=NS;case NS:return b=1,n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);case Ta:return b=-3,n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b);default:return b=-2,n.bitb=k,n.bitk=$,x.avail_in=L,x.total_in+=F-x.next_in_index,x.next_in_index=F,n.write=H,n.inflate_flush(x,b)}}},n.free=function(x){n.reset(x,null),n.win=null,g=null},n.set_dictionary=function(x,b,S){n.win.set(x.subarray(b,b+S),0),n.read=n.write=S},n.sync_point=function(){return r==b_?1:0}}var z5=32,K5=8,Z5=0,MS=1,qS=2,LS=3,US=4,WS=5,x_=6,Gl=7,HS=12,$o=13,V5=[0,0,255,255];function Y5(){let t=this;t.mode=0,t.method=0,t.was=[0],t.need=0,t.marker=0,t.wbits=0;function e(n){return!n||!n.istate?-2:(n.total_in=n.total_out=0,n.msg=null,n.istate.mode=Gl,n.istate.blocks.reset(n,null),0)}t.inflateEnd=function(n){return t.blocks&&t.blocks.free(n),t.blocks=null,0},t.inflateInit=function(n,r){return n.msg=null,t.blocks=null,r<8||r>15?(t.inflateEnd(n),-2):(t.wbits=r,n.istate.blocks=new G5(n,1<<r),e(n),0)},t.inflate=function(n,r){let s,a;if(!n||!n.istate||!n.next_in)return-2;let c=n.istate;for(r=r==N5?-5:0,s=-5;;)switch(c.mode){case Z5:if(n.avail_in===0)return s;if(s=r,n.avail_in--,n.total_in++,((c.method=n.read_byte(n.next_in_index++))&15)!=K5){c.mode=$o,n.msg="unknown compression method",c.marker=5;break}if((c.method>>4)+8>c.wbits){c.mode=$o,n.msg="invalid win size",c.marker=5;break}c.mode=MS;case MS:if(n.avail_in===0)return s;if(s=r,n.avail_in--,n.total_in++,a=n.read_byte(n.next_in_index++)&255,((c.method<<8)+a)%31!==0){c.mode=$o,n.msg="incorrect header check",c.marker=5;break}if((a&z5)===0){c.mode=Gl;break}c.mode=qS;case qS:if(n.avail_in===0)return s;s=r,n.avail_in--,n.total_in++,c.need=(n.read_byte(n.next_in_index++)&255)<<24&4278190080,c.mode=LS;case LS:if(n.avail_in===0)return s;s=r,n.avail_in--,n.total_in++,c.need+=(n.read_byte(n.next_in_index++)&255)<<16&16711680,c.mode=US;case US:if(n.avail_in===0)return s;s=r,n.avail_in--,n.total_in++,c.need+=(n.read_byte(n.next_in_index++)&255)<<8&65280,c.mode=WS;case WS:return n.avail_in===0?s:(s=r,n.avail_in--,n.total_in++,c.need+=n.read_byte(n.next_in_index++)&255,c.mode=x_,2);case x_:return c.mode=$o,n.msg="need dictionary",c.marker=0,-2;case Gl:if(s=c.blocks.proc(n,s),s==-3){c.mode=$o,c.marker=0;break}if(s==0&&(s=r),s!=1)return s;s=r,c.blocks.reset(n,c.was),c.mode=HS;case HS:return n.avail_in=0,1;case $o:return-3;default:return-2}},t.inflateSetDictionary=function(n,r,s){let a=0,c=s;if(!n||!n.istate||n.istate.mode!=x_)return-2;let l=n.istate;return c>=1<<l.wbits&&(c=(1<<l.wbits)-1,a=s-c),l.blocks.set_dictionary(r,a,c),l.mode=Gl,0},t.inflateSync=function(n){let r,s,a,c,l;if(!n||!n.istate)return-2;let d=n.istate;if(d.mode!=$o&&(d.mode=$o,d.marker=0),(r=n.avail_in)===0)return-5;for(s=n.next_in_index,a=d.marker;r!==0&&a<4;)n.read_byte(s)==V5[a]?a++:n.read_byte(s)!==0?a=0:a=4-a,s++,r--;return n.total_in+=s-n.next_in_index,n.next_in_index=s,n.avail_in=r,d.marker=a,a!=4?-3:(c=n.total_in,l=n.total_out,e(n),n.total_in=c,n.total_out=l,d.mode=Gl,0)},t.inflateSyncPoint=function(n){return!n||!n.istate||!n.istate.blocks?-2:n.istate.blocks.sync_point()}}function XS(){}XS.prototype={inflateInit(t){let e=this;return e.istate=new Y5,t||(t=15),e.istate.inflateInit(e,t)},inflate(t){let e=this;return e.istate?e.istate.inflate(e,t):-2},inflateEnd(){let t=this;if(!t.istate)return-2;let e=t.istate.inflateEnd(t);return t.istate=null,e},inflateSync(){let t=this;return t.istate?t.istate.inflateSync(t):-2},inflateSetDictionary(t,e){let n=this;return n.istate?n.istate.inflateSetDictionary(n,t,e):-2},read_byte(t){return this.next_in[t]},read_buf(t,e){return this.next_in.subarray(t,t+e)}};function BS(t){let e=this,n=new XS,r=t&&t.chunkSize?Math.floor(t.chunkSize*2):128*1024,s=F5,a=new Uint8Array(r),c=!1;n.inflateInit(),n.next_out=a,e.append=function(l,d){let f=[],p,m,g=0,w=0,v=0;if(l.length!==0){n.next_in_index=0,n.next_in=l,n.avail_in=l.length;do{if(n.next_out_index=0,n.avail_out=r,n.avail_in===0&&!c&&(n.next_in_index=0,c=!0),p=n.inflate(s),c&&p===-5){if(n.avail_in!==0)throw new Error("inflating: bad input")}else if(p!==0&&p!==1)throw new Error("inflating: "+n.msg);if((c||p===1)&&n.avail_in===l.length)throw new Error("inflating: bad input");n.next_out_index&&(n.next_out_index===r?f.push(new Uint8Array(a)):f.push(a.subarray(0,n.next_out_index))),v+=n.next_out_index,d&&n.next_in_index>0&&n.next_in_index!=g&&(d(n.next_in_index),g=n.next_in_index)}while(n.avail_in>0||n.avail_out===0);return f.length>1?(m=new Uint8Array(v),f.forEach(function(x){m.set(x,w),w+=x.length})):m=f[0]?new Uint8Array(f[0]):new Uint8Array,m}},e.flush=function(){n.inflateEnd()}}var R_=new Date(2107,11,31),E_=new Date(1980,0,1),Je=void 0,Ii="undefined",Os="function";var zl=class{constructor(e){return class extends TransformStream{constructor(n,r){let s=new e(r);super({transform(a,c){c.enqueue(s.append(a))},flush(a){let c=s.flush();c&&a.enqueue(c)}})}}}};var J5=64,GS=2;try{typeof navigator!=Ii&&navigator.hardwareConcurrency&&(GS=navigator.hardwareConcurrency)}catch{}var Q5={chunkSize:512*1024,maxWorkers:GS,terminateWorkerTimeout:5e3,useWebWorkers:!0,useCompressionStream:!0,workerScripts:Je,CompressionStreamNative:typeof CompressionStream!=Ii&&CompressionStream,DecompressionStreamNative:typeof DecompressionStream!=Ii&&DecompressionStream},Fo=Object.assign({},Q5);function Kl(){return Fo}function Df(t){return Math.max(t.chunkSize,J5)}function mc(t){let{baseURL:e,chunkSize:n,maxWorkers:r,terminateWorkerTimeout:s,useCompressionStream:a,useWebWorkers:c,Deflate:l,Inflate:d,CompressionStream:f,DecompressionStream:p,workerScripts:m}=t;if(Oo("baseURL",e),Oo("chunkSize",n),Oo("maxWorkers",r),Oo("terminateWorkerTimeout",s),Oo("useCompressionStream",a),Oo("useWebWorkers",c),l&&(Fo.CompressionStream=new zl(l)),d&&(Fo.DecompressionStream=new zl(d)),Oo("CompressionStream",f),Oo("DecompressionStream",p),m!==Je){let{deflate:g,inflate:w}=m;if((g||w)&&(Fo.workerScripts||(Fo.workerScripts={})),g){if(!Array.isArray(g))throw new Error("workerScripts.deflate must be an array");Fo.workerScripts.deflate=g}if(w){if(!Array.isArray(w))throw new Error("workerScripts.inflate must be an array");Fo.workerScripts.inflate=w}}}function Oo(t,e){e!==Je&&(Fo[t]=e)}var S_={application:{"andrew-inset":"ez",annodex:"anx","atom+xml":"atom","atomcat+xml":"atomcat","atomserv+xml":"atomsrv",bbolin:"lin","cu-seeme":"cu","davmount+xml":"davmount",dsptype:"tsp",ecmascript:["es","ecma"],futuresplash:"spl",hta:"hta","java-archive":"jar","java-serialized-object":"ser","java-vm":"class",m3g:"m3g","mac-binhex40":"hqx",mathematica:["nb","ma","mb"],msaccess:"mdb",msword:["doc","dot","wiz"],mxf:"mxf",oda:"oda",ogg:"ogx",pdf:"pdf","pgp-keys":"key","pgp-signature":["asc","sig"],"pics-rules":"prf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],rar:"rar","rdf+xml":"rdf","rss+xml":"rss",rtf:"rtf","xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","xpdl"],"xspf+xml":"xspf",zip:"zip","vnd.android.package-archive":"apk","vnd.cinderella":"cdy","vnd.google-earth.kml+xml":"kml","vnd.google-earth.kmz":"kmz","vnd.mozilla.xul+xml":"xul","vnd.ms-excel":["xls","xlb","xlt","xlm","xla","xlc","xlw"],"vnd.ms-pki.seccat":"cat","vnd.ms-pki.stl":"stl","vnd.ms-powerpoint":["ppt","pps","pot","ppa","pwz"],"vnd.oasis.opendocument.chart":"odc","vnd.oasis.opendocument.database":"odb","vnd.oasis.opendocument.formula":"odf","vnd.oasis.opendocument.graphics":"odg","vnd.oasis.opendocument.graphics-template":"otg","vnd.oasis.opendocument.image":"odi","vnd.oasis.opendocument.presentation":"odp","vnd.oasis.opendocument.presentation-template":"otp","vnd.oasis.opendocument.spreadsheet":"ods","vnd.oasis.opendocument.spreadsheet-template":"ots","vnd.oasis.opendocument.text":"odt","vnd.oasis.opendocument.text-master":["odm","otm"],"vnd.oasis.opendocument.text-template":"ott","vnd.oasis.opendocument.text-web":"oth","vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","vnd.openxmlformats-officedocument.spreadsheetml.template":"xltx","vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","vnd.openxmlformats-officedocument.presentationml.slideshow":"ppsx","vnd.openxmlformats-officedocument.presentationml.template":"potx","vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","vnd.openxmlformats-officedocument.wordprocessingml.template":"dotx","vnd.smaf":"mmf","vnd.stardivision.calc":"sdc","vnd.stardivision.chart":"sds","vnd.stardivision.draw":"sda","vnd.stardivision.impress":"sdd","vnd.stardivision.math":["sdf","smf"],"vnd.stardivision.writer":["sdw","vor"],"vnd.stardivision.writer-global":"sgl","vnd.sun.xml.calc":"sxc","vnd.sun.xml.calc.template":"stc","vnd.sun.xml.draw":"sxd","vnd.sun.xml.draw.template":"std","vnd.sun.xml.impress":"sxi","vnd.sun.xml.impress.template":"sti","vnd.sun.xml.math":"sxm","vnd.sun.xml.writer":"sxw","vnd.sun.xml.writer.global":"sxg","vnd.sun.xml.writer.template":"stw","vnd.symbian.install":["sis","sisx"],"vnd.visio":["vsd","vst","vss","vsw","vsdx","vssx","vstx","vssm","vstm"],"vnd.wap.wbxml":"wbxml","vnd.wap.wmlc":"wmlc","vnd.wap.wmlscriptc":"wmlsc","vnd.wordperfect":"wpd","vnd.wordperfect5.1":"wp5","x-123":"wk","x-7z-compressed":"7z","x-abiword":"abw","x-apple-diskimage":"dmg","x-bcpio":"bcpio","x-bittorrent":"torrent","x-cbr":["cbr","cba","cbt","cb7"],"x-cbz":"cbz","x-cdf":["cdf","cda"],"x-cdlink":"vcd","x-chess-pgn":"pgn","x-cpio":"cpio","x-csh":"csh","x-director":["dir","dxr","cst","cct","cxt","w3d","fgd","swa"],"x-dms":"dms","x-doom":"wad","x-dvi":"dvi","x-httpd-eruby":"rhtml","x-font":"pcf.Z","x-freemind":"mm","x-gnumeric":"gnumeric","x-go-sgf":"sgf","x-graphing-calculator":"gcf","x-gtar":["gtar","taz"],"x-hdf":"hdf","x-httpd-php":["phtml","pht","php"],"x-httpd-php-source":"phps","x-httpd-php3":"php3","x-httpd-php3-preprocessed":"php3p","x-httpd-php4":"php4","x-httpd-php5":"php5","x-ica":"ica","x-info":"info","x-internet-signup":["ins","isp"],"x-iphone":"iii","x-iso9660-image":"iso","x-java-jnlp-file":"jnlp","x-jmol":"jmz","x-killustrator":"kil","x-latex":"latex","x-lyx":"lyx","x-lzx":"lzx","x-maker":["frm","fb","fbdoc"],"x-ms-wmd":"wmd","x-msdos-program":["com","exe","bat","dll"],"x-netcdf":["nc"],"x-ns-proxy-autoconfig":["pac","dat"],"x-nwc":"nwc","x-object":"o","x-oz-application":"oza","x-pkcs7-certreqresp":"p7r","x-python-code":["pyc","pyo"],"x-qgis":["qgs","shp","shx"],"x-quicktimeplayer":"qtl","x-redhat-package-manager":["rpm","rpa"],"x-ruby":"rb","x-sh":"sh","x-shar":"shar","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","x-stuffit":"sit","x-sv4cpio":"sv4cpio","x-sv4crc":"sv4crc","x-tar":"tar","x-tex-gf":"gf","x-tex-pk":"pk","x-texinfo":["texinfo","texi"],"x-trash":["~","%","bak","old","sik"],"x-ustar":"ustar","x-wais-source":"src","x-wingz":"wz","x-x509-ca-cert":["crt","der","cer"],"x-xcf":"xcf","x-xfig":"fig","x-xpinstall":"xpi",applixware:"aw","atomsvc+xml":"atomsvc","ccxml+xml":"ccxml","cdmi-capability":"cdmia","cdmi-container":"cdmic","cdmi-domain":"cdmid","cdmi-object":"cdmio","cdmi-queue":"cdmiq","docbook+xml":"dbk","dssc+der":"dssc","dssc+xml":"xdssc","emma+xml":"emma","epub+zip":"epub",exi:"exi","font-tdpfr":"pfr","gml+xml":"gml","gpx+xml":"gpx",gxf:"gxf",hyperstudio:"stk","inkml+xml":["ink","inkml"],ipfix:"ipfix","jsonml+json":"jsonml","lost+xml":"lostxml","mads+xml":"mads",marc:"mrc","marcxml+xml":"mrcx","mathml+xml":["mathml","mml"],mbox:"mbox","mediaservercontrol+xml":"mscml","metalink+xml":"metalink","metalink4+xml":"meta4","mets+xml":"mets","mods+xml":"mods",mp21:["m21","mp21"],mp4:"mp4s","oebps-package+xml":"opf","omdoc+xml":"omdoc",onenote:["onetoc","onetoc2","onetmp","onepkg"],oxps:"oxps","patch-ops-error+xml":"xer","pgp-encrypted":"pgp",pkcs10:"p10","pkcs7-mime":["p7m","p7c"],"pkcs7-signature":"p7s",pkcs8:"p8","pkix-attr-cert":"ac","pkix-crl":"crl","pkix-pkipath":"pkipath",pkixcmp:"pki","pls+xml":"pls","prs.cww":"cww","pskc+xml":"pskcxml","reginfo+xml":"rif","relax-ng-compact-syntax":"rnc","resource-lists+xml":"rl","resource-lists-diff+xml":"rld","rls-services+xml":"rs","rpki-ghostbusters":"gbr","rpki-manifest":"mft","rpki-roa":"roa","rsd+xml":"rsd","sbml+xml":"sbml","scvp-cv-request":"scq","scvp-cv-response":"scs","scvp-vp-request":"spq","scvp-vp-response":"spp",sdp:"sdp","set-payment-initiation":"setpay","set-registration-initiation":"setreg","shf+xml":"shf","sparql-query":"rq","sparql-results+xml":"srx",srgs:"gram","srgs+xml":"grxml","sru+xml":"sru","ssdl+xml":"ssdl","ssml+xml":"ssml","tei+xml":["tei","teicorpus"],"thraud+xml":"tfi","timestamped-data":"tsd","vnd.3gpp.pic-bw-large":"plb","vnd.3gpp.pic-bw-small":"psb","vnd.3gpp.pic-bw-var":"pvb","vnd.3gpp2.tcap":"tcap","vnd.3m.post-it-notes":"pwn","vnd.accpac.simply.aso":"aso","vnd.accpac.simply.imp":"imp","vnd.acucobol":"acu","vnd.acucorp":["atc","acutc"],"vnd.adobe.air-application-installer-package+zip":"air","vnd.adobe.formscentral.fcdt":"fcdt","vnd.adobe.fxp":["fxp","fxpl"],"vnd.adobe.xdp+xml":"xdp","vnd.adobe.xfdf":"xfdf","vnd.ahead.space":"ahead","vnd.airzip.filesecure.azf":"azf","vnd.airzip.filesecure.azs":"azs","vnd.amazon.ebook":"azw","vnd.americandynamics.acc":"acc","vnd.amiga.ami":"ami","vnd.anser-web-certificate-issue-initiation":"cii","vnd.anser-web-funds-transfer-initiation":"fti","vnd.antix.game-component":"atx","vnd.apple.installer+xml":"mpkg","vnd.apple.mpegurl":"m3u8","vnd.aristanetworks.swi":"swi","vnd.astraea-software.iota":"iota","vnd.audiograph":"aep","vnd.blueice.multipass":"mpm","vnd.bmi":"bmi","vnd.businessobjects":"rep","vnd.chemdraw+xml":"cdxml","vnd.chipnuts.karaoke-mmd":"mmd","vnd.claymore":"cla","vnd.cloanto.rp9":"rp9","vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"vnd.cluetrust.cartomobile-config":"c11amc","vnd.cluetrust.cartomobile-config-pkg":"c11amz","vnd.commonspace":"csp","vnd.contact.cmsg":"cdbcmsg","vnd.cosmocaller":"cmc","vnd.crick.clicker":"clkx","vnd.crick.clicker.keyboard":"clkk","vnd.crick.clicker.palette":"clkp","vnd.crick.clicker.template":"clkt","vnd.crick.clicker.wordbank":"clkw","vnd.criticaltools.wbs+xml":"wbs","vnd.ctc-posml":"pml","vnd.cups-ppd":"ppd","vnd.curl.car":"car","vnd.curl.pcurl":"pcurl","vnd.dart":"dart","vnd.data-vision.rdz":"rdz","vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"vnd.dece.ttml+xml":["uvt","uvvt"],"vnd.dece.unspecified":["uvx","uvvx"],"vnd.dece.zip":["uvz","uvvz"],"vnd.denovo.fcselayout-link":"fe_launch","vnd.dna":"dna","vnd.dolby.mlp":"mlp","vnd.dpgraph":"dpg","vnd.dreamfactory":"dfac","vnd.ds-keypoint":"kpxx","vnd.dvb.ait":"ait","vnd.dvb.service":"svc","vnd.dynageo":"geo","vnd.ecowin.chart":"mag","vnd.enliven":"nml","vnd.epson.esf":"esf","vnd.epson.msf":"msf","vnd.epson.quickanime":"qam","vnd.epson.salt":"slt","vnd.epson.ssf":"ssf","vnd.eszigno3+xml":["es3","et3"],"vnd.ezpix-album":"ez2","vnd.ezpix-package":"ez3","vnd.fdf":"fdf","vnd.fdsn.mseed":"mseed","vnd.fdsn.seed":["seed","dataless"],"vnd.flographit":"gph","vnd.fluxtime.clip":"ftc","vnd.framemaker":["fm","frame","maker","book"],"vnd.frogans.fnc":"fnc","vnd.frogans.ltf":"ltf","vnd.fsc.weblaunch":"fsc","vnd.fujitsu.oasys":"oas","vnd.fujitsu.oasys2":"oa2","vnd.fujitsu.oasys3":"oa3","vnd.fujitsu.oasysgp":"fg5","vnd.fujitsu.oasysprs":"bh2","vnd.fujixerox.ddd":"ddd","vnd.fujixerox.docuworks":"xdw","vnd.fujixerox.docuworks.binder":"xbd","vnd.fuzzysheet":"fzs","vnd.genomatix.tuxedo":"txd","vnd.geogebra.file":"ggb","vnd.geogebra.tool":"ggt","vnd.geometry-explorer":["gex","gre"],"vnd.geonext":"gxt","vnd.geoplan":"g2w","vnd.geospace":"g3w","vnd.gmx":"gmx","vnd.grafeq":["gqf","gqs"],"vnd.groove-account":"gac","vnd.groove-help":"ghf","vnd.groove-identity-message":"gim","vnd.groove-injector":"grv","vnd.groove-tool-message":"gtm","vnd.groove-tool-template":"tpl","vnd.groove-vcard":"vcg","vnd.hal+xml":"hal","vnd.handheld-entertainment+xml":"zmm","vnd.hbci":"hbci","vnd.hhe.lesson-player":"les","vnd.hp-hpgl":"hpgl","vnd.hp-hpid":"hpid","vnd.hp-hps":"hps","vnd.hp-jlyt":"jlt","vnd.hp-pcl":"pcl","vnd.hp-pclxl":"pclxl","vnd.hydrostatix.sof-data":"sfd-hdstx","vnd.ibm.minipay":"mpy","vnd.ibm.modcap":["afp","listafp","list3820"],"vnd.ibm.rights-management":"irm","vnd.ibm.secure-container":"sc","vnd.iccprofile":["icc","icm"],"vnd.igloader":"igl","vnd.immervision-ivp":"ivp","vnd.immervision-ivu":"ivu","vnd.insors.igm":"igm","vnd.intercon.formnet":["xpw","xpx"],"vnd.intergeo":"i2g","vnd.intu.qbo":"qbo","vnd.intu.qfx":"qfx","vnd.ipunplugged.rcprofile":"rcprofile","vnd.irepository.package+xml":"irp","vnd.is-xpr":"xpr","vnd.isac.fcs":"fcs","vnd.jam":"jam","vnd.jcp.javame.midlet-rms":"rms","vnd.jisp":"jisp","vnd.joost.joda-archive":"joda","vnd.kahootz":["ktz","ktr"],"vnd.kde.karbon":"karbon","vnd.kde.kchart":"chrt","vnd.kde.kformula":"kfo","vnd.kde.kivio":"flw","vnd.kde.kontour":"kon","vnd.kde.kpresenter":["kpr","kpt"],"vnd.kde.kspread":"ksp","vnd.kde.kword":["kwd","kwt"],"vnd.kenameaapp":"htke","vnd.kidspiration":"kia","vnd.kinar":["kne","knp"],"vnd.koan":["skp","skd","skt","skm"],"vnd.kodak-descriptor":"sse","vnd.las.las+xml":"lasxml","vnd.llamagraphics.life-balance.desktop":"lbd","vnd.llamagraphics.life-balance.exchange+xml":"lbe","vnd.lotus-1-2-3":"123","vnd.lotus-approach":"apr","vnd.lotus-freelance":"pre","vnd.lotus-notes":"nsf","vnd.lotus-organizer":"org","vnd.lotus-screencam":"scm","vnd.lotus-wordpro":"lwp","vnd.macports.portpkg":"portpkg","vnd.mcd":"mcd","vnd.medcalcdata":"mc1","vnd.mediastation.cdkey":"cdkey","vnd.mfer":"mwf","vnd.mfmp":"mfm","vnd.micrografx.flo":"flo","vnd.micrografx.igx":"igx","vnd.mif":"mif","vnd.mobius.daf":"daf","vnd.mobius.dis":"dis","vnd.mobius.mbk":"mbk","vnd.mobius.mqy":"mqy","vnd.mobius.msl":"msl","vnd.mobius.plc":"plc","vnd.mobius.txf":"txf","vnd.mophun.application":"mpn","vnd.mophun.certificate":"mpc","vnd.ms-artgalry":"cil","vnd.ms-cab-compressed":"cab","vnd.ms-excel.addin.macroenabled.12":"xlam","vnd.ms-excel.sheet.binary.macroenabled.12":"xlsb","vnd.ms-excel.sheet.macroenabled.12":"xlsm","vnd.ms-excel.template.macroenabled.12":"xltm","vnd.ms-fontobject":"eot","vnd.ms-htmlhelp":"chm","vnd.ms-ims":"ims","vnd.ms-lrm":"lrm","vnd.ms-officetheme":"thmx","vnd.ms-powerpoint.addin.macroenabled.12":"ppam","vnd.ms-powerpoint.presentation.macroenabled.12":"pptm","vnd.ms-powerpoint.slide.macroenabled.12":"sldm","vnd.ms-powerpoint.slideshow.macroenabled.12":"ppsm","vnd.ms-powerpoint.template.macroenabled.12":"potm","vnd.ms-project":["mpp","mpt"],"vnd.ms-word.document.macroenabled.12":"docm","vnd.ms-word.template.macroenabled.12":"dotm","vnd.ms-works":["wps","wks","wcm","wdb"],"vnd.ms-wpl":"wpl","vnd.ms-xpsdocument":"xps","vnd.mseq":"mseq","vnd.musician":"mus","vnd.muvee.style":"msty","vnd.mynfc":"taglet","vnd.neurolanguage.nlu":"nlu","vnd.nitf":["ntf","nitf"],"vnd.noblenet-directory":"nnd","vnd.noblenet-sealer":"nns","vnd.noblenet-web":"nnw","vnd.nokia.n-gage.data":"ngdat","vnd.nokia.n-gage.symbian.install":"n-gage","vnd.nokia.radio-preset":"rpst","vnd.nokia.radio-presets":"rpss","vnd.novadigm.edm":"edm","vnd.novadigm.edx":"edx","vnd.novadigm.ext":"ext","vnd.oasis.opendocument.chart-template":"otc","vnd.oasis.opendocument.formula-template":"odft","vnd.oasis.opendocument.image-template":"oti","vnd.olpc-sugar":"xo","vnd.oma.dd2+xml":"dd2","vnd.openofficeorg.extension":"oxt","vnd.openxmlformats-officedocument.presentationml.slide":"sldx","vnd.osgeo.mapguide.package":"mgp","vnd.osgi.dp":"dp","vnd.osgi.subsystem":"esa","vnd.palm":["pdb","pqa","oprc"],"vnd.pawaafile":"paw","vnd.pg.format":"str","vnd.pg.osasli":"ei6","vnd.picsel":"efif","vnd.pmi.widget":"wg","vnd.pocketlearn":"plf","vnd.powerbuilder6":"pbd","vnd.previewsystems.box":"box","vnd.proteus.magazine":"mgz","vnd.publishare-delta-tree":"qps","vnd.pvi.ptid1":"ptid","vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"vnd.realvnc.bed":"bed","vnd.recordare.musicxml":"mxl","vnd.recordare.musicxml+xml":"musicxml","vnd.rig.cryptonote":"cryptonote","vnd.rn-realmedia":"rm","vnd.rn-realmedia-vbr":"rmvb","vnd.route66.link66+xml":"link66","vnd.sailingtracker.track":"st","vnd.seemail":"see","vnd.sema":"sema","vnd.semd":"semd","vnd.semf":"semf","vnd.shana.informed.formdata":"ifm","vnd.shana.informed.formtemplate":"itp","vnd.shana.informed.interchange":"iif","vnd.shana.informed.package":"ipk","vnd.simtech-mindmapper":["twd","twds"],"vnd.smart.teacher":"teacher","vnd.solent.sdkm+xml":["sdkm","sdkd"],"vnd.spotfire.dxp":"dxp","vnd.spotfire.sfs":"sfs","vnd.stepmania.package":"smzip","vnd.stepmania.stepchart":"sm","vnd.sus-calendar":["sus","susp"],"vnd.svd":"svd","vnd.syncml+xml":"xsm","vnd.syncml.dm+wbxml":"bdm","vnd.syncml.dm+xml":"xdm","vnd.tao.intent-module-archive":"tao","vnd.tcpdump.pcap":["pcap","cap","dmp"],"vnd.tmobile-livetv":"tmo","vnd.trid.tpt":"tpt","vnd.triscape.mxs":"mxs","vnd.trueapp":"tra","vnd.ufdl":["ufd","ufdl"],"vnd.uiq.theme":"utz","vnd.umajin":"umj","vnd.unity":"unityweb","vnd.uoml+xml":"uoml","vnd.vcx":"vcx","vnd.visionary":"vis","vnd.vsf":"vsf","vnd.webturbo":"wtb","vnd.wolfram.player":"nbp","vnd.wqd":"wqd","vnd.wt.stf":"stf","vnd.xara":"xar","vnd.xfdl":"xfdl","vnd.yamaha.hv-dic":"hvd","vnd.yamaha.hv-script":"hvs","vnd.yamaha.hv-voice":"hvp","vnd.yamaha.openscoreformat":"osf","vnd.yamaha.openscoreformat.osfpvg+xml":"osfpvg","vnd.yamaha.smaf-audio":"saf","vnd.yamaha.smaf-phrase":"spf","vnd.yellowriver-custom-menu":"cmp","vnd.zul":["zir","zirz"],"vnd.zzazz.deck+xml":"zaz","voicexml+xml":"vxml",widget:"wgt",winhlp:"hlp","wsdl+xml":"wsdl","wspolicy+xml":"wspolicy","x-ace-compressed":"ace","x-authorware-bin":["aab","x32","u32","vox"],"x-authorware-map":"aam","x-authorware-seg":"aas","x-blorb":["blb","blorb"],"x-bzip":"bz","x-bzip2":["bz2","boz"],"x-cfs-compressed":"cfs","x-chat":"chat","x-conference":"nsc","x-dgc-compressed":"dgc","x-dtbncx+xml":"ncx","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-eva":"eva","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-freearc":"arc","x-gca-compressed":"gca","x-glulx":"ulx","x-gramps-xml":"gramps","x-install-instructions":"install","x-lzh-compressed":["lzh","lha"],"x-mie":"mie","x-mobipocket-ebook":["prc","mobi"],"x-ms-application":"application","x-ms-shortcut":"lnk","x-ms-xbap":"xbap","x-msbinder":"obd","x-mscardfile":"crd","x-msclip":"clp","application/x-ms-installer":"msi","x-msmediaview":["mvb","m13","m14"],"x-msmetafile":["wmf","wmz","emf","emz"],"x-msmoney":"mny","x-mspublisher":"pub","x-msschedule":"scd","x-msterminal":"trm","x-mswrite":"wri","x-nzb":"nzb","x-pkcs12":["p12","pfx"],"x-pkcs7-certificates":["p7b","spc"],"x-research-info-systems":"ris","x-silverlight-app":"xap","x-sql":"sql","x-stuffitx":"sitx","x-subrip":"srt","x-t3vm-image":"t3","x-tex-tfm":"tfm","x-tgif":"obj","x-xliff+xml":"xlf","x-xz":"xz","x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"xaml+xml":"xaml","xcap-diff+xml":"xdf","xenc+xml":"xenc","xml-dtd":"dtd","xop+xml":"xop","xproc+xml":"xpl","xslt+xml":"xslt","xv+xml":["mxml","xhvml","xvml","xvm"],yang:"yang","yin+xml":"yin",envoy:"evy",fractals:"fif","internet-property-stream":"acx",olescript:"axs","vnd.ms-outlook":"msg","vnd.ms-pkicertstore":"sst","x-compress":"z","x-perfmon":["pma","pmc","pmr","pmw"],"ynd.ms-pkipko":"pko",gzip:["gz","tgz"],"smil+xml":["smi","smil"],"vnd.debian.binary-package":["deb","udeb"],"vnd.hzn-3d-crossword":"x3d","vnd.sqlite3":["db","sqlite","sqlite3","db-wal","sqlite-wal","db-shm","sqlite-shm"],"vnd.wap.sic":"sic","vnd.wap.slc":"slc","x-krita":["kra","krz"],"x-perl":["pm","pl"],yaml:["yaml","yml"]},audio:{amr:"amr","amr-wb":"awb",annodex:"axa",basic:["au","snd"],flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"prs.sid":"sid","x-aiff":"aifc","x-gsm":"gsm","x-ms-wma":"wma","x-ms-wax":"wax","x-pn-realaudio":"ram","x-realaudio":"ra","x-sd2":"sd2",adpcm:"adp",mp4:"mp4a",s3m:"s3m",silk:"sil","vnd.dece.audio":["uva","uvva"],"vnd.digital-winds":"eol","vnd.dra":"dra","vnd.dts":"dts","vnd.dts.hd":"dtshd","vnd.lucent.voice":"lvp","vnd.ms-playready.media.pya":"pya","vnd.nuera.ecelp4800":"ecelp4800","vnd.nuera.ecelp7470":"ecelp7470","vnd.nuera.ecelp9600":"ecelp9600","vnd.rip":"rip",webm:"weba","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",aac:"aac",aiff:["aiff","aif","aff"],opus:"opus",wav:"wav"},chemical:{"x-alchemy":"alc","x-cache":["cac","cache"],"x-cache-csf":"csf","x-cactvs-binary":["cbin","cascii","ctab"],"x-cdx":"cdx","x-chem3d":"c3d","x-cif":"cif","x-cmdf":"cmdf","x-cml":"cml","x-compass":"cpa","x-crossfire":"bsd","x-csml":["csml","csm"],"x-ctx":"ctx","x-cxf":["cxf","cef"],"x-embl-dl-nucleotide":["emb","embl"],"x-gamess-input":["inp","gam","gamin"],"x-gaussian-checkpoint":["fch","fchk"],"x-gaussian-cube":"cub","x-gaussian-input":["gau","gjc","gjf"],"x-gaussian-log":"gal","x-gcg8-sequence":"gcg","x-genbank":"gen","x-hin":"hin","x-isostar":["istr","ist"],"x-jcamp-dx":["jdx","dx"],"x-kinemage":"kin","x-macmolecule":"mcm","x-macromodel-input":"mmod","x-mdl-molfile":"mol","x-mdl-rdfile":"rd","x-mdl-rxnfile":"rxn","x-mdl-sdfile":"sd","x-mdl-tgf":"tgf","x-mmcif":"mcif","x-mol2":"mol2","x-molconn-Z":"b","x-mopac-graph":"gpt","x-mopac-input":["mop","mopcrt","zmt"],"x-mopac-out":"moo","x-ncbi-asn1":"asn","x-ncbi-asn1-ascii":["prt","ent"],"x-ncbi-asn1-binary":"val","x-rosdal":"ros","x-swissprot":"sw","x-vamas-iso14976":"vms","x-vmd":"vmd","x-xtel":"xtel","x-xyz":"xyz"},font:{otf:"otf",woff:"woff",woff2:"woff2"},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe","jfif","jfif-tbnl","jif"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"vnd.djvu":["djvu","djv"],"vnd.wap.wbmp":"wbmp","x-canon-cr2":"cr2","x-canon-crw":"crw","x-cmu-raster":"ras","x-coreldraw":"cdr","x-coreldrawpattern":"pat","x-coreldrawtemplate":"cdt","x-corelphotopaint":"cpt","x-epson-erf":"erf","x-icon":"ico","x-jg":"art","x-jng":"jng","x-nikon-nef":"nef","x-olympus-orf":"orf","x-portable-anymap":"pnm","x-portable-bitmap":"pbm","x-portable-graymap":"pgm","x-portable-pixmap":"ppm","x-rgb":"rgb","x-xbitmap":"xbm","x-xpixmap":"xpm","x-xwindowdump":"xwd",bmp:"bmp",cgm:"cgm",g3fax:"g3",ktx:"ktx","prs.btif":"btif",sgi:"sgi","vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"vnd.dwg":"dwg","vnd.dxf":"dxf","vnd.fastbidsheet":"fbs","vnd.fpx":"fpx","vnd.fst":"fst","vnd.fujixerox.edmics-mmr":"mmr","vnd.fujixerox.edmics-rlc":"rlc","vnd.ms-modi":"mdi","vnd.ms-photo":"wdp","vnd.net-fpx":"npx","vnd.xiff":"xif",webp:"webp","x-3ds":"3ds","x-cmx":"cmx","x-freehand":["fh","fhc","fh4","fh5","fh7"],"x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod",avif:"avifs",heic:["heif","heic"],pjpeg:["pjpg"],"vnd.adobe.photoshop":"psd","x-adobe-dng":"dng","x-fuji-raf":"raf","x-icns":"icns","x-kodak-dcr":"dcr","x-kodak-k25":"k25","x-kodak-kdc":"kdc","x-minolta-mrw":"mrw","x-panasonic-raw":["raw","rw2","rwl"],"x-pentax-pef":["pef","ptx"],"x-sigma-x3f":"x3f","x-sony-arw":"arw","x-sony-sr2":"sr2","x-sony-srf":"srf"},message:{rfc822:["eml","mime","mht","mhtml","nws"]},model:{iges:["igs","iges"],mesh:["msh","mesh","silo"],vrml:["wrl","vrml"],"x3d+vrml":["x3dv","x3dvz"],"x3d+xml":"x3dz","x3d+binary":["x3db","x3dbz"],"vnd.collada+xml":"dae","vnd.dwf":"dwf","vnd.gdl":"gdl","vnd.gtw":"gtw","vnd.mts":"mts","vnd.usdz+zip":"usdz","vnd.vtu":"vtu"},text:{"cache-manifest":["manifest","appcache"],calendar:["ics","icz","ifb"],css:"css",csv:"csv",h323:"323",html:["html","htm","shtml","stm"],iuls:"uls",plain:["txt","text","brf","conf","def","list","log","in","bas","diff","ksh"],richtext:"rtx",scriptlet:["sct","wsc"],texmacs:"tm","tab-separated-values":"tsv","vnd.sun.j2me.app-descriptor":"jad","vnd.wap.wml":"wml","vnd.wap.wmlscript":"wmls","x-bibtex":"bib","x-boo":"boo","x-c++hdr":["h++","hpp","hxx","hh"],"x-c++src":["c++","cpp","cxx","cc"],"x-component":"htc","x-dsrc":"d","x-diff":"patch","x-haskell":"hs","x-java":"java","x-literate-haskell":"lhs","x-moc":"moc","x-pascal":["p","pas","pp","inc"],"x-pcs-gcd":"gcd","x-python":"py","x-scala":"scala","x-setext":"etx","x-tcl":["tcl","tk"],"x-tex":["tex","ltx","sty","cls"],"x-vcalendar":"vcs","x-vcard":"vcf",n3:"n3","prs.lines.tag":"dsc",sgml:["sgml","sgm"],troff:["t","tr","roff","man","me","ms"],turtle:"ttl","uri-list":["uri","uris","urls"],vcard:"vcard","vnd.curl":"curl","vnd.curl.dcurl":"dcurl","vnd.curl.scurl":"scurl","vnd.curl.mcurl":"mcurl","vnd.dvb.subtitle":"sub","vnd.fly":"fly","vnd.fmi.flexstor":"flx","vnd.graphviz":"gv","vnd.in3d.3dml":"3dml","vnd.in3d.spot":"spot","x-asm":["s","asm"],"x-c":["c","h","dic"],"x-fortran":["f","for","f77","f90"],"x-opml":"opml","x-nfo":"nfo","x-sfv":"sfv","x-uuencode":"uu",webviewhtml:"htt",javascript:"js",json:"json",markdown:["md","markdown","mdown","markdn"],"vnd.wap.si":"si","vnd.wap.sl":"sl"},video:{avif:"avif","3gpp":"3gp",annodex:"axv",dl:"dl",dv:["dif","dv"],fli:"fli",gl:"gl",mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.dece.hd":["uvh","uvvh"],"vnd.dece.mobile":["uvm","uvvm"],"vnd.dece.pd":["uvp","uvvp"],"vnd.dece.sd":["uvs","uvvs"],"vnd.dece.video":["uvv","uvvv"],"vnd.dvb.file":"dvb","vnd.fvt":"fvt","vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv",mp2t:"ts"},"x-conference":{"x-cooltalk":"ice"},"x-world":{"x-vrml":["vrm","flr","wrz","xaf","xof"]}},zK=(()=>{let t={};for(let e of Object.keys(S_))for(let n of Object.keys(S_[e])){let r=S_[e][n];if(typeof r=="string")t[r]=e+"/"+n;else for(let s=0;s<r.length;s++)t[r[s]]=e+"/"+n}return t})();var zS=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=e>>>1^3988292384:e=e>>>1;zS[t]=e}var to=class{constructor(e){this.crc=e||-1}append(e){let n=this.crc|0;for(let r=0,s=e.length|0;r<s;r++)n=n>>>8^zS[(n^e[r])&255];this.crc=n}get(){return~this.crc}};var Zl=class extends TransformStream{constructor(){let e,n=new to;super({transform(r,s){n.append(r),s.enqueue(r)},flush(){let r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,n.get()),e.value=r}}),e=this}};function gc(t){if(typeof TextEncoder==Ii){t=unescape(encodeURIComponent(t));let e=new Uint8Array(t.length);for(let n=0;n<e.length;n++)e[n]=t.charCodeAt(n);return e}else return new TextEncoder().encode(t)}var Vr={concat(t,e){if(t.length===0||e.length===0)return t.concat(e);let n=t[t.length-1],r=Vr.getPartial(n);return r===32?t.concat(e):Vr._shiftRight(e,r,n|0,t.slice(0,t.length-1))},bitLength(t){let e=t.length;if(e===0)return 0;let n=t[e-1];return(e-1)*32+Vr.getPartial(n)},clamp(t,e){if(t.length*32<e)return t;t=t.slice(0,Math.ceil(e/32));let n=t.length;return e=e&31,n>0&&e&&(t[n-1]=Vr.partial(e,t[n-1]&2147483648>>e-1,1)),t},partial(t,e,n){return t===32?e:(n?e|0:e<<32-t)+t*1099511627776},getPartial(t){return Math.round(t/1099511627776)||32},_shiftRight(t,e,n,r){for(r===void 0&&(r=[]);e>=32;e-=32)r.push(n),n=0;if(e===0)return r.concat(t);for(let c=0;c<t.length;c++)r.push(n|t[c]>>>e),n=t[c]<<32-e;let s=t.length?t[t.length-1]:0,a=Vr.getPartial(s);return r.push(Vr.partial(e+a&31,e+a>32?n:r.pop(),1)),r}},Vl={bytes:{fromBits(t){let n=Vr.bitLength(t)/8,r=new Uint8Array(n),s;for(let a=0;a<n;a++)(a&3)===0&&(s=t[a/4]),r[a]=s>>>24,s<<=8;return r},toBits(t){let e=[],n,r=0;for(n=0;n<t.length;n++)r=r<<8|t[n],(n&3)===3&&(e.push(r),r=0);return n&3&&e.push(Vr.partial(8*(n&3),r)),e}}},KS={};KS.sha1=class{constructor(t){let e=this;e.blockSize=512,e._init=[1732584193,4023233417,2562383102,271733878,3285377520],e._key=[1518500249,1859775393,2400959708,3395469782],t?(e._h=t._h.slice(0),e._buffer=t._buffer.slice(0),e._length=t._length):e.reset()}reset(){let t=this;return t._h=t._init.slice(0),t._buffer=[],t._length=0,t}update(t){let e=this;typeof t=="string"&&(t=Vl.utf8String.toBits(t));let n=e._buffer=Vr.concat(e._buffer,t),r=e._length,s=e._length=r+Vr.bitLength(t);if(s>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");let a=new Uint32Array(n),c=0;for(let l=e.blockSize+r-(e.blockSize+r&e.blockSize-1);l<=s;l+=e.blockSize)e._block(a.subarray(16*c,16*(c+1))),c+=1;return n.splice(0,16*c),e}finalize(){let t=this,e=t._buffer,n=t._h;e=Vr.concat(e,[Vr.partial(1,1)]);for(let r=e.length+2;r&15;r++)e.push(0);for(e.push(Math.floor(t._length/4294967296)),e.push(t._length|0);e.length;)t._block(e.splice(0,16));return t.reset(),n}_f(t,e,n,r){if(t<=19)return e&n|~e&r;if(t<=39)return e^n^r;if(t<=59)return e&n|e&r|n&r;if(t<=79)return e^n^r}_S(t,e){return e<<t|e>>>32-t}_block(t){let e=this,n=e._h,r=Array(80);for(let f=0;f<16;f++)r[f]=t[f];let s=n[0],a=n[1],c=n[2],l=n[3],d=n[4];for(let f=0;f<=79;f++){f>=16&&(r[f]=e._S(1,r[f-3]^r[f-8]^r[f-14]^r[f-16]));let p=e._S(5,s)+e._f(f,a,c,l)+d+r[f]+e._key[Math.floor(f/20)]|0;d=l,l=c,c=e._S(30,a),a=s,s=p}n[0]=n[0]+s|0,n[1]=n[1]+a|0,n[2]=n[2]+c|0,n[3]=n[3]+l|0,n[4]=n[4]+d|0}};var C_={};C_.aes=class{constructor(t){let e=this;e._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],e._tables[0][0][0]||e._precompute();let n=e._tables[0][4],r=e._tables[1],s=t.length,a,c,l,d=1;if(s!==4&&s!==6&&s!==8)throw new Error("invalid aes key size");for(e._key=[c=t.slice(0),l=[]],a=s;a<4*s+28;a++){let f=c[a-1];(a%s===0||s===8&&a%s===4)&&(f=n[f>>>24]<<24^n[f>>16&255]<<16^n[f>>8&255]<<8^n[f&255],a%s===0&&(f=f<<8^f>>>24^d<<24,d=d<<1^(d>>7)*283)),c[a]=c[a-s]^f}for(let f=0;a;f++,a--){let p=c[f&3?a:a-4];a<=4||f<4?l[f]=p:l[f]=r[0][n[p>>>24]]^r[1][n[p>>16&255]]^r[2][n[p>>8&255]]^r[3][n[p&255]]}}encrypt(t){return this._crypt(t,0)}decrypt(t){return this._crypt(t,1)}_precompute(){let t=this._tables[0],e=this._tables[1],n=t[4],r=e[4],s=[],a=[],c,l,d,f;for(let p=0;p<256;p++)a[(s[p]=p<<1^(p>>7)*283)^p]=p;for(let p=c=0;!n[p];p^=l||1,c=a[c]||1){let m=c^c<<1^c<<2^c<<3^c<<4;m=m>>8^m&255^99,n[p]=m,r[m]=p,f=s[d=s[l=s[p]]];let g=f*16843009^d*65537^l*257^p*16843008,w=s[m]*257^m*16843008;for(let v=0;v<4;v++)t[v][p]=w=w<<24^w>>>8,e[v][m]=g=g<<24^g>>>8}for(let p=0;p<5;p++)t[p]=t[p].slice(0),e[p]=e[p].slice(0)}_crypt(t,e){if(t.length!==4)throw new Error("invalid aes block size");let n=this._key[e],r=n.length/4-2,s=[0,0,0,0],a=this._tables[e],c=a[0],l=a[1],d=a[2],f=a[3],p=a[4],m=t[0]^n[0],g=t[e?3:1]^n[1],w=t[2]^n[2],v=t[e?1:3]^n[3],x=4,b,S,k;for(let $=0;$<r;$++)b=c[m>>>24]^l[g>>16&255]^d[w>>8&255]^f[v&255]^n[x],S=c[g>>>24]^l[w>>16&255]^d[v>>8&255]^f[m&255]^n[x+1],k=c[w>>>24]^l[v>>16&255]^d[m>>8&255]^f[g&255]^n[x+2],v=c[v>>>24]^l[m>>16&255]^d[g>>8&255]^f[w&255]^n[x+3],x+=4,m=b,g=S,w=k;for(let $=0;$<4;$++)s[e?3&-$:$]=p[m>>>24]<<24^p[g>>16&255]<<16^p[w>>8&255]<<8^p[v&255]^n[x++],b=m,m=g,g=w,w=v,v=b;return s}};var ZS={getRandomValues(t){let e=new Uint32Array(t.buffer),n=r=>{let s=987654321,a=4294967295;return function(){return s=36969*(s&65535)+(s>>16)&a,r=18e3*(r&65535)+(r>>16)&a,(((s<<16)+r&a)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let r=0,s;r<t.length;r+=4){let a=n((s||Math.random())*4294967296);s=a()*987654071,e[r/4]=a()*4294967296|0}return t}},k_={};k_.ctrGladman=class{constructor(t,e){this._prf=t,this._initIv=e,this._iv=e}reset(){this._iv=this._initIv}update(t){return this.calculate(this._prf,t,this._iv)}incWord(t){if((t>>24&255)===255){let e=t>>16&255,n=t>>8&255,r=t&255;e===255?(e=0,n===255?(n=0,r===255?r=0:++r):++n):++e,t=0,t+=e<<16,t+=n<<8,t+=r}else t+=1<<24;return t}incCounter(t){(t[0]=this.incWord(t[0]))===0&&(t[1]=this.incWord(t[1]))}calculate(t,e,n){let r;if(!(r=e.length))return[];let s=Vr.bitLength(e);for(let a=0;a<r;a+=4){this.incCounter(n);let c=t.encrypt(n);e[a]^=c[0],e[a+1]^=c[1],e[a+2]^=c[2],e[a+3]^=c[3]}return Vr.clamp(e,s)}};var No={importKey(t){return new No.hmacSha1(Vl.bytes.toBits(t))},pbkdf2(t,e,n,r){if(n=n||1e4,r<0||n<0)throw new Error("invalid params to pbkdf2");let s=(r>>5)+1<<2,a,c,l,d,f,p=new ArrayBuffer(s),m=new DataView(p),g=0,w=Vr;for(e=Vl.bytes.toBits(e),f=1;g<(s||1);f++){for(a=c=t.encrypt(w.concat(e,[f])),l=1;l<n;l++)for(c=t.encrypt(c),d=0;d<c.length;d++)a[d]^=c[d];for(l=0;g<(s||1)&&l<a.length;l++)m.setInt32(g,a[l]),g+=4}return p.slice(0,r/8)}};No.hmacSha1=class{constructor(t){let e=this,n=e._hash=KS.sha1,r=[[],[]];e._baseHash=[new n,new n];let s=e._baseHash[0].blockSize/32;t.length>s&&(t=new n().update(t).finalize());for(let a=0;a<s;a++)r[0][a]=t[a]^909522486,r[1][a]=t[a]^1549556828;e._baseHash[0].update(r[0]),e._baseHash[1].update(r[1]),e._resultHash=new n(e._baseHash[0])}reset(){let t=this;t._resultHash=new t._hash(t._baseHash[0]),t._updated=!1}update(t){let e=this;e._updated=!0,e._resultHash.update(t)}digest(){let t=this,e=t._resultHash.finalize(),n=new t._hash(t._baseHash[1]).update(e).finalize();return t.reset(),n}encrypt(t){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(t),this.digest(t)}};var t4=typeof crypto!=Ii&&typeof crypto.getRandomValues==Os,Fs="Invalid password",Mo="Invalid signature",no="zipjs-abort-check-password";function If(t){return t4?crypto.getRandomValues(t):ZS.getRandomValues(t)}var _c=16,n4="raw",JS={name:"PBKDF2"},r4={name:"HMAC"},i4="SHA-1",s4=Object.assign({hash:r4},JS),P_=Object.assign({iterations:1e3,hash:{name:i4}},JS),o4=["deriveBits"],Jl=[8,12,16],Yl=[16,24,32],qo=10,a4=[0,0,0,0],Ff=typeof crypto!=Ii,tu=Ff&&crypto.subtle,QS=Ff&&typeof tu!=Ii,Ns=Vl.bytes,c4=C_.aes,l4=k_.ctrGladman,u4=No.hmacSha1,VS=Ff&&QS&&typeof tu.importKey==Os,YS=Ff&&QS&&typeof tu.deriveBits==Os,$f=class extends TransformStream{constructor({password:e,rawPassword:n,signed:r,encryptionStrength:s,checkPasswordOnly:a}){super({start(){Object.assign(this,{ready:new Promise(c=>this.resolveReady=c),password:nC(e,n),signed:r,strength:s-1,pending:new Uint8Array})},async transform(c,l){let d=this,{password:f,strength:p,resolveReady:m,ready:g}=d;f?(await d4(d,p,f,Qi(c,0,Jl[p]+2)),c=Qi(c,Jl[p]+2),a?l.error(new Error(no)):m()):await g;let w=new Uint8Array(c.length-qo-(c.length-qo)%_c);l.enqueue(eC(d,c,w,0,qo,!0))},async flush(c){let{signed:l,ctr:d,hmac:f,pending:p,ready:m}=this;if(f&&d){await m;let g=Qi(p,0,p.length-qo),w=Qi(p,p.length-qo),v=new Uint8Array;if(g.length){let x=eu(Ns,g);f.update(x);let b=d.update(x);v=Ql(Ns,b)}if(l){let x=Qi(Ql(Ns,f.digest()),0,qo);for(let b=0;b<qo;b++)if(x[b]!=w[b])throw new Error(Mo)}c.enqueue(v)}}})}},Of=class extends TransformStream{constructor({password:e,rawPassword:n,encryptionStrength:r}){let s;super({start(){Object.assign(this,{ready:new Promise(a=>this.resolveReady=a),password:nC(e,n),strength:r-1,pending:new Uint8Array})},async transform(a,c){let l=this,{password:d,strength:f,resolveReady:p,ready:m}=l,g=new Uint8Array;d?(g=await f4(l,f,d),p()):await m;let w=new Uint8Array(g.length+a.length-a.length%_c);w.set(g,0),c.enqueue(eC(l,a,w,g.length,0))},async flush(a){let{ctr:c,hmac:l,pending:d,ready:f}=this;if(l&&c){await f;let p=new Uint8Array;if(d.length){let m=c.update(eu(Ns,d));l.update(m),p=Ql(Ns,m)}s.signature=Ql(Ns,l.digest()).slice(0,qo),a.enqueue(A_(p,s.signature))}}}),s=this}};function eC(t,e,n,r,s,a){let{ctr:c,hmac:l,pending:d}=t,f=e.length-s;d.length&&(e=A_(d,e),n=m4(n,f-f%_c));let p;for(p=0;p<=f-_c;p+=_c){let m=eu(Ns,Qi(e,p,p+_c));a&&l.update(m);let g=c.update(m);a||l.update(g),n.set(Ql(Ns,g),p+r)}return t.pending=Qi(e,p),n}async function d4(t,e,n,r){let s=await tC(t,e,n,Qi(r,0,Jl[e])),a=Qi(r,Jl[e]);if(s[0]!=a[0]||s[1]!=a[1])throw new Error(Fs)}async function f4(t,e,n){let r=If(new Uint8Array(Jl[e])),s=await tC(t,e,n,r);return A_(r,s)}async function tC(t,e,n,r){t.password=null;let s=await p4(n4,n,s4,!1,o4),a=await h4(Object.assign({salt:r},P_),s,8*(Yl[e]*2+2)),c=new Uint8Array(a),l=eu(Ns,Qi(c,0,Yl[e])),d=eu(Ns,Qi(c,Yl[e],Yl[e]*2)),f=Qi(c,Yl[e]*2);return Object.assign(t,{keys:{key:l,authentication:d,passwordVerification:f},ctr:new l4(new c4(l),Array.from(a4)),hmac:new u4(d)}),f}async function p4(t,e,n,r,s){if(VS)try{return await tu.importKey(t,e,n,r,s)}catch{return VS=!1,No.importKey(e)}else return No.importKey(e)}async function h4(t,e,n){if(YS)try{return await tu.deriveBits(t,e,n)}catch{return YS=!1,No.pbkdf2(e,t.salt,P_.iterations,n)}else return No.pbkdf2(e,t.salt,P_.iterations,n)}function nC(t,e){return e===Je?gc(t):e}function A_(t,e){let n=t;return t.length+e.length&&(n=new Uint8Array(t.length+e.length),n.set(t,0),n.set(e,t.length)),n}function m4(t,e){if(e&&e>t.length){let n=t;t=new Uint8Array(e),t.set(n,0)}return t}function Qi(t,e,n){return t.subarray(e,n)}function Ql(t,e){return t.fromBits(e)}function eu(t,e){return t.toBits(e)}var vc=12,Nf=class extends TransformStream{constructor({password:e,passwordVerification:n,checkPasswordOnly:r}){super({start(){Object.assign(this,{password:e,passwordVerification:n}),oC(this,e)},transform(s,a){let c=this;if(c.password){let l=rC(c,s.subarray(0,vc));if(c.password=null,l[vc-1]!=c.passwordVerification)throw new Error(Fs);s=s.subarray(vc)}r?a.error(new Error(no)):a.enqueue(rC(c,s))}})}},Mf=class extends TransformStream{constructor({password:e,passwordVerification:n}){super({start(){Object.assign(this,{password:e,passwordVerification:n}),oC(this,e)},transform(r,s){let a=this,c,l;if(a.password){a.password=null;let d=If(new Uint8Array(vc));d[vc-1]=a.passwordVerification,c=new Uint8Array(r.length+d.length),c.set(iC(a,d),0),l=vc}else c=new Uint8Array(r.length),l=0;c.set(iC(a,r),l),s.enqueue(c)}})}};function rC(t,e){let n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=aC(t)^e[r],D_(t,n[r]);return n}function iC(t,e){let n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=aC(t)^e[r],D_(t,e[r]);return n}function oC(t,e){let n=[305419896,591751049,878082192];Object.assign(t,{keys:n,crcKey0:new to(n[0]),crcKey2:new to(n[2])});for(let r=0;r<e.length;r++)D_(t,e.charCodeAt(r))}function D_(t,e){let[n,r,s]=t.keys;t.crcKey0.append([e]),n=~t.crcKey0.get(),r=sC(Math.imul(sC(r+cC(n)),134775813)+1),t.crcKey2.append([r>>>24]),s=~t.crcKey2.get(),t.keys=[n,r,s]}function aC(t){let e=t.keys[2]|2;return cC(Math.imul(e,e^1)>>>8)}function cC(t){return t&255}function sC(t){return t&4294967295}var yc="Invalid uncompressed size",lC="deflate-raw",qf=class extends TransformStream{constructor(e,{chunkSize:n,CompressionStream:r,CompressionStreamNative:s}){super({});let{compressed:a,encrypted:c,useCompressionStream:l,zipCrypto:d,signed:f,level:p}=e,m=this,g,w,v=super.readable;(!c||d)&&f&&(g=new Zl,v=ro(v,g)),a&&(v=dC(v,l,{level:p,chunkSize:n},s,r)),c&&(d?v=ro(v,new Mf(e)):(w=new Of(e),v=ro(v,w))),uC(m,v,()=>{let x;c&&!d&&(x=w.signature),(!c||d)&&f&&(x=new DataView(g.value.buffer).getUint32(0)),m.signature=x})}},Lf=class extends TransformStream{constructor(e,{chunkSize:n,DecompressionStream:r,DecompressionStreamNative:s}){super({});let{zipCrypto:a,encrypted:c,signed:l,signature:d,compressed:f,useCompressionStream:p}=e,m,g,w=super.readable;c&&(a?w=ro(w,new Nf(e)):(g=new $f(e),w=ro(w,g))),f&&(w=dC(w,p,{chunkSize:n},s,r)),(!c||a)&&l&&(m=new Zl,w=ro(w,m)),uC(this,w,()=>{if((!c||a)&&l){let v=new DataView(m.value.buffer);if(d!=v.getUint32(0,!1))throw new Error(Mo)}})}};function uC(t,e,n){e=ro(e,new TransformStream({flush:n})),Object.defineProperty(t,"readable",{get(){return e}})}function dC(t,e,n,r,s){try{let a=e&&r?r:s;t=ro(t,new a(lC,n))}catch(a){if(e)t=ro(t,new s(lC,n));else throw a}return t}function ro(t,e){return t.pipeThrough(e)}var fC="message",pC="start",hC="pull",I_="data",mC="ack",$_="close",Hf="deflate",jf="inflate";var Uf=class extends TransformStream{constructor(e,n){super({});let r=this,{codecType:s}=e,a;s.startsWith(Hf)?a=qf:s.startsWith(jf)&&(a=Lf),r.outputSize=0;let c=0,l=new a(e,n),d=super.readable,f=new TransformStream({transform(m,g){m&&m.length&&(c+=m.length,g.enqueue(m))},flush(){Object.assign(r,{inputSize:c})}}),p=new TransformStream({transform(m,g){if(m&&m.length&&(g.enqueue(m),r.outputSize+=m.length,e.outputSize&&r.outputSize>e.outputSize))throw new Error(yc)},flush(){let{signature:m}=l;Object.assign(r,{signature:m,inputSize:c})}});Object.defineProperty(r,"readable",{get(){return d.pipeThrough(f).pipeThrough(l).pipeThrough(p)}})}},Wf=class extends TransformStream{constructor(e){let n;super({transform:r,flush(s){n&&n.length&&s.enqueue(n)}});function r(s,a){if(n){let c=new Uint8Array(n.length+s.length);c.set(n),c.set(s,n.length),s=c,n=null}s.length>e?(a.enqueue(s.slice(0,e)),r(s.slice(e),a)):n=s}}};var vC=typeof Worker!=Ii;var wc=class{constructor(e,{readable:n,writable:r},{options:s,config:a,streamOptions:c,useWebWorkers:l,transferStreams:d,scripts:f},p){let{signal:m}=c;return Object.assign(e,{busy:!0,readable:n.pipeThrough(new Wf(a.chunkSize)).pipeThrough(new F_(c),{signal:m}),writable:r,options:Object.assign({},s),scripts:f,transferStreams:d,terminate(){return new Promise(g=>{let{worker:w,busy:v}=e;w?(v?e.resolveTerminated=g:(w.terminate(),g()),e.interface=null):g()})},onTaskFinished(){let{resolveTerminated:g}=e;g&&(e.resolveTerminated=null,e.terminated=!0,e.worker.terminate(),g()),e.busy=!1,p(e)}}),(l&&vC?g4:yC)(e,a)}},F_=class extends TransformStream{constructor({onstart:e,onprogress:n,size:r,onend:s}){let a=0;super({async start(){e&&await O_(e,r)},async transform(c,l){a+=c.length,n&&await O_(n,a,r),l.enqueue(c)},async flush(){s&&await O_(s,a)}})}};async function O_(t,...e){try{await t(...e)}catch{}}function yC(t,e){return{run:()=>_4(t,e)}}function g4(t,e){let{baseURL:n,chunkSize:r}=e;if(!t.interface){let s;try{s=w4(t.scripts[0],n,t)}catch{return vC=!1,yC(t,e)}Object.assign(t,{worker:s,interface:{run:()=>v4(t,{chunkSize:r})}})}return t.interface}async function _4({options:t,readable:e,writable:n,onTaskFinished:r},s){let a;try{a=new Uf(t,s),await e.pipeThrough(a).pipeTo(n,{preventClose:!0,preventAbort:!0});let{signature:c,inputSize:l,outputSize:d}=a;return{signature:c,inputSize:l,outputSize:d}}catch(c){throw a&&(c.outputSize=a.outputSize),c}finally{r()}}async function v4(t,e){let n,r,s=new Promise((g,w)=>{n=g,r=w});Object.assign(t,{reader:null,writer:null,resolveResult:n,rejectResult:r,result:s});let{readable:a,options:c,scripts:l}=t,{writable:d,closed:f}=y4(t.writable),p=Xf({type:pC,scripts:l.slice(1),options:c,config:e,readable:a,writable:d},t);p||Object.assign(t,{reader:a.getReader(),writer:d.getWriter()});let m=await s;return p||await d.getWriter().close(),await f,m}function y4(t){let e,n=new Promise(s=>e=s);return{writable:new WritableStream({async write(s){let a=t.getWriter();await a.ready,await a.write(s),a.releaseLock()},close(){e()},abort(s){return t.getWriter().abort(s)}}),closed:n}}var gC=!0,_C=!0;function w4(t,e,n){let r={type:"module"},s,a;typeof t==Os&&(t=t());try{s=new URL(t,e)}catch{s=t}if(gC)try{a=new Worker(s)}catch{gC=!1,a=new Worker(s,r)}else a=new Worker(s,r);return a.addEventListener(fC,c=>b4(c,n)),a}function Xf(t,{worker:e,writer:n,onTaskFinished:r,transferStreams:s}){try{let{value:a,readable:c,writable:l}=t,d=[];if(a&&(a.byteLength<a.buffer.byteLength?t.value=a.buffer.slice(0,a.byteLength):t.value=a.buffer,d.push(t.value)),s&&_C?(c&&d.push(c),l&&d.push(l)):t.readable=t.writable=null,d.length)try{return e.postMessage(t,d),!0}catch{_C=!1,t.readable=t.writable=null,e.postMessage(t)}else e.postMessage(t)}catch(a){throw n&&n.releaseLock(),r(),a}}async function b4({data:t},e){let{type:n,value:r,messageId:s,result:a,error:c}=t,{reader:l,writer:d,resolveResult:f,rejectResult:p,onTaskFinished:m}=e;try{if(c){let{message:w,stack:v,code:x,name:b,outputSize:S}=c,k=new Error(w);Object.assign(k,{stack:v,code:x,name:b,outputSize:S}),g(k)}else{if(n==hC){let{value:w,done:v}=await l.read();Xf({type:I_,value:w,done:v,messageId:s},e)}n==I_&&(await d.ready,await d.write(new Uint8Array(r)),Xf({type:mC,messageId:s},e)),n==$_&&g(null,a)}}catch(w){Xf({type:$_,messageId:s},e),g(w)}function g(w,v){w?p(w):f(v),d&&d.releaseLock(),m()}}var Ra=[],N_=[];var wC=0;async function Bf(t,e){let{options:n,config:r}=e,{transferStreams:s,useWebWorkers:a,useCompressionStream:c,codecType:l,compressed:d,signed:f,encrypted:p}=n,{workerScripts:m,maxWorkers:g}=r;e.transferStreams=s||s===Je;let w=!d&&!f&&!p&&!e.transferStreams;return e.useWebWorkers=!w&&(a||a===Je&&r.useWebWorkers),e.scripts=e.useWebWorkers&&m?m[l]:[],n.useCompressionStream=c||c===Je&&r.useCompressionStream,(await v()).run();async function v(){let b=Ra.find(S=>!S.busy);if(b)return bC(b),new wc(b,t,e,x);if(Ra.length<g){let S={indexWorker:wC};return wC++,Ra.push(S),new wc(S,t,e,x)}else return new Promise(S=>N_.push({resolve:S,stream:t,workerOptions:e}))}function x(b){if(N_.length){let[{resolve:S,stream:k,workerOptions:$}]=N_.splice(0,1);S(new wc(b,k,$,x))}else b.worker?(bC(b),x4(b,e)):Ra=Ra.filter(S=>S!=b)}}function x4(t,e){let{config:n}=e,{terminateWorkerTimeout:r}=n;Number.isFinite(r)&&r>=0&&(t.terminated?t.terminated=!1:t.terminateTimeout=setTimeout(async()=>{Ra=Ra.filter(s=>s!=t);try{await t.terminate()}catch{}},r))}function bC(t){let{terminateTimeout:e}=t;e&&(clearTimeout(e),t.terminateTimeout=null)}function xC(t,e={}){let n=`const{Array:e,Object:t,Number:n,Math:r,Error:s,Uint8Array:i,Uint16Array:o,Uint32Array:c,Int32Array:f,Map:a,DataView:l,Promise:u,TextEncoder:w,crypto:h,postMessage:d,TransformStream:p,ReadableStream:y,WritableStream:m,CompressionStream:b,DecompressionStream:g}=self,k=void 0,v="undefined",S="function";class z{constructor(e){return class extends p{constructor(t,n){const r=new e(n);super({transform(e,t){t.enqueue(r.append(e))},flush(e){const t=r.flush();t&&e.enqueue(t)}})}}}}const C=[];for(let e=0;256>e;e++){let t=e;for(let e=0;8>e;e++)1&t?t=t>>>1^3988292384:t>>>=1;C[e]=t}class x{constructor(e){this.t=e||-1}append(e){let t=0|this.t;for(let n=0,r=0|e.length;r>n;n++)t=t>>>8^C[255&(t^e[n])];this.t=t}get(){return~this.t}}class A extends p{constructor(){let e;const t=new x;super({transform(e,n){t.append(e),n.enqueue(e)},flush(){const n=new i(4);new l(n.buffer).setUint32(0,t.get()),e.value=n}}),e=this}}const I={concat(e,t){if(0===e.length||0===t.length)return e.concat(t);const n=e[e.length-1],r=I.i(n);return 32===r?e.concat(t):I.o(t,r,0|n,e.slice(0,e.length-1))},l(e){const t=e.length;if(0===t)return 0;const n=e[t-1];return 32*(t-1)+I.i(n)},u(e,t){if(32*e.length<t)return e;const n=(e=e.slice(0,r.ceil(t/32))).length;return t&=31,n>0&&t&&(e[n-1]=I.h(t,e[n-1]&2147483648>>t-1,1)),e},h:(e,t,n)=>32===e?t:(n?0|t:t<<32-e)+1099511627776*e,i:e=>r.round(e/1099511627776)||32,o(e,t,n,r){for(void 0===r&&(r=[]);t>=32;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(let s=0;s<e.length;s++)r.push(n|e[s]>>>t),n=e[s]<<32-t;const s=e.length?e[e.length-1]:0,i=I.i(s);return r.push(I.h(t+i&31,t+i>32?n:r.pop(),1)),r}},_={bytes:{p(e){const t=I.l(e)/8,n=new i(t);let r;for(let s=0;t>s;s++)3&s||(r=e[s/4]),n[s]=r>>>24,r<<=8;return n},m(e){const t=[];let n,r=0;for(n=0;n<e.length;n++)r=r<<8|e[n],3&~n||(t.push(r),r=0);return 3&n&&t.push(I.h(8*(3&n),r)),t}}},P=class{constructor(e){const t=this;t.blockSize=512,t.k=[1732584193,4023233417,2562383102,271733878,3285377520],t.v=[1518500249,1859775393,2400959708,3395469782],e?(t.S=e.S.slice(0),t.C=e.C.slice(0),t.A=e.A):t.reset()}reset(){const e=this;return e.S=e.k.slice(0),e.C=[],e.A=0,e}update(e){const t=this;"string"==typeof e&&(e=_.I.m(e));const n=t.C=I.concat(t.C,e),r=t.A,i=t.A=r+I.l(e);if(i>9007199254740991)throw new s("Cannot hash more than 2^53 - 1 bits");const o=new c(n);let f=0;for(let e=t.blockSize+r-(t.blockSize+r&t.blockSize-1);i>=e;e+=t.blockSize)t._(o.subarray(16*f,16*(f+1))),f+=1;return n.splice(0,16*f),t}P(){const e=this;let t=e.C;const n=e.S;t=I.concat(t,[I.h(1,1)]);for(let e=t.length+2;15&e;e++)t.push(0);for(t.push(r.floor(e.A/4294967296)),t.push(0|e.A);t.length;)e._(t.splice(0,16));return e.reset(),n}D(e,t,n,r){return e>19?e>39?e>59?e>79?void 0:t^n^r:t&n|t&r|n&r:t^n^r:t&n|~t&r}V(e,t){return t<<e|t>>>32-e}_(t){const n=this,s=n.S,i=e(80);for(let e=0;16>e;e++)i[e]=t[e];let o=s[0],c=s[1],f=s[2],a=s[3],l=s[4];for(let e=0;79>=e;e++){16>e||(i[e]=n.V(1,i[e-3]^i[e-8]^i[e-14]^i[e-16]));const t=n.V(5,o)+n.D(e,c,f,a)+l+i[e]+n.v[r.floor(e/20)]|0;l=a,a=f,f=n.V(30,c),c=o,o=t}s[0]=s[0]+o|0,s[1]=s[1]+c|0,s[2]=s[2]+f|0,s[3]=s[3]+a|0,s[4]=s[4]+l|0}},D={getRandomValues(e){const t=new c(e.buffer),n=e=>{let t=987654321;const n=4294967295;return()=>(t=36969*(65535&t)+(t>>16)&n,(((t<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n)/4294967296+.5)*(r.random()>.5?1:-1))};for(let s,i=0;i<e.length;i+=4){const e=n(4294967296*(s||r.random()));s=987654071*e(),t[i/4]=4294967296*e()|0}return e}},V={importKey:e=>new V.R(_.bytes.m(e)),B(e,t,n,r){if(n=n||1e4,0>r||0>n)throw new s("invalid params to pbkdf2");const i=1+(r>>5)<<2;let o,c,f,a,u;const w=new ArrayBuffer(i),h=new l(w);let d=0;const p=I;for(t=_.bytes.m(t),u=1;(i||1)>d;u++){for(o=c=e.encrypt(p.concat(t,[u])),f=1;n>f;f++)for(c=e.encrypt(c),a=0;a<c.length;a++)o[a]^=c[a];for(f=0;(i||1)>d&&f<o.length;f++)h.setInt32(d,o[f]),d+=4}return w.slice(0,r/8)},R:class{constructor(e){const t=this,n=t.M=P,r=[[],[]];t.U=[new n,new n];const s=t.U[0].blockSize/32;e.length>s&&(e=(new n).update(e).P());for(let t=0;s>t;t++)r[0][t]=909522486^e[t],r[1][t]=1549556828^e[t];t.U[0].update(r[0]),t.U[1].update(r[1]),t.K=new n(t.U[0])}reset(){const e=this;e.K=new e.M(e.U[0]),e.N=!1}update(e){this.N=!0,this.K.update(e)}digest(){const e=this,t=e.K.P(),n=new e.M(e.U[1]).update(t).P();return e.reset(),n}encrypt(e){if(this.N)throw new s("encrypt on already updated hmac called!");return this.update(e),this.digest(e)}}},R=typeof h!=v&&typeof h.getRandomValues==S,B="Invalid password",E="Invalid signature",M="zipjs-abort-check-password";function U(e){return R?h.getRandomValues(e):D.getRandomValues(e)}const K=16,N={name:"PBKDF2"},O=t.assign({hash:{name:"HMAC"}},N),T=t.assign({iterations:1e3,hash:{name:"SHA-1"}},N),W=["deriveBits"],j=[8,12,16],H=[16,24,32],L=10,F=[0,0,0,0],q=typeof h!=v,G=q&&h.subtle,J=q&&typeof G!=v,Q=_.bytes,X=class{constructor(e){const t=this;t.O=[[[],[],[],[],[]],[[],[],[],[],[]]],t.O[0][0][0]||t.T();const n=t.O[0][4],r=t.O[1],i=e.length;let o,c,f,a=1;if(4!==i&&6!==i&&8!==i)throw new s("invalid aes key size");for(t.v=[c=e.slice(0),f=[]],o=i;4*i+28>o;o++){let e=c[o-1];(o%i===0||8===i&&o%i===4)&&(e=n[e>>>24]<<24^n[e>>16&255]<<16^n[e>>8&255]<<8^n[255&e],o%i===0&&(e=e<<8^e>>>24^a<<24,a=a<<1^283*(a>>7))),c[o]=c[o-i]^e}for(let e=0;o;e++,o--){const t=c[3&e?o:o-4];f[e]=4>=o||4>e?t:r[0][n[t>>>24]]^r[1][n[t>>16&255]]^r[2][n[t>>8&255]]^r[3][n[255&t]]}}encrypt(e){return this.W(e,0)}decrypt(e){return this.W(e,1)}T(){const e=this.O[0],t=this.O[1],n=e[4],r=t[4],s=[],i=[];let o,c,f,a;for(let e=0;256>e;e++)i[(s[e]=e<<1^283*(e>>7))^e]=e;for(let l=o=0;!n[l];l^=c||1,o=i[o]||1){let i=o^o<<1^o<<2^o<<3^o<<4;i=i>>8^255&i^99,n[l]=i,r[i]=l,a=s[f=s[c=s[l]]];let u=16843009*a^65537*f^257*c^16843008*l,w=257*s[i]^16843008*i;for(let n=0;4>n;n++)e[n][l]=w=w<<24^w>>>8,t[n][i]=u=u<<24^u>>>8}for(let n=0;5>n;n++)e[n]=e[n].slice(0),t[n]=t[n].slice(0)}W(e,t){if(4!==e.length)throw new s("invalid aes block size");const n=this.v[t],r=n.length/4-2,i=[0,0,0,0],o=this.O[t],c=o[0],f=o[1],a=o[2],l=o[3],u=o[4];let w,h,d,p=e[0]^n[0],y=e[t?3:1]^n[1],m=e[2]^n[2],b=e[t?1:3]^n[3],g=4;for(let e=0;r>e;e++)w=c[p>>>24]^f[y>>16&255]^a[m>>8&255]^l[255&b]^n[g],h=c[y>>>24]^f[m>>16&255]^a[b>>8&255]^l[255&p]^n[g+1],d=c[m>>>24]^f[b>>16&255]^a[p>>8&255]^l[255&y]^n[g+2],b=c[b>>>24]^f[p>>16&255]^a[y>>8&255]^l[255&m]^n[g+3],g+=4,p=w,y=h,m=d;for(let e=0;4>e;e++)i[t?3&-e:e]=u[p>>>24]<<24^u[y>>16&255]<<16^u[m>>8&255]<<8^u[255&b]^n[g++],w=p,p=y,y=m,m=b,b=w;return i}},Y=class{constructor(e,t){this.j=e,this.H=t,this.L=t}reset(){this.L=this.H}update(e){return this.F(this.j,e,this.L)}q(e){if(255&~(e>>24))e+=1<<24;else{let t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}return e}G(e){0===(e[0]=this.q(e[0]))&&(e[1]=this.q(e[1]))}F(e,t,n){let r;if(!(r=t.length))return[];const s=I.l(t);for(let s=0;r>s;s+=4){this.G(n);const r=e.encrypt(n);t[s]^=r[0],t[s+1]^=r[1],t[s+2]^=r[2],t[s+3]^=r[3]}return I.u(t,s)}},Z=V.R;let $=q&&J&&typeof G.importKey==S,ee=q&&J&&typeof G.deriveBits==S;class te extends p{constructor({password:e,rawPassword:n,signed:r,encryptionStrength:o,checkPasswordOnly:c}){super({start(){t.assign(this,{ready:new u(e=>this.J=e),password:ie(e,n),signed:r,X:o-1,pending:new i})},async transform(e,t){const n=this,{password:r,X:o,J:f,ready:a}=n;r?(await(async(e,t,n,r)=>{const i=await se(e,t,n,ce(r,0,j[t])),o=ce(r,j[t]);if(i[0]!=o[0]||i[1]!=o[1])throw new s(B)})(n,o,r,ce(e,0,j[o]+2)),e=ce(e,j[o]+2),c?t.error(new s(M)):f()):await a;const l=new i(e.length-L-(e.length-L)%K);t.enqueue(re(n,e,l,0,L,!0))},async flush(e){const{signed:t,Y:n,Z:r,pending:o,ready:c}=this;if(r&&n){await c;const f=ce(o,0,o.length-L),a=ce(o,o.length-L);let l=new i;if(f.length){const e=ae(Q,f);r.update(e);const t=n.update(e);l=fe(Q,t)}if(t){const e=ce(fe(Q,r.digest()),0,L);for(let t=0;L>t;t++)if(e[t]!=a[t])throw new s(E)}e.enqueue(l)}}})}}class ne extends p{constructor({password:e,rawPassword:n,encryptionStrength:r}){let s;super({start(){t.assign(this,{ready:new u(e=>this.J=e),password:ie(e,n),X:r-1,pending:new i})},async transform(e,t){const n=this,{password:r,X:s,J:o,ready:c}=n;let f=new i;r?(f=await(async(e,t,n)=>{const r=U(new i(j[t]));return oe(r,await se(e,t,n,r))})(n,s,r),o()):await c;const a=new i(f.length+e.length-e.length%K);a.set(f,0),t.enqueue(re(n,e,a,f.length,0))},async flush(e){const{Y:t,Z:n,pending:r,ready:o}=this;if(n&&t){await o;let c=new i;if(r.length){const e=t.update(ae(Q,r));n.update(e),c=fe(Q,e)}s.signature=fe(Q,n.digest()).slice(0,L),e.enqueue(oe(c,s.signature))}}}),s=this}}function re(e,t,n,r,s,o){const{Y:c,Z:f,pending:a}=e,l=t.length-s;let u;for(a.length&&(t=oe(a,t),n=((e,t)=>{if(t&&t>e.length){const n=e;(e=new i(t)).set(n,0)}return e})(n,l-l%K)),u=0;l-K>=u;u+=K){const e=ae(Q,ce(t,u,u+K));o&&f.update(e);const s=c.update(e);o||f.update(s),n.set(fe(Q,s),u+r)}return e.pending=ce(t,u),n}async function se(n,r,s,o){n.password=null;const c=await(async(e,t,n,r,s)=>{if(!$)return V.importKey(t);try{return await G.importKey("raw",t,n,!1,s)}catch(e){return $=!1,V.importKey(t)}})(0,s,O,0,W),f=await(async(e,t,n)=>{if(!ee)return V.B(t,e.salt,T.iterations,n);try{return await G.deriveBits(e,t,n)}catch(r){return ee=!1,V.B(t,e.salt,T.iterations,n)}})(t.assign({salt:o},T),c,8*(2*H[r]+2)),a=new i(f),l=ae(Q,ce(a,0,H[r])),u=ae(Q,ce(a,H[r],2*H[r])),w=ce(a,2*H[r]);return t.assign(n,{keys:{key:l,$:u,passwordVerification:w},Y:new Y(new X(l),e.from(F)),Z:new Z(u)}),w}function ie(e,t){return t===k?(e=>{if(typeof w==v){const t=new i((e=unescape(encodeURIComponent(e))).length);for(let n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return t}return(new w).encode(e)})(e):t}function oe(e,t){let n=e;return e.length+t.length&&(n=new i(e.length+t.length),n.set(e,0),n.set(t,e.length)),n}function ce(e,t,n){return e.subarray(t,n)}function fe(e,t){return e.p(t)}function ae(e,t){return e.m(t)}class le extends p{constructor({password:e,passwordVerification:n,checkPasswordOnly:r}){super({start(){t.assign(this,{password:e,passwordVerification:n}),de(this,e)},transform(e,t){const n=this;if(n.password){const t=we(n,e.subarray(0,12));if(n.password=null,t[11]!=n.passwordVerification)throw new s(B);e=e.subarray(12)}r?t.error(new s(M)):t.enqueue(we(n,e))}})}}class ue extends p{constructor({password:e,passwordVerification:n}){super({start(){t.assign(this,{password:e,passwordVerification:n}),de(this,e)},transform(e,t){const n=this;let r,s;if(n.password){n.password=null;const t=U(new i(12));t[11]=n.passwordVerification,r=new i(e.length+t.length),r.set(he(n,t),0),s=12}else r=new i(e.length),s=0;r.set(he(n,e),s),t.enqueue(r)}})}}function we(e,t){const n=new i(t.length);for(let r=0;r<t.length;r++)n[r]=ye(e)^t[r],pe(e,n[r]);return n}function he(e,t){const n=new i(t.length);for(let r=0;r<t.length;r++)n[r]=ye(e)^t[r],pe(e,t[r]);return n}function de(e,n){const r=[305419896,591751049,878082192];t.assign(e,{keys:r,ee:new x(r[0]),te:new x(r[2])});for(let t=0;t<n.length;t++)pe(e,n.charCodeAt(t))}function pe(e,t){let[n,s,i]=e.keys;e.ee.append([t]),n=~e.ee.get(),s=be(r.imul(be(s+me(n)),134775813)+1),e.te.append([s>>>24]),i=~e.te.get(),e.keys=[n,s,i]}function ye(e){const t=2|e.keys[2];return me(r.imul(t,1^t)>>>8)}function me(e){return 255&e}function be(e){return 4294967295&e}const ge="deflate-raw";class ke extends p{constructor(e,{chunkSize:t,CompressionStream:n,CompressionStreamNative:r}){super({});const{compressed:s,encrypted:i,useCompressionStream:o,zipCrypto:c,signed:f,level:a}=e,u=this;let w,h,d=super.readable;i&&!c||!f||(w=new A,d=Ce(d,w)),s&&(d=ze(d,o,{level:a,chunkSize:t},r,n)),i&&(c?d=Ce(d,new ue(e)):(h=new ne(e),d=Ce(d,h))),Se(u,d,()=>{let e;i&&!c&&(e=h.signature),i&&!c||!f||(e=new l(w.value.buffer).getUint32(0)),u.signature=e})}}class ve extends p{constructor(e,{chunkSize:t,DecompressionStream:n,DecompressionStreamNative:r}){super({});const{zipCrypto:i,encrypted:o,signed:c,signature:f,compressed:a,useCompressionStream:u}=e;let w,h,d=super.readable;o&&(i?d=Ce(d,new le(e)):(h=new te(e),d=Ce(d,h))),a&&(d=ze(d,u,{chunkSize:t},r,n)),o&&!i||!c||(w=new A,d=Ce(d,w)),Se(this,d,()=>{if((!o||i)&&c){const e=new l(w.value.buffer);if(f!=e.getUint32(0,!1))throw new s(E)}})}}function Se(e,n,r){n=Ce(n,new p({flush:r})),t.defineProperty(e,"readable",{get:()=>n})}function ze(e,t,n,r,s){try{e=Ce(e,new(t&&r?r:s)(ge,n))}catch(r){if(!t)throw r;e=Ce(e,new s(ge,n))}return e}function Ce(e,t){return e.pipeThrough(t)}const xe="data",Ae="close";class Ie extends p{constructor(e,n){super({});const r=this,{codecType:i}=e;let o;i.startsWith("deflate")?o=ke:i.startsWith("inflate")&&(o=ve),r.outputSize=0;let c=0;const f=new o(e,n),a=super.readable,l=new p({transform(e,t){e&&e.length&&(c+=e.length,t.enqueue(e))},flush(){t.assign(r,{inputSize:c})}}),u=new p({transform(t,n){if(t&&t.length&&(n.enqueue(t),r.outputSize+=t.length,e.outputSize&&r.outputSize>e.outputSize))throw new s("Invalid uncompressed size")},flush(){const{signature:e}=f;t.assign(r,{signature:e,inputSize:c})}});t.defineProperty(r,"readable",{get:()=>a.pipeThrough(l).pipeThrough(f).pipeThrough(u)})}}class _e extends p{constructor(e){let t;super({transform:function n(r,s){if(t){const e=new i(t.length+r.length);e.set(t),e.set(r,t.length),r=e,t=null}r.length>e?(s.enqueue(r.slice(0,e)),n(r.slice(e),s)):t=r},flush(e){t&&t.length&&e.enqueue(t)}})}}const Pe=new a,De=new a;let Ve,Re=0,Be=!0;async function Ee(e){try{const{options:t,scripts:r,config:s}=e;if(r&&r.length)try{Be?importScripts.apply(k,r):await Me(r)}catch(e){Be=!1,await Me(r)}self.initCodec&&self.initCodec(),s.CompressionStreamNative=self.CompressionStream,s.DecompressionStreamNative=self.DecompressionStream,self.Deflate&&(s.CompressionStream=new z(self.Deflate)),self.Inflate&&(s.DecompressionStream=new z(self.Inflate));const i={highWaterMark:1},o=e.readable||new y({async pull(e){const t=new u(e=>Pe.set(Re,e));Ue({type:"pull",messageId:Re}),Re=(Re+1)%n.MAX_SAFE_INTEGER;const{value:r,done:s}=await t;e.enqueue(r),s&&e.close()}},i),c=e.writable||new m({async write(e){let t;const r=new u(e=>t=e);De.set(Re,t),Ue({type:xe,value:e,messageId:Re}),Re=(Re+1)%n.MAX_SAFE_INTEGER,await r}},i),f=new Ie(t,s);Ve=new AbortController;const{signal:a}=Ve;await o.pipeThrough(f).pipeThrough(new _e(s.chunkSize)).pipeTo(c,{signal:a,preventClose:!0,preventAbort:!0}),await c.getWriter().close();const{signature:l,inputSize:w,outputSize:h}=f;Ue({type:Ae,result:{signature:l,inputSize:w,outputSize:h}})}catch(e){e.outputSize=0,Ke(e)}}async function Me(e){for(const t of e)await import(t)}function Ue(e){let{value:t}=e;if(t)if(t.length)try{t=new i(t),e.value=t.buffer,d(e,[e.value])}catch(t){d(e)}else d(e);else d(e)}function Ke(e=new s("Unknown error")){const{message:t,stack:n,code:r,name:i,outputSize:o}=e;d({error:{message:t,stack:n,code:r,name:i,outputSize:o}})}addEventListener("message",({data:e})=>{const{type:t,messageId:n,value:r,done:s}=e;try{if("start"==t&&Ee(e),t==xe){const e=Pe.get(n);Pe.delete(n),e({value:new i(r),done:s})}if("ack"==t){const e=De.get(n);De.delete(n),e()}t==Ae&&Ve.abort()}catch(e){Ke(e)}});const Ne=-2;function Oe(t){return Te(t.map(([t,n])=>new e(t).fill(n,0,t)))}function Te(t){return t.reduce((t,n)=>t.concat(e.isArray(n)?Te(n):n),[])}const We=[0,1,2,3].concat(...Oe([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function je(){const e=this;function t(e,t){let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}e.ne=n=>{const s=e.re,i=e.ie.se,o=e.ie.oe;let c,f,a,l=-1;for(n.ce=0,n.fe=573,c=0;o>c;c++)0!==s[2*c]?(n.ae[++n.ce]=l=c,n.le[c]=0):s[2*c+1]=0;for(;2>n.ce;)a=n.ae[++n.ce]=2>l?++l:0,s[2*a]=1,n.le[a]=0,n.ue--,i&&(n.we-=i[2*a+1]);for(e.he=l,c=r.floor(n.ce/2);c>=1;c--)n.de(s,c);a=o;do{c=n.ae[1],n.ae[1]=n.ae[n.ce--],n.de(s,1),f=n.ae[1],n.ae[--n.fe]=c,n.ae[--n.fe]=f,s[2*a]=s[2*c]+s[2*f],n.le[a]=r.max(n.le[c],n.le[f])+1,s[2*c+1]=s[2*f+1]=a,n.ae[1]=a++,n.de(s,1)}while(n.ce>=2);n.ae[--n.fe]=n.ae[1],(t=>{const n=e.re,r=e.ie.se,s=e.ie.pe,i=e.ie.ye,o=e.ie.me;let c,f,a,l,u,w,h=0;for(l=0;15>=l;l++)t.be[l]=0;for(n[2*t.ae[t.fe]+1]=0,c=t.fe+1;573>c;c++)f=t.ae[c],l=n[2*n[2*f+1]+1]+1,l>o&&(l=o,h++),n[2*f+1]=l,f>e.he||(t.be[l]++,u=0,i>f||(u=s[f-i]),w=n[2*f],t.ue+=w*(l+u),r&&(t.we+=w*(r[2*f+1]+u)));if(0!==h){do{for(l=o-1;0===t.be[l];)l--;t.be[l]--,t.be[l+1]+=2,t.be[o]--,h-=2}while(h>0);for(l=o;0!==l;l--)for(f=t.be[l];0!==f;)a=t.ae[--c],a>e.he||(n[2*a+1]!=l&&(t.ue+=(l-n[2*a+1])*n[2*a],n[2*a+1]=l),f--)}})(n),((e,n,r)=>{const s=[];let i,o,c,f=0;for(i=1;15>=i;i++)s[i]=f=f+r[i-1]<<1;for(o=0;n>=o;o++)c=e[2*o+1],0!==c&&(e[2*o]=t(s[c]++,c))})(s,e.he,n.be)}}function He(e,t,n,r,s){const i=this;i.se=e,i.pe=t,i.ye=n,i.oe=r,i.me=s}je.ge=[0,1,2,3,4,5,6,7].concat(...Oe([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),je.ke=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],je.ve=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],je.Se=e=>256>e?We[e]:We[256+(e>>>7)],je.ze=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],je.Ce=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],je.xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],je.Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];const Le=Oe([[144,8],[112,9],[24,7],[8,8]]);He.Ie=Te([12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227].map((e,t)=>[e,Le[t]]));const Fe=Oe([[30,5]]);function qe(e,t,n,r,s){const i=this;i._e=e,i.Pe=t,i.De=n,i.Ve=r,i.Re=s}He.Be=Te([0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23].map((e,t)=>[e,Fe[t]])),He.Ee=new He(He.Ie,je.ze,257,286,15),He.Me=new He(He.Be,je.Ce,0,30,15),He.Ue=new He(null,je.xe,0,19,7);const Ge=[new qe(0,0,0,0,0),new qe(4,4,8,4,1),new qe(4,5,16,8,1),new qe(4,6,32,32,1),new qe(4,4,16,16,2),new qe(8,16,32,32,2),new qe(8,16,128,128,2),new qe(8,32,128,256,2),new qe(32,128,258,1024,2),new qe(32,258,258,4096,2)],Je=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Qe=113,Xe=666,Ye=262;function Ze(e,t,n,r){const s=e[2*t],i=e[2*n];return i>s||s==i&&r[t]<=r[n]}function $e(){const e=this;let t,n,s,c,f,a,l,u,w,h,d,p,y,m,b,g,k,v,S,z,C,x,A,I,_,P,D,V,R,B,E,M,U;const K=new je,N=new je,O=new je;let T,W,j,H,L,F;function q(){let t;for(t=0;286>t;t++)E[2*t]=0;for(t=0;30>t;t++)M[2*t]=0;for(t=0;19>t;t++)U[2*t]=0;E[512]=1,e.ue=e.we=0,W=j=0}function G(e,t){let n,r=-1,s=e[1],i=0,o=7,c=4;0===s&&(o=138,c=3),e[2*(t+1)+1]=65535;for(let f=0;t>=f;f++)n=s,s=e[2*(f+1)+1],++i<o&&n==s||(c>i?U[2*n]+=i:0!==n?(n!=r&&U[2*n]++,U[32]++):i>10?U[36]++:U[34]++,i=0,r=n,0===s?(o=138,c=3):n==s?(o=6,c=3):(o=7,c=4))}function J(t){e.Ke[e.pending++]=t}function Q(e){J(255&e),J(e>>>8&255)}function X(e,t){let n;const r=t;F>16-r?(n=e,L|=n<<F&65535,Q(L),L=n>>>16-F,F+=r-16):(L|=e<<F&65535,F+=r)}function Y(e,t){const n=2*e;X(65535&t[n],65535&t[n+1])}function Z(e,t){let n,r,s=-1,i=e[1],o=0,c=7,f=4;for(0===i&&(c=138,f=3),n=0;t>=n;n++)if(r=i,i=e[2*(n+1)+1],++o>=c||r!=i){if(f>o)do{Y(r,U)}while(0!==--o);else 0!==r?(r!=s&&(Y(r,U),o--),Y(16,U),X(o-3,2)):o>10?(Y(18,U),X(o-11,7)):(Y(17,U),X(o-3,3));o=0,s=r,0===i?(c=138,f=3):r==i?(c=6,f=3):(c=7,f=4)}}function $(){16==F?(Q(L),L=0,F=0):8>F||(J(255&L),L>>>=8,F-=8)}function ee(t,n){let s,i,o;if(e.Ne[W]=t,e.Oe[W]=255&n,W++,0===t?E[2*n]++:(j++,t--,E[2*(je.ge[n]+256+1)]++,M[2*je.Se(t)]++),!(8191&W)&&D>2){for(s=8*W,i=C-k,o=0;30>o;o++)s+=M[2*o]*(5+je.Ce[o]);if(s>>>=3,j<r.floor(W/2)&&s<r.floor(i/2))return!0}return W==T-1}function te(t,n){let r,s,i,o,c=0;if(0!==W)do{r=e.Ne[c],s=e.Oe[c],c++,0===r?Y(s,t):(i=je.ge[s],Y(i+256+1,t),o=je.ze[i],0!==o&&(s-=je.ke[i],X(s,o)),r--,i=je.Se(r),Y(i,n),o=je.Ce[i],0!==o&&(r-=je.ve[i],X(r,o)))}while(W>c);Y(256,t),H=t[513]}function ne(){F>8?Q(L):F>0&&J(255&L),L=0,F=0}function re(t,n,r){X(0+(r?1:0),3),((t,n)=>{ne(),H=8,Q(n),Q(~n),e.Ke.set(u.subarray(t,t+n),e.pending),e.pending+=n})(t,n)}function se(n){((t,n,r)=>{let s,i,o=0;D>0?(K.ne(e),N.ne(e),o=(()=>{let t;for(G(E,K.he),G(M,N.he),O.ne(e),t=18;t>=3&&0===U[2*je.Ae[t]+1];t--);return e.ue+=14+3*(t+1),t})(),s=e.ue+3+7>>>3,i=e.we+3+7>>>3,i>s||(s=i)):s=i=n+5,n+4>s||-1==t?i==s?(X(2+(r?1:0),3),te(He.Ie,He.Be)):(X(4+(r?1:0),3),((e,t,n)=>{let r;for(X(e-257,5),X(t-1,5),X(n-4,4),r=0;n>r;r++)X(U[2*je.Ae[r]+1],3);Z(E,e-1),Z(M,t-1)})(K.he+1,N.he+1,o+1),te(E,M)):re(t,n,r),q(),r&&ne()})(0>k?-1:k,C-k,n),k=C,t.Te()}function ie(){let e,n,r,s;do{if(s=w-A-C,0===s&&0===C&&0===A)s=f;else if(-1==s)s--;else if(C>=f+f-Ye){u.set(u.subarray(f,f+f),0),x-=f,C-=f,k-=f,e=y,r=e;do{n=65535&d[--r],d[r]=f>n?0:n-f}while(0!==--e);e=f,r=e;do{n=65535&h[--r],h[r]=f>n?0:n-f}while(0!==--e);s+=f}if(0===t.We)return;e=t.je(u,C+A,s),A+=e,3>A||(p=255&u[C],p=(p<<g^255&u[C+1])&b)}while(Ye>A&&0!==t.We)}function oe(e){let t,n,r=_,s=C,i=I;const o=C>f-Ye?C-(f-Ye):0;let c=B;const a=l,w=C+258;let d=u[s+i-1],p=u[s+i];R>I||(r>>=2),c>A&&(c=A);do{if(t=e,u[t+i]==p&&u[t+i-1]==d&&u[t]==u[s]&&u[++t]==u[s+1]){s+=2,t++;do{}while(u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&w>s);if(n=258-(w-s),s=w-258,n>i){if(x=e,i=n,n>=c)break;d=u[s+i-1],p=u[s+i]}}}while((e=65535&h[e&a])>o&&0!==--r);return i>A?A:i}e.le=[],e.be=[],e.ae=[],E=[],M=[],U=[],e.de=(t,n)=>{const r=e.ae,s=r[n];let i=n<<1;for(;i<=e.ce&&(i<e.ce&&Ze(t,r[i+1],r[i],e.le)&&i++,!Ze(t,s,r[i],e.le));)r[n]=r[i],n=i,i<<=1;r[n]=s},e.He=(t,S,x,W,j,G)=>(W||(W=8),j||(j=8),G||(G=0),t.Le=null,-1==S&&(S=6),1>j||j>9||8!=W||9>x||x>15||0>S||S>9||0>G||G>2?Ne:(t.Fe=e,a=x,f=1<<a,l=f-1,m=j+7,y=1<<m,b=y-1,g=r.floor((m+3-1)/3),u=new i(2*f),h=[],d=[],T=1<<j+6,e.Ke=new i(4*T),s=4*T,e.Ne=new o(T),e.Oe=new i(T),D=S,V=G,(t=>(t.qe=t.Ge=0,t.Le=null,e.pending=0,e.Je=0,n=Qe,c=0,K.re=E,K.ie=He.Ee,N.re=M,N.ie=He.Me,O.re=U,O.ie=He.Ue,L=0,F=0,H=8,q(),(()=>{w=2*f,d[y-1]=0;for(let e=0;y-1>e;e++)d[e]=0;P=Ge[D].Pe,R=Ge[D]._e,B=Ge[D].De,_=Ge[D].Ve,C=0,k=0,A=0,v=I=2,z=0,p=0})(),0))(t))),e.Qe=()=>42!=n&&n!=Qe&&n!=Xe?Ne:(e.Oe=null,e.Ne=null,e.Ke=null,d=null,h=null,u=null,e.Fe=null,n==Qe?-3:0),e.Xe=(e,t,n)=>{let r=0;return-1==t&&(t=6),0>t||t>9||0>n||n>2?Ne:(Ge[D].Re!=Ge[t].Re&&0!==e.qe&&(r=e.Ye(1)),D!=t&&(D=t,P=Ge[D].Pe,R=Ge[D]._e,B=Ge[D].De,_=Ge[D].Ve),V=n,r)},e.Ze=(e,t,r)=>{let s,i=r,o=0;if(!t||42!=n)return Ne;if(3>i)return 0;for(i>f-Ye&&(i=f-Ye,o=r-i),u.set(t.subarray(o,o+i),0),C=i,k=i,p=255&u[0],p=(p<<g^255&u[1])&b,s=0;i-3>=s;s++)p=(p<<g^255&u[s+2])&b,h[s&l]=d[p],d[p]=s;return 0},e.Ye=(r,i)=>{let o,w,m,_,R;if(i>4||0>i)return Ne;if(!r.$e||!r.et&&0!==r.We||n==Xe&&4!=i)return r.Le=Je[4],Ne;if(0===r.tt)return r.Le=Je[7],-5;var B;if(t=r,_=c,c=i,42==n&&(w=8+(a-8<<4)<<8,m=(D-1&255)>>1,m>3&&(m=3),w|=m<<6,0!==C&&(w|=32),w+=31-w%31,n=Qe,J((B=w)>>8&255),J(255&B)),0!==e.pending){if(t.Te(),0===t.tt)return c=-1,0}else if(0===t.We&&_>=i&&4!=i)return t.Le=Je[7],-5;if(n==Xe&&0!==t.We)return r.Le=Je[7],-5;if(0!==t.We||0!==A||0!=i&&n!=Xe){switch(R=-1,Ge[D].Re){case 0:R=(e=>{let n,r=65535;for(r>s-5&&(r=s-5);;){if(1>=A){if(ie(),0===A&&0==e)return 0;if(0===A)break}if(C+=A,A=0,n=k+r,(0===C||C>=n)&&(A=C-n,C=n,se(!1),0===t.tt))return 0;if(C-k>=f-Ye&&(se(!1),0===t.tt))return 0}return se(4==e),0===t.tt?4==e?2:0:4==e?3:1})(i);break;case 1:R=(e=>{let n,r=0;for(;;){if(Ye>A){if(ie(),Ye>A&&0==e)return 0;if(0===A)break}if(3>A||(p=(p<<g^255&u[C+2])&b,r=65535&d[p],h[C&l]=d[p],d[p]=C),0===r||(C-r&65535)>f-Ye||2!=V&&(v=oe(r)),3>v)n=ee(0,255&u[C]),A--,C++;else if(n=ee(C-x,v-3),A-=v,v>P||3>A)C+=v,v=0,p=255&u[C],p=(p<<g^255&u[C+1])&b;else{v--;do{C++,p=(p<<g^255&u[C+2])&b,r=65535&d[p],h[C&l]=d[p],d[p]=C}while(0!==--v);C++}if(n&&(se(!1),0===t.tt))return 0}return se(4==e),0===t.tt?4==e?2:0:4==e?3:1})(i);break;case 2:R=(e=>{let n,r,s=0;for(;;){if(Ye>A){if(ie(),Ye>A&&0==e)return 0;if(0===A)break}if(3>A||(p=(p<<g^255&u[C+2])&b,s=65535&d[p],h[C&l]=d[p],d[p]=C),I=v,S=x,v=2,0!==s&&P>I&&f-Ye>=(C-s&65535)&&(2!=V&&(v=oe(s)),5>=v&&(1==V||3==v&&C-x>4096)&&(v=2)),3>I||v>I)if(0!==z){if(n=ee(0,255&u[C-1]),n&&se(!1),C++,A--,0===t.tt)return 0}else z=1,C++,A--;else{r=C+A-3,n=ee(C-1-S,I-3),A-=I-1,I-=2;do{++C>r||(p=(p<<g^255&u[C+2])&b,s=65535&d[p],h[C&l]=d[p],d[p]=C)}while(0!==--I);if(z=0,v=2,C++,n&&(se(!1),0===t.tt))return 0}}return 0!==z&&(n=ee(0,255&u[C-1]),z=0),se(4==e),0===t.tt?4==e?2:0:4==e?3:1})(i)}if(2!=R&&3!=R||(n=Xe),0==R||2==R)return 0===t.tt&&(c=-1),0;if(1==R){if(1==i)X(2,3),Y(256,He.Ie),$(),9>1+H+10-F&&(X(2,3),Y(256,He.Ie),$()),H=7;else if(re(0,0,!1),3==i)for(o=0;y>o;o++)d[o]=0;if(t.Te(),0===t.tt)return c=-1,0}}return 4!=i?0:1}}function et(){const e=this;e.nt=0,e.rt=0,e.We=0,e.qe=0,e.tt=0,e.Ge=0}function tt(e){const t=new et,n=(o=e&&e.chunkSize?e.chunkSize:65536)+5*(r.floor(o/16383)+1);var o;const c=new i(n);let f=e?e.level:-1;void 0===f&&(f=-1),t.He(f),t.$e=c,this.append=(e,r)=>{let o,f,a=0,l=0,u=0;const w=[];if(e.length){t.nt=0,t.et=e,t.We=e.length;do{if(t.rt=0,t.tt=n,o=t.Ye(0),0!=o)throw new s("deflating: "+t.Le);t.rt&&(t.rt==n?w.push(new i(c)):w.push(c.subarray(0,t.rt))),u+=t.rt,r&&t.nt>0&&t.nt!=a&&(r(t.nt),a=t.nt)}while(t.We>0||0===t.tt);return w.length>1?(f=new i(u),w.forEach(e=>{f.set(e,l),l+=e.length})):f=w[0]?new i(w[0]):new i,f}},this.flush=()=>{let e,r,o=0,f=0;const a=[];do{if(t.rt=0,t.tt=n,e=t.Ye(4),1!=e&&0!=e)throw new s("deflating: "+t.Le);n-t.tt>0&&a.push(c.slice(0,t.rt)),f+=t.rt}while(t.We>0||0===t.tt);return t.Qe(),r=new i(f),a.forEach(e=>{r.set(e,o),o+=e.length}),r}}et.prototype={He(e,t){const n=this;return n.Fe=new $e,t||(t=15),n.Fe.He(n,e,t)},Ye(e){const t=this;return t.Fe?t.Fe.Ye(t,e):Ne},Qe(){const e=this;if(!e.Fe)return Ne;const t=e.Fe.Qe();return e.Fe=null,t},Xe(e,t){const n=this;return n.Fe?n.Fe.Xe(n,e,t):Ne},Ze(e,t){const n=this;return n.Fe?n.Fe.Ze(n,e,t):Ne},je(e,t,n){const r=this;let s=r.We;return s>n&&(s=n),0===s?0:(r.We-=s,e.set(r.et.subarray(r.nt,r.nt+s),t),r.nt+=s,r.qe+=s,s)},Te(){const e=this;let t=e.Fe.pending;t>e.tt&&(t=e.tt),0!==t&&(e.$e.set(e.Fe.Ke.subarray(e.Fe.Je,e.Fe.Je+t),e.rt),e.rt+=t,e.Fe.Je+=t,e.Ge+=t,e.tt-=t,e.Fe.pending-=t,0===e.Fe.pending&&(e.Fe.Je=0))}};const nt=-2,rt=-3,st=-5,it=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],ot=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],ct=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],ft=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],at=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],lt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ut=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function wt(){let e,t,n,r,s,i;function o(e,t,o,c,f,a,l,u,w,h,d){let p,y,m,b,g,k,v,S,z,C,x,A,I,_,P;C=0,g=o;do{n[e[t+C]]++,C++,g--}while(0!==g);if(n[0]==o)return l[0]=-1,u[0]=0,0;for(S=u[0],k=1;15>=k&&0===n[k];k++);for(v=k,k>S&&(S=k),g=15;0!==g&&0===n[g];g--);for(m=g,S>g&&(S=g),u[0]=S,_=1<<k;g>k;k++,_<<=1)if(0>(_-=n[k]))return rt;if(0>(_-=n[g]))return rt;for(n[g]+=_,i[1]=k=0,C=1,I=2;0!==--g;)i[I]=k+=n[C],I++,C++;g=0,C=0;do{0!==(k=e[t+C])&&(d[i[k]++]=g),C++}while(++g<o);for(o=i[m],i[0]=g=0,C=0,b=-1,A=-S,s[0]=0,x=0,P=0;m>=v;v++)for(p=n[v];0!==p--;){for(;v>A+S;){if(b++,A+=S,P=m-A,P=P>S?S:P,(y=1<<(k=v-A))>p+1&&(y-=p+1,I=v,P>k))for(;++k<P&&(y<<=1)>n[++I];)y-=n[I];if(P=1<<k,h[0]+P>1440)return rt;s[b]=x=h[0],h[0]+=P,0!==b?(i[b]=g,r[0]=k,r[1]=S,k=g>>>A-S,r[2]=x-s[b-1]-k,w.set(r,3*(s[b-1]+k))):l[0]=x}for(r[1]=v-A,o>C?d[C]<c?(r[0]=256>d[C]?0:96,r[2]=d[C++]):(r[0]=a[d[C]-c]+16+64,r[2]=f[d[C++]-c]):r[0]=192,y=1<<v-A,k=g>>>A;P>k;k+=y)w.set(r,3*(x+k));for(k=1<<v-1;0!==(g&k);k>>>=1)g^=k;for(g^=k,z=(1<<A)-1;(g&z)!=i[b];)b--,A-=S,z=(1<<A)-1}return 0!==_&&1!=m?st:0}function c(o){let c;for(e||(e=[],t=[],n=new f(16),r=[],s=new f(15),i=new f(16)),t.length<o&&(t=[]),c=0;o>c;c++)t[c]=0;for(c=0;16>c;c++)n[c]=0;for(c=0;3>c;c++)r[c]=0;s.set(n.subarray(0,15),0),i.set(n.subarray(0,16),0)}this.st=(n,r,s,i,f)=>{let a;return c(19),e[0]=0,a=o(n,0,19,19,null,null,s,r,i,e,t),a==rt?f.Le="oversubscribed dynamic bit lengths tree":a!=st&&0!==r[0]||(f.Le="incomplete dynamic bit lengths tree",a=rt),a},this.it=(n,r,s,i,f,a,l,u,w)=>{let h;return c(288),e[0]=0,h=o(s,0,n,257,ft,at,a,i,u,e,t),0!=h||0===i[0]?(h==rt?w.Le="oversubscribed literal/length tree":-4!=h&&(w.Le="incomplete literal/length tree",h=rt),h):(c(288),h=o(s,n,r,0,lt,ut,l,f,u,e,t),0!=h||0===f[0]&&n>257?(h==rt?w.Le="oversubscribed distance tree":h==st?(w.Le="incomplete distance tree",h=rt):-4!=h&&(w.Le="empty distance tree with lengths",h=rt),h):0)}}function ht(){const e=this;let t,n,r,s,i=0,o=0,c=0,f=0,a=0,l=0,u=0,w=0,h=0,d=0;function p(e,t,n,r,s,i,o,c){let f,a,l,u,w,h,d,p,y,m,b,g,k,v,S,z;d=c.nt,p=c.We,w=o.ot,h=o.ct,y=o.write,m=y<o.read?o.read-y-1:o.end-y,b=it[e],g=it[t];do{for(;20>h;)p--,w|=(255&c.ft(d++))<<h,h+=8;if(f=w&b,a=n,l=r,z=3*(l+f),0!==(u=a[z]))for(;;){if(w>>=a[z+1],h-=a[z+1],16&u){for(u&=15,k=a[z+2]+(w&it[u]),w>>=u,h-=u;15>h;)p--,w|=(255&c.ft(d++))<<h,h+=8;for(f=w&g,a=s,l=i,z=3*(l+f),u=a[z];;){if(w>>=a[z+1],h-=a[z+1],16&u){for(u&=15;u>h;)p--,w|=(255&c.ft(d++))<<h,h+=8;if(v=a[z+2]+(w&it[u]),w>>=u,h-=u,m-=k,v>y){S=y-v;do{S+=o.end}while(0>S);if(u=o.end-S,k>u){if(k-=u,y-S>0&&u>y-S)do{o.lt[y++]=o.lt[S++]}while(0!==--u);else o.lt.set(o.lt.subarray(S,S+u),y),y+=u,S+=u,u=0;S=0}}else S=y-v,y-S>0&&2>y-S?(o.lt[y++]=o.lt[S++],o.lt[y++]=o.lt[S++],k-=2):(o.lt.set(o.lt.subarray(S,S+2),y),y+=2,S+=2,k-=2);if(y-S>0&&k>y-S)do{o.lt[y++]=o.lt[S++]}while(0!==--k);else o.lt.set(o.lt.subarray(S,S+k),y),y+=k,S+=k,k=0;break}if(64&u)return c.Le="invalid distance code",k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,rt;f+=a[z+2],f+=w&it[u],z=3*(l+f),u=a[z]}break}if(64&u)return 32&u?(k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,1):(c.Le="invalid literal/length code",k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,rt);if(f+=a[z+2],f+=w&it[u],z=3*(l+f),0===(u=a[z])){w>>=a[z+1],h-=a[z+1],o.lt[y++]=a[z+2],m--;break}}else w>>=a[z+1],h-=a[z+1],o.lt[y++]=a[z+2],m--}while(m>=258&&p>=10);return k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,0}e.init=(e,i,o,c,f,a)=>{t=0,u=e,w=i,r=o,h=c,s=f,d=a,n=null},e.ut=(e,y,m)=>{let b,g,k,v,S,z,C,x=0,A=0,I=0;for(I=y.nt,v=y.We,x=e.ot,A=e.ct,S=e.write,z=S<e.read?e.read-S-1:e.end-S;;)switch(t){case 0:if(z>=258&&v>=10&&(e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,m=p(u,w,r,h,s,d,e,y),I=y.nt,v=y.We,x=e.ot,A=e.ct,S=e.write,z=S<e.read?e.read-S-1:e.end-S,0!=m)){t=1==m?7:9;break}c=u,n=r,o=h,t=1;case 1:for(b=c;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(I++))<<A,A+=8}if(g=3*(o+(x&it[b])),x>>>=n[g+1],A-=n[g+1],k=n[g],0===k){f=n[g+2],t=6;break}if(16&k){a=15&k,i=n[g+2],t=2;break}if(!(64&k)){c=k,o=g/3+n[g+2];break}if(32&k){t=7;break}return t=9,y.Le="invalid literal/length code",m=rt,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);case 2:for(b=a;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(I++))<<A,A+=8}i+=x&it[b],x>>=b,A-=b,c=w,n=s,o=d,t=3;case 3:for(b=c;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(I++))<<A,A+=8}if(g=3*(o+(x&it[b])),x>>=n[g+1],A-=n[g+1],k=n[g],16&k){a=15&k,l=n[g+2],t=4;break}if(!(64&k)){c=k,o=g/3+n[g+2];break}return t=9,y.Le="invalid distance code",m=rt,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);case 4:for(b=a;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(I++))<<A,A+=8}l+=x&it[b],x>>=b,A-=b,t=5;case 5:for(C=S-l;0>C;)C+=e.end;for(;0!==i;){if(0===z&&(S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z&&(e.write=S,m=e.wt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z)))return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);e.lt[S++]=e.lt[C++],z--,C==e.end&&(C=0),i--}t=0;break;case 6:if(0===z&&(S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z&&(e.write=S,m=e.wt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z)))return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,e.lt[S++]=f,z--,t=0;break;case 7:if(A>7&&(A-=8,v++,I--),e.write=S,m=e.wt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,e.read!=e.write)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);t=8;case 8:return m=1,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);case 9:return m=rt,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);default:return m=nt,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m)}},e.ht=()=>{}}wt.dt=(e,t,n,r)=>(e[0]=9,t[0]=5,n[0]=ot,r[0]=ct,0);const dt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function pt(e,t){const n=this;let r,s=0,o=0,c=0,a=0;const l=[0],u=[0],w=new ht;let h=0,d=new f(4320);const p=new wt;n.ct=0,n.ot=0,n.lt=new i(t),n.end=t,n.read=0,n.write=0,n.reset=(e,t)=>{t&&(t[0]=0),6==s&&w.ht(e),s=0,n.ct=0,n.ot=0,n.read=n.write=0},n.reset(e,null),n.wt=(e,t)=>{let r,s,i;return s=e.rt,i=n.read,r=(i>n.write?n.end:n.write)-i,r>e.tt&&(r=e.tt),0!==r&&t==st&&(t=0),e.tt-=r,e.Ge+=r,e.$e.set(n.lt.subarray(i,i+r),s),s+=r,i+=r,i==n.end&&(i=0,n.write==n.end&&(n.write=0),r=n.write-i,r>e.tt&&(r=e.tt),0!==r&&t==st&&(t=0),e.tt-=r,e.Ge+=r,e.$e.set(n.lt.subarray(i,i+r),s),s+=r,i+=r),e.rt=s,n.read=i,t},n.ut=(e,t)=>{let i,f,y,m,b,g,k,v;for(m=e.nt,b=e.We,f=n.ot,y=n.ct,g=n.write,k=g<n.read?n.read-g-1:n.end-g;;){let S,z,C,x,A,I,_,P;switch(s){case 0:for(;3>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}switch(i=7&f,h=1&i,i>>>1){case 0:f>>>=3,y-=3,i=7&y,f>>>=i,y-=i,s=1;break;case 1:S=[],z=[],C=[[]],x=[[]],wt.dt(S,z,C,x),w.init(S[0],z[0],C[0],0,x[0],0),f>>>=3,y-=3,s=6;break;case 2:f>>>=3,y-=3,s=3;break;case 3:return f>>>=3,y-=3,s=9,e.Le="invalid block type",t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t)}break;case 1:for(;32>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if((~f>>>16&65535)!=(65535&f))return s=9,e.Le="invalid stored block lengths",t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);o=65535&f,f=y=0,s=0!==o?2:0!==h?7:0;break;case 2:if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);if(0===k&&(g==n.end&&0!==n.read&&(g=0,k=g<n.read?n.read-g-1:n.end-g),0===k&&(n.write=g,t=n.wt(e,t),g=n.write,k=g<n.read?n.read-g-1:n.end-g,g==n.end&&0!==n.read&&(g=0,k=g<n.read?n.read-g-1:n.end-g),0===k)))return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);if(t=0,i=o,i>b&&(i=b),i>k&&(i=k),n.lt.set(e.je(m,i),g),m+=i,b-=i,g+=i,k-=i,0!==(o-=i))break;s=0!==h?7:0;break;case 3:for(;14>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if(c=i=16383&f,(31&i)>29||(i>>5&31)>29)return s=9,e.Le="too many length or distance symbols",t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);if(i=258+(31&i)+(i>>5&31),!r||r.length<i)r=[];else for(v=0;i>v;v++)r[v]=0;f>>>=14,y-=14,a=0,s=4;case 4:for(;4+(c>>>10)>a;){for(;3>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}r[dt[a++]]=7&f,f>>>=3,y-=3}for(;19>a;)r[dt[a++]]=0;if(l[0]=7,i=p.st(r,l,u,d,e),0!=i)return(t=i)==rt&&(r=null,s=9),n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);a=0,s=5;case 5:for(;i=c,258+(31&i)+(i>>5&31)>a;){let o,w;for(i=l[0];i>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if(i=d[3*(u[0]+(f&it[i]))+1],w=d[3*(u[0]+(f&it[i]))+2],16>w)f>>>=i,y-=i,r[a++]=w;else{for(v=18==w?7:w-14,o=18==w?11:3;i+v>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if(f>>>=i,y-=i,o+=f&it[v],f>>>=v,y-=v,v=a,i=c,v+o>258+(31&i)+(i>>5&31)||16==w&&1>v)return r=null,s=9,e.Le="invalid bit length repeat",t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);w=16==w?r[v-1]:0;do{r[v++]=w}while(0!==--o);a=v}}if(u[0]=-1,A=[],I=[],_=[],P=[],A[0]=9,I[0]=6,i=c,i=p.it(257+(31&i),1+(i>>5&31),r,A,I,_,P,d,e),0!=i)return i==rt&&(r=null,s=9),t=i,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);w.init(A[0],I[0],d,_[0],d,P[0]),s=6;case 6:if(n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,1!=(t=w.ut(n,e,t)))return n.wt(e,t);if(t=0,w.ht(e),m=e.nt,b=e.We,f=n.ot,y=n.ct,g=n.write,k=g<n.read?n.read-g-1:n.end-g,0===h){s=0;break}s=7;case 7:if(n.write=g,t=n.wt(e,t),g=n.write,k=g<n.read?n.read-g-1:n.end-g,n.read!=n.write)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);s=8;case 8:return t=1,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);case 9:return t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);default:return t=nt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t)}}},n.ht=e=>{n.reset(e,null),n.lt=null,d=null},n.yt=(e,t,r)=>{n.lt.set(e.subarray(t,t+r),0),n.read=n.write=r},n.bt=()=>1==s?1:0}const yt=13,mt=[0,0,255,255];function bt(){const e=this;function t(e){return e&&e.gt?(e.qe=e.Ge=0,e.Le=null,e.gt.mode=7,e.gt.kt.reset(e,null),0):nt}e.mode=0,e.method=0,e.vt=[0],e.St=0,e.marker=0,e.zt=0,e.Ct=t=>(e.kt&&e.kt.ht(t),e.kt=null,0),e.xt=(n,r)=>(n.Le=null,e.kt=null,8>r||r>15?(e.Ct(n),nt):(e.zt=r,n.gt.kt=new pt(n,1<<r),t(n),0)),e.At=(e,t)=>{let n,r;if(!e||!e.gt||!e.et)return nt;const s=e.gt;for(t=4==t?st:0,n=st;;)switch(s.mode){case 0:if(0===e.We)return n;if(n=t,e.We--,e.qe++,8!=(15&(s.method=e.ft(e.nt++)))){s.mode=yt,e.Le="unknown compression method",s.marker=5;break}if(8+(s.method>>4)>s.zt){s.mode=yt,e.Le="invalid win size",s.marker=5;break}s.mode=1;case 1:if(0===e.We)return n;if(n=t,e.We--,e.qe++,r=255&e.ft(e.nt++),((s.method<<8)+r)%31!=0){s.mode=yt,e.Le="incorrect header check",s.marker=5;break}if(!(32&r)){s.mode=7;break}s.mode=2;case 2:if(0===e.We)return n;n=t,e.We--,e.qe++,s.St=(255&e.ft(e.nt++))<<24&4278190080,s.mode=3;case 3:if(0===e.We)return n;n=t,e.We--,e.qe++,s.St+=(255&e.ft(e.nt++))<<16&16711680,s.mode=4;case 4:if(0===e.We)return n;n=t,e.We--,e.qe++,s.St+=(255&e.ft(e.nt++))<<8&65280,s.mode=5;case 5:return 0===e.We?n:(n=t,e.We--,e.qe++,s.St+=255&e.ft(e.nt++),s.mode=6,2);case 6:return s.mode=yt,e.Le="need dictionary",s.marker=0,nt;case 7:if(n=s.kt.ut(e,n),n==rt){s.mode=yt,s.marker=0;break}if(0==n&&(n=t),1!=n)return n;n=t,s.kt.reset(e,s.vt),s.mode=12;case 12:return e.We=0,1;case yt:return rt;default:return nt}},e.It=(e,t,n)=>{let r=0,s=n;if(!e||!e.gt||6!=e.gt.mode)return nt;const i=e.gt;return s<1<<i.zt||(s=(1<<i.zt)-1,r=n-s),i.kt.yt(t,r,s),i.mode=7,0},e._t=e=>{let n,r,s,i,o;if(!e||!e.gt)return nt;const c=e.gt;if(c.mode!=yt&&(c.mode=yt,c.marker=0),0===(n=e.We))return st;for(r=e.nt,s=c.marker;0!==n&&4>s;)e.ft(r)==mt[s]?s++:s=0!==e.ft(r)?0:4-s,r++,n--;return e.qe+=r-e.nt,e.nt=r,e.We=n,c.marker=s,4!=s?rt:(i=e.qe,o=e.Ge,t(e),e.qe=i,e.Ge=o,c.mode=7,0)},e.Pt=e=>e&&e.gt&&e.gt.kt?e.gt.kt.bt():nt}function gt(){}function kt(e){const t=new gt,n=e&&e.chunkSize?r.floor(2*e.chunkSize):131072,o=new i(n);let c=!1;t.xt(),t.$e=o,this.append=(e,r)=>{const f=[];let a,l,u=0,w=0,h=0;if(0!==e.length){t.nt=0,t.et=e,t.We=e.length;do{if(t.rt=0,t.tt=n,0!==t.We||c||(t.nt=0,c=!0),a=t.At(0),c&&a===st){if(0!==t.We)throw new s("inflating: bad input")}else if(0!==a&&1!==a)throw new s("inflating: "+t.Le);if((c||1===a)&&t.We===e.length)throw new s("inflating: bad input");t.rt&&(t.rt===n?f.push(new i(o)):f.push(o.subarray(0,t.rt))),h+=t.rt,r&&t.nt>0&&t.nt!=u&&(r(t.nt),u=t.nt)}while(t.We>0||0===t.tt);return f.length>1?(l=new i(h),f.forEach(e=>{l.set(e,w),w+=e.length})):l=f[0]?new i(f[0]):new i,l}},this.flush=()=>{t.Ct()}}gt.prototype={xt(e){const t=this;return t.gt=new bt,e||(e=15),t.gt.xt(t,e)},At(e){const t=this;return t.gt?t.gt.At(t,e):nt},Ct(){const e=this;if(!e.gt)return nt;const t=e.gt.Ct(e);return e.gt=null,t},_t(){const e=this;return e.gt?e.gt._t(e):nt},It(e,t){const n=this;return n.gt?n.gt.It(n,e,t):nt},ft(e){return this.et[e]},je(e,t){return this.et.subarray(e,e+t)}},self.initCodec=()=>{self.Deflate=tt,self.Inflate=kt};
`,r=()=>e.useDataURI?"data:text/javascript,"+encodeURIComponent(n):URL.createObjectURL(new Blob([n],{type:"text/javascript"}));t({workerScripts:{inflate:[r],deflate:[r]}})}var TC="Writer iterator completed too soon";var T4="Content-Type";var R4=64*1024,RC="writable",nu=class{constructor(){this.size=0}init(){this.initialized=!0}},bc=class extends nu{get readable(){let e=this,{chunkSize:n=R4}=e,r=new ReadableStream({start(){this.chunkOffset=0},async pull(s){let{offset:a=0,size:c,diskNumberStart:l}=r,{chunkOffset:d}=this,f=c===Je?n:Math.min(n,c-d),p=await fr(e,a+d,f,l);s.enqueue(p),d+n>c||c===Je&&!p.length&&f?s.close():this.chunkOffset+=n}});return r}};var Lo=class extends bc{constructor(e){super(),Object.assign(this,{blob:e,size:e.size})}async readUint8Array(e,n){let r=this,s=e+n,c=await(e||s<r.size?r.blob.slice(e,s):r.blob).arrayBuffer();return c.byteLength>n&&(c=c.slice(e,s)),new Uint8Array(c)}},xc=class extends nu{constructor(e){super();let n=this,r=new TransformStream,s=[];e&&s.push([T4,e]),Object.defineProperty(n,RC,{get(){return r.writable}}),n.blob=new Response(r.readable,{headers:s}).blob()}getData(){return this.blob}};var Gf=class extends bc{constructor(e){super(),this.readers=e}async init(){let e=this,{readers:n}=e;e.lastDiskNumber=0,e.lastDiskOffset=0,await Promise.all(n.map(async(r,s)=>{await r.init(),s!=n.length-1&&(e.lastDiskOffset+=r.size),e.size+=r.size})),super.init()}async readUint8Array(e,n,r=0){let s=this,{readers:a}=this,c,l=r;l==-1&&(l=a.length-1);let d=e;for(;a[l]&&d>=a[l].size;)d-=a[l].size,l++;let f=a[l];if(f){let p=f.size;if(d+n<=p)c=await fr(f,d,n);else{let m=p-d;c=new Uint8Array(n);let g=await fr(f,d,m);c.set(g,0);let w=await s.readUint8Array(e+m,n-m,r);c.set(w,m),g.length+w.length<n&&(c=c.subarray(0,g.length+w.length))}}else c=new Uint8Array;return s.lastDiskNumber=Math.max(l,s.lastDiskNumber),c}},ru=class extends nu{constructor(e,n=4294967295){super();let r=this;Object.assign(r,{diskNumber:0,diskOffset:0,size:0,maxSize:n,availableSize:n});let s,a,c,l=new WritableStream({async write(p){let{availableSize:m}=r;if(c)p.length>=m?(await d(p.subarray(0,m)),await f(),r.diskOffset+=s.size,r.diskNumber++,c=null,await this.write(p.subarray(m))):await d(p);else{let{value:g,done:w}=await e.next();if(w&&!g)throw new Error(TC);s=g,s.size=0,s.maxSize&&(r.maxSize=s.maxSize),r.availableSize=r.maxSize,await _s(s),a=g.writable,c=a.getWriter(),await this.write(p)}},async close(){await c.ready,await f()}});Object.defineProperty(r,RC,{get(){return l}});async function d(p){let m=p.length;m&&(await c.ready,await c.write(p),s.size+=m,r.size+=m,r.availableSize-=m)}async function f(){await c.close()}}},Ea=class{constructor(e){return Array.isArray(e)&&(e=new Gf(e)),e instanceof ReadableStream&&(e={readable:e}),e}},Tc=class{constructor(e){return e.writable===Je&&typeof e.next==Os&&(e=new ru(e)),e instanceof WritableStream&&(e={writable:e}),e.size===Je&&(e.size=0),e instanceof ru||Object.assign(e,{diskNumber:0,diskOffset:0,availableSize:1/0,maxSize:1/0}),e}};async function _s(t,e){if(t.init&&!t.initialized)await t.init(e);else return Promise.resolve()}function fr(t,e,n,r){return t.readUint8Array(e,n,r)}var EC="\0\u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\xB6\xA7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xC7\xFC\xE9\xE2\xE4\xE0\xE5\xE7\xEA\xEB\xE8\xEF\xEE\xEC\xC4\xC5\xC9\xE6\xC6\xF4\xF6\xF2\xFB\xF9\xFF\xD6\xDC\xA2\xA3\xA5\u20A7\u0192\xE1\xED\xF3\xFA\xF1\xD1\xAA\xBA\xBF\u2310\xAC\xBD\xBC\xA1\xAB\xBB\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255D\u255C\u255B\u2510\u2514\u2534\u252C\u251C\u2500\u253C\u255E\u255F\u255A\u2554\u2569\u2566\u2560\u2550\u256C\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256B\u256A\u2518\u250C\u2588\u2584\u258C\u2590\u2580\u03B1\xDF\u0393\u03C0\u03A3\u03C3\xB5\u03C4\u03A6\u0398\u03A9\u03B4\u221E\u03C6\u03B5\u2229\u2261\xB1\u2265\u2264\u2320\u2321\xF7\u2248\xB0\u2219\xB7\u221A\u207F\xB2\u25A0 ".split(""),E4=EC.length==256;function SC(t){if(E4){let e="";for(let n=0;n<t.length;n++)e+=EC[t[n]];return e}else return new TextDecoder().decode(t)}function iu(t,e){return e&&e.trim().toLowerCase()=="cp437"?SC(t):new TextDecoder(e).decode(t)}var M_="filename",q_="rawFilename",su="comment",L_="rawComment",ou="uncompressedSize",U_="compressedSize",W_="offset",zf="diskNumberStart",Rc="lastModDate",Kf="rawLastModDate",au="lastAccessDate",CC="rawLastAccessDate",cu="creationDate",kC="rawCreationDate",H_="internalFileAttribute",j_="internalFileAttributes",X_="externalFileAttribute",B_="externalFileAttributes",G_="msDosCompatible",Zf="zip64",z_="encrypted",K_="version",Z_="versionMadeBy",V_="zipCrypto",lu="directory",Y_="executable",J_="compressionMethod",Q_="signature",ev="extraField",S4=[M_,q_,U_,ou,Rc,Kf,su,L_,au,cu,W_,zf,zf,H_,j_,X_,B_,G_,Zf,z_,K_,Z_,V_,lu,Y_,J_,Q_,ev,"bitFlag","filenameUTF8","commentUTF8","rawExtraField","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","extraFieldNTFS","extraFieldExtendedTimestamp"],io=class{constructor(e){S4.forEach(n=>this[n]=e[n])}};var PC="filenameEncoding",AC="commentEncoding",DC="decodeText",IC="extractPrependedData",$C="extractAppendedData",Vf="password",Yf="rawPassword",Jf="passThrough",Qf="signal",OC="checkPasswordOnly",FC="checkOverlappingEntryOnly",NC="checkOverlappingEntry",MC="checkSignature",ep="useWebWorkers",tp="useCompressionStream",qC="transferStreams",np="preventClose",LC="encryptionStrength",UC="extendedTimestamp",WC="keepOrder",HC="level",jC="bufferedWrite",XC="dataDescriptorSignature",BC="useUnicodeFileNames",GC="dataDescriptor",tv="supportZip64SplitFile",zC="encodeText",nv="offset",rv="usdz";var rp="File format is not recognized",YC="End of central directory not found",JC="End of Zip64 central directory locator not found",QC="Central directory header not found",ek="Local file header not found",tk="Zip64 extra field not found",nk="File contains encrypted entry",rk="Encryption method not supported",sv="Compression method not supported",ov="Split zip file",ik="Overlapping entry found",KC="utf-8",ZC="cp437",D4=[[ou,4294967295],[U_,4294967295],[W_,4294967295],[zf,65535]],I4={65535:{getValue:vn,bytes:4},4294967295:{getValue:Sc,bytes:8}},kc=class{constructor(e,n={}){Object.assign(this,{reader:new Ea(e),options:n,config:Kl(),readRanges:[]})}async*getEntriesGenerator(e={}){let n=this,{reader:r}=n,{config:s}=n;if(await _s(r),(r.size===Je||!r.readUint8Array)&&(r=new Lo(await new Response(r.readable).blob()),await _s(r)),r.size<22)throw new Error(rp);r.chunkSize=Df(s);let a=await q4(r,101010256,r.size,22,65535*16);if(!a){let Y=await fr(r,0,4),D=Sn(Y);throw vn(D)==134695760?new Error(ov):new Error(YC)}let c=Sn(a),l=vn(c,12),d=vn(c,16),f=a.offset,p=pr(c,20),m=f+22+p,g=pr(c,4),w=r.lastDiskNumber||0,v=pr(c,6),x=pr(c,8),b=0,S=0;if(d==4294967295||l==4294967295||x==65535||v==65535){let Y=await fr(r,a.offset-20,20),D=Sn(Y);if(vn(D,0)==117853008){d=Sc(D,8);let j=await fr(r,d,56,-1),ae=Sn(j),me=a.offset-20-56;if(vn(ae,0)!=101075792&&d!=me){let ue=d;d=me,d>ue&&(b=d-ue),j=await fr(r,d,56,-1),ae=Sn(j)}if(vn(ae,0)!=101075792)throw new Error(JC);g==65535&&(g=vn(ae,16)),v==65535&&(v=vn(ae,20)),x==65535&&(x=Sc(ae,32)),l==4294967295&&(l=Sc(ae,40)),d-=l}}if(d>=r.size&&(b=r.size-d-l-22,d=r.size-l-22),w!=g)throw new Error(ov);if(d<0)throw new Error(rp);let k=0,$=await fr(r,d,l,v),F=Sn($);if(l){let Y=a.offset-l;if(vn(F,k)!=33639248&&d!=Y){let D=d;d=Y,d>D&&(b+=d-D),$=await fr(r,d,l,v),F=Sn($)}}let L=a.offset-d-(r.lastDiskOffset||0);if(l!=L&&L>=0&&(l=L,$=await fr(r,d,l,v),F=Sn($)),d<0||d>=r.size)throw new Error(rp);let H=xr(n,e,PC),N=xr(n,e,AC);for(let Y=0;Y<x;Y++){let D=new av(r,s,n.options);if(vn(F,k)!=33639248)throw new Error(QC);sk(D,F,k+6);let j=!!D.bitFlag.languageEncodingFlag,ae=k+46,me=ae+D.filenameLength,ue=me+D.extraFieldLength,_e=pr(F,k+4),ke=_e>>8==0,De=_e>>8==3,Ie=$.subarray(ae,me),Ce=pr(F,k+32),Ge=ue+Ce,Re=$.subarray(ue,Ge),Oe=j,mt=j,ze=vn(F,k+38),Xe=ke&&(Ec(F,k+38)&16)==16||De&&(ze>>16&61440)==16384||Ie.length&&Ie[Ie.length-1]=="/".charCodeAt(0),tt=De&&(ze>>16&73)!=0,We=vn(F,k+42)+b;Object.assign(D,{versionMadeBy:_e,msDosCompatible:ke,compressedSize:0,uncompressedSize:0,commentLength:Ce,directory:Xe,offset:We,diskNumberStart:pr(F,k+34),internalFileAttributes:pr(F,k+36),externalFileAttributes:ze,rawFilename:Ie,filenameUTF8:Oe,commentUTF8:mt,rawExtraField:$.subarray(me,ue),executable:tt}),D.internalFileAttribute=D.internalFileAttributes,D.externalFileAttribute=D.externalFileAttributes;let rn=xr(n,e,DC)||iu,sn=Oe?KC:H||ZC,Bn=mt?KC:N||ZC,Ye=rn(Ie,sn);Ye===Je&&(Ye=iu(Ie,sn));let Yt=rn(Re,Bn);Yt===Je&&(Yt=iu(Re,Bn)),Object.assign(D,{rawComment:Re,filename:Ye,comment:Yt,directory:Xe||Ye.endsWith("/")}),S=Math.max(We,S),ok(D,D,F,k+6),D.zipCrypto=D.encrypted&&!D.extraFieldAES;let ln=new io(D);ln.getData=(Nt,tn)=>D.getData(Nt,ln,n.readRanges,tn),ln.arrayBuffer=async Nt=>{let tn=new TransformStream,[Jt]=await Promise.all([new Response(tn.readable).arrayBuffer(),D.getData(tn,ln,n.readRanges,Nt)]);return Jt},k=Ge;let{onprogress:rt}=e;if(rt)try{await rt(Y+1,x,new io(D))}catch{}yield ln}let X=xr(n,e,IC),V=xr(n,e,$C);return X&&(n.prependedData=S>0?await fr(r,0,S):new Uint8Array),n.comment=p?await fr(r,f+22,p):new Uint8Array,V&&(n.appendedData=m<r.size?await fr(r,m,r.size-m):new Uint8Array),!0}async getEntries(e={}){let n=[];for await(let r of this.getEntriesGenerator(e))n.push(r);return n}async close(){}};var av=class{constructor(e,n,r){Object.assign(this,{reader:e,config:n,options:r})}async getData(e,n,r,s={}){let a=this,{reader:c,offset:l,diskNumberStart:d,extraFieldAES:f,extraFieldZip64:p,compressionMethod:m,config:g,bitFlag:w,signature:v,rawLastModDate:x,uncompressedSize:b,compressedSize:S}=a,{dataDescriptor:k}=w,$=n.localDirectory={},F=await fr(c,l,30,d),L=Sn(F),H=xr(a,s,Vf),N=xr(a,s,Yf),X=xr(a,s,Jf);if(H=H&&H.length&&H,N=N&&N.length&&N,f&&f.originalCompressionMethod!=99)throw new Error(sv);if(m!=0&&m!=8&&!X)throw new Error(sv);if(vn(L,0)!=67324752)throw new Error(ek);sk($,L,4);let{extraFieldLength:V,filenameLength:Y,lastAccessDate:D,creationDate:j}=$;$.rawExtraField=V?await fr(c,l+30+Y,V,d):new Uint8Array,ok(a,$,L,4,!0),Object.assign(n,{lastAccessDate:D,creationDate:j});let ae=a.encrypted&&$.encrypted&&!X,me=ae&&!f;if(X||(n.zipCrypto=me),ae){if(!me&&f.strength===Je)throw new Error(rk);if(!H&&!N)throw new Error(nk)}let ue=l+30+Y+V,_e=S,ke=c.readable;Object.assign(ke,{diskNumberStart:d,offset:ue,size:_e});let De=xr(a,s,Qf),Ie=xr(a,s,OC),Ce=xr(a,s,NC),Ge=xr(a,s,FC);Ge&&(Ce=!0);let{onstart:Re,onprogress:Oe,onend:mt}=s,ze={options:{codecType:jf,password:H,rawPassword:N,zipCrypto:me,encryptionStrength:f&&f.strength,signed:xr(a,s,MC)&&!X,passwordVerification:me&&(k?x>>>8&255:v>>>24&255),outputSize:b,signature:v,compressed:m!=0&&!X,encrypted:a.encrypted&&!X,useWebWorkers:xr(a,s,ep),useCompressionStream:xr(a,s,tp),transferStreams:xr(a,s,qC),checkPasswordOnly:Ie},config:g,streamOptions:{signal:De,size:_e,onstart:Re,onprogress:Oe,onend:mt}};Ce&&await M4({reader:c,fileEntry:n,offset:l,diskNumberStart:d,signature:v,compressedSize:S,uncompressedSize:b,dataOffset:ue,dataDescriptor:k||$.bitFlag.dataDescriptor,extraFieldZip64:p||$.extraFieldZip64,readRanges:r});let Xe;try{if(!Ge){Ie&&(e=new WritableStream),e=new Tc(e),await _s(e,X?S:b),{writable:Xe}=e;let{outputSize:tt}=await Bf({readable:ke,writable:Xe},ze);if(e.size+=tt,tt!=(X?S:b))throw new Error(yc)}}catch(tt){if(tt.outputSize!==Je&&(e.size+=tt.outputSize),!Ie||tt.message!=no)throw tt}finally{!xr(a,s,np)&&Xe&&!Xe.locked&&await Xe.getWriter().close()}return Ie||Ge?Je:e.getData?e.getData():Xe}};function sk(t,e,n){let r=t.rawBitFlag=pr(e,n+2),s=(r&1)==1,a=vn(e,n+6);Object.assign(t,{encrypted:s,version:pr(e,n),bitFlag:{level:(r&6)>>1,dataDescriptor:(r&8)==8,languageEncodingFlag:(r&2048)==2048},rawLastModDate:a,lastModDate:L4(a),filenameLength:pr(e,n+22),extraFieldLength:pr(e,n+24)})}function ok(t,e,n,r,s){let{rawExtraField:a}=e,c=e.extraField=new Map,l=Sn(new Uint8Array(a)),d=0;try{for(;d<a.length;){let S=pr(l,d),k=pr(l,d+2);c.set(S,{type:S,data:a.slice(d+4,d+4+k)}),d+=4+k}}catch{}let f=pr(n,r+4);Object.assign(e,{signature:vn(n,r+10),compressedSize:vn(n,r+14),uncompressedSize:vn(n,r+18)});let p=c.get(1);p&&($4(p,e),e.extraFieldZip64=p);let m=c.get(28789);m&&(VC(m,M_,q_,e,t),e.extraFieldUnicodePath=m);let g=c.get(25461);g&&(VC(g,su,L_,e,t),e.extraFieldUnicodeComment=g);let w=c.get(39169);w?(O4(w,e,f),e.extraFieldAES=w):e.compressionMethod=f;let v=c.get(10);v&&(F4(v,e),e.extraFieldNTFS=v);let x=c.get(21589);x&&(N4(x,e,s),e.extraFieldExtendedTimestamp=x);let b=c.get(6534);b&&(e.extraFieldUSDZ=b)}function $4(t,e){e.zip64=!0;let n=Sn(t.data),r=D4.filter(([s,a])=>e[s]==a);for(let s=0,a=0;s<r.length;s++){let[c,l]=r[s];if(e[c]==l){let d=I4[l];e[c]=t[c]=d.getValue(n,a),a+=d.bytes}else if(t[c])throw new Error(tk)}}function VC(t,e,n,r,s){let a=Sn(t.data),c=new to;c.append(s[n]);let l=Sn(new Uint8Array(4));l.setUint32(0,c.get(),!0);let d=vn(a,1);Object.assign(t,{version:Ec(a,0),[e]:iu(t.data.subarray(5)),valid:!s.bitFlag.languageEncodingFlag&&d==vn(l,0)}),t.valid&&(r[e]=t[e],r[e+"UTF8"]=!0)}function O4(t,e,n){let r=Sn(t.data),s=Ec(r,4);Object.assign(t,{vendorVersion:Ec(r,0),vendorId:Ec(r,2),strength:s,originalCompressionMethod:n,compressionMethod:pr(r,5)}),e.compressionMethod=t.compressionMethod}function F4(t,e){let n=Sn(t.data),r=4,s;try{for(;r<t.data.length&&!s;){let a=pr(n,r),c=pr(n,r+2);a==1&&(s=t.data.slice(r+4,r+4+c)),r+=4+c}}catch{}try{if(s&&s.length==24){let a=Sn(s),c=a.getBigUint64(0,!0),l=a.getBigUint64(8,!0),d=a.getBigUint64(16,!0);Object.assign(t,{rawLastModDate:c,rawLastAccessDate:l,rawCreationDate:d});let f=iv(c),p=iv(l),m=iv(d),g={lastModDate:f,lastAccessDate:p,creationDate:m};Object.assign(t,g),Object.assign(e,g)}}catch{}}function N4(t,e,n){let r=Sn(t.data),s=Ec(r,0),a=[],c=[];n?((s&1)==1&&(a.push(Rc),c.push(Kf)),(s&2)==2&&(a.push(au),c.push(CC)),(s&4)==4&&(a.push(cu),c.push(kC))):t.data.length>=5&&(a.push(Rc),c.push(Kf));let l=1;a.forEach((d,f)=>{if(t.data.length>=l+4){let p=vn(r,l);e[d]=t[d]=new Date(p*1e3);let m=c[f];t[m]=p}l+=4})}async function M4({reader:t,fileEntry:e,offset:n,diskNumberStart:r,signature:s,compressedSize:a,uncompressedSize:c,dataOffset:l,dataDescriptor:d,extraFieldZip64:f,readRanges:p}){let m=0;if(r)for(let v=0;v<r;v++){let x=t.readers[v];m+=x.size}let g=0;if(d&&(f?g=20:g=12),g){let v=await fr(t,l+a,g+4,r);if(vn(Sn(v),0)==134695760){let b=vn(Sn(v),4),S,k;f?(S=Sc(Sn(v),8),k=Sc(Sn(v),16)):(S=vn(Sn(v),8),k=vn(Sn(v),12)),(e.encrypted&&!e.zipCrypto||b==s)&&S==a&&k==c&&(g+=4)}}let w={start:m+n,end:m+l+a+g,fileEntry:e};for(let v of p)if(v.fileEntry!=e&&w.start>=v.start&&w.start<v.end){let x=new Error(ik);throw x.overlappingEntry=v.fileEntry,x}p.push(w)}async function q4(t,e,n,r,s){let a=new Uint8Array(4),c=Sn(a);U4(c,0,e);let l=r+s;return await d(r)||await d(Math.min(l,n));async function d(f){let p=n-f,m=await fr(t,p,f);for(let g=m.length-r;g>=0;g--)if(m[g]==a[0]&&m[g+1]==a[1]&&m[g+2]==a[2]&&m[g+3]==a[3])return{offset:p+g,buffer:m.slice(g,g+r).buffer}}}function xr(t,e,n){return e[n]===Je?t.options[n]:e[n]}function L4(t){let e=(t&4294901760)>>16,n=t&65535;try{return new Date(1980+((e&65024)>>9),((e&480)>>5)-1,e&31,(n&63488)>>11,(n&2016)>>5,(n&31)*2,0)}catch{}}function iv(t){return new Date(Number(t/BigInt(1e4)-BigInt(116444736e5)))}function Ec(t,e){return t.getUint8(e)}function pr(t,e){return t.getUint16(e,!0)}function vn(t,e){return t.getUint32(e,!0)}function Sc(t,e){return Number(t.getBigUint64(e,!0))}function U4(t,e,n){t.setUint32(e,n,!0)}function Sn(t){return new DataView(t.buffer)}var pk="File already exists",hk="Zip file comment exceeds 64KB",mk="File entry comment exceeds 64KB",gk="File entry name exceeds 64KB",Sv="Version exceeds 65535",_k="The strength must equal 1, 2, or 3",vk="Extra field type exceeds 65535",yk="Extra field data exceeds 64KB",hp="Zip64 is not supported (make sure 'keepOrder' is set to 'true')",wk="Undefined uncompressed size",bk="Zip file not empty",lk=new Uint8Array([7,0,2,0,65,69,3,0,0]),Rv=0,uk=[],Pc=class{constructor(e,n={}){e=new Tc(e);let r=e.availableSize!==Je&&e.availableSize>0&&e.availableSize!==1/0&&e.maxSize!==Je&&e.maxSize>0&&e.maxSize!==1/0;Object.assign(this,{writer:e,addSplitZipSignature:r,options:n,config:Kl(),files:new Map,filenames:new Set,offset:n[nv]===Je?e.size||e.writable.size||0:n[nv],pendingEntriesSize:0,pendingAddFileCalls:new Set,bufferedWrites:0})}async prependZip(e){if(this.filenames.size)throw new Error(bk);e=new Ea(e);let n=new kc(e.readable),r=await n.getEntries();await n.close(),await e.readable.pipeTo(this.writer.writable,{preventClose:!0,preventAbort:!0}),this.writer.size=this.offset=e.size,this.filenames=new Set(r.map(s=>s.filename)),this.files=new Map(r.map(s=>{let{version:a,compressionMethod:c,lastModDate:l,lastAccessDate:d,creationDate:f,rawFilename:p,bitFlag:m,encrypted:g,uncompressedSize:w,compressedSize:v,diskOffset:x,diskNumber:b,zip64:S}=s,{rawExtraFieldZip64:k,rawExtraFieldAES:$,rawExtraFieldExtendedTimestamp:F,rawExtraFieldNTFS:L,rawExtraField:H}=s,{level:N,languageEncodingFlag:X,dataDescriptor:V}=m;k=k||new Uint8Array,$=$||new Uint8Array,F=F||new Uint8Array,L=L||new Uint8Array,H=H||new Uint8Array;let Y=Et(k,$,F,L,H),D=S&&w>4294967295,j=S&&v>4294967295,{headerArray:ae,headerView:me}=xk({version:a,bitFlag:Tk(N,X,V,g,c),compressionMethod:c,uncompressedSize:w,compressedSize:v,lastModDate:l,rawFilename:p,zip64CompressedSize:j,zip64UncompressedSize:D,extraFieldLength:Y});return Object.assign(s,{zip64UncompressedSize:D,zip64CompressedSize:j,zip64Offset:S&&this.offset-x>4294967295,zip64DiskNumberStart:S&&b>65535,rawExtraFieldZip64:k,rawExtraFieldAES:$,rawExtraFieldExtendedTimestamp:F,rawExtraFieldNTFS:L,rawExtraField:H,extendedTimestamp:F.length>0||L.length>0,extraFieldExtendedTimestampFlag:1+(d?2:0)+(f?4:0),headerArray:ae,headerView:me}),[s.filename,s]}))}async add(e="",n,r={}){let s=this,{pendingAddFileCalls:a,config:c}=s;Rv<c.maxWorkers?Rv++:await new Promise(d=>uk.push(d));let l;try{if(e=e.trim(),s.filenames.has(e))throw new Error(pk);return s.filenames.add(e),l=z4(s,e,n,r),a.add(l),await l}catch(d){throw s.filenames.delete(e),d}finally{a.delete(l);let d=uk.shift();d?d():Rv--}}remove(e){let{filenames:n,files:r}=this;if(typeof e=="string"&&(e=r.get(e)),e&&e.filename!==Je){let{filename:s}=e;if(n.has(s)&&r.has(s))return n.delete(s),r.delete(s),!0}return!1}async close(e=new Uint8Array,n={}){let r=this,{pendingAddFileCalls:s,writer:a}=this,{writable:c}=a;for(;s.size;)await Promise.allSettled(Array.from(s));return await t6(this,e,n),It(r,n,np)||await c.getWriter().close(),a.getData?a.getData():c}};async function z4(t,e,n,r){e=e.trim();let s=It(t,r,G_),a=It(t,r,Z_,s?20:768),c=It(t,r,Y_);if(a>65535)throw new Error(Sv);let l=It(t,r,B_,0);l===0&&(l=It(t,r,X_,0)),!r[lu]&&e.endsWith("/")&&(r[lu]=!0),It(t,r,lu)?(e.endsWith("/")||(e+="/"),l===0&&(l=16,s||(l|=16877<<16))):!s&&l===0&&(c?l=493<<16:l=420<<16);let f=It(t,r,zC,gc),p=f(e);if(p===Je&&(p=gc(e)),Et(p)>65535)throw new Error(gk);let m=r[su]||"",g=f(m);if(g===Je&&(g=gc(m)),Et(g)>65535)throw new Error(mk);let w=It(t,r,K_,20);if(w>65535)throw new Error(Sv);let v=It(t,r,Rc,new Date),x=It(t,r,au),b=It(t,r,cu),S=It(t,r,j_,0);S===0&&(S=It(t,r,H_,0));let k=It(t,r,Jf),$,F;k||($=It(t,r,Vf),F=It(t,r,Yf));let L=It(t,r,LC,3),H=It(t,r,V_),N=It(t,r,UC,!0),X=It(t,r,WC,!0),V=It(t,r,HC),Y=It(t,r,ep),D=It(t,r,jC),j=It(t,r,XC,!1),ae=It(t,r,Qf),me=It(t,r,BC,!0),ue=It(t,r,tp),_e=It(t,r,J_),ke=It(t,r,GC);D&&ke===Je&&(ke=!1),(ke===Je||H)&&(ke=!0);let De=It(t,r,Zf);if(!H&&($!==Je||F!==Je)&&!(L>=1&&L<=3))throw new Error(_k);let Ie=new Uint8Array,Ce=r[ev];if(Ce){let Jt=0,st=0;Ce.forEach(At=>Jt+=4+Et(At)),Ie=new Uint8Array(Jt),Ce.forEach((At,St)=>{if(St>65535)throw new Error(vk);if(Et(At)>65535)throw new Error(yk);Kn(Ie,new Uint16Array([St]),st),Kn(Ie,new Uint16Array([Et(At)]),st+2),Kn(Ie,At,st+4),st+=4+Et(At)})}let Ge=0,Re=0,Oe=0;if(k&&(Oe=r[ou],Oe===Je))throw new Error(wk);let mt=De===!0;n&&(n=new Ea(n),await _s(n),k?(r.uncompressedSize=Oe,Ge=fk(Oe)):n.size===Je?(ke=!0,(De||De===Je)&&(De=!0,Oe=Ge=4294967296)):(r.uncompressedSize=Oe=n.size,Ge=fk(Oe)));let{diskOffset:ze,diskNumber:Xe,maxSize:tt}=t.writer,We=mt||Oe>4294967295,rn=mt||Ge>4294967295,sn=mt||t.offset+t.pendingEntriesSize-ze>4294967295,Ye=It(t,r,tv,!0)&&mt||Xe+Math.ceil(t.pendingEntriesSize/tt)>65535;if(sn||We||rn||Ye){if(De===!1||!X)throw new Error(hp);De=!0}De=De||!1;let Yt=It(t,r,z_);r=Object.assign({},r,{rawFilename:p,rawComment:g,version:w,versionMadeBy:a,lastModDate:v,lastAccessDate:x,creationDate:b,rawExtraField:Ie,zip64:De,zip64UncompressedSize:We,zip64CompressedSize:rn,zip64Offset:sn,zip64DiskNumberStart:Ye,password:$,rawPassword:F,level:!ue&&t.config.CompressionStream===Je&&t.config.CompressionStreamNative===Je?0:V,useWebWorkers:Y,encryptionStrength:L,extendedTimestamp:N,zipCrypto:H,bufferedWrite:D,keepOrder:X,useUnicodeFileNames:me,dataDescriptor:ke,dataDescriptorSignature:j,signal:ae,msDosCompatible:s,internalFileAttribute:S,internalFileAttributes:S,externalFileAttribute:l,externalFileAttributes:l,useCompressionStream:ue,passThrough:k,encrypted:!!($&&Et($)||F&&Et(F))||k&&Yt,signature:r[Q_],compressionMethod:_e,uncompressedSize:Oe,offset:t.offset-ze,diskNumberStart:Xe});let ln=V4(r),rt=J4(r),Nt=Et(ln.localHeaderArray,rt.dataDescriptorArray);Re=Nt+Ge,t.options[rv]&&(Re+=Re+64),t.pendingEntriesSize+=Re;let tn;try{tn=await K4(t,e,n,{headerInfo:ln,dataDescriptorInfo:rt,metadataSize:Nt},r)}finally{t.pendingEntriesSize-=Re}return Object.assign(tn,{name:e,comment:m,extraField:Ce}),new io(tn)}async function K4(t,e,n,r,s){let{files:a,writer:c}=t,{keepOrder:l,dataDescriptor:d,signal:f}=s,{headerInfo:p}=r,m=t.options[rv],g=Array.from(a.values()).pop(),w={},v,x,b,S,k,$,F;a.set(e,w);try{let X;l&&(X=g&&g.lock,L()),(s.bufferedWrite||t.writerLocked||t.bufferedWrites&&l||!d)&&!m?($=new TransformStream,$.size=0,v=!0,t.bufferedWrites++,await _s(c)):($=c,await H()),await _s($);let{writable:V,diskOffset:Y}=c;if(t.addSplitZipSignature){delete t.addSplitZipSignature;let ue=new Uint8Array(4),_e=Tr(ue);Rt(_e,0,134695760),await so(c,ue),t.offset+=4}m&&Y4(r,t.offset-Y);let{localHeaderView:D,localHeaderArray:j}=p;v||(await X,await N(V));let{diskNumber:ae}=c;k=!0,w.diskNumberStart=ae,v?F=new Response($.readable).blob():await so($,j),w=await Z4(n,$,w,r,t.config,s);let{zip64:me}=w;if(k=!1,a.set(e,w),w.filename=e,v){let[ue]=await Promise.all([F,$.writable.getWriter().close(),X]);await H(),S=!0,w.diskNumberStart=c.diskNumber,w.offset=t.offset-c.diskOffset,me&&dk(w),e6(w,D,s),await N(V),await so(c,j),await ue.stream().pipeTo(V,{preventClose:!0,preventAbort:!0,signal:f}),c.size+=$.size,S=!1}else w.offset=t.offset-Y,me&&dk(w);if(w.offset>4294967295&&!me)throw new Error(hp);return t.offset+=w.size,w}catch(X){if(v&&S||!v&&k){if(t.hasCorruptedEntries=!0,X)try{X.corruptedEntry=!0}catch{}v?t.offset+=$.size:t.offset=$.size}throw a.delete(e),X}finally{v&&t.bufferedWrites--,b&&b(),x&&x()}function L(){w.lock=new Promise(X=>b=X)}async function H(){t.writerLocked=!0;let{lockWriter:X}=t;t.lockWriter=new Promise(V=>x=()=>{t.writerLocked=!1,V()}),await X}async function N(X){Et(p.localHeaderArray)>c.availableSize&&(c.availableSize=0,await so(X,new Uint8Array))}}async function Z4(t,e,{diskNumberStart:n,lock:r},s,a,c){let{headerInfo:l,dataDescriptorInfo:d,metadataSize:f}=s,{headerArray:p,headerView:m,lastModDate:g,rawLastModDate:w,encrypted:v,compressed:x,version:b,compressionMethod:S,rawExtraFieldZip64:k,localExtraFieldZip64Length:$,rawExtraFieldExtendedTimestamp:F,extraFieldExtendedTimestampFlag:L,rawExtraFieldNTFS:H,rawExtraFieldAES:N}=l,{dataDescriptorArray:X}=d,{rawFilename:V,lastAccessDate:Y,creationDate:D,password:j,rawPassword:ae,level:me,zip64:ue,zip64UncompressedSize:_e,zip64CompressedSize:ke,zip64Offset:De,zip64DiskNumberStart:Ie,zipCrypto:Ce,dataDescriptor:Ge,directory:Re,executable:Oe,versionMadeBy:mt,rawComment:ze,rawExtraField:Xe,useWebWorkers:tt,onstart:We,onprogress:rn,onend:sn,signal:Bn,encryptionStrength:Ye,extendedTimestamp:Yt,msDosCompatible:ln,internalFileAttributes:rt,externalFileAttributes:Nt,useCompressionStream:tn,passThrough:Jt}=c,st={lock:r,versionMadeBy:mt,zip64:ue,directory:!!Re,executable:!!Oe,filenameUTF8:!0,rawFilename:V,commentUTF8:!0,rawComment:ze,rawExtraFieldZip64:k,localExtraFieldZip64Length:$,rawExtraFieldExtendedTimestamp:F,rawExtraFieldNTFS:H,rawExtraFieldAES:N,rawExtraField:Xe,extendedTimestamp:Yt,msDosCompatible:ln,internalFileAttributes:rt,externalFileAttributes:Nt,diskNumberStart:n},{signature:At,uncompressedSize:St}=c,xn=0;Jt||(St=0);let{writable:pn}=e;if(t){t.chunkSize=Df(a);let Sr=t.readable,Zn=t.size,Un={options:{codecType:Hf,level:me,rawPassword:ae,password:j,encryptionStrength:Ye,zipCrypto:v&&Ce,passwordVerification:v&&Ce&&w>>8&255,signed:!Jt,compressed:x&&!Jt,encrypted:v&&!Jt,useWebWorkers:tt,useCompressionStream:tn,transferStreams:!1},config:a,streamOptions:{signal:Bn,size:Zn,onstart:We,onprogress:rn,onend:sn}};try{let Gt=await Bf({readable:Sr,writable:pn},Un);xn=Gt.outputSize,e.size+=xn,Jt||(St=Gt.inputSize,At=Gt.signature)}catch(Gt){throw Gt.outputSize!==Je&&(e.size+=Gt.outputSize),Gt}}return Q4({signature:At,compressedSize:xn,uncompressedSize:St,headerInfo:l,dataDescriptorInfo:d},c),Ge&&await so(e,X),Object.assign(st,{uncompressedSize:St,compressedSize:xn,lastModDate:g,rawLastModDate:w,creationDate:D,lastAccessDate:Y,encrypted:v,zipCrypto:Ce,size:f+xn,compressionMethod:S,version:b,headerArray:p,headerView:m,signature:At,extraFieldExtendedTimestampFlag:L,zip64UncompressedSize:_e,zip64CompressedSize:ke,zip64Offset:De,zip64DiskNumberStart:Ie}),st}function V4(t){let{rawFilename:e,lastModDate:n,lastAccessDate:r,creationDate:s,level:a,zip64:c,zipCrypto:l,useUnicodeFileNames:d,dataDescriptor:f,directory:p,rawExtraField:m,encryptionStrength:g,extendedTimestamp:w,passThrough:v,encrypted:x,zip64UncompressedSize:b,zip64CompressedSize:S,zip64Offset:k,zip64DiskNumberStart:$,uncompressedSize:F,offset:L,diskNumberStart:H}=t,{version:N,compressionMethod:X}=t,V=!p&&(a>0||a===Je&&X!==0),Y,D=v||!V,j=c&&(t.bufferedWrite||!b&&!S||D);if(c){let ze=4;b&&(ze+=8),S&&(ze+=8),k&&(ze+=8),$&&(ze+=4),Y=new Uint8Array(ze);let Xe=Tr(Y);if(Mt(Xe,0,1),Mt(Xe,2,Et(Y)-4),j){let tt=Tr(Y),We=4;b&&(tr(tt,We,BigInt(F)),We+=8),S&&D&&(tr(tt,We,BigInt(F)),We+=8),k&&(tr(tt,We,BigInt(L)),We+=8),$&&(Rt(tt,We,H),We+=4)}}else Y=new Uint8Array;let ae;if(x&&!l){ae=new Uint8Array(Et(lk)+2);let ze=Tr(ae);Mt(ze,0,39169),Kn(ae,lk,2),Cv(ze,8,g)}else ae=new Uint8Array;let me,ue,_e;if(w){ue=new Uint8Array(9+(r?4:0)+(s?4:0));let ze=Tr(ue);Mt(ze,0,21589),Mt(ze,2,Et(ue)-4),_e=1+(r?2:0)+(s?4:0),Cv(ze,4,_e);let Xe=5;Rt(ze,Xe,Math.floor(n.getTime()/1e3)),Xe+=4,r&&(Rt(ze,Xe,Math.floor(r.getTime()/1e3)),Xe+=4),s&&Rt(ze,Xe,Math.floor(s.getTime()/1e3));try{me=new Uint8Array(36);let tt=Tr(me),We=Ev(n);Mt(tt,0,10),Mt(tt,2,32),Mt(tt,8,1),Mt(tt,10,24),tr(tt,12,We),tr(tt,20,Ev(r)||We),tr(tt,28,Ev(s)||We)}catch{me=new Uint8Array}}else me=ue=new Uint8Array;X===Je&&(X=V?8:0),c&&(N=N>45?N:45),x&&!l&&(N=N>51?N:51,ae[9]=X,X=99);let ke=j?Et(Y):0,De=ke+Et(ae,ue,me,m),{headerArray:Ie,headerView:Ce,rawLastModDate:Ge}=xk({version:N,bitFlag:Tk(a,d,f,x,X),compressionMethod:X,uncompressedSize:F,lastModDate:n<E_?E_:n>R_?R_:n,rawFilename:e,zip64CompressedSize:S,zip64UncompressedSize:b,extraFieldLength:De}),Re=30,Oe=new Uint8Array(Re+Et(e)+De),mt=Tr(Oe);return Rt(mt,0,67324752),Kn(Oe,Ie,4),Kn(Oe,e,Re),Re+=Et(e),j&&Kn(Oe,Y,Re),Re+=ke,Kn(Oe,ae,Re),Re+=Et(ae),Kn(Oe,ue,Re),Re+=Et(ue),Kn(Oe,me,Re),Re+=Et(me),Kn(Oe,m,Re),f&&(Rt(mt,18,0),Rt(mt,22,0)),{localHeaderArray:Oe,localHeaderView:mt,headerArray:Ie,headerView:Ce,lastModDate:n,rawLastModDate:Ge,encrypted:x,compressed:V,version:N,compressionMethod:X,extraFieldExtendedTimestampFlag:_e,rawExtraFieldZip64:Y,localExtraFieldZip64Length:ke,rawExtraFieldExtendedTimestamp:ue,rawExtraFieldNTFS:me,rawExtraFieldAES:ae,extraFieldLength:De}}function Y4(t,e){let{headerInfo:n}=t,{localHeaderArray:r,extraFieldLength:s}=n,a=Tr(r),c=64-(e+Et(r))%64;c<4&&(c+=64);let l=new Uint8Array(c),d=Tr(l);Mt(d,0,6534),Mt(d,2,c-2);let f=r;n.localHeaderArray=r=new Uint8Array(Et(f)+c),Kn(r,f),Kn(r,l,Et(f)),a=Tr(r),Mt(a,28,s+c),t.metadataSize+=c}function J4({zip64:t,dataDescriptor:e,dataDescriptorSignature:n}){let r=new Uint8Array,s,a=0,c=t?20:12;return n&&(c+=4),e&&(r=new Uint8Array(c),s=Tr(r),n&&(a=4,Rt(s,0,134695760))),{dataDescriptorArray:r,dataDescriptorView:s,dataDescriptorOffset:a}}function Q4({signature:t,compressedSize:e,uncompressedSize:n,headerInfo:r,dataDescriptorInfo:s},{zip64:a,zipCrypto:c,dataDescriptor:l}){let{headerView:d,encrypted:f}=r,{dataDescriptorView:p,dataDescriptorOffset:m}=s;(!f||c)&&t!==Je&&(Rt(d,10,t),l&&Rt(p,m,t)),a?l&&(tr(p,m+4,BigInt(e)),tr(p,m+12,BigInt(n))):(Rt(d,14,e),Rt(d,18,n),l&&(Rt(p,m+4,e),Rt(p,m+8,n)))}function e6({rawFilename:t,encrypted:e,zip64:n,localExtraFieldZip64Length:r,signature:s,compressedSize:a,uncompressedSize:c,offset:l,diskNumberStart:d,zip64UncompressedSize:f,zip64CompressedSize:p,zip64Offset:m,zip64DiskNumberStart:g},w,{dataDescriptor:v}){if(v||(e||Rt(w,14,s),n||(Rt(w,18,a),Rt(w,22,c))),n&&r){let x=30+Et(t)+4;f&&(tr(w,x,BigInt(c)),x+=8),p&&(tr(w,x,BigInt(a)),x+=8),m&&(tr(w,x,BigInt(l)),x+=8),g&&Rt(w,x,d)}}function dk({compressedSize:t,uncompressedSize:e,offset:n,diskNumberStart:r,zip64UncompressedSize:s,zip64CompressedSize:a,zip64Offset:c,zip64DiskNumberStart:l,rawExtraFieldZip64:d}){let f=Tr(d),p=4;s&&(tr(f,p,BigInt(e)),p+=8),a&&(tr(f,p,BigInt(t)),p+=8),c&&(tr(f,p,BigInt(n)),p+=8),l&&Rt(f,p,r)}async function t6(t,e,n){let{files:r,writer:s}=t,{diskOffset:a}=s,{diskNumber:c}=s,l=0,d=0,f=t.offset-a,p=r.size;for(let[,F]of r){let{rawFilename:L,rawExtraFieldZip64:H,rawExtraFieldAES:N,rawComment:X,rawExtraFieldNTFS:V,rawExtraField:Y,extendedTimestamp:D,extraFieldExtendedTimestampFlag:j,lastModDate:ae}=F,me;if(D){me=new Uint8Array(9);let ue=Tr(me);Mt(ue,0,21589),Mt(ue,2,5),Cv(ue,4,j),Rt(ue,5,Math.floor(ae.getTime()/1e3))}else me=new Uint8Array;F.rawExtraFieldExtendedTimestamp=me,d+=46+Et(L,X,H,N,V,me,Y)}let m=new Uint8Array(d),g=Tr(m);await _s(s);let w=0;for(let[F,L]of Array.from(r.values()).entries()){let{offset:H,rawFilename:N,rawExtraFieldZip64:X,rawExtraFieldAES:V,rawExtraFieldExtendedTimestamp:Y,rawExtraFieldNTFS:D,rawExtraField:j,rawComment:ae,versionMadeBy:me,headerArray:ue,headerView:_e,zip64:ke,zip64UncompressedSize:De,zip64CompressedSize:Ie,zip64DiskNumberStart:Ce,zip64Offset:Ge,internalFileAttributes:Re,externalFileAttributes:Oe,diskNumberStart:mt,uncompressedSize:ze,compressedSize:Xe}=L,tt=Et(X,V,Y,D,j);Rt(g,l,33639248),Mt(g,l+4,me),De||Rt(_e,18,ze),Ie||Rt(_e,14,Xe),Kn(m,ue,l+6);let We=l+30;if(Mt(g,We,tt),We+=2,Mt(g,We,Et(ae)),We+=2,Mt(g,We,ke&&Ce?65535:mt),We+=2,Mt(g,We,Re),We+=2,Oe&&Rt(g,We,Oe),We+=4,Rt(g,We,ke&&Ge?4294967295:H),We+=4,Kn(m,N,We),We+=Et(N),Kn(m,X,We),We+=Et(X),Kn(m,V,We),We+=Et(V),Kn(m,Y,We),We+=Et(Y),Kn(m,D,We),We+=Et(D),Kn(m,j,We),We+=Et(j),Kn(m,ae,We),l-w>s.availableSize&&(s.availableSize=0,await so(s,m.slice(w,l)),w=l),l=We,n.onprogress)try{await n.onprogress(F+1,r.size,new io(L))}catch{}}await so(s,w?m.slice(w):m);let v=s.diskNumber,{availableSize:x}=s;x<22&&v++;let b=It(t,n,Zf);if(f>4294967295||d>4294967295||p>65535||v>65535){if(b===!1)throw new Error(hp);b=!0}let S=new Uint8Array(b?98:22),k=Tr(S);l=0,b&&(Rt(k,0,101075792),tr(k,4,BigInt(44)),Mt(k,12,45),Mt(k,14,45),Rt(k,16,v),Rt(k,20,c),tr(k,24,BigInt(p)),tr(k,32,BigInt(p)),tr(k,40,BigInt(d)),tr(k,48,BigInt(f)),Rt(k,56,117853008),tr(k,64,BigInt(f)+BigInt(d)),Rt(k,72,v+1),It(t,n,tv,!0)&&(v=65535,c=65535),p=65535,f=4294967295,d=4294967295,l+=76),Rt(k,l,101010256),Mt(k,l+4,v),Mt(k,l+6,c),Mt(k,l+8,p),Mt(k,l+10,p),Rt(k,l+12,d),Rt(k,l+16,f);let $=Et(e);if($)if($<=65535)Mt(k,l+20,$);else throw new Error(hk);await so(s,S),$&&await so(s,e)}async function so(t,e){let{writable:n}=t,r=n.getWriter();try{await r.ready,t.size+=Et(e),await r.write(e)}finally{r.releaseLock()}}function Ev(t){if(t)return(BigInt(t.getTime())+BigInt(116444736e5))*BigInt(1e4)}function It(t,e,n,r){let s=e[n]===Je?t.options[n]:e[n];return s===Je?r:s}function fk(t){return t+5*(Math.floor(t/16383)+1)}function Cv(t,e,n){t.setUint8(e,n)}function Mt(t,e,n){t.setUint16(e,n,!0)}function Rt(t,e,n){t.setUint32(e,n,!0)}function tr(t,e,n){t.setBigUint64(e,n,!0)}function Kn(t,e,n){t.set(e,n)}function Tr(t){return new DataView(t.buffer)}function Et(...t){let e=0;return t.forEach(n=>n&&(e+=n.length)),e}function xk({version:t,bitFlag:e,compressionMethod:n,uncompressedSize:r,compressedSize:s,lastModDate:a,rawFilename:c,zip64CompressedSize:l,zip64UncompressedSize:d,extraFieldLength:f}){let p=new Uint8Array(26),m=Tr(p);Mt(m,0,t),Mt(m,2,e),Mt(m,4,n);let g=new Uint32Array(1),w=Tr(g);Mt(w,0,(a.getHours()<<6|a.getMinutes())<<5|a.getSeconds()/2),Mt(w,2,(a.getFullYear()-1980<<4|a.getMonth()+1)<<5|a.getDate());let v=g[0];return Rt(m,6,v),(l||s!==Je)&&Rt(m,14,l?4294967295:s),(d||r!==Je)&&Rt(m,18,d?4294967295:r),Mt(m,22,Et(c)),Mt(m,24,f),{headerArray:p,headerView:m,rawLastModDate:v}}function Tk(t,e,n,r,s){let a=0;return e&&(a=a|2048),n&&(a=a|8),(s==8||s==9)&&(t>=0&&t<=3&&(a=a|6),t>3&&t<=5&&(a=a|4),t==9&&(a=a|2)),r&&(a=a|1),a}var d6={},Rk;try{Rk=d6.url}catch{}mc({baseURL:Rk});xC(mc);mc({Deflate:TS,Inflate:BS});var Ac=require("fs");async function mp(t,e,n,r,s){let a=s||new Ek.CancellationTokenSource().token,c=(0,pu.join)(ge,"static");console.log("Uploading static content from",c);let l=new Pc(new xc("application/zip"));function d(g,w=""){let v=["node_modules","dist","build","out"],x=[];for(let b of(0,Ac.readdirSync)(g,{encoding:"utf8"})){let S=w?(0,pu.join)(w,b):b,k=(0,pu.join)(g,b),$=(0,Ac.statSync)(k);if($.isDirectory()){if(v.includes(b))continue;x=x.concat(d(k,S))}else $.isFile()&&x.push(S)}return x}let f=d(c);console.log(`Found ${f.length} files (excluding ignored folders)`);for(let g of f){if(a.isCancellationRequested)return"cancelled";console.log("adding",g);let w=(0,pu.join)(c,g),v=(0,Ac.readFileSync)(w);await l.add(g,new Lo(new Blob([v])))}console.log("Creating zip file for static content...");let p=await l.close(),m=new FormData;return m.append("file",p,"static.zip"),m.append("deploy","dev"),m.append("name",n||"static"),m.append("description",r||"Uploaded via VS Code"),a.isCancellationRequested?"cancelled":Te(t,`workspace/${e}/static_host/default/build`,{method:"POST",body:m})}var qs=we(require("vscode"));async function Sk(){await ps();try{let t=[{kind:qs.QuickPickItemKind.Default,label:"Development",value:"dev"},{kind:qs.QuickPickItemKind.Default,label:"Production",value:"prod"}],e=await qs.window.showQuickPick(t,{placeHolder:"Select environment"});if(!e)return;qs.window.withProgress({location:qs.ProgressLocation.Notification,title:`Uploading static content to ${e.label}...`,cancellable:!0},async(n,r)=>{await mp(A.instanceName,A.workspaceId,"static","Static content uploaded via VS Code",r),qs.window.showInformationMessage("Static content uploaded successfully!")})}catch(t){console.error("Error uploading static content:",t),qs.window.showErrorMessage("Failed to upload static content")}}async function Ck(){try{await gS(),console.info("Xano registry stash applied successfully")}catch(t){console.error("Failed to apply Xano registry stash",t)}}var Wo=we(require("vscode"));var kk=require("path");async function Pk(t){if(!t){Wo.window.showErrorMessage("No file selected to view diff.");return}console.log("viewRemoteDiffCmd",JSON.stringify(t,null,2));let e=(0,kk.join)(ge,t);if(!e){Wo.window.showErrorMessage("No file path provided for the modified file.");return}let n=Wo.Uri.file(e),r=Wo.Uri.parse(`xano-remote:${t}`);Wo.commands.executeCommand("vscode.diff",r,n,`${t.split("/").pop()} (Remote \u2194 Local)`)}var oo=we(require("vscode"));var Ak=require("path"),Dk=we(mn());async function Ik(){if(await ps(),(await oo.window.showWarningMessage("Resetting will discard all local changes not saved to Xano and sync with your Xano workspace. Are you sure?",{modal:!0},{title:"Reset and Sync",isCloseAffordance:!1},{title:"Cancel",isCloseAffordance:!0}))?.title==="Reset and Sync"){oo.window.visibleTextEditors.length>0&&await oo.commands.executeCommand("workbench.action.closeAllEditors");for(let n in A.paths){let r=(0,Dk.get)(A.paths,n),s=oo.Uri.file((0,Ak.join)(ge,r));await oo.workspace.fs.delete(s,{recursive:!0})}await gn([]),await pc()}}var vs=we(require("vscode"));var $k=require("path"),Ok=we(mn());async function Fk(){let t=await vs.window.showInputBox({prompt:"Enter the workflow test name",placeHolder:"e.g., send_email"});if(!t){vs.window.showErrorMessage("Workflow test name is required");return}t=t.replace(/([^a-zA-Z0-9/]+)/g,"_");let e=`workflow_test "${t}" {
  stack {
    expect.to_be_true (1 == 1)
  }
}`;try{let n=vs.Uri.file((0,$k.join)(ge,A.paths.workflowTests,`${(0,Ok.snakeCase)(t)}.xs`));if(await vs.workspace.fs.stat(n).then(s=>s,()=>null)){vs.window.showErrorMessage("A file with the same name already exists");return}await vs.workspace.fs.writeFile(n,Buffer.from(e)),jt(n),vs.window.showInformationMessage(`Workflow test ${t} created successfully`),await nn([n.path.slice(ge.length+1)]),je.refresh()}catch{vs.window.showErrorMessage("Failed to create task");return}}var ao=we(require("vscode"));async function Nk(){let t=ao.window.activeTextEditor;t?.document?ao.window.withProgress({location:ao.ProgressLocation.Notification,title:"Running Workflow Test"},async e=>{let n=t.document.getText();e.report({message:"Running test..."});let r=await W1(A.instanceName,A.workspaceId,n);e.report({increment:100,message:"done"}),r.status=="ok"?ao.window.showInformationMessage(`Test succeeded - ${r.timing}ms`):r.status=="exception"?ao.window.showWarningMessage(`Test failed: ${r.message}`):ao.window.showErrorMessage(`Could not run test: ${r.message}`)}):ao.window.showErrorMessage("No active editor found")}var ys=we(require("vscode"));var Mk=require("path"),kv=we(mn());async function qk(){let t=await ys.window.showInputBox({prompt:"Enter the agent name",placeHolder:"e.g., email_assistant"});if(!t){ys.window.showErrorMessage("Agent name is required");return}t=t.replace(/([^a-zA-Z0-9/]+)/g,"_");let e=`agent "${t}" {
  canonical = "${(0,kv.snakeCase)(t)}"
  llm = {
    type         : "xano-free"
    system_prompt: """
      You are a helpful AI Agent that completes tasks accurately. 
      When you need additional information to complete a task, use the available tools. 
      Always explain your reasoning and provide clear responses.
      """
    max_steps    : 5
    prompt       : "The following is what the user is asking: {{ args.user_prompt }}"
  }

  tools = [
    "tool_name"
  ]
}`;try{let n=ys.Uri.file((0,Mk.join)(ge,A.paths.agents,`${(0,kv.snakeCase)(t)}.xs`));if(await ys.workspace.fs.stat(n).then(s=>s,()=>null)){ys.window.showErrorMessage("A file with the same name already exists");return}await ys.workspace.fs.writeFile(n,Buffer.from(e)),jt(n),ys.window.showInformationMessage(`Agent ${t} created successfully`),await nn([n.path.slice(ge.length+1)]),je.refresh()}catch{ys.window.showErrorMessage("Failed to create agent");return}}var ws=we(require("vscode"));var Lk=require("path"),Uk=we(mn());async function Wk(){let t=await ws.window.showInputBox({prompt:"Enter the MCP server name",placeHolder:"e.g., email_server"});if(!t){ws.window.showErrorMessage("MCP server name is required");return}t=t.replace(/([^a-zA-Z0-9/]+)/g,"_");let e=`mcp_server ${t} {
  input {
    text message_id
  }
  stack {
  }
}`;try{let n=ws.Uri.file((0,Lk.join)(ge,A.paths.mcpServers,`${(0,Uk.snakeCase)(t)}.xs`));if(await ws.workspace.fs.stat(n).then(s=>s,()=>null)){ws.window.showErrorMessage("A file with the same name already exists");return}await ws.workspace.fs.writeFile(n,Buffer.from(e)),jt(n),ws.window.showInformationMessage(`MCP server ${t} created successfully`),await nn([n.path.slice(ge.length+1)]),je.refresh()}catch{ws.window.showErrorMessage("Failed to create MCP server");return}}var ai=we(require("vscode"));var Hk=require("path"),Pv=we(mn());async function jk(){let e=(await eo()).table||[];if(e.length===0){ai.window.showErrorMessage("No tables to associate with. Please create a table first.");return}let n=await ai.window.showQuickPick(e.map(a=>({label:a.name})),{placeHolder:"Select the table to associate with"});if(!n){ai.window.showErrorMessage("No table selected");return}let r=await ai.window.showInputBox({prompt:"Enter the table trigger name",placeHolder:"e.g., user_update_trigger",value:`${n.label}_trigger`});if(!r){ai.window.showErrorMessage("Table trigger name is required");return}r=r.replace(/([^a-zA-Z0-9/]+)/g,"_");let s=`table_trigger ${r} {
  table = "${(0,Pv.snakeCase)(r)}"

  input {
    json new
    json old
    enum action {
      values = ["insert", "update", "delete", "truncate"]
    }
    text datasource
  }

  stack {
  }

  actions = {
    delete: true
    insert: true
    update: true
    truncate: true
  }
}`;try{let a=ai.Uri.file((0,Hk.join)(ge,A.paths.tableTriggers,`${(0,Pv.snakeCase)(r)}.xs`));if(await ai.workspace.fs.stat(a).then(l=>l,()=>null)){ai.window.showErrorMessage("A file with the same name already exists");return}await ai.workspace.fs.writeFile(a,Buffer.from(s)),jt(a),ai.window.showInformationMessage(`Table trigger ${r} created successfully`),await nn([a.path.slice(ge.length+1)]),je.refresh()}catch{ai.window.showErrorMessage("Failed to create table trigger");return}}var ci=we(require("vscode"));var Xk=require("path"),Bk=we(mn());async function Gk(){let e=(await eo()).agent||[];if(e.length===0){ci.window.showErrorMessage("No agents to associate with. Please create an agent first.");return}let n=await ci.window.showQuickPick(e.map(a=>({label:a.name})),{placeHolder:"Select the agent to associate with"});if(!n){ci.window.showErrorMessage("No agent selected");return}let r=await ci.window.showInputBox({prompt:"Enter the agent trigger name",placeHolder:"e.g., user_signup_trigger",value:`${n.label}_trigger`});if(!r){ci.window.showErrorMessage("Agent trigger name is required");return}r=r.replace(/([^a-zA-Z0-9/]+)/g,"_");let s=`agent_trigger "${r}" {
  agent = "${n.label}"
  
  input {
    json payload
  }
  
  stack {
  }

  response = null
}`;try{let a=ci.Uri.file((0,Xk.join)(ge,A.paths.agentTriggers,`${(0,Bk.snakeCase)(r)}.xs`));if(await ci.workspace.fs.stat(a).then(l=>l,()=>null)){ci.window.showErrorMessage("A file with the same name already exists");return}await ci.workspace.fs.writeFile(a,Buffer.from(s)),jt(a),ci.window.showInformationMessage(`Agent trigger ${r} created successfully`),await nn([a.path.slice(ge.length+1)]),je.refresh()}catch{ci.window.showErrorMessage("Failed to create agent trigger");return}}var bs=we(require("vscode"));var zk=require("path"),Av=we(mn());async function Kk(){let t=await bs.window.showInputBox({prompt:"Enter the middleware name",placeHolder:"e.g., auth_middleware"});if(!t){bs.window.showErrorMessage("Middleware name is required");return}t=t.replace(/([^a-zA-Z0-9/]+)/g,"_");let e=`middleware "${t}" {
  canonical = "${(0,Av.snakeCase)(t)}"
  
  input {
    json request
  }
  
  stack {
  }
  
  output {
    json response
  }
}`;try{let n=bs.Uri.file((0,zk.join)(ge,A.paths.middlewares,`${(0,Av.snakeCase)(t)}.xs`));if(await bs.workspace.fs.stat(n).then(s=>s,()=>null)){bs.window.showErrorMessage("A file with the same name already exists");return}await bs.workspace.fs.writeFile(n,Buffer.from(e)),jt(n),bs.window.showInformationMessage(`Middleware ${t} created successfully`),await nn([n.path.slice(ge.length+1)]),je.refresh()}catch{bs.window.showErrorMessage("Failed to create middleware");return}}var Yr=we(require("vscode"));var Zk=require("path"),Vk=we(mn());async function Yk(){let t=await Yr.window.showInputBox({prompt:"Enter the realtime channel name",placeHolder:"e.g., chat_room"});if(!t){Yr.window.showErrorMessage("Realtime channel name is required");return}let e=await Yr.window.showQuickPick([{label:"Yes",description:"Enable public messaging",value:!0},{label:"No",description:"Disable public messaging",value:!1}],{placeHolder:"Enable public messaging?",title:"Public Messaging"});if(!e){Yr.window.showErrorMessage("Realtime channel creation canceled");return}let n=await Yr.window.showQuickPick([{label:"Yes",description:"Enable private messaging",value:!0},{label:"No",description:"Disable private messaging",value:!1}],{placeHolder:"Enable private messaging?",title:"Private Messaging"});if(!n){Yr.window.showErrorMessage("Realtime channel creation canceled");return}t=t.replace(/([^a-zA-Z0-9/]+)/g,"_");let r=`realtime_channel ${t} {
  public_messaging = {active: ${e.value}}
  private_messaging = {active: ${n.value}}
  settings = {
    anonymous_clients: false
    nested_channels  : false
    message_history  : 0
    auth_channel     : false
    presence         : false
  }
}`;try{let s=Yr.Uri.file((0,Zk.join)(ge,A.paths.realtimeChannels,`${(0,Vk.snakeCase)(t)}.xs`));if(await Yr.workspace.fs.stat(s).then(c=>c,()=>null)){Yr.window.showErrorMessage("A file with the same name already exists");return}await Yr.workspace.fs.writeFile(s,Buffer.from(r)),jt(s),Yr.window.showInformationMessage(`Realtime channel ${t} created successfully`),await nn([s.path.slice(ge.length+1)]),je.refresh()}catch{Yr.window.showErrorMessage("Failed to create realtime channel");return}}var Jr=we(require("vscode"));var Jk=require("path"),Qk=we(mn());async function eP(){let t=await Jr.window.showInputBox({prompt:"Enter the realtime trigger name",placeHolder:"e.g., message_handler"});if(!t){Jr.window.showErrorMessage("Realtime trigger name is required");return}let e=await Jr.window.showInputBox({prompt:"Enter the channel name this trigger will listen to",placeHolder:"e.g., chat_room"});if(!e){Jr.window.showErrorMessage("Channel name is required");return}let n=[{label:"message",description:"Trigger on message events",value:"message"},{label:"join",description:"Trigger on join events",value:"join"},{label:"connection",description:"Trigger on connection events",value:"connection"}],r=await Jr.window.showQuickPick(n,{placeHolder:"Select the action this trigger will handle",title:"Trigger Action"});if(!r){Jr.window.showErrorMessage("Realtime trigger creation canceled");return}t=t.replace(/([^a-zA-Z0-9/]+)/g,"_"),e=e.replace(/([^a-zA-Z0-9/]+)/g,"_");let s=`realtime_trigger ${t} {
  channel = "${e}"
  input {
    enum action {
      values = ["message", "join", "connection"]
    }
    text channel
    object client {
      schema {
        json extras
        object permissions {
          schema {
            int dbo_id
            text row_id
          }
        }
      }
    }
    object options {
      schema {
        bool authenticated
        text channel
      }
    }
    json payload
  }
  stack {
    var $message {
      value = "Handle ${r.value} event"
    }
    debug.log {
      value = $message
    }
  }
  actions = {${r.value}: true}
}`;try{let a=Jr.Uri.file((0,Jk.join)(ge,A.paths.realtimeTriggers,`${(0,Qk.snakeCase)(t)}.xs`));if(await Jr.workspace.fs.stat(a).then(l=>l,()=>null)){Jr.window.showErrorMessage("A file with the same name already exists");return}await Jr.workspace.fs.writeFile(a,Buffer.from(s)),jt(a),Jr.window.showInformationMessage(`Realtime trigger ${t} created successfully`),await nn([a.path.slice(ge.length+1)]),je.refresh()}catch{Jr.window.showErrorMessage("Failed to create realtime trigger");return}}var tP=`---
applyTo: "functions/**/*.xs"
---

# How to Define Functions in XanoScript

A **function** in XanoScript is a reusable block of logic that can be called from other scripts, queries, or tasks. Functions are created in the \`functions\` folder and can be organized into subfolders for better structure.

## Function Structure

A function file consists of:

- The function name (e.g., \`calculate_total\`, \`utilities/parse_email\`)
- An optional \`description\` field
- An \`input\` block defining parameters
- A \`stack\` block containing the logic to execute
- A \`response\` block specifying the output

## Example Function

\`\`\`xs
function maths/calculate_total {
  description = "Calculate the total cost based on quantity and price per item"

  input {
    int quantity filters=min:0 {
      description = "Number of items"
    }

    decimal price_per_item filters=min:0.01 {
      description = "Price for each item"
    }
  }

  stack {
    var $total {
      value = 0
      description = "Initialize total"
    }

    math.add $total {
      value = $input.quantity * $input.price_per_item
      description = "Calculate total"
    }
  }

  response = $total
}
\`\`\`

## How to call a function in your code

You can call a function using the \`function.run\` keyword followed by the function's name.

**Example:**

\`\`\`xs
function.run maths/calculate_total {
  input = {
    quantity: 5,
    price_per_item: 20
  }
} as $result
\`\`\`

## Input Block

The \`input\` block defines the parameters your function expects. You can specify:

- Data types (\`int\`, \`text\`, \`decimal\`, etc.)
- Optional fields (add \`?\`)
- Filters (e.g., \`trim\`, \`lower\`)
- Metadata (\`description\`, \`sensitive\`)

**Example:**

\`\`\`xs
input {
  text username filters=trim {
    description = "User's login name"
  }

  text email filters=trim {
    description = "User's email address"
  }

  date dob? {
    description = "User's date of birth (YYYY-MM-DD)"
    sensitive = true
  }
}
\`\`\`

## Stack Block

The \`stack\` block contains the logic for your function, such as:

- Variable declarations (\`var\`)
- Control flow (\`conditional\`, \`for\`, \`foreach\`)
- Function calls (\`math.add\`, \`debug.log\`)
- Database operations (\`db.query\`, \`db.add\`)
- Error handling (\`throw\`, \`try_catch\`)

## Response Block

The \`response\` block defines what your function returns. The value can be a variable, object, or expression.

**Example:**

\`\`\`xs
response = $total
\`\`\`

## Best Practices

- Use \`description\` for documentation.
- Validate inputs with \`filters=...\` first, fallback on \`precondition\` or \`conditional\` blocks.
- Place all logic inside the \`stack\` block.
- Always define a \`response\` block for output.
- Organize functions in subfolders for clarity.

## Summary

- Place functions in the \`functions\` folder.
- Use \`input\` for parameters.
- Use \`stack\` for logic.
- Use \`response\` for output.
- Document your function with \`description\` fields.

For more examples, see the documentation or sample functions in your project.
`;var nP=`---
applyTo: "functions/**/*.xs"
---

# Xanoscript Function Examples

Below are some examples of custom functions defined in Xanoscript.

Function can be called using

\`\`\`xs
function.run add_numbers {
  input = { a: 5, b: $input.b }
} as $return_value
\`\`\`

## youtube_url_analyzer_utility

\`\`\`xs
function utilities/youtube_url_parser {
  description = "This utility function parses various YouTube URL formats (including short, mobile, and embed links) to extract the video ID. It then uses the ID to generate a list of corresponding thumbnail URLs in multiple quality options, all while providing robust input validation."
  input {
    text youtube_url? filters=trim
  }

  stack {
    var $youtube_id {
      value = ("/^((?:https?:)?\\/\\/)?((?:www|m)\\.)?((?:youtube\\.com|youtu.be))(\\/(?:[\\w\\-]+\\?v=|embed\\/|v\\/)?)([\\w\\-]+)(\\S+)?$/"|regex_get_all_matches:$input.youtube_url)[5]|first
    }

    precondition (($youtube_id|strlen) > 5) {
      error = "No valid ID found"
    }

    var $default_thumbnail {
      description = "Default quality thumbnail URL"
      value = "https://img.youtube.com/vi/" ~ $youtube_id ~ "/default.jpg"
    }

    var $medium_thumbnail {
      description = "Medium quality thumbnail URL"
      value = "https://img.youtube.com/vi/" ~ $youtube_id ~ "/mqdefault.jpg"
    }

    var $high_thumbnail {
      description = "High quality thumbnail URL"
      value = "https://img.youtube.com/vi/" ~ $youtube_id ~ "/hqdefault.jpg"
    }

    var $standard_thumbnail {
      description = "Standard quality thumbnail URL"
      value = "https://img.youtube.com/vi/" ~ $youtube_id ~ "/sddefault.jpg"
    }

    var $maxres_thumbnail {
      description = "Maximum resolution thumbnail URL"
      value = "https://img.youtube.com/vi/" ~ $youtube_id ~ "/maxresdefault.jpg"
    }

    var $thumbnail_urls {
      description = "Object containing different quality thumbnail URLs"
      value = {
        default: $default_thumbnail
        medium: $medium_thumbnail
        high: $high_thumbnail
        standard: $standard_thumbnail
        maxres: $maxres_thumbnail
      }
    }
  }

  response = {
    youtube_id: $youtube_id,
    thumbnail_urls: $thumbnail_urls
  }
}
\`\`\`

## get_linear_labels_paginated

\`\`\`xs
function Linear/GetLabelsPaginated {
  input {
  }

  stack {
    group {
      description = "Declare Initial Variables"
      stack {
        var $labels {
          description = "Empty array to collect the labels with each loop"
          value = []
        }

        var $has_next_page {
          description = "Start with a true value for the initial loop"
          value = true
        }

        var $cursor {
          description = "The cursor will be provided by the first API call"
          value = null
        }
      }
    }

    while ($has_next_page) {
      each {
        api.request {
          description = "Get Labels from Linear"
          url = "https://api.linear.app/graphql"
          method = "POST"
          params = {}|set:"query":"""
            query ($per_page: Int, $after: String) {
              issueLabels(first:$per_page, after:$after) {
                pageInfo {
                    hasNextPage
                    endCursor
                }
                nodes {
                  id
                  name
                  parent {
                    id
                    name
                  }
                  team {
                    name
                    id
                  }
                }
              }
            }
            """|set:"variables":({}|set:"per_page":50|set:"after":$cursor)

          headers = []|push:"Content-Type: application/json"|push:"Authorization: " ~ $env.linear_key
        } as $api_labels

        var $has_next_page {
          description = "Check the pagination to see if there's another page"
          value = $api_labels|get:"data.issueLabels.pageInfo.hasNextPage":null
        }

        var $cursor {
          description = "Get the current page cursor and store it for the next loop"
          value = $api_labels|get:"data.issueLabels.pageInfo.endCursor":null
        }

        array.merge $labels {
          description = "Merge the labels from this loop into the main Labels array"
          value = $api_labels|get:"data.issueLabels.nodes":null
        }
      }
    }
  }

  response = $labels
}
\`\`\`

## phone_number_formatter

\`\`\`xs
function utilities/phone_number_formatter {
  description = "Format phone numbers into standardized US format with basic validation"
  input {
    text phone_number filters=min:10|max:10|digitOk {
      description = "Raw phone number string (10 digits only for this version)"
    }

    enum? format_type?=standard {
      values = ["standard", "dotted", "spaced"]
      description = "Format type: 'standard', 'dotted', 'spaced'. Defaults to 'standard'"
    }
  }

  stack {
    var $area_code {
      description = "Extract area code (first 3 digits)"
      value = $input.phone_number|substr:0:3
    }

    var $exchange {
      description = "Extract exchange code (next 3 digits)"
      value = $input.phone_number|substr:3:3
    }

    var $number {
      description = "Extract last 4 digits"
      value = $input.phone_number|substr:6:4
    }

    var $formatted_phone {
      description = "Initialize formatted phone variable"
      value = ""
    }

    switch ($input.format_type) {
      case ("dotted") {
        var.update $formatted_phone {
          description = "Format as 123.456.7890"
          value = $area_code ~ "." ~ $exchange ~ "." ~ $number
        }
      } break

      case ("spaced") {
        var.update $formatted_phone {
          description = "Format as 123 456 7890"
          value = $area_code ~ " " ~ $exchange ~ " " ~ $number
        }
      } break

      default {
        var.update $formatted_phone {
          description = "Format as (123) 456-7890"
          value = "(" ~ $area_code ~ ") " ~ $exchange ~ "-" ~ $number
        }
      }
    }
  }

  response = {
    formatted_phone: $formatted_phone
    original_input : $input.phone_number
    format_type    : $input.format_type
    area_code      : $area_code
    exchange       : $exchange
    number         : $number
  }
}
\`\`\`

## weighted_average_function

\`\`\`xs
function maths/weighted_average {
  description = "Calculates the weighted average of values in an array"
  input {
    decimal[] values {
      description = "Array of numbers representing the values to be averaged"
    }

    decimal[] weights {
      description = "Array of numbers representing the weights for each value"
    }
  }

  stack {
    var $values_length {
      description = "Get the length of the values array"
      value = $input.values|count
    }

    var $weights_length {
      description = "Get the length of the weights array"
      value = $input.weights|count
    }

    precondition ($values_length == $weights_length) {
      error_type = "inputerror"
      payload = "Values and weights arrays must have the same length"
    }

    var $has_negative_weights {
      description = "Check if any weights are negative"
      value = $input.weights|some:$$ < 0
    }

    precondition ($has_negative_weights == false) {
      error_type = "inputerror"
      payload = "All weights must be non-negative"
    }

    var $weighted_sum {
      description = "Initialize the weighted sum"
      value = 0
    }

    var $total_weight {
      description = "Initialize the total weight"
      value = 0
    }

    var $size {
      description = "Size of the arrays for iteration"
      value = $values_length
    }

    for ($size) {
      each as $index {
        var $current_value {
          description = "Get the value at the current index"
          value = $input.values[$index]
        }

        var $current_weight {
          description = "Get the weight at the current index"
          value = $input.weights[$index]
        }

        math.add $weighted_sum {
          description = "Add the weighted value to the sum"
          value = $current_value * $current_weight
        }

        math.add $total_weight {
          description = "Add the current weight to the total"
          value = $current_weight
        }
      }
    }

    precondition ($total_weight > 0) {
      error_type = "inputerror"
      payload = "Total weight cannot be zero"
    }

    var $weighted_average {
      description = "Calculate the weighted average"
      value = $weighted_sum / $total_weight
    }
  }

  response = $weighted_average
}
\`\`\`

## url_parser_utility

\`\`\`xs
function utilities/url_parser_utility {
  description = "Parse and validate URLs, extracting protocol, domain, path, and basic components"
  input {
    text url filters=trim|min:1 {
      description = "The URL to parse and validate"
    }
  }

  stack {
    var $url_lower {
      description = "Convert to lowercase for consistent processing"
      value = $input.url|to_lower
    }

    var $protocol {
      description = "Default protocol"
      value = "http"
    }

    var $domain {
      description = "Extract domain from URL"
      value = ""
    }

    var $path {
      description = "Extract path from URL"
      value = ""
    }

    var $is_valid {
      description = "URL validation result"
      value = false
    }

    var $validation_errors {
      description = "List of validation errors"
      value = []
    }

    conditional {
      description = "Check if URL contains protocol"
      if ($url_lower|contains:"://") {
        var $url_parts {
          description = "Split URL by protocol separator"
          value = $url_lower|split:"://"
        }

        var.update $protocol {
          description = "Extract protocol"
          value = $url_parts[0]
        }

        var $remaining_url {
          description = "Get URL without protocol"
          value = $url_parts[1]
        }

        conditional {
          description = "Check if URL contains path"
          if ($remaining_url|contains:"/") {
            var $path_parts {
              description = "Split by first slash"
              value = $remaining_url|split:"/"
            }

            var.update $domain {
              description = "Extract domain"
              value = $path_parts[0]
            }

            var.update $path {
              description = "Extract path"
              value = "/" ~ ($path_parts|slice:1:($path_parts|count)|join:"/")
            }
          }

          else {
            var.update $domain {
              description = "No path, entire remaining is domain"
              value = $remaining_url
            }
          }
        }
      }

      else {
        var.update $domain {
          description = "Use entire URL as domain"
          value = $url_lower
        }
      }
    }

    conditional {
      description = "Validate protocol"
      if ($protocol != "") {
        var $valid_protocols {
          description = "List of valid protocols"
          value = ["http", "https", "ftp", "sftp", "ws", "wss"]
        }

        conditional {
          description = "Check if protocol is valid"
          if ($valid_protocols|in:$protocol) {
            var $protocol_valid {
              description = "Protocol is valid"
              value = true
            }
          }

          else {
            var $protocol_valid {
              description = "Protocol is not valid"
              value = false
            }
          }
        }

        conditional {
          description = "Add protocol error if invalid"
          if ($protocol_valid == false) {
            var.update $validation_errors {
              description = "Add protocol error to validation errors"
              value = $validation_errors|append:"Invalid protocol: " ~ $protocol
            }
          }
        }
      }
    }

    conditional {
      description = "Validate domain"
      if ($domain != "") {
        var $domain_pattern {
          description = "Domain validation pattern"
          value = "/^[a-z0-9]([a-z0-9-]*[a-z0-9])?(.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/"
        }

        conditional {
          description = "Check if domain matches pattern"
          if (($domain_pattern|regex_matches:$domain) == false) {
            var.update $validation_errors {
              description = "Add domain error to validation errors"
              value = $validation_errors|append:"Invalid domain format: " ~ $domain
            }
          }
        }
      }
    }

    var.update $is_valid {
      description = "Set validation result based on error count"
      value = ($validation_errors|count) == 0
    }
  }

  response = {
    url              : $input.url
    is_valid         : $is_valid
    protocol         : $protocol
    domain           : $domain
    path             : $path
    validation_errors: $validation_errors
    base_url         : $protocol ~ "://" ~ $domain
    full_url         : $protocol ~ "://" ~ $domain ~ $path
  }
}
\`\`\`

## random_text_selector

\`\`\`xs
function utilities/random_text_selector {
  description = "Select a random text value from an array with optional exclusion of previously used index"
  input {
    json text_array {
      description = "Array of text values to choose from"
    }

    int? last_used_index? {
      description = "Optional index of previously used value to exclude from selection"
    }
  }

  stack {
    var $text_array {
      description = "Convert input to safe array"
      value = $input.text_array|safe_array
    }

    precondition (($text_array|count) > 0) {
      error_type = "inputerror"
      error = "Text array cannot be empty"
    }

    var $available_options {
      description = "Start with full array"
      value = $text_array
    }

    conditional {
      description = "Filter out last used index if provided"
      if ($input.last_used_index !== null) {
        var.update $available_options {
          description = "Remove last used index from options"
          value = $text_array|filter:"return $index != " ~ $input.last_used_index ~ ";"
        }
      }
    }

    var $selected_text {
      description = "Get random text from available options"
      value = $available_options|shuffle|first
    }
  }

  response = {
    selected_text    : $selected_text
    total_options    : $available_options|count
    available_options: $available_options
  }
}
\`\`\`

## process_csv_import

\`\`\`xs
function csv_import/process_customers {
  description = "Processes a CSV file to import customer data. Creates user records for email/name data and customer records with address information. Handles duplicate detection and provides import statistics."
  input {
    file csv_file {
      description = "The CSV file containing customer data."
    }
  }

  stack {
    var $successful_imports {
      value = 0
      description = "Counter for successfully imported records."
    }

    var $failed_imports {
      value = 0
      description = "Counter for failed imports."
    }

    var $total_processed {
      value = 0
      description = "Total number of records processed."
    }

    debug.log {
      value = "CSV import process started."
      description = "Log the start of the import process."
    }

    stream.from_csv {
      value = $input.csv_file
      separator = ","
      enclosure = '"'
      escape_char = '"'
      description = "CSV File Data"
    } as $csv_data

    foreach ($csv_data) {
      each as $row {
        var.update $total_processed {
          value = $total_processed + 1
          description = "Increment total processed records."
        }

        var $email {
          value = ($row|get:"email":null)|trim|lower
          description = "Extract and normalize email from the current row."
        }

        try_catch {
          description = "Process customer record with error handling."
          try {
            var $full_name {
              value = (($row|get:"first_name":null)|trim) ~ " " ~ (($row|get:"last_name":null)|trim)
              description = "Combine first and last name for user record."
            }

            group {
              description = "Check for existing user and customer records. Add new record if they do not exist."
              stack {
                db.get user {
                  field_name = "email"
                  field_value = $email
                  description = "Check if user already exists by email."
                } as $user

                conditional {
                  description = "Create user if they don't already exist."
                  if ($user == null) {
                    db.add user {
                      data = {
                        created_at: "now"
                        name      : $full_name
                        email     : $email
                        is_active : true
                      }

                      description = "Create new user record with name and email."
                    } as $new_user

                    var.update $user {
                      value = $new_user
                      description = "Update user variable with newly created user record."
                    }
                  }
                }

                db.get customer {
                  field_name = "user_id"
                  field_value = $user.id
                  description = "Check if user is already a customer"
                } as $customer

                conditional {
                  description = "Create customer record if user is not already a customer"
                  if ($customer == null) {
                    db.add customer {
                      data = {
                        created_at    : "now"
                        user_id       : $user.id
                        customer_type : "individual"
                        street_address: ($row|get:"street_address":null)|trim
                        zip_code      : ($row|get:"zip_code":null)|trim
                        city          : ($row|get:"city":null)|trim
                      }

                      description = "Create new customer record linked to user."
                    } as $customer
                  }
                }
              }
            }

            var.update $successful_imports {
              value = $successful_imports + 1
              description = "Increment successful imports counter."
            }

            debug.log {
              value = "Successfully imported customer: " ~ $email ~ " (User ID: " ~ $user_record.id ~ ")"
              description = "Log successful customer import."
            }
          }

          catch {
            var.update $failed_imports {
              value = $failed_imports + 1
              description = "Increment failed imports on error."
            }

            debug.log {
              value = "Failed to process row: " ~ ($row|json_encode) ~ ", Error: " ~ $error
              description = "Log row processing failure."
            }
          }
        }
      }
    }

    var $result {
      value = {
        total_processed   : $total_processed
        successful_imports: $successful_imports
        failed_imports    : $failed_imports
        message          : "CSV import completed successfully."
      }
    }
  }

  response = $result
}
\`\`\`

## survey_analytics_system

\`\`\`xs
function analytics/survey_analytics {
  description = "Calculate survey completion rates, response statistics, and question-level analytics for survey system analysis"
  input {
    int survey_id {
      description = "The ID of the survey to analyze"
    }
  }

  stack {
    precondition ($input.survey_id > 0) {
      error_type = "inputerror"
      error = "Survey ID must be positive"
      description = "Validate survey_id is valid"
    }

    db.get surveys {
      field_name = "id"
      field_value = $input.survey_id
      description = "Get survey information and verify it exists"
    } as $survey_info

    precondition ($survey_info != null) {
      error_type = "notfound"
      error = "Survey not found"
      description = "Ensure survey exists"
    }

    db.query survey_questions {
      description = "Get all questions for this survey ordered by display order"
      where = $db.survey_questions.survey_id == $input.survey_id
    } as $questions

    db.query survey_responses {
      description = "Get all responses for this survey"
      where = $db.survey_responses.survey_id == $input.survey_id
    } as $all_responses

    var $total_questions {
      value = $questions|count
      description = "Total number of questions in survey"
    }

    db.query survey_responses {
      description = "Get all responses for this survey"
      where = $db.survey_responses.survey_id == $input.survey_id
    } as $responses

    var $unique_respondents {
      value = $all_responses.respondent_id|unique
      description = "Get unique respondent IDs"
    }

    var $total_respondents {
      value = $unique_respondents|count
      description = "Total number of unique respondents"
    }

    var $completion_analysis {
      value = []
      description = "Array to store completion analysis for each respondent"
    }

    foreach ($unique_respondents) {
      each as $respondent_id {
        var $respondent_responses {
          value = $all_responses|filter:"return $this.respondent_id == '" ~ $respondent_id ~ "';"
          description = "Get responses for current respondent"
        }

        var $response_count {
          value = $respondent_responses|count
          description = "Count responses for this respondent"
        }

        var $completion_percentage {
          value = 0
          description = "Initialize completion percentage"
        }

        conditional {
          if ($total_questions > 0) {
            var.update $completion_percentage {
              value = (($response_count / $total_questions) * 100)|number_format:2:".":","
              description = "Calculate completion percentage"
            }
          }
        }

        var $is_complete {
          value = ($response_count == $total_questions)
          description = "Check if survey is complete"
        }

        var $respondent_analysis {
          value = {
            respondent_id: $respondent_id
            responses_given: $response_count
            completion_percentage: $completion_percentage
            is_complete: $is_complete
          }

          description = "Analysis for current respondent"
        }

        array.push $completion_analysis {
          value = $respondent_analysis
          description = "Add respondent analysis to results"
        }
      }
    }

    var $completed_surveys {
      value = $completion_analysis|filter:"return $this.is_complete == true;"
      description = "Filter to only completed surveys"
    }

    var $completion_rate {
      value = 0
      description = "Overall completion rate percentage"
    }

    conditional {
      if ($total_respondents > 0) {
        var $completed_count {
          value = $completed_surveys|count
          description = "Number of completed surveys"
        }

        var.update $completion_rate {
          value = (($completed_count / $total_respondents) * 100)|number_format:2:".":","
          description = "Calculate completion rate"
        }
      }
    }

    var $question_stats {
      value = []
      description = "Array to store response statistics for each question"
    }

    foreach ($questions) {
      each as $question {
        var $question_responses {
          value = $all_responses|filter:"return $this.question_id == " ~ $question.id ~ ";"
          description = "Get responses for current question"
        }

        var $response_count {
          value = $question_responses|count
          description = "Count responses for this question"
        }

        var $response_rate {
          value = 0
          description = "Initialize response rate"
        }

        conditional {
          if ($total_respondents > 0) {
            var.update $response_rate {
              value = (($response_count / $total_respondents) * 100)|number_format:2:".":","
              description = "Calculate response rate percentage"
            }
          }
        }

        var $question_analysis {
          value = {
            question_id: $question.id
            question_text: $question.question_text
            question_type: $question.question_type
            is_required: $question.is_required
            total_responses: $response_count
            response_rate: $response_rate
          }

          description = "Analysis for current question"
        }

        array.push $question_stats {
          value = $question_analysis
          description = "Add question analysis to results"
        }
      }
    }

    var $average_answered {
      value = 0
      description = "Average questions answered per respondent"
    }

    conditional {
      if ($total_respondents > 0) {
        var $total_responses_given {
          value = $completion_analysis.responses_given|sum
          description = "Sum of all responses given"
        }

        var.update $average_answered {
          value = ($total_responses_given / $total_respondents)|number_format:2:".":","
          description = "Calculate average questions answered"
        }
      }
    }

    var $analytics_summary {
      value = {
        survey_id: $input.survey_id
        survey_title: $survey_info.title
        survey_status: $survey_info.status
        total_questions: $total_questions
        total_respondents: $total_respondents
        completed_responses: ($completed_surveys|count)
        completion_rate_percent: $completion_rate
        partial_responses: ($total_respondents - ($completed_surveys|count))
        average_questions_answered: $average_answered
      }

      description = "Summary analytics for the survey"
    }

    debug.log {
      value = "Survey analytics calculated for survey " ~ $input.survey_id ~ " - " ~ $total_respondents ~ " respondents, " ~ $completion_rate ~ "% completion rate"
      description = "Log analytics completion"
    }
  }

  response = {
    summary           : $analytics_summary
    question_breakdown: $question_stats
    completion_details: $completion_analysis
    generated_at      : "now"
  }
}
\`\`\`

## calculate_customer_lifetime_value

\`\`\`xs
function analytics/calculate_customer_lifetime_value {
  description = "Calculates the total monetary value of all orders made by a specific customer, providing a measure of their lifetime value to the business. This function queries the customer's order history and sums up all order totals to determine their overall spending."
  input {
    int customer_id {
      description = "The ID of the customer to calculate lifetime value for"
    }
  }

  stack {
    db.query customer {
      description = "Query the customer table to get customer information"
      where = $db.customer.id == $input.customer_id
      mock "should return customer" {
        value = [{id: 5, name: "John"}]
      }
    } as $customer

    db.query orders {
      description = "Query the orders table to get all orders for this customer"
      where = $db.orders.customer_id == $input.customer_id
      mock "should return customer" {
        value = [
          {id: 1, customer_id: 5, order_total: 100},
          {id: 2, customer_id: 5, order_total: 50}
        ]
      }
      mock "should return zero for no orders" {
        value = []
      }
    } as $orders

    var $total {
      value = $orders[$$].order_total|sum
      description = "Calculate the total value by summing all order totals"
    }
  }

  response = $total

  test "should return customer" {
    input = {customer_id: 5}
    expect.to_equal $response {
      value = 150
    }
  }

  test "should return zero for no orders" {
    input = {customer_id: 99}
    expect.to_equal $response {
      value = 0
    }
  }
}
\`\`\`

## employee_performance_bonus_calculator

\`\`\`xs
function hr/employee_performance_bonus_calculator {
  description = "Calculates employee performance bonuses based on performance score, years of service, department, and additional factors"
  input {
    decimal performance_score filters=min:0|max:100 {
      description = "Employee's performance score (0-100)"
    }

    int years_of_service filters=min:0|max:50 {
      description = "Number of years the employee has worked"
    }

    text department {
      description = "Employee's department (engineering, sales, management, marketing, hr, finance)"
    }

    decimal base_salary filters=min:0 {
      description = "Employee's annual base salary"
    }

    bool exceeded_targets? {
      description = "Whether employee exceeded their annual targets"
    }

    text performance_tier? {
      description = "Performance tier: exceptional, high, satisfactory, needs_improvement"
    }

    decimal bonus_cap_percentage?=25 filters=min:0|max:50 {
      description = "Maximum bonus as percentage of base salary (default 25%)"
    }
  }

  stack {
    var $department_multiplier {
      value = 1
      description = "Initialize department multiplier"
    }

    switch ($input.department|to_lower) {
      case ("engineering") {
        var.update $department_multiplier {
          value = 1.2
          description = "Engineering department gets 20% multiplier"
        }
      } break

      case ("sales") {
        var.update $department_multiplier {
          value = 1.3
          description = "Sales department gets 30% multiplier"
        }
      } break

      case ("management") {
        var.update $department_multiplier {
          value = 1.4
          description = "Management gets 40% multiplier"
        }
      } break

      case ("marketing") {
        var.update $department_multiplier {
          value = 1.15
          description = "Marketing gets 15% multiplier"
        }
      } break

      case ("hr") {
        var.update $department_multiplier {
          value = 1.1
          description = "HR gets 10% multiplier"
        }
      } break

      case ("finance") {
        var.update $department_multiplier {
          value = 1.25
          description = "Finance gets 25% multiplier"
        }
      } break

      default {
        var.update $department_multiplier {
          value = 1
          description = "Default multiplier for other departments"
        }
      }
    }

    var $years_multiplier {
      value = 1
      description = "Initialize years of service multiplier"
    }

    conditional {
      if ($input.years_of_service >= 20) {
        var.update $years_multiplier {
          value = 1.5
          description = "20+ years gets 50% multiplier"
        }
      }

      elseif ($input.years_of_service >= 15) {
        var.update $years_multiplier {
          value = 1.4
          description = "15+ years gets 40% multiplier"
        }
      }

      elseif ($input.years_of_service >= 10) {
        var.update $years_multiplier {
          value = 1.3
          description = "10+ years gets 30% multiplier"
        }
      }

      elseif ($input.years_of_service >= 5) {
        var.update $years_multiplier {
          value = 1.2
          description = "5+ years gets 20% multiplier"
        }
      }

      elseif ($input.years_of_service >= 2) {
        var.update $years_multiplier {
          value = 1.1
          description = "2+ years gets 10% multiplier"
        }
      }
    }

    var $performance_multiplier {
      value = $input.performance_score / 100
      description = "Convert performance score to decimal multiplier"
    }

    var $target_bonus {
      value = 0
      description = "Initialize target achievement bonus"
    }

    conditional {
      if ($input.exceeded_targets) {
        var.update $target_bonus {
          value = $input.base_salary * 0.05
          description = "5% bonus for exceeding targets"
        }
      }
    }

    var $tier_multiplier {
      value = 1
      description = "Initialize performance tier multiplier"
    }

    conditional {
      if ($input.performance_tier != "") {
        switch ($input.performance_tier|to_lower) {
          case ("exceptional") {
            var.update $tier_multiplier {
              value = 1.25
              description = "Exceptional performance gets 25% multiplier"
            }
          } break

          case ("high") {
            var.update $tier_multiplier {
              value = 1.15
              description = "High performance gets 15% multiplier"
            }
          } break

          case ("satisfactory") {
            var.update $tier_multiplier {
              value = 1
              description = "Satisfactory performance gets standard multiplier"
            }
          } break

          case ("needs_improvement") {
            var.update $tier_multiplier {
              value = 0.5
              description = "Needs improvement gets reduced multiplier"
            }
          } break
        }
      }
    }

    var $calculated_bonus {
      value = $input.base_salary * $performance_multiplier * $department_multiplier * $years_multiplier * $tier_multiplier
      description = "Calculate base bonus before caps and additions"
    }

    var $total_bonus_before_cap {
      value = $calculated_bonus + $target_bonus
      description = "Add target achievement bonus"
    }

    var $bonus_cap {
      value = $input.base_salary * ($input.bonus_cap_percentage / 100)
      description = "Calculate maximum allowed bonus"
    }

    var $final_bonus {
      value = ($total_bonus_before_cap > $bonus_cap) ? $bonus_cap : $total_bonus_before_cap
      description = "Apply bonus cap if necessary"
    }

    var $was_capped {
      value = $total_bonus_before_cap > $bonus_cap
      description = "Track if bonus was capped"
    }

    var $bonus_as_percentage {
      value = ($final_bonus / $input.base_salary) * 100
      description = "Calculate bonus as percentage of base salary"
    }

    var $result {
      value = {
        final_bonus_amount: $final_bonus
        bonus_percentage: $bonus_as_percentage
        was_capped: $was_capped
        calculation_details: {
          base_salary: $input.base_salary
          performance_score: $input.performance_score
          years_of_service: $input.years_of_service
          department: $input.department
          performance_tier: $input.performance_tier
          exceeded_targets: $input.exceeded_targets
        }
        multipliers_applied: {
          department_multiplier: $department_multiplier
          years_multiplier: $years_multiplier
          performance_multiplier: $performance_multiplier
          tier_multiplier: $tier_multiplier
        }
        bonus_breakdown: {
          calculated_base_bonus: $calculated_bonus
          target_achievement_bonus: $target_bonus
          total_before_cap: $total_bonus_before_cap
          bonus_cap: $bonus_cap
          final_bonus: $final_bonus
        }
      }

      description = "Comprehensive bonus calculation result with detailed breakdown"
    }
  }

  response = $result
}
\`\`\`

## compute_user_engagement_score

\`\`\`xs
function analytics/compute_user_engagement_score {
  description = "Computes a user engagement score based on their activity data. Accepts a user ID and activity array, validates inputs, calculates weighted engagement score (posts * 10 + comments * 5 + likes * 2), and ensures all values are non-negative using array validation."
  input {
    int user_id {
      description = "Unique identifier for the user"
    }
    decimal[] posts {
      description = "Array of post counts for each period"
    }
    decimal[] comments {
      description = "Array of comment counts for each period"
    }
    decimal[] likes {
      description = "Array of like counts for each period"
    }
    decimal post_weight?=10 {
      description = "Weight multiplier for posts (default: 10)"
    }
    decimal comment_weight?=5 {
      description = "Weight multiplier for comments (default: 5)"
    }
    decimal like_weight?=2 {
      description = "Weight multiplier for likes (default: 2)"
    }
  }
  stack {
    precondition ($input.user_id > 0) {
      error_type = "inputerror"
      error = "User ID must be positive"
      description = "Validate user_id is positive"
    }
    var $posts_length {
      value = $input.posts|count
      description = "Length of posts array"
    }
    var $comments_length {
      value = $input.comments|count
      description = "Length of comments array"
    }
    var $likes_length {
      value = $input.likes|count
      description = "Length of likes array"
    }
    precondition ($posts_length > 0) {
      error_type = "inputerror"
      error = "Posts array cannot be empty"
      description = "Validate arrays are not empty"
    }
    precondition ($posts_length == $comments_length && $posts_length == $likes_length) {
      error_type = "inputerror"
      error = "All activity arrays must have the same length"
      description = "Validate all arrays have the same length"
    }
    precondition ($input.post_weight >= 0) {
      error_type = "inputerror"
      error = "Post weight must be non-negative"
      description = "Validate post weight is non-negative"
    }
    precondition ($input.comment_weight >= 0) {
      error_type = "inputerror"
      error = "Comment weight must be non-negative"
      description = "Validate comment weight is non-negative"
    }
    precondition ($input.like_weight >= 0) {
      error_type = "inputerror"
      error = "Like weight must be non-negative"
      description = "Validate like weight is non-negative"
    }
    var $min_post_value {
      value = $input.posts|min
      description = "Minimum value in posts array"
    }
    var $min_comment_value {
      value = $input.comments|min
      description = "Minimum value in comments array"
    }
    var $min_like_value {
      value = $input.likes|min
      description = "Minimum value in likes array"
    }
    precondition ($min_post_value >= 0) {
      error_type = "inputerror"
      error = "All post counts must be non-negative"
      description = "Check if all post counts are valid"
    }
    precondition ($min_comment_value >= 0) {
      error_type = "inputerror"
      error = "All comment counts must be non-negative"
      description = "Check if all comment counts are valid"
    }
    precondition ($min_like_value >= 0) {
      error_type = "inputerror"
      error = "All like counts must be non-negative"
      description = "Check if all like counts are valid"
    }
    var $total_score {
      value = 0
      description = "Total engagement score"
    }
    for ($posts_length) {
      each as $index {
        var $period_score {
          value = ($input.posts[$index] * $input.post_weight) + ($input.comments[$index] * $input.comment_weight) + ($input.likes[$index] * $input.like_weight)
          description = "Weighted score for period $index"
        }
        math.add $total_score {
          value = $period_score
          description = "Add period score to total"
        }
      }
    }
  }

  response = $total_score

  test "should calculate correct engagement score" {
    input = {
      user_id: 1,
      posts: [2, 1],
      comments: [5, 3],
      likes: [10, 4]
    }
    expect.to_equal $response {
      value = 2*10+5*5+10*2 + 1*10+3*5+4*2
    }
  }

  test "should throw error for negative post count" {
    input = {
      user_id: 1,
      posts: [-1, 2],
      comments: [1, 2],
      likes: [1, 2]
    }
    expect.to_throw {
      value = "All post counts must be non-negative"
    }
  }
}
\`\`\`
`;var rP=`---
applyTo: "apis/**/*.xs"
---

# How to Define API Queries in XanoScript

An **API query** in XanoScript defines an endpoint for handling HTTP requests (GET, POST, etc.). Queries are created in the \`apis/<api-group>/\` folder, where \`<api-group>\` is the name of your API group. Queries cannot have subfolders; each query belongs to its API group.

## Query Structure

A query file consists of:

- The query name and HTTP verb (e.g., \`products verb=GET\`)
- An optional \`description\` field
- An \`input\` block for request parameters
- A \`stack\` block for processing logic
- A \`response\` block for returned data

## Authentication

By default a query will be public. To require authentication, add an \`auth\` field with the name of the table to use for authentication (this would usually be a \`user\` table). When \`auth\` is set, the variable \`$auth.id\` will contain the authenticated user's ID. Xano offers built-in JWT authentication endpoint to signup, login and retrieve your user information. Endpoints requiring authentication expect the JWT token to be sent in the \`Authorization\` header as a Bearer token.

## Example Query

The following script would be stored in \`apis/product/products.xs\`, which means its API group would be \`product\`. It requires authentication and returns a list of products filtered by category.

\`\`\`xs
query products verb=GET {
  description = "Returns a list of products filtered by category, requires user authentication"
  auth = "user"

  input {
    text category filters=trim {
      description = "Product category to filter by"
    }
  }
  stack {
    var $category_filter {
      value = $input.category
    }
    conditional {
      if (($category_filter|strlen) > 0) {
        db.query product {
          where = ($db.product.category|to_lower) == ($category_filter|to_lower)
        } as $filtered_products
      }
      else {
        db.query product {
        } as $filtered_products
      }
    }
  }
  response = $filtered_products
}
\`\`\`

## Input Block

Defines the parameters accepted by the API endpoint. You can specify:

- Data types (\`int\`, \`text\`, \`decimal\`, etc.)
- Optional fields (add \`?\`)
- Filters (e.g., \`trim\`, \`lower\`)
- Metadata (\`description\`, \`sensitive\`)

**Example:**

\`\`\`xs
input {
  int page?=1 {
    description = "Page number for pagination"
  }
  int per_page?=10 {
    description = "Items per page"
  }
}
\`\`\`

## Stack Block

Contains the logic for processing the request, such as:

- Variable declarations (\`var\`)
- Control flow (\`conditional\`, \`for\`, \`foreach\`)
- Database operations (\`db.query\`, \`db.add\`)
- Function calls (\`function.run\`)
- Logging (\`debug.log\`)
- Error handling (\`throw\`, \`try_catch\`)

## Response Content Type

By default the response type is "application/json", to return a web page set the response type to "text/html" using the \`util.set_header\` statement:

\`\`\`xs
  util.set_header {
    value = "Content-Type: text/html; charset=utf-8"
    duplicates = "replace"
  }
\`\`\`

## Response Block

Specifies the data returned by the API. The value can be a variable, object, or expression.

**Example:**

\`\`\`xs
response = $filtered_products
\`\`\`

## Best Practices

- Use \`description\` for documentation.
- Validate inputs with filters and \`precondition\` blocks.
- Place all logic inside the \`stack\` block.
- Always define a \`response\` block for output.
- Use pagination and sorting for large datasets.

## Summary

- Always place a query in under an API group folder.
- To create a new API group, just create a folder under \`apis/\`.
- Place queries in the \`apis/<api-group>/\` folder.
- Use \`input\` for request parameters.
- Use \`stack\` for processing logic.
- Use \`response\` for returned data.
- Document your query with \`description\` fields.

For more examples, see the documentation or sample queries in your
`;var iP=`---
applyTo: "apis/**/*.xs"
---

# Xanoscript API Query Examples

Below are some examples of API queries that can be made using Xanoscript.

## random_text_selector

## blog_posts_list

\`\`\`xs
query blog_posts verb=GET {
  description = "Returns a paginated list of all blog posts with paging and sorting capabilities. Includes author information, comment counts, and like counts for each post."
  input {
    int page?=1 {
      description = "Page number for pagination"
    }

    int per_page?=10 {
      description = "Number of items per page (max 100)"
    }

    json sort? {
      description = "External sorting configuration array with orderBy and sortBy fields"
    }
  }

  stack {
    db.query blog_post {
      sort = {blog_post.publication_date: "desc"}
      override_sort = $input.sort
      return = {
        type  : "list"
        paging: {
          page    : $input.page
          per_page: $input.per_page
          totals  : true
        }
      }

      addon = {
        items.blog_post_likes   : {
          name : "blog_post_likes"
          input: {blog_post_id: $output.id}
        }
        items.blog_post_comments: {
          name : "blog_post_comments"
          input: {blog_post_id: $output.id}
        }
        items.author            : {
          name  : "author"
          output: ["id", "name", "email", "is_active"]
          input : {user_id: $output.author_id}
        }
      }
    } as $posts
  }

  response = $posts

  history = false
}
\`\`\`

## review_by_product

\`\`\`xs
query reviews/by_product verb=GET {
  description = "Retrieve all reviews for a given product with optional minimum rating, sorted by review_date descending, and paginated."
  input {
    int product_id {
      description = "ID of the product to filter reviews"
    }

    decimal min_rating? {
      description = "Optional minimum rating to filter reviews"
    }
  }

  stack {
    debug.log {
      value = "Requester IP: " ~ $env.$remote_ip
    }

    conditional {
      if ($input.min_rating != null) {
        db.query product_reviews {
          where = $db.product_reviews.product_id == $input.product_id && $db.product_reviews.rating >= $input.min_rating
          sort = {product_reviews.review_date: "desc"}
          return = {type: "list", paging: {page: 1, per_page: 25, totals: true}}
        } as $reviews
      }

      else {
        db.query product_reviews {
          where = $db.product_reviews.product_id == $input.product_id
          sort = {product_reviews.review_date: "desc"}
          return = {type: "list", paging: {page: 1, per_page: 25, totals: true}}
        } as $reviews
      }
    }
  }

  response = $reviews

  history = 100
}
\`\`\`

## last_five_blog_posts

\`\`\`xs
// Retrieve the 5 most recent published blog posts,
// sorted by publication_date in descending order.
query posts/recent verb=GET {

  input {
  }

  stack {
    db.query blog_post {
      where = $db.blog_post.is_draft == false
      sort = {blog_post.publication_date: "desc"}
      return = {
        type  : "list"
        paging: {page: 1, per_page: 5, metadata: false}
      }
    } as $recent_posts
  }

  response = $recent_posts

  history = "inherit"
}
\`\`\`

## booking_reservation_system

\`\`\`xs
// Create a new booking reservation with availability checking and conflict resolution
query create_booking verb=POST {
  auth = "user"
  input {
    // ID of the resource to be booked
    int resource_id filters=min:1

    // Title or purpose of the booking
    text title filters=trim|min:1

    // Detailed description of the booking
    text description? filters=trim

    // When the booking should begin (ISO format)
    timestamp start_time

    // When the booking should end (ISO format)
    timestamp end_time

    // Number of people attending (default: 1)
    int attendee_count?=1 filters=min:1

    // Contact email for booking notifications
    email contact_email

    // Contact phone number (optional)
    text contact_phone? filters=trim

    // Any special requirements or requests
    text special_requests? filters=trim

    // Whether to send email confirmation (default: true)
    bool send_confirmation?=1
  }

  stack {
    precondition ($input.start_time < $input.end_time) {
      description = "Validate booking time range is logical"
      error_type = "inputerror"
      error = "Start time must be before end time."
    }

    precondition ($input.start_time > now) {
      description = "Validate booking is not in the past"
      error_type = "inputerror"
      error = "Cannot create bookings in the past."
    }

    db.query resources {
      description = "Get the resource being booked"
      where = $db.resources.id == $input.resource_id && $db.resources.is_active
      return = {type: "list"}
    } as $resource_data

    precondition (($resource_data|count) > 0) {
      description = "Validate resource exists and is active"
      error_type = "inputerror"
      error = "Resource not found or is not available for booking."
    }

    var $resource {
      description = "Store the resource record"
      value = $resource_data|first
    }

    precondition ($input.attendee_count <= $resource.capacity) {
      description = "Validate attendee count does not exceed resource capacity"
      error_type = "inputerror"
      error = "Attendee count (" ~ $input.attendee_count ~ ") exceeds resource capacity (" ~ $resource.capacity ~ ")."
    }

    db.query bookings {
      description = "Get all existing bookings for this resource to check conflicts"
      where = $db.bookings.resource_id == $input.resource_id
      return = {type: "list"}
    } as $all_bookings

    var $existing_bookings {
      description = "Filter bookings to only confirmed or pending ones"
      value = $all_bookings|filter:($this.status == "confirmed" || $this.status == "pending")
    }

    var $conflicts {
      description = "Find conflicting bookings that overlap with requested time"
      value = $existing_bookings|filter:(($this.start_time < $input.end_time) && ($this.end_time > $input.start_time))
    }

    // Ensure no time conflicts exist
    precondition (($conflicts|count) == 0) {
      error_type = "inputerror"
      error = "Time slot conflicts with existing booking. Please choose a different time."
    }

    // Calculate booking duration in hours
    var $booking_duration {
      value = ($input.end_time - $input.start_time) / 3600
    }

    // Calculate total cost based on hourly rate and duration
    var $total_cost {
      value = $booking_duration * $resource.hourly_rate
    }

    // Generate a unique booking reference code
    var $booking_reference {
      value = "BK-" ~ $input.resource_id ~ "-" ~ (now|to_timestamp) ~ "-" ~ ($auth.id|to_text)
    }

    var $initial_status {
      description = "Set initial status based on whether resource requires approval"
      value = ($resource.requires_approval == true) ? "pending" : "confirmed"
    }

    db.add bookings {
      description = "Create the new booking record"
      data = {
        resource_id      : $input.resource_id
        user_id          : $auth.id
        title            : $input.title
        description      : $input.description
        start_time       : $input.start_time
        end_time         : $input.end_time
        attendee_count   : $input.attendee_count
        contact_email    : $input.contact_email
        contact_phone    : $input.contact_phone
        status           : $initial_status
        total_cost       : $total_cost
        special_requests : $input.special_requests
        booking_reference: $booking_reference
        created_at       : now
        updated_at       : now
      }
    } as $new_booking

    conditional {
      description = "Send confirmation email if requested"
      if ($input.send_confirmation) {
        var $email_subject {
          description = "Create email subject line"
          value = "Booking Confirmation - " ~ $resource.name ~ " (" ~ $booking_reference ~ ")"
        }

        // Generate booking confirmation email body
        util.template_engine {
          value = """
            Dear Customer,

            Your booking has been {{ initial_status == 'confirmed' ? 'confirmed' : 'submitted for approval' }}.

            Booking Details:
            - Resource: {{ resource.name }}
            - Date/Time: {{ input.start_time }} - {{ input.end_time }}
            - Duration: {{ booking_duration }} hours
            - Attendees: {{ input.attendee_count }}
            - Total Cost: \${{ total_cost }}
            - Reference: {{ booking_reference }}

            Thank you for your booking!
            """
        } as $email_body

        // Send booking confirmation email
        util.send_email {
          service_provider = "resend"
          api_key = $env.secret_key
          from = "no-reply@example.com"
          to = $input.contact_email
          subject = $email_subject
          message = $email_body
        } as $confirmation_email
      }
    }

    // Prepare booking result summary
    var $booking_result {
      value = {
        booking_id: $new_booking.id
        booking_reference: $booking_reference
        resource_name: $resource.name
        status: $initial_status
        start_time: $input.start_time
        end_time: $input.end_time
        duration_hours: $booking_duration
        total_cost: $total_cost
        requires_approval: $resource.requires_approval
        confirmation_sent: $input.send_confirmation
      }
    }
  }

  response = $booking_result

  history = "all"
}
\`\`\`

## audio_transcription_endpoint

\`\`\`xs
// Upload an audio file to be transcribed using ElevenLabs API,
// store the file in cloud storage, and save transcription in the database.
query transcribe/audio verb=POST {
  auth = "user"

  input {
    // Audio file to be transcribed
    file audio

    // Target language for transcription (optional, auto-detect if not provided)
    text ?language

    // Access level for the audio file (public or private)
    text access_level?=private filters=trim
  }

  stack {
    try_catch {
      try {
        conditional {
          if ($input.access_level == "public") {
            storage.create_attachment {
              value = $input.audio
              access = "public"
              filename = $filename
              description = "Store audio in cloud storage as public"
            } as $audio_storage
          }

          else {
            return {
              value = "This function is built for public files. Please set access_level to public"
            }
          }
        }
      }

      catch {
        throw {
          name = "Audio file issue"
          value = ""
        }
      }
    }

    group {
      description = "Handle audio upload and transcription process"
      stack {
        db.get user {
          field_name = "id"
          field_value = $auth.id
          description = "Verify user exists"
        } as $user

        conditional {
          if ($user == "") {
            throw {
              name = "inputerror"
              value = "Invalid user ID provided."
            }
          }
        }

        var $allowed_audio_types {
          value = ["audio/mpeg", "audio/mp3", "audio/wav", "audio/m4a", "audio/aac", "audio/ogg", "audio/flac"]
          description = "List of allowed audio MIME types"
        }

        var $file_mime {
          value = $audio_storage.mime
          description = "MIME type of uploaded audio file"
        }

        var $file_size {
          value = $audio_storage.size
          description = "Size of uploaded audio file in bytes"
        }

        var $filename {
          value = $audio_storage.name
          description = "Original filename"
        }

        conditional {
          if ($allowed_audio_types|contains:$file_mime) {
            throw {
              name = "inputerror"
              value = "Invalid file type. Only audio files (MP3, WAV, M4A, AAC, OGG, FLAC) are allowed."
            }
          }
        }

        conditional {
          if ($file_size > 26214400) {
            throw {
              name = "inputerror"
              value = "File size too large. Maximum size is 25MB."
            }
          }
        }

        var $transcription_params {
          value = {}
          description = "Parameters for transcription request"
        }

        conditional {
          if ($input.language != "") {
            var.update $transcription_params {
              value = $transcription_params|set:"language":$input.language
            }
          }
        }

        api.request {
          url = "https://api.elevenlabs.io/v1/speech-to-text"
          method = "POST"
          params = {}|set:"file":$input.audio|set:"model_id":"scribe_v1"
          headers = []|push:"xi-api-key: " ~ $env.elevenlabs_audio_key
          timeout = 120
          verify_host = false
          verify_peer = false
          description = "Send audio to ElevenLabs for transcription"
        } as $transcription_response

        var $transcript_text {
          value = $transcription_response.response.result.text
          description = "Extracted transcript text"
        }

        var $detected_language {
          value = $transcription_response.response.result.language_code
          description = "Language detected by ElevenLabs"
        }

        var $confidence {
          value = $transcription_response.response.result.language_probability
          description = "Transcription language confidence score"
        }

        db.add audio_file {
          data = {
            created_at   : "now"
            user         : $auth.id
            filename     : $filename
            file_type    : $file_mime
            file_size    : $file_size
            transcription: $transcript_text
            status       : "completed"
            metadata     : $audio_storage
            audio_file   : $audio_storage
          }
        } as $audio_file

        var $result {
          value = {
            event: "audio_transcription_success",
            audio_id: $audio_file.id,
            user_id: $auth.id,
            filename: $filename,
            transcript_length: ($transcript_text|strlen)
          }
        }

        debug.log {
          value = {
            event: "audio_transcription_success",
            audio_id: $audio_file.id,
            user_id: $auth.id,
            filename: $filename,
            transcript_length: ($transcript_text|strlen)
          }

          description = "Log successful transcription"
        }
      }
    }
  }

  response = $result

  history = false
}
\`\`\`

## upload_image_endpoint

\`\`\`xs
query upload/image verb=POST {
  auth = "user"
  input {
    file? image
    text access_level?=public filters=trim {
      description = "Access level for the image (public or private)"
    }
  }

  stack {
    try_catch {
      try {
        conditional {
          if ($input.access_level == "private") {
            storage.create_image {
              description = "Store image in cloud storage as private"
              value = $input.image
              access = "private"
              filename = $filename
            } as $image_storage
          }

          else {
            storage.create_image {
              description = "Store image in cloud storage as public"
              value = $input.image
              access = "public"
              filename = $filename
            } as $image_storage
          }
        }
      }

      catch {
        throw {
          name = "Invalid image"
          value = $error.message
        }
      }
    }

    !debug.stop {
      value = $image_storage
    }

    try_catch {
      try {
        // List of allowed image MIME types
        var $allowed_types {
          value = ["image/jpeg", "image/jpg", "image/png", "image/gif", "image/webp"]
        }

        // MIME type of uploaded file
        var $file_mime {
          value = $image_storage.mime
        }


        // Size of uploaded file in bytes
        var $file_size {
          value = $image_storage.size
        }

        // Original filename
        var $filename {
          value = $image_storage.name
        }

        conditional {
          if ($allowed_types|contains:$file_mime) {
            throw {
              name = "ValidationError"
              value = "Invalid file type. Only JPEG, PNG, GIF, and WebP images are allowed."
            }
          }
        }

        conditional {
          if ($file_size > 10485760) {
            throw {
              name = "ValidationError"
              value = "File size too large. Maximum size is 10MB."
            }
          }
        }

        db.get user {
          description = "Verify user exists"
          field_name = "id"
          field_value = $auth.id
        } as $user

        conditional {
          if ($user == "") {
            throw {
              name = "ValidationError"
              value = "Invalid user ID provided."
            }
          }
        }

        db.add images {
          description = "Save image metadata to database"
          data = {
            created_at  : "now"
            user_id     : $auth.id
            filename    : $filename
            file_type   : $file_mime
            file_size   : $file_size
            image_url   : $image_storage.path
            access_level: $input.access_level
            is_active   : true
            image_meta  : $image_storage
          }
        } as $image_record
      }

      catch {
        debug.log {
          description = "Log upload failure"
          value = "Image upload failed:"|concat:$error.message:" "
        }
      }
    }
  }

  response = {
    success  : true
    image_id : $image_record.id
    image_url: $image_storage.path
  }

  history = "inherit"
}
\`\`\`

## retrieve_active_user_profile

\`\`\`xs
query user_profile verb=GET {
  description = "API endpoint to retrieve active user profile details based on user_id"

  input {
    int user_id {
      description = "Unique identifier for the user"
    }
  }

  stack {
    db.query user {
      description = "Retrieve active user profile details"
      where = $db.user.id == $input.user_id && $db.user.is_active
      return_single = {}
      mock "should return active profile" {
        value = {id: 7, user: 42, full_name: "Jane Doe", email: "jane@example.com", is_active: true}
      }
      mock "should return null for inactive" {
        value = null
      }
    } as $profile
  }
  response = $profile

  history = 10000

  test "should return active profile" {
    input = {user_id: 42}
    expect.to_equal $response {
      value = {id: 7, user: 42, full_name: "Jane Doe", email: "jane@example.com", is_active: true}
    }
  }

  test "should return null for inactive" {
    input = {user_id: 99}
    expect.to_be_null $response
  }
}
\`\`\`

## blog_posts_by_user

\`\`\`xs
query blog_posts_by_user verb=GET {
  description = "list all post by a given user and the number of comments and likes it received"
  auth = "user"
  input {
  }

  stack {
    db.query blog_post {
      where = $db.blog_post.author_id == $auth.id
      sort = {blog_post.publication_date: "desc"}
      return = {type: "list", paging: {page: 1, per_page: 25, totals: true}}
      addon = {
        items.blog_post_likes   : {
          name : "blog_post_likes"
          input: {blog_post_id: $output.id}
        }
        items.blog_post_comments: {
          name : "blog_post_comments"
          input: {blog_post_id: $output.id}
        }
      }
    } as $posts
  }

  response = $posts

  history = "inherit"
}
\`\`\`

## notification_system_endpoint

\`\`\`xs
query send_notification verb=POST {
  description = "Sends notifications to users via multiple channels (push, email, SMS). It validates input, checks user notification preferences, routes to appropriate external services, tracks delivery status, and logs all notification attempts with their outcomes."
  input {
    int user_id
    text notification_type {
      description = "Type of notification: push, email, sms"
    }

    text title filters=trim {
      description = "Notification title"
    }

    text message filters=trim {
      description = "Notification message content"
    }

    json data {
      description = "Additional notification data"
    }

    bool force? {
      description = "Force send even if user has disabled this notification type"
    }
  }

  stack {
    debug.log {
      description = "Log notification attempt start"
      value = "Starting notification send for user " ~ $input.user_id
    }

    precondition ($input.notification_type == "push" || $input.notification_type == "email" || $input.notification_type == "sms") {
      description = "Validate that notification type is one of the three supported types"
      error_type = "inputerror"
      error = "Invalid notification type. Must be: push, email, or sms"
    }

    precondition (($input.title|strlen) > 0) {
      description = "Ensure the notification title is not empty"
      error_type = "inputerror"
      error = "Notification title is required"
    }

    db.query notification_preference {
      description = "Check user notification preferences"
      where = $db.notification_preference.user_id == $input.user_id && $db.notification_preference.notification_type == $input.notification_type
      return = {type: "list"}
    } as $user_preferences

    conditional {
      description = "If no preferences exist, create default preferences with notifications enabled. Otherwise, get the user's enabled status from existing preferences"
      if (($user_preferences|count) == 0) {
        db.add notification_preference {
          description = "Create default notification preference"
          data = {
            user_id          : $input.user_id
            notification_type: $input.notification_type
            enabled          : true
            preferences      : "{}"
          }
        } as $new_preference

        var $user_enabled {
          value = true
        }
      }

      elseif ($input.notification_type == "asdfasdf") {
      }

      else {
        var $user_enabled {
          value = ($user_preferences|first).enabled
        }
      }
    }

    conditional {
      description = "Set up different API calls based on notification type"
      if ($input.notification_type == "push") {
        api.request {
          description = "Sample API call"
          url = "https://mandrillapp.com/api/1.0/messages/send"
          method = "POST"
          params = {}|set:"key":$env.your_api_key|set:"message":({}|set:"from_email":"you@yourdomain.com"|set:"from_name":"Your Name"|set:"subject":"Test Transactional Email"|set:"text":"Hello, this is a transactional email!"|set:"to":([]|push:({}|set:"email":"recipient@example.com"|set:"name":"Recipient Name"|set:"type":"to")))
          headers = []|push:"Content-Type: application/json"
        } as $api_endpoint
      }

      elseif ($input.notification_type == "email") {
        api.request {
          description = "Sample API call"
          url = "https://mandrillapp.com/api/1.0/messages/send"
          method = "POST"
          params = {}|set:"key":$env.your_api_key|set:"message":({}|set:"from_email":"you@yourdomain.com"|set:"from_name":"Your Name"|set:"subject":"Test Transactional Email"|set:"text":"Hello, this is a transactional email!"|set:"to":([]|push:({}|set:"email":"recipient@example.com"|set:"name":"Recipient Name"|set:"type":"to")))
          headers = []|push:"Content-Type: application/json"
        } as $api_endpoint
      }

      elseif ($input.notification_type == "sms") {
        api.request {
          description = "Sample API call"
          url = "https://api.twilio.com/2010-04-01/Accounts/ACXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX/Messages"
          method = "POST"
          params = {}|set:"To":" 1234567890"|set:"From":" 1987654321"|set:"Body":"Hello from Twilio!"
          headers = []|push:("Authorization: Basic %s"|sprintf:("ACXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX:your_auth_token"|base64_encode))
        } as $api_endpoint
      }
    }

    conditional {
      description = "Skip user if not enabled AND force send is false"
      if ($user_enabled == false && $input.force == false) {
        var $status_result {
          value = "skipped"
        }

        var $external_ref {
          value = ""
        }

        debug.log {
          value = "Skipped user"
        }
      }
    }

    conditional {
      description = "Process the API response and set status"
      if ($api_response.status_code >= 200 && $api_response.status_code < 300) {
        var $status_result {
          value = "sent"
        }

        var $external_ref {
          value = $api_response.body.id
        }
      }

      elseif ($status_result == "skipped") {
        debug.log {
          value = "Status already set above, do nothing"
        }
      }

      else {
        var $status_result {
          value = "failed"
        }

        var $external_ref {
          value = ""
        }
      }
    }

    db.add notification_log {
      description = "Log the notification attempt to the database"
      data = {
        created_at       : "now"
        user_id          : $input.user_id
        notification_type: $input.notification_type
        title            : $input.title
        message          : $input.message
        response_data    : $api_endpoint
      }
    } as $notification_log
  }

  response = null

  history = 1000
}
\`\`\`

## products_search_endpoint

Searches products with optional filters and pagination. Notice how the \`category_id\` filter is optional and the search term will be ignored if not provided (thanks to the operator \`==?\`).

\`\`\`xs
query products/search verb=GET {
  input {
    text search_term? filters=trim {
      description = "Search term to match against product name and description"
    }

    int category_id? filters=min:0 {
      description = "Optional category ID to filter products"
    }

    int page?=1 filters=min:1 {
      description = "Page number for pagination (starts at 1)"
    }

    int per_page?=20 filters=min:1|max:100 {
      description = "Number of items per page (max 100)"
    }
  }

  stack {
    db.query product {
      description = "Search products with filters and pagination"
      where = $db.product.category_id ==? $input.category_id && ($db.product.name includes? $input.search_term || $db.product.description includes? $input.search_term)
      sort = {product.price: "asc"}
      return = {type: "list"}
    } as $products
  }

  response = $products

  history = "inherit"
}
\`\`\`

## signup_endpoint

\`\`\`xs
query auth/signup verb=POST {
  description = "Signup and retrieve an authentication token"
  input {
    text name? {
      description = "User's name (optional)"
    }

    email email? {
      description = "User's email address (required for signup)"
      sensitive = true
    }

    text password? {
      description = "User's password (required for signup)"
      sensitive = true
    }
  }

  stack {
    db.get user {
      description = "Check if a user with this email already exists"
      field_name = "email"
      field_value = $input.email
    } as $user

    precondition ($user == null) {
      description = "Prevent duplicate signup with the same email"
      error_type = "accessdenied"
      error = "This account is already in use."
    }

    db.add user {
      description = "Create a new user record with provided details"
      data = {
        created_at: "now"
        name      : $input.name
        email     : $input.email
        password  : $input.password
      }
    } as $user

    security.create_auth_token {
      description = "Generate an authentication token for the new user"
      table = "user"
      extras = {}
      expiration = 86400
      id = $user.id
    } as $authToken
  }

  response = {authToken: $authToken}

  history = 1000
}
\`\`\`

## search_users_endpoint

\`\`\`xs
query users verb=GET {
  auth = "user"
  input {
    text filter
  }

  stack {
    // Search users whose names include the filter string, sorted by name ascending
    db.query user {
      where = $db.user.name includes $input.filter
      sort = {user.name: "asc"}
      return = {type: "list"}
    } as $users
  }

  response = $users

  history = "inherit"
}
\`\`\`

\`\`\`xs
query webhook_receiver verb=POST {
  input {
    text webhook_id
    text signature?
  }

  stack {
    util.get_input {
      encoding = "json"
    } as $payload_data

    conditional {
      if ($payload_data.body.event_type == "user.created") {
        db.add webhook_logs {
          data = {
            webhook_id  : $input.webhook_id
            event_type  : "user.created"
            status      : "processed"
            payload     : $payload_data
            signature   : $input.signature
            user_id     : $payload_data.body.user.id
            received_at : now
            processed_at: now
            retry_count : 0
            max_retries : 3
          }
        } as $webhook_record
      }

      elseif ($payload_data.body.event_type == "payment.completed") {
        db.add webhook_logs {
          data = {
            webhook_id  : $input.webhook_id
            event_type  : "payment.completed"
            status      : "processed"
            payload     : $payload_data
            signature   : $input.signature
            payment_id  : $payload_data.payment.id
            amount      : $payload_data.payment.amount
            received_at : now
            processed_at: now
            retry_count : 0
            max_retries : 3
          }
        } as $webhook_record
      }

      else {
        db.add webhook_logs {
          data = {
            webhook_id  : $input.webhook_id
            event_type  : $payload_data.event_type
            status      : "processed"
            payload     : $payload_data
            signature   : $input.signature
            received_at : now
            processed_at: now
            retry_count : 0
            max_retries : 3
          }
        } as $webhook_record
      }
    }
  }

  response = {
    webhook_processed: true
    message          : "Webhook processed successfully"
    webhook_id       : $input.webhook_id
    event_type       : $payload_data.body.event_type
  }

  history = 100
}
\`\`\`

\`\`\`
query list_orders verb=GET {
  description = "Display all the order in a html table view"
  input {
    // Year to filter orders by (default: current year)
    int year?=2025
  }

  stack {
    var $start_of_year {
      description = "Start of the year for filtering"
      value = $input.year ~ "-01-01T00:00:00.000-08:00"
    }

    var $end_of_year {
      description = "End of the year for filtering (exclusive)"
      value = ($input.year + 1) ~ "-01-01T00:00:00.000-08:00"
    }

    db.query orders {
      where = $db.orders.order_date >= $start_of_year && $db.orders.order_date < $end_of_year
      return = {type: "list"}
      addon = {
        _customer: {
          name : "customer"
          input: {customer_id: $output.customer_id}
        }
      }
    } as $orders

    util.template_engine {
      description = "Initialize HTML output with table structure"
      value = """
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Order List</title>
            <!-- Bootstrap CSS CDN -->
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        </head>
        <body>
            <div class="container mt-5">
                <h1 class="mb-4">Customer Orders</h1>

                {% if $var.orders is defined and $var.orders|length > 0 %}
                <table class="table table-striped table-bordered table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th scope="col">Order ID</th>
                            <th scope="col">Customer Address</th>
                            <th scope="col">Product Name</th>
                            <th scope="col">Price</th>
                            <th scope="col">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in $var.orders %}
                        <tr>
                            <td>{{ order.id }}</td>
                            <td>{{ order._customer.street_address }}{% if order._customer.city %}, {{ order._customer.city }}{% endif %}{% if order._customer.zip_code %}, {{ order._customer.zip_code }}{% endif %}</td>
                            <td>{{ order.product_name }}</td>
                            <td>\${{ order.order_total|number_format(2) }}</td>
                            <td><span class="badge bg-{% if order.status == 'completed' %}success{% elseif order.status == 'pending' %}warning{% else %}danger{% endif %}">{{ order.status|capitalize }}</span></td>

                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="alert alert-info" role="alert">
                    No orders found.
                </div>
                {% endif %}

            </div>

            <!-- Bootstrap JS and Popper.js CDN (optional, for interactive components) -->
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
        </body>
        </html>
        """
    } as $html_output

    util.set_header {
      value = "Content-Type: text/html; charset=utf-8"
      duplicates = "replace"
    }
  }

  response = $html_output

  history = "inherit"
}
\`\`\`
`;var sP=`---
applyTo: "tables/*.xs"
---

# How to Define Tables in XanoScript

A **table** in XanoScript defines the structure of a database table, including its fields, types, relationships, and indexes. Tables are created in the \`tables\` folder and are essential for organizing and storing data in your application.

## Built-in tables

Most of the time, a \`user\` table with user name, email, and password (hashed) will already be present in the Xano workspace (\`tables/<table_id>_user.xs\`), and is already used by the authentication system. You can customize it by adding fields to it, indexes, and relationships as needed.

## Table Structure

A table file consists of:

- The table name (e.g., \`order\`, \`product\`)
- A \`schema\` block listing all fields and their properties
- An \`index\` block for efficient querying
- Optional \`auth\`, indicating that this table can be used for authentication by an API endpoint, meaning the \`id\` contained in the auth token can be matched against the \`id\` field in this table (usually this is only set for a \`user\` table)

## Example Table

!!! IMPORTANT !!!
EACH TABLE SHOULD HAVE AN \`id\` FIELD, THIS IS THE PRIMARY KEY, IT CAN EITHER BE AN INT OR A UUID, IT SHOULD BE NAMED \`id\` AND IT SHOULD BE THE PRIMARY KEY.
!!! IMPORTANT !!!

The following xanoscript would be stored in \`tables/user.xs\`

\`\`\`xs
table shopping_cart_items {
  auth = false
  schema {
    int id {
      description = "Unique identifier for the cart item"
    }

    int user_id {
      table = "user"
      description = "ID of the user who owns the cart"
    }

    int product_id {
      table = "product"
      description = "ID of the product added to the cart"
    }

    int quantity filters=min:0 {
      description = "Quantity of the product in the cart (non-negative)"
    }

    decimal unit_price filters=min:0 {
      description = "Unit price of the product (non-negative)"
    }

    timestamp last_updated?=now {
      description = "Timestamp of the last update to the cart item"
    }
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {
      type : "btree"
      field: [{name: "user_id"}, {name: "product_id"}]
    }
  ]
}
\`\`\`

## Field Types

Supported types for table columns include:

- \`int\` (integer)
- \`text\`
- \`email\`
- \`password\`
- \`decimal\`
- \`bool\`
- \`timestamp\`
- \`date\`
- \`uuid\`
- \`vector\`
- \`json\`
- \`image\`
- \`video\`
- \`audio\`
- \`attachment\`
- \`enum\`

## Field Options

Each field can have:

- **Optional status**: Add \`?\` for optional fields, e.g., \`text nickname?\`
- **Default value**: Use \`?=value\`, e.g., \`timestamp created_at?=now\`
- **Filters**: Process input, e.g., \`filters=trim|lower\`
- **Metadata**: Add \`description\` or \`sensitive\` for documentation and privacy
- **Relationships**: Reference another table with \`table\`, e.g., \`int user_id { table = "user" }\`

## Indexes

Indexes improve query performance and enforce uniqueness. Common types:

- \`primary\`: Main identifier (usually \`id\`)
- \`btree\`: Standard index, can be unique
- \`gin\`: For JSON or array fields
- \`unique\`: Ensures values are not duplicated

**Example:**

\`\`\`xs
index = [
  {type: "primary", field: [{name: "id"}]}
  {type: "btree|unique", field: [{name: "email", op: "asc"}]}
]
\`\`\`

## Best Practices

- Use \`description\` for every field to document its purpose.
- Mark sensitive fields with \`sensitive = true\`.
- Use filters to clean and normalize data.
- Define indexes for fields that are searched or must be unique.
- Reference related tables using \`table\` for foreign keys.

## Summary

- Place tables in the \`tables\` folder.
- Use the \`schema\` block for fields and types.
- Add \`index\` for performance and uniqueness.
- Use metadata and filters for clarity and data integrity.
- Reference other tables for relationships.
- Use \`auth = true\` for tables used in authentication, for most table use cases, this should be set to \`false\`.

For more examples, see the documentation or sample tables in your
`;var oP=`---
applyTo: "tables/*.xs"
---

# Xanoscript Table Examples

Below are some examples of tables defined in Xanoscript.

## inventory_management_table

\`\`\`xs
table inventory_item {
  auth = false
  schema {
    uuid id {
      description = "Unique identifier for the inventory item"
    }

    text name filters=trim {
      description = "Name of the inventory item"
    }

    text description filters=trim {
      description = "Detailed description of the inventory item"
      sensitive = true
    }

    decimal price? filters=min:0 {
      description = "Price of the inventory item in decimal format"
    }

    int stock_quantity? filters=min:0 {
      description = "Current quantity of the item in stock"
    }

    int[] category_ids {
      table = "category"
      description = "Foreign key reference to the product categories"
    }

    timestamp last_updated?=now {
      description = "Timestamp when the inventory record was last updated"
    }

    timestamp created_at?=now {
      description = "Timestamp when the inventory item was created"
    }

    json item_properties? {
      description = "Additional properties stored as JSON (color, size, weight, etc.)"
    }

    text sku filters=trim {
      description = "Stock Keeping Unit - unique product identifier"
    }

    decimal cost? filters=min:0 {
      description = "Cost price of the item for internal calculations"
    }

    int reorder_level? filters=min:0 {
      description = "Minimum stock level that triggers reorder alerts"
    }

    bool is_active?=1 {
      description = "Indicates whether the item is currently active in inventory"
    }

    text supplier_name? filters=trim {
      description = "Name of the primary supplier for this item"
    }

    text location? filters=trim {
      description = "Physical location/warehouse section where item is stored"
    }
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "btree|unique", field: [{name: "name", op: "asc"}]}
    {type: "btree|unique", field: [{name: "sku", op: "asc"}]}
    {type: "btree", field: [{name: "stock_quantity", op: "asc"}]}
    {type: "btree", field: [{name: "last_updated", op: "desc"}]}
    {type: "btree", field: [{name: "is_active", op: "asc"}]}
    {type: "gin", field: [{name: "item_properties"}]}
    {type: "btree", field: [{name: "reorder_level", op: "asc"}]}
  ]
}
\`\`\`

## shopping_cart_items_table

\`\`\`xs
table shopping_cart_items {
  auth = false
  schema {
    int id {
      description = "Unique identifier for the cart item"
    }

    int user_id {
      table = "user"
      description = "ID of the user who owns the cart"
    }

    int product_id {
      table = "product"
      description = "ID of the product added to the cart"
    }

    int quantity filters=min:0 {
      description = "Quantity of the product in the cart (non-negative)"
    }

    decimal unit_price filters=min:0 {
      description = "Unit price of the product (non-negative)"
    }

    timestamp last_updated?=now {
      description = "Timestamp of the last update to the cart item"
    }
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {
      type : "btree"
      field: [{name: "user_id"}, {name: "product_id"}]
    }
  ]
}
\`\`\`

## weekly_slack_pets_prompt

\`\`\`xs
table slack_prompts {
  auth = false
  schema {
    int id {
      description = "Identifier for the Slack prompt"
    }

    text prompt filters=trim {
      description = "The Slack prompt message to be sent"
    }

    bool is_used? {
      description = "Boolean flag indicating whether this prompt has been used"
    }

    text gif_url filters=trim {
      description = "URL of the GIF file to be sent with the prompt"
    }

    timestamp created_at?=now {
      description = "Timestamp when the prompt was created"
    }

    timestamp used_at? {
      description = "Timestamp when the prompt was last used"
    }

    enum type? {
      values = ["pets"]
    }
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "btree", field: [{name: "is_used", op: "asc"}]}
    {type: "btree", field: [{name: "created_at", op: "desc"}]}
  ]
}
\`\`\`

## orders_table

\`\`\`xs
table orders {
  auth = false
  schema {
    uuid id {
      description = "Unique identifier for the order"
    }

    decimal order_total filters=min:0 {
      description = "Total amount for the order"
    }

    timestamp order_date?=now {
      description = "Date and time when the order was placed"
    }

    bool is_fulfilled? {
      description = "Indicates whether the order has been fulfilled"
    }

    int customer_id? {
      table = "customer"
    }

    enum order_status? {
      values = [
        "draft"
        "confirmed"
        "fulfilling"
        "shipping"
        "delivered"
        "returned"
      ]
    }
  }

  index = [{type: "primary", field: [{name: "id"}]}]
}
\`\`\`

## payment_transaction

\`\`\`xs
table payment_transactions {
  description = "Table to store payment transaction details"
  auth = false
  schema {
    int id {
      description = "Unique identifier for the transaction"
    }

    uuid ?order_id? {
      table = "orders"
      description = "Associated order ID"
    }

    text[] logs {
      description = "Array of logs or comments related to the transaction"
    }

    int customer_id {
      table = "user"
      description = "Customer ID related to the transaction"
    }

    decimal amount filters=min:0 {
      description = "Transaction amount"
    }

    text payment_method filters=trim {
      description = "Payment method used (e.g., credit card, PayPal)"
    }

    enum transaction_status {
      values = ["completed", "pending", "failed"]
      description = "Current status of the transaction (e.g., completed, pending)"
    }

    timestamp transaction_date?=now {
      description = "Date and time of the transaction"
    }

    json payment_gateway_metadata {
      description = "Metadata from the payment gateway"
      sensitive = true
    }
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "btree", field: [{name: "order_id", op: "asc"}]}
  ]
}
\`\`\`

## blog_post_table

\`\`\`xs
table blog_post {
  auth = false
  schema {
    uuid id {
      description = "Unique identifier for the blog post"
    }

    text title filters=trim {
      description = "Title of the blog post"
    }

    text content filters=trim {
      description = "Main content/body of the blog post"
      sensitive = true
    }

    text[] tags {
      description = "Array of tags associated with the blog post"
    }

    int author_id {
      table = "user"
      description = "ID of the author who created the blog post"
    }

    timestamp ?publication_date?=now {
      description = "Date and time when the blog post was published"
    }

    json tags? {
      description = "Array of tags associated with the blog post for categorization"
    }

    bool is_draft?=1 {
      description = "Indicates whether the blog post is in draft status (not published)"
    }

    timestamp created_at?=now {
      description = "Timestamp when the blog post was created"
    }

    timestamp updated_at? {
      description = "Timestamp when the blog post was last updated"
    }

    text slug filters=trim {
      description = "URL-friendly version of the title for SEO purposes"
    }

    int view_count? {
      description = "Number of times the blog post has been viewed"
    }
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "btree", field: [{name: "author_id", op: "asc"}]}
    {
      type : "btree"
      field: [{name: "publication_date", op: "desc"}]
    }
    {type: "btree|unique", field: [{name: "slug", op: "asc"}]}
    {type: "btree", field: [{name: "is_draft", op: "asc"}]}
  ]
}
\`\`\`

## table_for_user_profile

\`\`\`xs
table user_profile {
  description = "Table to store user profiles for a social networking platform"
  auth = false
  schema {
    int id {
      description = "Unique user ID"
    }

    text full_name filters=trim {
      description = "User's full name"
    }

    email email filters=trim|lower {
      description = "User's email address"
      sensitive = true
    }

    text profile_picture_url filters=trim {
      description = "URL of the user's profile picture"
    }

    timestamp registration_date?=now {
      description = "Date and time the user registered"
    }

    bool is_active?=1 {
      description = "Indicates if the user is active"
    }

    int user? {
      table = "user"
      description = "A reference to the associated user account."
    }
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "btree|unique", field: [{name: "email", op: "asc"}]}
    {
      type : "btree"
      field: [{name: "registration_date", op: "desc"}]
    }
    {type: "btree|unique", field: [{name: "user", op: "asc"}]}
  ]
}
\`\`\`

## product_reviews

\`\`\`xs
table product_reviews {
  auth = false
  schema {
    int id {
      description = "Unique identifier for the review"
    }

    int rating filters=min:1|max:5 {
      description = "Rating given by the customer (1 to 5)"
    }

    text review_text filters=trim {
      description = "Text of the review provided by the customer"
      sensitive = true
    }

    timestamp review_date?=now {
      description = "Date and time when the review was submitted"
    }

    bool is_verified? {
      description = "Indicates whether the review is verified"
    }

    json metadata {
      description = "Additional metadata for the review (e.g., tags)"
    }

    int product_id {
      table = "product"
    }

    int customer_id {
      table = "customer"
      description = "Author of the review"
    }
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "btree", field: [{name: "product_id", op: "asc"}]}
    {type: "btree", field: [{name: "customer_id", op: "asc"}]}
  ]
}
\`\`\`

## user_analytics_endpoint

\`\`\`xs
table user_activity {
  auth = false
  schema {
    int id
    int user_id
    text action_type
    text action_details?
    text session_id
    timestamp session_start_time?
    timestamp session_end_time?
    int session_duration?
    text page_url?
    text referrer_url?
    text user_agent?
    text ip_address?
    text device_type?
    text browser?
    text country?
    text region?
    text city?
    timestamp created_at?=now
    timestamp updated_at?=now
    int page_load_time?
    json metadata?
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "btree", field: [{name: "user_id", op: "asc"}]}
    {type: "btree", field: [{name: "session_id", op: "asc"}]}
    {type: "btree", field: [{name: "action_type", op: "asc"}]}
    {type: "btree", field: [{name: "created_at", op: "desc"}]}
    {
      type : "btree"
      field: [
        {name: "user_id", op: "asc"}
        {name: "created_at", op: "desc"}
      ]
    }
  ]
}
\`\`\`

## survey_form_builder_system

\`\`\`xs
table surveys {
  auth = false
  schema {
    int id {
      description = "Unique identifier for the survey"
    }

    text title filters=trim {
      description = "Survey title displayed to respondents"
    }

    text description? {
      description = "Optional survey description or instructions"
    }

    enum status? {
      values = ["draft", "active", "closed", "archived"]
      description = "Survey status - draft, active, closed, or archived"
    }

    json settings? {
      description = "Survey settings like anonymous responses, deadline, etc."
    }

    timestamp created_at?=now {
      description = "When the survey was created"
    }

    timestamp updated_at?=now {
      description = "When the survey was last updated"
    }

    int created_by? {
      description = "ID of user who created the survey"
    }
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "btree", field: [{name: "status", op: "asc"}]}
    {type: "btree", field: [{name: "created_by", op: "asc"}]}
    {type: "btree", field: [{name: "created_at", op: "desc"}]}
  ]
}
\`\`\`

## product_table

\`\`\`xs
table product {
  auth = false
  schema {
    int id {
      description = "Unique product ID"
    }

    text name filters=trim {
      description = "Product name"
    }

    text description filters=trim {
      description = "Detailed product description"
    }

    decimal price? filters=min:0 {
      description = "Product price (non-negative)"
    }

    int stock_quantity? filters=min:0 {
      description = "Available stock quantity (non-negative)"
    }

    int category_id filters=min:0 {
      description = "Category ID for product classification"
    }

    text sku filters=trim {
      description = "Stock-keeping unit (unique identifier)"
      sensitive = true
    }

    timestamp created_at?=now {
      description = "Timestamp of product creation"
    }

    int in_cart?
  }

  index = [
    {type: "primary", field: [{name: "id"}]}
    {type: "btree", field: [{name: "category_id", op: "asc"}]}
    {type: "btree|unique", field: [{name: "sku", op: "asc"}]}
  ]
}
\`\`\`
`;var aP=`---
applyTo: "tasks/*.xs"
---

# How to Define Tasks in XanoScript

A **task** in XanoScript is a scheduled job that automates operations at specific times or intervals. Tasks are created in the \`tasks\` folder and are ideal for recurring jobs like data cleanup, report generation, or sending notifications.

## Task Structure

A task file consists of:

- The task name (e.g., \`daily_report\`, \`cleanup_expired_sessions\`)
- An optional \`description\` field
- A \`stack\` block containing the logic to execute
- A \`schedule\` block specifying when the task runs

## Example Task

The following task would be stored in \`tasks/daily_sales_report.xs\`

\`\`\`xs
task daily_sales_report {
  description = "Generate a daily sales report at 11 PM UTC"
  stack {
    db.query payment_transactions {
      description = "Get all transactions from the past 24 hours"
      where = $db.payment_transactions.transaction_date >= (now|transform_timestamp:"24 hours ago":"UTC")
    } as $daily_sales

    var $transaction_count {
      value = $daily_sales|count
      description = "Count number of transactions"
    }

    var $total_sales {
      value = ($daily_sales[$$].amount)|sum
      description = "Calculate total sales amount"
    }

    db.add reports {
      data = {
        report_type      : "daily_sales"
        report_date      : now
        total_sales      : $total_sales
        transaction_count: $transaction_count
      }
      description = "Insert daily sales report"
    } as $report_result

    debug.log {
      value = "Daily sales report generated"
      description = "Log report generation"
    }
  }

  schedule = [{starts_on: 2026-05-01 23:00:00+0000, freq: 86400}]
}
\`\`\`

## Stack Block

The \`stack\` block contains the sequence of actions to perform, such as:

- Database queries (\`db.query\`, \`db.add\`, \`db.edit\`, etc.)
- Variable declarations (\`var\`)
- Control flow (\`foreach\`, \`conditional\`)
- Logging (\`debug.log\`)
- API calls (\`api.request\`)

## Schedule Block

The \`schedule\` block defines when the task runs. It uses an \`events\` array with:

- \`starts_on\`: Start date and time (e.g., \`2026-05-01 23:00:00+0000\`)
- \`freq\`: Frequency in seconds (e.g., \`86400\` for daily)
- \`ends_on\`: Optional end date

**Example:**

\`\`\`xs
schedule {
  events = [
    {starts_on: 2026-05-01 23:00:00+0000, freq: 86400}
  ]
}
\`\`\`

## Best Practices

- Use \`description\` fields to document the purpose of your task and each block.
- Place all logic inside the \`stack\` block.
- Use the \`schedule\` block to automate execution.
- Use logging (\`debug.log\`) to track task execution and outcomes.

## Summary

- Place tasks in the \`tasks\` folder.
- Use the \`stack\` block for job logic.
- Use the \`schedule\` block for timing.
- Document your task with \`description\` fields.

For more examples, see the documentation or sample tasks in your
`;var cP=`---
applyTo: "tasks/*.xs"
---

# Xanoscript Task Examples

Below are some examples of tasks defined in Xanoscript.

## deactivate_user_profile_task

\`\`\`xs
task deactivate_inactive_profiles {
  description = "Deactivate user profiles for users who have not had session activity in the past 30 days. This task runs monthly."
  stack {
    var $current_time {
      value = now
      description = "Get the current timestamp for comparison"
    }

    var $threshold_time {
      value = $current_time - (30 * 86400 * 1000)
      description = "Calculate the timestamp for 30 days ago"
    }

    db.query sessions {
      description = "Find users with no session activity in the past 30 days"
      where = $db.sessions.last_activity < $threshold_time
      output = ["id", "user_id", "is_active"]
    } as $inactive_users

    foreach ($inactive_users) {
      each as $user {
        db.edit user_profile {
          field_name = "id"
          field_value = $user.user_id
          data = {is_active: false}
          description = "Deactivate user profile"
        } as $user_profile

        debug.log {
          value = "Deactivated user profile with ID: " ~ $var.user_profileuser.user_id
          description = "Log individual profile deactivation"
        }
      }
    }

    debug.log {
      value = "Profile deactivation task completed. Total profiles deactivated: " ~ $inactive_users|count
      description = "Log successful task completion"
    }
  }

  schedule = [{starts_on: 2025-07-01 00:00:00+0000, freq: 2592000}]

  history = "inherit"
}
\`\`\`

## cleanup_expired_sessions_task

\`\`\`xs
task cleanup_expired_sessions {
  description = "Clean up expired sessions from the sessions table every 6 hours starting Feb 1, 2026. This task deletes expired sessions and logs the number of deletions for monitoring purposes."
  stack {
    var $current_time {
      value = now
      description = "Get the current timestamp for comparison"
    }

    db.query sessions {
      description = "Count expired sessions before deletion"
      where = $db.sessions.expires_at < $current_time && $db.sessions.is_active
    } as $expired_sessions

    var $expired_count {
      value = $expired_sessions|count
      description = "Count of expired sessions to be deleted"
    }

    var $total_deletions {
      value = 0
      description = "Track the total number of sessions deleted"
    }

    debug.log {
      value = "Found " ~ $expired_count ~ " expired sessions for cleanup"
      description = "Log count of sessions found for deletion"
    }

    foreach ($expired_sessions) {
      each as $session {
        db.del sessions {
          field_name = "id"
          field_value = $session.id
          description = "Delete expired session"
        }

        math.add $total_deletions {
          value = 1
          description = "Increment deletion counter"
        }

        debug.log {
          value = "Deleted session with ID: " ~ $session.id
          description = "Log individual session deletion"
        }
      }
    }

    debug.log {
      value = "Session cleanup completed. Total sessions deleted: " ~ $total_deletions
      description = "Log successful cleanup completion"
    }
  }

  schedule = [{starts_on: 2026-02-01 00:00:00+0000, freq: 21600}]

  history = 1000
}
\`\`\`

## slack_prompts_gif_finder

\`\`\`xs
task slack_prompts_gif_finder {
  description = "Find and populate GIF URLs for Slack prompts using AI completion"
  stack {
    debug.log {
      value = "Starting GIF URL population task"
      description = "Log task start"
    }

    db.query slack_prompts {
      description = "Retrieve prompts that are missing a GIF URL"
      where = $db.slack_prompts.gif_url == "" && $db.slack_prompts.prompt != ""
    } as $prompts_without_gifs

    debug.log {
      value = {
        count: ($prompts_without_gifs|count)
      }

      description = "Log prompts found"
    }

    conditional {
      description = "Process if prompts exist"
      if (($prompts_without_gifs|count) > 0) {
        var $processed {
          value = 0
        }

        foreach ($prompts_without_gifs) {
          each as $prompt {
            util.template_engine {
              value = """
                Based on the following Slack message, suggest a single search query of 2-3 words for finding a funny GIF on Giphy. Your response should *ONLY* include the search term. Do not included any other explanation in your response.

                Message:
                {{$prompt.prompt}}
                """

              description = "Gemini Prompt"
            } as $ai_request

            var $search_term {
              value = "cute dog"
              description = "Set the fallback search term"
            }

            try_catch {
              description = "Get AI suggestion"
              try {
                function.run "ai/Gemini: Simple Chat Completion" {
                  description = "Use Gemini to convert the Slack prompt into a search term for Giphy"
                  input = {model: "gemini-2.5-flash", message: $ai_request}
                } as $ai_result

                var.update $search_term {
                  value = $ai_result
                }
              }

              catch {
                debug.log {
                  value = "AI request failed, using fallback"
                  description = "Log AI failure"
                  errorCode = $error.code
                  errorMessage = $error.message
                }
              }
            }

            try_catch {
              description = "Search Giphy"
              try {
                api.request {
                  url = "https://api.giphy.com/v1/gifs/search"
                  method = "GET"
                  params = {
                    api_key: $env.giphy_key
                    q: $search_term
                    limit: 1
                    rating: "g"
                  }

                  verify_host = false
                  verify_peer = false
                  description = "Giphy search"
                } as $gif_result

                var.update $gif_result {
                  value = $gif_result.response.result
                }

                conditional {
                  description = "Update if GIF found"
                  if (($gif_result.data|count) > 0) {
                    var $gif_url {
                      value = ($gif_result.data|first).images.original.url
                    }

                    db.edit slack_prompts {
                      field_name = "id"
                      field_value = $prompt.id
                      data = {gif_url: $gif_url}
                      description = "Update the GIF URL and updated_at for the prompt"
                    } as $updated_record

                    debug.log {
                      value = {
                        id: $var.updated_record.id
                        gif_url: $var.updated_record.gif_url
                      }

                      description = "GIF URL added"
                    }
                  }
                }
              }

              catch {
                debug.log {
                  value = {
                    id: $var.updated_record.id
                    error: "Giphy search failed"
                    errorCode = $error.code
                    errorMessage = $error.message
                  }

                  description = "Giphy error"
                }
              }
            }

            var.update $processed {
              value = $var.processed + 1
              description = "Increment the processed counter"
            }
          }
        }

        debug.log {
          value = {
            processed: $var.processed
          }

          description = "Processing complete"
        }
      }

      else {
        debug.log {
          value = "No prompts need GIFs"
          description = "Nothing to process"
        }
      }
    }

    debug.log {
      value = "Task completed"
      description = "Task end"
    }
  }

  schedule = [{starts_on: 2026-01-14 09:00:00+0000, freq: 86400}]

  history = "inherit"
}
\`\`\`

## scheduled_end_of_month_task

\`\`\`xs
task end_of_month_task {
  stack {
    var $timezone {
      value = "UTC"
      description = "Set Timezone"
    }

    var $now {
      value = now
    }

    var $today {
      value = $now|format_timestamp:"Y-m-d":$timezone
      description = "Today"
    }

    var $end_of_month {
      value = $now|transform_timestamp:"last day of this month":$timezone|format_timestamp:"Y-m-d":$timezone
      description = "Last day of this month"
    }

    conditional {
      description = "If Today is NOT the last day of the month, stop running"
      if ($today != $end_of_month) {
        return {
          value = "Today is not the last day of the month. Stop running."
        }
      }
    }

    debug.log {
      value = "It's the end of the month... executing task..."
      description = "Beginning of end of month task"
    }
  }

  schedule = [{starts_on: 2026-05-01 23:00:00+0000, freq: 86400}]

  history = "all"
}
\`\`\`

## subscription_renewal_reminder_task

\`\`\`xs
task subscription_renewal_reminder {
  stack {
    var $current_time {
      value = now
      description = "Current timestamp for calculations"
    }

    debug.log {
      value = "Starting subscription renewal reminder task"
      description = "Log task start"
    }

    db.query subscription {
      description = "Query subscriptions expiring in next 7 days"
      where = $db.subscription.status == "active" && $db.subscription.end_date > $current_time && $db.subscription.end_date <= ($current_time + 604800000)
    } as $expiring_subscriptions

    foreach ($expiring_subscriptions) {
      each as $subscription {
        db.query user {
          description = "Get user details"
          where = $db.user.id == $subscription.user_id
        } as $user_result

        conditional {
          description = "Process if user found"
          if (($user_result|count) > 0) {
            var $user {
              value = $user_result|first
              description = "Extract user from result"
            }

            api.request {
              url = "https://mandrillapp.com/api/1.0/messages/send"
              method = "POST"
              params = {}|set:"key":$env.mandrill_api_key|set:"message":({}|set:"from_email":"noreply@example.com"|set:"subject":"Subscription Reminder"|set:"text":"Your subscription expires soon"|set:"to":([]|push:({}|set:"email":$user.email|set:"type":"to")))
              headers = []|push:"Content-Type: application/json"
              description = "Send email reminder"
            } as $email_response

            db.add notification_log {
              data = {
                created_at       : $current_time
                user_id          : $user.id
                notification_type: "subscription_renewal_reminder"
                title            : "Subscription Reminder"
                message          : "Reminder sent successfully"
              }

              description = "Log notification"
            } as $log_entry
          }
        }
      }
    }

    debug.log {
      value = "Task completed"
      description = "Log completion"
    }
  }

  schedule = [{starts_on: 2026-01-01 09:00:00+0000, freq: 86400}]

  history = "all"
}
\`\`\`

## low_stock_alert

\`\`\`xs
task low_stock_alert {
  stack {
    db.query product {
      description = "Fetch products with stock quantity below 10"
      where = $db.product.stock_quantity < 10
    } as $low_stock_products

    var $alert_count {
      value = 0
      description = "Counter for alerted products"
    }

    foreach ($low_stock_products) {
      each as $product {
        api.realtime_event {
          channel = "stock_channel"
          data = {product_id: $product.id, stock_quantity: $product.stock_quantity}
          auth_table = "user"
          auth_id = "123"
          description = "Send real-time notification for low stock product"
        }

        math.add $alert_count {
          value = 1
          description = "Increment alert count"
        }
      }
    }

    debug.log {
      value = $alert_count
      description = "Log the number of alerted products"
    }
  }

  schedule = [{starts_on: 2026-01-01 09:00:00+0000, freq: 86400}]

  history = "inherit"
}
\`\`\`

## daily_sales_report_task

\`\`\`xs
task daily_sales_report {
  description = "Daily at 11 PM UTC generate a sales report by querying all payment transactions from the past 24 hours and calculating the total sales amount and transaction count. The task automatically executes every day starting from May 1, 2026, providing a summary of daily sales performance."
  stack {
    var $twenty_four_hours_ago {
      value = (now|transform_timestamp:"24 hours ago":"UTC")
      description = "Calculate timestamp for 24 hours ago"
    }

    db.query payment_transactions {
      description = "Get all transactions from the past 24 hours"
      where = $db.payment_transactions.transaction_date >= $twenty_four_hours_ago
    } as $daily_sales

    var $transaction_count {
      value = $daily_sales|count
      description = "Count number of transactions"
    }

    var $total_sales {
      value = ($daily_sales[$$].amount)|sum
      description = "Initialize total sales amount"
    }

    var $report_date {
      value = now
      description = "Current timestamp for the report"
    }

    db.transaction {
      description = "Store daily sales report with data consistency"
      stack {
        db.add reports {
          data = {
            report_type      : "daily_sales"
            report_date      : $report_date
            total_sales      : $total_sales
            transaction_count: $transaction_count
            period_start     : $twenty_four_hours_ago
            period_end       : $report_date
          }

          description = "Insert daily sales report into reports table"
        } as $report_result

        debug.log {
          value = "Daily sales report generated successfully"
          description = "Log successful report generation"
        }
      }
    }
  }

  schedule = [{starts_on: 2026-05-01 23:00:00+0000, freq: 86400}]

  history = "inherit"
}
\`\`\`
`;var lP=`When building from a Loveable generated website you'll apply the following strategy.

# 1. Database and API Setup

Extract the table structure and API endpoints necessary using the \`static/src/integrations/supabase/types.ts\` file. Xano handles permission at the API level, there will not be Row Level Security (RLS).

1. Establish a list of tables, their fields, and relationships. All string \`id\` fields should use \`int\`, as Xano does not support string primary keys.
2. Create these tables in Xano, ensuring that field types and relationships are accurately represented.
3. The \`types.ts\` file also contains the endpoints used to interact with the Supabase backend. List them and list their expected input (type and optionality)
4. Create these endpoints in Xano following Xano best practices.
5. Ensure the user pushes the tables and endpoints to Xano created before proceeding to the frontend development.

# 2. Frontend Development

Here the goal is to replace the Supabase integration with a Xano integration interfacing the newly created Xano backend.

!!!IMPORTANT!!!
ENSURE YOU PULL THE LATEST API SPECIFICATIONS FROM XANO USING THE \`get_xano_api_specifications\` TOOL BEFORE PROCEEDING.
!!!IMPORTANT!!!

1. Retrieve the current Xano API specifications using the \`get_xano_api_specifications\` tool.
2. Analyze the specifications to understand the endpoints, methods, authentication, and data structures.
3. Build a xano client to interact with the Xano API in \`static/src/integrations/xano/client.ts\` it will host the Xano client code.

\`\`\`ts
// import the xano types
import { User, ... } from "./types";

export class XanoClient {
  // pull the URL of the different api groups from the OpenAPI spec
  // and add them below
  private authenticationUrl = \`https://<Xano-Server-URL>/abcd-1234\`;
  // private bookUrl = \`https://<Xano-Server-URL>/efgh-5678\`;
  // ... other api groups

  constructor(private authToken: string | null) {
    this.updateAuthToken(authToken);
  }

  updateAuthToken(token: string | null) {
    this.authToken = token;
    localStorage.setItem("authToken", token || "");
  }

  // Add all the API methods you need below

  /**
   * Fetch the current authenticated user
   * @returns The authenticated user or null if not authenticated
   */
  async auth_me(): Promise<User> {
    const response = await fetch(\`\${this.authenticationUrl}/auth/me\`, {
      credentials: "include",
      headers: {
        Authorization: \`Bearer \${this.authToken}\`,
      },
    });
    if (response.ok) {
      const data = await response.json();
      return data;
    } else {
      throw new Error("Not authenticated");
    }
  }

  /**
   * Log in a user with email and password
   * @param email User's email
   * @param password User's password
   * @param options Optional parameters (matches the supabase options)
   * @returns The authentication token and user data
   */
  async auth_signup(
    name: string,
    email: string,
    password: string,
    options?: {
      /**
       * Optional URL to redirect the user to after email confirmation
       */
      emailRedirectTo?: string,
    },
  ): Promise<string> {
    const response = await fetch(\`\${this.authenticationUrl}/auth/signup\`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: \`Bearer \${this.authToken}\`,
      },
      credentials: "include",
      body: JSON.stringify({ name, email, password }),
    });
    if (response.ok) {
      const { authToken } = await response.json();
      if(options.emailRedirectTo) {
        setTimeout(() => {
          window.location.href = options.emailRedirectTo!;
        }, 1000); // Redirect after 1 second
      }
      return authToken;
    } else {
      throw new Error("Signup failed");
    }
  }

  // Add other methods as needed
  // async book_getAll():Promise<Book[]> { ... }
  // async book_create(...):Promise<Book> { ... }
  // async order_create(...):Promise<Order> { ... }
  // ...
}

export const xanoClient = new XanoClient(localStorage.getItem("authToken"));
\`\`\`

# 3. Add the useXanoAuth.tsx hook to manage authentication

\`\`\`tsx
import {
  useState,
  useEffect,
  createContext,
  useContext,
  ReactNode,
} from "react";
import { useToast } from "@/hooks/use-toast";
import { xanoClient } from "@/integrations/xano/client";
import { User } from "@/integrations/xano/types";

export function useXanoAuth() {
  const [user, setUser] = useState<User | null>(null);
  const [session, setSession] = useState<Session | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    // Fetch current user on mount
    const fetchUser = async () => {
      try {
        const user = await xanoClient.auth_me();
        setUser(user);
      } catch (error) {
        setUser(null);
      } finally {
        setLoading(false);
      }
    };

    fetchUser();
  }, []);

  const signOut = async () => {
    await setUser(null);
    xanoClient.updateAuthToken(null);
  };

  retur {
    user,
    loading,
    signOut,
  };
}
\`\`\`

This should allow you to replace the supabase version with the xano version in \`static/src/pages/Index.tsx\`:

\`\`\`tsx
import { useAuth } from "@/hooks/useAuth";
\`\`\`

with the new Xano version:

\`\`\`tsx
import { useXanoAuth } from "@/hooks/useXanoAuth";
\`\`\`

and proceed to use the \`useXanoAuth\` hook instead of the \`useAuth\` hook.

## 4. Replace all Supabase calls with Xano calls

Look for all the \`supabase.functions.invoke(...)\` calls and replace them with the corresponding \`xanoClient\` calls.
For example, replace:

\`\`\`ts
const { data, error } = await supabase.functions.invoke("getProfile");
\`\`\`

with

\`\`\`ts
const data = await xanoClient.getProfile();
\`\`\`

Make sure to handle errors appropriately, as the error handling mechanisms may differ between Supabase and Xano.

!!!IMPORTANT!!!
ENSURE YOU REMOVE ALL SUPABASE DEPENDENCIES FROM THE PROJECT, IN THE CODE, INCLUDING THE \`supabaseClient\` INTEGRATION AND THE \`supabase\` PACKAGE IN \`package.json\`
!!!IMPORTANT!!!
`;var uP=`---
applyTo: "functions/**/*.xs,apis/**/*.xs"
---

# Unit Testing in XanoScript

Unit tests in XanoScript are defined using the \`test\` block inside a \`function\` or \`query\`. Each test can use various \`expect\` methods to assert the correctness of your code. Below are examples for all supported \`expect\` methods.

## Argument-based expects

These expects require a payload block with a \`value\` or other parameters.

### \`expect.to_equal\`

\`\`\`xs
test "should match email" {
  expect.to_equal ($response.user.email) {
    value = "john@example.com"
  }
}
\`\`\`

Checks that \`$response.user.email\` equals \`"john@example.com"\`.

### \`expect.to_not_equal\`

\`\`\`xs
test "should not be error status" {
  expect.to_not_equal ($response.status) {
    value = "error"
  }
}
\`\`\`

Checks that \`$response.status\` is not \`"error"\`.

### \`expect.to_start_with\`

\`\`\`xs
test "should start with John" {
  expect.to_start_with ($response.user.name) {
    value = "John"
  }
}
\`\`\`

Checks that \`$response.user.name\` starts with \`"John"\`.

### \`expect.to_end_with\`

\`\`\`xs
test "should end with .pdf" {
  expect.to_end_with ($response.file.name) {
    value = ".pdf"
  }
}
\`\`\`

Checks that \`$response.file.name\` ends with \`".pdf"\`.

### \`expect.to_be_greater_than\`

\`\`\`xs
test "should be greater than 100" {
  expect.to_be_greater_than ($response.order.total) {
    value = 100
  }
}
\`\`\`

Checks that \`$response.order.total\` is greater than \`100\`.

### \`expect.to_be_less_than\`

\`\`\`xs
test "should be less than 10" {
  expect.to_be_less_than ($response.product.stock_quantity) {
    value = 10
  }
}
\`\`\`

Checks that \`$response.product.stock_quantity\` is less than \`10\`.

### \`expect.to_match\`

\`\`\`xs
test "should match US phone pattern" {
  expect.to_match ($response.user.phone) {
    value = "^\\\\+1\\\\d{10}$"
  }
}
\`\`\`

Checks that \`$response.user.phone\` matches the regex pattern for a US phone number.

### \`expect.to_contain\`

\`\`\`xs
test "should contain featured tag" {
  expect.to_contain ($response.tags) {
    value = "featured"
  }
}
\`\`\`

Checks that \`"featured"\` is present in \`$response.tags\` array.

## Range expects

### \`expect.to_be_within\`

\`\`\`xs
test "should be within range" {
  expect.to_be_within ($response.temperature) {
    min = 20
    max = 30
  }
}
\`\`\`

Checks that \`$response.temperature\` is between \`20\` and \`30\` (inclusive).

## Argument-less expects

These expects do not require a payload block.

### \`expect.to_be_true\`

\`\`\`xs
test "should be true" {
  expect.to_be_true ($response.is_active)
}
\`\`\`

Checks that \`$response.is_active\` is \`true\`.

### \`expect.to_be_false\`

\`\`\`xs
test "should be false" {
  expect.to_be_false ($response.is_deleted)
}
\`\`\`

Checks that \`$response.is_deleted\` is \`false\`.

### \`expect.to_be_in_the_past\`

\`\`\`xs
test "should be in the past" {
  expect.to_be_in_the_past ($response.created_at)
}
\`\`\`

Checks that \`$response.created_at\` is a timestamp in the past.

### \`expect.to_be_in_the_future\`

\`\`\`xs
test "should be in the future" {
  expect.to_be_in_the_future ($response.scheduled_at)
}
\`\`\`

Checks that \`$response.scheduled_at\` is a timestamp in the future.

### \`expect.to_be_defined\`

\`\`\`xs
test "should be defined" {
  expect.to_be_defined ($response.user_id)
}
\`\`\`

Checks that \`$response.user_id\` is defined.

### \`expect.to_not_be_defined\`

\`\`\`xs
test "should not be defined" {
  expect.to_not_be_defined ($response.optional_field)
}
\`\`\`

Checks that \`$response.optional_field\` is not defined.

### \`expect.to_be_null\`

\`\`\`xs
test "should be null" {
  expect.to_be_null ($response.deleted_at)
}
\`\`\`

Checks that \`$response.deleted_at\` is \`null\`.

### \`expect.to_not_be_null\`

\`\`\`xs
test "should not be null" {
  expect.to_not_be_null ($response.updated_at)
}
\`\`\`

Checks that \`$response.updated_at\` is not \`null\`.

### \`expect.to_be_empty\`

\`\`\`xs
test "should be empty" {
  expect.to_be_empty ($response.items)
}
\`\`\`

Checks that \`$response.items\` is empty (array, string, etc).

## Exception expects

### \`expect.to_throw\`

\`\`\`xs
test "should throw error" {
  expect.to_throw {
    value = "InvalidInputError"
  }
}
\`\`\`

Checks that an error with value \`"InvalidInputError"\` was thrown.

\`\`\`xs
test "should throw any error" {
  expect.to_throw
}
\`\`\`

Checks that any error was thrown.

## Mocking

You can use the \`mock\` block inside your function or query to simulate external API responses or other data sources during unit testing. The mock will only be applied if its name matches the test name. This allows you to test your logic without making real network requests or depending on external systems.

Mocks can be placed on any statement with a return value, such as API requests (\`...} as $foo\`), variable declarations (\`var $x\`), or variable updates (\`var.update $x\`). This gives you flexibility to mock data at any point in your logic.

**Example with multiple tests and mocks:**

\`\`\`xs
function get_weather {
  input {
    text city
  }

  stack {
    api.request {
      url = "https://api.weather.com/v1/current"
      method = "GET"
      params = {city: $input.city}
      mock "should return sunny weather" {
        value = {response: {weather: "sunny"}}
      }
      mock "should return rainy weather" {
        value = {response: {weather: "rainy"}}
      }
    } as $weather_response

    var $weather_message {
      value = "Today's weather is " ~ $weather_response.response.weather
      mock "should return sunny weather" {
        value = "Today's weather is sunny"
      }
      mock "should return rainy weather" {
        value = "Today's weather is rainy"
      }
    }
  }

  response = $weather_message

  test "should return sunny weather" {
    input = {city: "Paris"}
    expect.to_equal ($response) {
      value = "Today's weather is sunny"
    }
  }

  test "should return rainy weather" {
    input = {city: "London"}
    expect.to_equal ($response) {
      value = "Today's weather is rainy"
    }
  }
}
\`\`\`

** Example without mocks **

\`\`\`xs
query add_number verb=GET {
  input {
    int a
    int b
  }

  stack {
    var $sum {
      value = $input.a + $input.b
    }
  }

  response = $sum

  test "should add two numbers" {
    input = {a: 5, b: 10}
    expect.to_equal ($response) {
      value = 15
    }
  }
}

**How mocking works:**

- The \`mock\` block provides a fixed response for the statement it is attached to.
- The mock is only used if its name matches the test name.
- You can define multiple mocks for different test scenarios.
- Mocks can be placed on API requests, variable declarations, or updates\u2014any statement with a return value.
- This ensures your tests run reliably and quickly, even when external services are unavailable.

Use mocks to isolate your code from external dependencies and focus on your business logic.
\`\`\`
`;var dP='---\napplyTo: "functions/**/*.xs, apis/**/*.xs, tasks/*.xs, middleware/*.xs, agents/**/*.xs, realtime/**/*.xs, workflow_tests/*.xs, mcp_servers/**/*.xs, addons/*.xs, table/triggers/*.xs"\n---\n\n# stack\n\n```xs\nstack {\n  var $counter {\n    value = 0\n  }\n  for (3) {\n    each as $index {\n      math.add $counter {\n        value = 1\n      }\n    }\n  }\n  debug.log {\n    value = $counter\n  }\n}\n```\n\nA `stack` block defines a sequence of actions to be executed in a specific context, such as within a `query`, `function`, `task`, or other block (e.g., `group`, `transaction`). It acts as a container for operations like:\n\n- Variable declarations (e.g., `var`),\n- Control flow (e.g., `for`, `conditional`),\n- Function calls (e.g., `math.add`, `debug.log`),\n- Database operations (e.g., `db.query`).\n\nStacks are used to organize and execute a series of steps in a structured manner, often as part of a larger workflow.\n\n# input\n\n```xs\ninput {\n  text username filters=trim {\n    description = "User\'s login name"\n    sensitive = false\n  }\n  int age? {\n    description = "User\'s age (optional)"\n  }\n}\n```\n\nAn `input` block defines the parameters expected by a `query` or `function`. It includes:\n\n- Fields with their data types (e.g., `text`, `int`),\n- Optional status (marked with `?`),\n- Filters (e.g., `trim`) to process the input,\n- Metadata like `description` for clarity or `sensitive` to mark private data.\n\nhere is the list of accepted types:\n\n- int\n- timestamp\n- text\n- uuid\n- vector\n- date\n- bool\n- decimal\n- email\n- password\n- json\n- image\n- video\n- audio\n- attachment\n\nInputs specify the data that a query or function can receive and work with, such as user-provided values in an API request.\n\n# schema\n\n```xs\nschema {\n  int customer_id\n  text full_name filters=trim {\n    description = "Customer\'s full name"\n  }\n  email contact_email filters=trim|lower {\n    description = "Customer\'s email address"\n    sensitive = true\n  }\n  timestamp registered_at?=now\n}\n```\n\nA `schema` block, used within a `table` file, defines the structure of a database table. It includes:\n\n- Fields with their data types (e.g., `int`, `text`, `email`),\n- Optional status (marked with `?`),\n- Default values (e.g., `?=now`),\n- Filters (e.g., `trim|lower`) to process field values,\n- Metadata like `description` for clarity or `sensitive` to mark private fields.\n\nSchemas outline the columns and their properties for storing data in a table.\n\n# response\n\n```xs\nresponse = $user_data\n```\n\nA `response` block, used within a `query` or `function`, specifies the data to return as the result of the operation. The value parameter defines the output, which can be a variable (e.g., `$user_data`), a literal, or an expression. Responses determine what data is sent back to the caller, such as API response data or a function\u2019s return value.\n\n# schedule\n\n```xs\nschedule {\n  events = [\n    {starts_on: 2025-01-01 09:00:00+0000, freq: 86400},\n    {starts_on: 2025-01-02 09:00:00+0000, freq: 604800, ends_on: 2025-12-31 09:00:00+0000}\n  ]\n}\n```\n\nA `schedule` block, used within a `task` file, defines when the task should run. It includes an `events` array with:\n\n- `starts_on`: The start date and time (e.g., `2025-01-01 09:00:00+0000`),\n- `freq`: The frequency in seconds for recurring tasks (e.g., `86400` for daily, `604800` for weekly),\n- `ends_on`: An optional end date for recurring tasks (e.g., `2025-12-31 09:00:00+0000`).\n\nSchedules automate task execution at specified intervals or times.\n\n# table\n\n```xs\ntable customer {\n  auth = true\n  schema {\n    int id\n    text name filters=trim {\n      description = "Customer\'s full name"\n    }\n    email email filters=trim|lower {\n      description = "Customer\'s email address"\n      sensitive = true\n    }\n    timestamp signup_date?=now\n    bool is_active?=true\n  }\n  index = [\n    {type: "primary", field: [{name: "id"}]}\n    {type: "gin", field: [{name: "xdo", op: "jsonb_path_op"}]}\n    {type: "btree", field: [{name: "email", op: "desc"}]}\n  ]\n}\n```\n\nA `table` file defines the schema for a database table (e.g., `customer`). It includes:\n\n- An `auth` flag to enable/disable authentication for the table,\n- A `schema` block listing fields with their data types (e.g., `int`, `text`, `email`), optional status (marked with `?`), default values (e.g., `?=now`), filters (e.g., `trim|lower`), and metadata like `description` or `sensitive`,\n- An `index` block defining indexes for efficient querying (e.g., `primary` for the `id` field, `unique` for the `email` field).\n\nTables are used to structure and store data in a database, such as customer information.\n\n# query\n\n```xs\nquery /products verb=GET {\n  input {\n    text category filters=trim {\n      description = "Product category to filter by"\n      sensitive = false\n    }\n  }\n  stack {\n    var $category_filter {\n      value = $input.category\n    }\n    conditional {\n      if (`$category_filter|strlen > 0`) {\n        db.query product {\n          where = ($db.product.category|to_lower) == ($category_filter|to_lower)\n        } as $filtered_products\n      }\n      else {\n        db.query product {\n        } as $filtered_products\n      }\n    }\n  }\n  response = $filtered_products\n}\n```\n\nA `query` file defines an API endpoint to handle HTTP requests (e.g., GET, POST). It includes:\n\n- A path (e.g., `/products`) and HTTP method (`verb`),\n- An `input` block to define request parameters (e.g., `category`), which can have filters (e.g., `trim`) and metadata like `description` or `sensitive`,\n- A `stack` block containing the logic to process the request (e.g., querying a database, applying conditions),\n- A `response` block specifying the data to return (e.g., `$filtered_products`).\n\nQueries are essential for creating API endpoints to retrieve or manipulate data, such as fetching products by category.\n\n# function\n\n```xs\nfunction calculate_total {\n  input {\n    int quantity?\n    int price_per_item?\n  }\n  stack {\n    var $total {\n      value = 0\n    }\n    conditional {\n      if (`$input.quantity == null || $input.price_per_item == null`) {\n        throw {\n          name = "InvalidInputError"\n          value = "Quantity and price must be provided"\n        }\n      }\n      else {\n        math.mul $total {\n          value = $input.quantity\n        }\n        math.mul $total {\n          value = $input.price_per_item\n        }\n      }\n    }\n  }\n  response = $total\n}\n```\n\nA `function` file defines a reusable custom function that can be called elsewhere in your script. It includes:\n\n- A name (e.g., `"calculate_total"`) to identify the function,\n- An `input` block to define parameters (e.g., `quantity` and `price_per_item`), which can be optional (marked with `?`),\n- A `stack` block containing the logic to execute (e.g., calculations, conditionals),\n- A `response` block specifying the return value (e.g., `$total`).\n\nFunctions are ideal for encapsulating logic, such as calculating a total cost, that can be reused across scripts.\n\n# task\n\n```xs\ntask "daily_report" {\n  stack {\n    db.query sales {\n      description = "Fetch daily sales data"\n    } as $daily_sales\n  }\n  schedule = [\n    {starts_on: 2025-01-01 08:00:00+0000, freq: 86400}\n  ]\n}\n```\n\nA `task` file defines a scheduled job that runs automatically at specified times. It includes:\n\n- A name (e.g., `"daily_report"`) to identify the task,\n- A `stack` block containing the actions to execute (e.g., querying a database),\n- A `schedule` block with `events` to define when the task runs, including:\n  - `starts_on`: The start date and time (e.g., `2025-01-01 08:00:00+0000`),\n  - `freq`: The frequency in seconds for recurring tasks (e.g., `86400` for daily),\n  - `ends_on`: An optional end date for recurring tasks (not used here).\n\nTasks are ideal for automating recurring operations like generating reports or syncing data.\n\n# api.lambda\n\n```xs\napi.lambda {\n  code = """\n    // Javascript or Typescript code here\n    return $input.value > 10 ? true : false;\n  timeout = 10\n  """\n} as $result\n```\n\nallows you to run provided `code` in Javascript or Typescript in a sandboxed environment. Maximum execution time is `timeout` seconds.\n\nThe lambda function has access to your function stack context like `$input`, `$var`, `$auth` and `$env`.\n\nThe result of the execution is stored in `as $result` variable and is the returned value of the code.\n\n# api.request\n\n```xs\napi.request {\n  url = "https://api.example.com/users"\n  method = "GET"\n  params = {}|set:"user_id":"123"\n  headers = []|push:"Authorization: Bearer token123"\n  timeout = 30\n} as $user_response\n```\n\nSends an HTTP request to a specified URL and retrieves the response. It supports various HTTP methods, query parameters, custom headers, and a timeout to limit execution time. The response is stored in the variable specified by `as`.\n\n# api.stream\n\n```xs\napi.stream {\n  value = $processed_results\n}\n```\n\nStreams data back to the client when the API response type is set to `\'Stream\'`. This is useful for real-time data delivery, such as in live updates or large data transfers.\n\n# api.realtime_event\n\n```xs\napi.realtime_event {\n  channel = "notifications_channel"\n  data = $alert_message\n  auth_table = "users"\n  auth_id = "user_789"\n}\n```\n\nSends a real-time event over a specified channel, enabling live updates in applications. It includes a data payload and optional authentication details to control access.\n\n# var\n\n```xs\nvar $name {\n  value = "value"\n}\n```\n\ndefines a variable with the name `$name` and the value `"value"`. The value can be a string, number, boolean, or an object followed by filters.\n\n# var.update\n\n```xs\nvar.update $name {\n  value = "value"\n}\n```\n\nupdates the value of the variable with the name `$name` to `"value"`. The value can be a string, number, boolean, or an object followed by filters.\n\n# array.find\n\n```xs\narray.find $customer_ages if (`$this > 18`) as $first_adult_age\n```\n\nSearches an array and returns the first element that meets the specified condition. If no element satisfies it, `null` is returned. The result is stored in the variable defined by `as`.\n\n# array.push\n\n```xs\narray.push $shopping_cart {\n  value = "oranges"\n  disabled = false\n  description = "Add oranges to cart"\n}\n```\n\nAppends a new element to the end of an array. It accepts a `value` to add, with optional `disabled` (to skip execution) and `description` (for context or logging).\n\n# array.unshift\n\n```xs\narray.unshift $priority_tasks {\n  value = "urgent meeting"\n}\n```\n\nInserts a new element at the beginning of an array, shifting existing elements to higher indexes.\n\n# array.shift\n\n```xs\narray.shift $waiting_list as $next_customer\n```\n\nRemoves and returns the first element of an array, shortening the array by one. The removed element is stored in the variable specified by `as`.\n\n# array.pop\n\n```xs\narray.pop $completed_tasks as $last_finished_task\n```\n\nRemoves and returns the last element of an array, reducing its length by one. The removed element is stored in the variable defined by `as`.\n\n# array.merge\n\n```xs\narray.merge $active_users {\n  value = $new_users\n}\n```\n\nCombines another array or a single value into the target array, appending all elements from the provided `value`.\n\n# array.find_index\n\n```xs\narray.find_index $sale_prices if (`$this < 20`) as $first_discount_index\n```\n\nReturns the index of the first element that satisfies the condition. If no match is found, it returns `-1`. The result is stored in the variable specified by `as`.\n\n# array.has\n\n```xs\narray.has $team_roles if (`$this == "manager"`) {\n  disabled = false\n  description = "Verify manager role"\n} as $has_manager\n```\n\nChecks if at least one element in the array meets the condition, returning `true` if so, `false` otherwise. The result is stored in the `as` variable. Optional `disabled` and `description` parameters control execution and add context.\n\n# array.every\n\n```xs\narray.every $exam_scores if (`$this >= 70`) as $all_passed\n```\n\nTests whether every element in the array satisfies the condition, returning `true` if they all do, `false` if any fail. The result is stored in the `as` variable.\n\n# array.filter\n\n```xs\narray.filter $temperatures if (`$this > 32`) as $above_freezing\n```\n\nCreates a new array containing only the elements that meet the condition. The filtered result is stored in the variable specified by `as`.\n\n# array.filter_count\n\n```xs\narray.filter_count $survey_responses if (`$this == "yes"`) as $yes_count\n```\n\nCounts how many elements in the array satisfy the condition. The total is stored in the variable defined by `as`.\n\nBelow is the documentation for the XanoScript functions related to database operations and control flow, as requested in your query. Each entry follows the style of the existing documentation, providing a code snippet example and a brief explanation of what the function does. The examples use meaningful variable names to illustrate practical use cases.\n\n# conditional\n\n```xs\nconditional {\n  if (`$user_age > 18`) {\n    debug.log {\n      value = "Adult user"\n    }\n  }\n  elseif (`$user_age < 18`) {\n    debug.log {\n      value = "Minor user"\n    }\n  }\n  else {\n    debug.log {\n      value = "User age not specified"\n    }\n  }\n}\n```\n\nControls the flow of the script based on specified conditions, allowing different code blocks to execute depending on whether the conditions are true or false. It functions like an if-else statement, checking each condition in sequence and running the corresponding block.\n\n# continue\n\n```xs\nforeach $users as $user {\n  if (`$user.age < 18`) {\n    continue\n  }\n  debug.log {\n    value = `$user.name + " is an adult"`\n  }\n}\n```\n\nSkips the current iteration of a loop and moves to the next one. This is useful for bypassing specific items in a loop based on a condition, such as skipping users under 18 in this example.\n\n# db.add\n\n```xs\ndb.add user {\n  data = {\n    name: $input.name,\n    email: $input.email\n  }\n} as $new_user\n```\n\nInserts a new record into a specified database table (e.g., `user`) with the provided data fields. The new record is stored in the variable specified by `as`, here `$new_user`, for further use.\n\n# db.add_or_edit\n\n```xs\ndb.add_or_edit user {\n  field_name = "email"\n  field_value = $input.email\n  data = {\n    name: $input.name,\n    category: $input.category\n  }\n} as $user_record\n```\n\nAdds a new record to a database table (e.g., `user`) or updates an existing one based on a specified field (e.g., `email`) and its value (e.g., `$input.email`). The data block specifies the fields to add or update, and the resulting record is stored in `$user_record`.\n\n# db.del\n\n```xs\ndb.del comment {\n  field_name = "id"\n  field_value = $input.commentId\n}\n```\n\nRemoves a record from a database table (e.g., `comment`) based on a specified field (e.g., `id`) and its value (e.g., `$input.commentId`). This deletes the matching record.\n\n# db.direct_query\n\n```xs\ndb.direct_query {\n  code = "SELECT * FROM users WHERE users.email = ?"\n  response_type = "list"\n  arg = $input.email\n} as $query_results\n```\n\nExecutes a raw SQL query directly on the database, using placeholders (`?`) for parameters provided via `arg`. The `response_type` specifies whether to return a `list` or `single` result. The output is stored in the variable defined by `as`, here `$query_results`.\n\n# db.edit\n\n```xs\ndb.edit user {\n  field_name = "email"\n  field_value = $input.email\n  data = {\n    category: $input.category\n  }\n} as $updated_user\n```\n\nUpdates an existing record in a database table (e.g., `user`) identified by a field (e.g., `email`) and its value (e.g., `$input.email`). The `data` block specifies the fields to update, and the revised record is stored in `$updated_user`.\n\n# db.get\n\n```xs\ndb.get user {\n  field_name = "email"\n  field_value = $input.email\n} as $user\n```\n\nRetrieves a single record from a database table (e.g., `user`) based on a specified field (e.g., `email`) and its value (e.g., `$input.email`). The fetched record is stored in the variable specified by `as`, here `$user`.\n\n# db.has\n\n```xs\ndb.has user {\n  field_name = "email"\n  field_value = $input.email\n} as $user_exists\n```\n\nChecks if a record exists in a database table (e.g., `user`) based on a specified field (e.g., `email`) and its value (e.g., `$input.email`). Returns `true` if found, `false` otherwise, stored in `$user_exists`.\n\n# db.query\n\n```xs\ndb.query client {\n  description = "Fetch client details by name"\n  where = $db.client.name contains $input.search\n  sort = {name: "asc"}\n  return = {\n    type: "list"\n    paging: {\n      page: 1\n      per_page: 25\n    }\n  }\n} as $matched_client\n```\n\nThe search variables accepts specific query filters, listed in the [Query Filters documentation](./query_filters.md).\n\nRetrieves multiple records from a database table (e.g., `client`) based on a search condition. Here, it matches records where the client name contains the search input. The results are sorted by name in ascending order and include pagination. The results are stored in `$matched_client`.\n\n```xs\ndb.query availability {\n  sort = {created_at: "asc"}\n  return = {\n    type: "list"\n    paging: {\n      page: $input.page\n      per_page: 20\n    }\n  }\n} as $availability\n```\n\nRetrieves multiple records from a database table (e.g., `availability`) with sorting by creation date. The results include pagination using dynamic values from input parameters. The results are stored in `$availability`.\n\n# db.schema\n\n```xs\ndb.schema user {\n  path = "email"\n} as $email_schema\n```\n\nReturns the schema of a database table (e.g., `user`) or a specific field within it (e.g., `email` via `path`). The schema information is stored in the variable specified by `as`, here `$email_schema`.\n\n# db.set_datasource\n\n```xs\ndb.set_datasource {\n  value = "test"\n}\n```\n\nChanges the datasource for all subsequent database queries in the current script execution to the specified value (e.g., `"test"`). This affects all database operations that follow.\n\n# db.transaction\n\n```xs\ndb.transaction {\n  description = "Update user and log action"\n  stack {\n    db.update user { /* ... */ }\n    db.add log { /* ... */ }\n  }\n}\n```\n\nExecutes a series of database operations (e.g., updating a user and adding a log entry) within a single transaction. Ensures atomicity\u2014either all operations succeed, or none are applied. The `description` provides context.\n\n# db.truncate\n\n```xs\ndb.truncate user {\n  reset = true\n}\n```\n\nDeletes all records from a specified database table (e.g., `user`). If `reset = true`, it also resets any auto-incrementing IDs, effectively clearing the table and starting fresh.\n\n# db.external.mssql.direct_query\n\n```xs\ndb.external.mssql.direct_query {\n  code = "SELECT * FROM orders WHERE orders.total > ?"\n  response_type = "list"\n  connection_string = "mssql://db_user:db_password@server.com:1433/sales_db?sslmode=disabled"\n  arg = $input.min_total\n} as $large_orders\n```\n\nExecutes a SQL query directly on an external Microsoft SQL Server database. The `code` parameter contains the SQL statement, and `response_type` specifies whether it returns a `list` of records or a `single` record. The `connection_string` provides access to the database, and `arg` supplies values for placeholders (e.g., `?`) in the query. Results are stored in the variable defined by `as`, here `$large_orders`.\n\n# db.external.mysql.direct_query\n\n```xs\ndb.external.mysql.direct_query {\n  code = "SELECT * FROM products WHERE products.category = ?"\n  response_type = "list"\n  connection_string = "mysql://db_user:db_password@host.com:3306/inventory_db?sslmode=disabled"\n  arg = $input.category\n} as $category_products\n```\n\nRuns a SQL query directly on an external MySQL database. The `response_type` determines if the result is a `list` or a `single` record. The `connection_string` specifies the database connection, and `arg` provides values for query placeholders. The output is stored in the `as` variable, here `$category_products`.\n\n# db.external.oracle.direct_query\n\n```xs\ndb.external.oracle.direct_query {\n  code = "SELECT * FROM employees WHERE employees.department = ?"\n  response_type = "list"\n  connection_string = "oracle://db_user:db_password@server.com:1521/hr_db"\n  arg = $input.department\n} as $department_employees\n```\n\nDirectly executes a SQL query on an external Oracle database. The `response_type` sets whether the query returns a `list` or a `single` record. The `connection_string` defines the database connection, and `arg` supplies placeholder values. Results are stored in the variable specified by `as`, here `$department_employees`.\n\n# db.external.postgres.direct_query\n\n```xs\ndb.external.postgres.direct_query {\n  code = "SELECT * FROM customers WHERE customers.last_purchase > ?"\n  response_type = "list"\n  connection_string = "postgres://db_user:db_password@host.com:5432/shop_db?sslmode=prefer"\n  arg = $input.date_threshold\n} as $recent_customers\n```\n\nPerforms a SQL query directly on an external PostgreSQL database. The `response_type` indicates if the result is a `list` or a `single` record. The `connection_string` establishes the database connection, and `arg` provides values for placeholders. The results are stored in the `as` variable, here `$recent_customers`.\n\n# debug.stop\n\n```xs\ndebug.stop {\n  value = $some_var\n}\n```\n\nThis function stops the script\u2019s execution at the point where it\u2019s called and sends the specified `value` to the debugger. It\u2019s a handy tool for troubleshooting, allowing you to inspect the contents of a variable (like `$some_var`) during development to ensure your script is working as expected.\n\n# foreach\n\n```xs\nforeach ($numbers_list) {\n  each as $item {\n    var.update $sum {\n      value = `$sum + $item`\n    }\n  }\n}\n```\n\n**Example with a predefined list**:\n\n```xs\nforeach ([1, 2, 3, 4]) {\n  each as $item {\n    var.update $sum {\n      value = `$sum + $item`\n    }\n  }\n}\n```\n\nThe `foreach` function loops through every item in a list (e.g., an array like `$numbers_list` or `[1, 2, 3, 4]`). The `each as` clause assigns the current item to a variable (e.g., `$item`), which you can use inside the loop to perform actions on each element.\n\n# for\n\n```xs\nfor (10) {\n  description = "Repeat this 10 times, with $index counting from 0 to 9"\n  each as $index {\n    debug.log {\n      value = `$index + 1`\n    }\n  }\n}\n```\n\nThis function creates a loop that runs a set number of times (e.g., 10). The `each as` clause provides a counter variable (e.g., `$index`), which starts at 0 and increases by 1 each iteration, up to one less than the specified number (e.g., 0 through 9 for a count of 10).\n\n# function.run\n\n```xs\nfunction.run add_fn {\n  input = { a: $input.a, b: $input.b }\n} as $func_result\n```\n\nThe `function.run` function calls a custom function (e.g., `add_fn`) and passes it the data specified in the `input` parameter (e.g., an object with `a` and `b` values). The result of the function is stored in the variable named after `as` (e.g., `$func_result`), making it available for further use in your script.\n\n# group\n\n```xs\ngroup {\n  description = "your group description"\n  stack {\n    debug.log {\n      value = "Action 1"\n    }\n  }\n}\n```\n\nThe `group` function organizes a set of actions into a logical block that can be collapsed in the user interface for better readability. The `description` field labels the group (e.g., "group description"), and the `stack` contains the actions you want to group together.\n\n# math.sub\n\n```xs\nmath.sub $total_cost {\n  value = $discount_amount\n}\n```\n\nSubtracts the specified `value` (e.g., `$discount_amount`) from the variable (e.g., `$total_cost`) and updates the variable with the result. This is ideal for scenarios like reducing a total by a discount.\n\n**NOTE**: math.sub does not return a value; it mutates the variable directly.\n\n# math.mul\n\n```xs\nmath.mul $base_price {\n  value = $tax_rate\n}\n```\n\nMultiplies the variable (e.g., `$base_price`) by the specified `value` (e.g., `$tax_rate`) and stores the product back into the variable. Use this to calculate values like a price with tax applied.\n\n**NOTE**: math.mul does not return a value; it mutates the variable directly.\n\n# math.div\n\n```xs\nmath.div $total_time {\n  value = $num_tasks\n}\n```\n\nDivides the variable (e.g., `$total_time`) by the specified `value` (e.g., `$num_tasks`), updating the variable with the quotient. This is useful for finding averages, such as time per task.\n\n**NOTE**: math.div mutates the value, it doesn\'t have a return value.\n\n# math.bitwise.xor\n\n```xs\nmath.bitwise.xor $flags {\n  value = $toggle_bit\n}\n```\n\nPerforms a bitwise XOR operation between the variable (e.g., `$flags`) and the specified `value` (e.g., `$toggle_bit`), storing the result in the variable. This is handy for toggling specific bits in a binary flag.\n\n**NOTE**: math.bitwise.xor mutates the value, it doesn\'t have a return value.\n\n# math.bitwise.or\n\n```xs\nmath.bitwise.or $permissions {\n  value = $new_permission\n}\n```\n\nApplies a bitwise OR operation between the variable (e.g., `$permissions`) and the specified `value` (e.g., `$new_permission`), updating the variable with the result. Commonly used to add permissions to an existing set.\n\n**NOTE**: math.bitwise.or mutates the value, it doesn\'t have a return value.\n\n# math.bitwise.and\n\n```xs\nmath.bitwise.and $status_flags {\n  value = $check_bit\n}\n```\n\nExecutes a bitwise AND operation between the variable (e.g., `$status_flags`) and the specified `value` (e.g., `$check_bit`), saving the result in the variable. This is useful for checking if a particular bit is set.\n\n**NOTE**: math.bitwise.and mutates the value, it doesn\'t have a return value.\n\n# math.add\n\n```xs\nmath.add $cart_total {\n  value = $item_price\n}\n```\n\nAdds the specified `value` (e.g., `$item_price`) to the variable (e.g., `$cart_total`) and updates the variable with the sum. Perfect for accumulating values, like adding an item\u2019s cost to a cart total.\n\n**NOTE**: math.add mutates the value, it doesn\'t have a return value.\n\n# redis.unshift\n\n```xs\nredis.unshift {\n  key = "task_list"\n  value = "urgent_task"\n} as $new_list_length\n```\n\nAdds an element to the beginning of a Redis list specified by `key`. The `value` is the element to add, and the new length of the list is stored in the variable defined by `as`, here `$new_list_length`.\n\n# redis.incr\n\n```xs\nredis.incr {\n  package_key = "1"\n  key = "visit_counter"\n  by = 1\n} as $new_count\n```\n\nIncrements a numeric value in Redis at the specified `key` within a `package_key` namespace by the amount given in `by`. The updated value is stored in the variable specified by `as`, here `$new_count`.\n\n# redis.remove\n\n```xs\nredis.remove {\n  key = "user_list"\n  value = "inactive_user"\n  count = 1\n}\n```\n\nRemoves a specified number (`count`) of occurrences of `value` from a Redis list identified by `key`. This is useful for cleaning up lists by removing specific elements.\n\n# redis.del\n\n```xs\nredis.del {\n  key = "session_data"\n}\n```\n\nDeletes a key and its associated value from Redis, specified by `key`. This clears the cache entry, freeing up space.\n\n# redis.push\n\n```xs\nredis.push {\n  package_key = "1"\n  key = "message_queue"\n  value = "new_message"\n} as $queue_length\n```\n\nAdds an element to the end of a Redis list identified by `key` within a `package_key` namespace. The `value` is the element to add, and the new list length is stored in the variable defined by `as`, here `$queue_length`.\n\n# redis.ratelimit\n\n```xs\nredis.ratelimit {\n  key = "api_requests"\n  max = 100\n  ttl = 60\n  error = "Rate limit exceeded"\n} as $rate_limit_status\n```\n\nEnforces rate limiting on requests using Redis, tracking usage with `key`. It allows up to `max` requests within a `ttl` time window (in seconds). If exceeded, the `error` message is used, and the result (e.g., success or failure) is stored in `$rate_limit_status`.\n\n# redis.range\n\n```xs\nredis.range {\n  key = "event_log"\n  start = 0\n  stop = 5\n} as $recent_events\n```\n\nRetrieves a range of elements from a Redis list specified by `key`, from the `start` index to the `stop` index (inclusive). The result is stored in the variable defined by `as`, here `$recent_events`.\n\n# redis.decr\n\n```xs\nredis.decr {\n  key = "stock_count"\n  by = 1\n} as $new_stock\n```\n\nDecrements a numeric value in Redis at the specified `key` by the amount given in `by`. The updated value is stored in the variable specified by `as`, here `$new_stock`.\n\n# redis.pop\n\n```xs\nredis.pop {\n  key = "task_queue"\n} as $last_task\n```\n\nRemoves and returns the last element from a Redis list specified by `key`. The removed element is stored in the variable defined by `as`, here `$last_task`.\n\n# redis.get\n\n```xs\nredis.get {\n  key = "user_session"\n} as $session_data\n```\n\nRetrieves the value associated with a `key` from Redis. The result is stored in the variable specified by `as`, here `$session_data`.\n\n# redis.set\n\n```xs\nredis.set {\n  key = "user_token"\n  data = "token123"\n  ttl = 3600\n}\n```\n\nSets a `key` in Redis to the specified `data` value, with an optional `ttl` (time-to-live in seconds) to control how long the key persists before expiring.\n\n# redis.has\n\n```xs\nredis.has {\n  key = "user_token"\n} as $token_exists\n```\n\nChecks if a `key` exists in Redis, returning `true` if it does, `false` otherwise. The result is stored in the variable specified by `as`, here `$token_exists`.\n\n# redis.shift\n\n```xs\nredis.shift {\n  key = "message_queue"\n} as $first_message\n```\n\nRemoves and returns the first element from a Redis list specified by `key`. The removed element is stored in the variable defined by `as`, here `$first_message`.\n\n# redis.count\n\n```xs\nredis.count {\n  key = "message_queue"\n} as $queue_size\n```\n\nReturns the number of elements in a Redis list specified by `key`. The count is stored in the variable defined by `as`, here `$queue_size`.\n\n# redis.keys\n\n```xs\nredis.keys {\n  where = "user_*"\n} as $user_keys\n```\n\nRetrieves a list of Redis keys that match the specified `search` pattern (e.g., `user_*` for all keys starting with "user\\_"). The matching keys are stored in the variable specified by `as`, here `$user_keys`.\n\n# object.keys\n\n```xs\nobject.keys {\n  value = $user_data\n} as $user_data_keys\n```\n\nRetrieves the property keys of an object (e.g., `$user_data`) as an array. The resulting array of keys is stored in the variable specified by `as`, here `$user_data_keys`.\n\n# object.values\n\n```xs\nobject.values {\n  value = $product_info\n} as $product_values\n```\n\nExtracts the values of an object\u2019s properties (e.g., `$product_info`) into an array. The array of values is stored in the variable defined by `as`, here `$product_values`.\n\n# object.entries\n\n```xs\nobject.entries {\n  value = $settings\n} as $settings_pairs\n```\n\nReturns an array of key-value pairs from an object (e.g., `$settings`), where each pair is an array containing the key and its corresponding value. The result is stored in the variable specified by `as`, here `$settings_pairs`.\n\n# precondition\n\n```xs\nprecondition (`$user_age >= 18`) {\n  error_type = "standard"\n  error = "User must be 18 or older"\n}\n```\n\nThrows an exception if the specified condition (e.g., `$user_age >= 18`) evaluates to `false`. The `error_type` defines the type of error, and `error` provides a custom message to describe the failure.\n\n# return\n\n```xs\nreturn {\n  value = $calculation_result\n}\n```\n\nHalts the execution of the current function and returns the specified `value` (e.g., `$calculation_result`) as the function\u2019s output. This allows early termination with a result.\n\n# security.create_auth_token\n\n```xs\nsecurity.create_auth_token {\n    table = "users"\n    extras = { "role": "admin" }\n    expiration = 86400\n    id = $user_id\n} as $auth_token\n```\n\nGenerates an encrypted authentication token linked to a database table (e.g., `users`). The `extras` parameter adds optional data, `expiration` sets validity in seconds (e.g., 86400 for 24 hours), and `id` identifies the user. The token is stored in the variable defined by `as`, here `$auth_token`.\n\n# security.create_uuid\n\n```xs\nsecurity.create_uuid as $unique_id\n```\n\nGenerates a Universally Unique Identifier (UUID), a random 128-bit value, stored in the variable defined by `as`, here `$unique_id`.\n\n# security.encrypt\n\n```xs\nsecurity.encrypt {\n    data = $sensitive_data\n    algorithm = "aes-256-cbc"\n    key = "encryption_key"\n    iv = "init_vector"\n} as $encrypted_data\n```\n\nEncrypts a payload into binary data using a specified `algorithm` (e.g., `aes-256-cbc`), `key`, and initialization vector (`iv`). The encrypted result is stored in the variable defined by `as`, here `$encrypted_data`.\n\n# security.create_curve_key\n\n```xs\nsecurity.create_curve_key {\n    curve = "P-256"\n    format = "object"\n} as $crypto_key\n```\n\nGenerates a cryptographic key using an elliptic curve type (`P-256`, `P-384`, or `P-521`). The `format` parameter sets the output type (e.g., `object`), and the key is stored in the variable defined by `as`, here `$crypto_key`.\n\n# security.random_bytes\n\n```xs\nsecurity.random_bytes {\n    length = 16\n} as $random_bytes\n```\n\nGenerates a string of random bytes with the specified `length` (e.g., 16), stored in the variable defined by `as`, here `$random_bytes`.\n\n# security.create_password\n\n```xs\nsecurity.create_password {\n    character_count = 12\n    require_lowercase = true\n    require_uppercase = true\n    require_digit = true\n    require_symbol = false\n    symbol_whitelist = ""\n} as $generated_password\n```\n\nGenerates a random password based on rules like `character_count` (e.g., 12) and requirements for lowercase, uppercase, digits, and symbols. The `symbol_whitelist` limits allowed symbols. The password is stored in the variable defined by `as`, here `$generated_password`.\n\n# security.decrypt\n\n```xs\nsecurity.decrypt {\n    data = $encrypted_data\n    algorithm = "aes-256-cbc"\n    key = "encryption_key"\n    iv = "init_vector"\n} as $decrypted_data\n```\n\nDecrypts a payload back to its original form using the specified `algorithm` (e.g., `aes-256-cbc`), `key`, and initialization vector (`iv`). The decrypted result is stored in the variable defined by `as`, here `$decrypted_data`.\n\n# security.jwe_decode\n\n```xs\nsecurity.jwe_decode {\n    token = $jwe_token\n    key = "decryption_key"\n    check_claims = { "iss": "my_app" }\n    key_algorithm = "A256KW"\n    content_algorithm = "A256GCM"\n    timeDrift = 0\n} as $decoded_payload\n```\n\nDecodes a JSON Web Encryption (JWE) token using the `key`, specified `key_algorithm` (e.g., `A256KW`), and `content_algorithm` (e.g., `A256GCM`). Optional `check_claims` validates token claims, and `timeDrift` adjusts time validation. The result is stored in the variable defined by `as`, here `$decoded_payload`.\n\n# security.jws_encode\n\n```xs\nsecurity.jws_encode {\n    headers = { "alg": "HS256" }\n    claims = { "user_id": "123" }\n    key = "signing_key"\n    signature_algorithm = "HS256"\n    ttl = 3600\n} as $signed_token\n```\n\nEncodes a payload as a JSON Web Signature (JWS) token with `headers`, `claims`, and a `key`. The `signature_algorithm` (e.g., `HS256`) signs the token, and `ttl` sets its validity in seconds (e.g., 3600). The token is stored in the variable defined by `as`, here `$signed_token`.\n\n# security.jws_decode\n\n```xs\nsecurity.jws_decode {\n    token = $jws_token\n    key = "signing_key"\n    check_claims = { "user_id": "123" }\n    signature_algorithm = "HS256"\n    timeDrift = 0\n} as $verified_payload\n```\n\nDecodes a JSON Web Signature (JWS) token using the `key` and `signature_algorithm` (e.g., `HS256`). Optional `check_claims` verifies token claims, and `timeDrift` adjusts time validation. The payload is stored in the variable defined by `as`, here `$verified_payload`.\n\n# security.jwe_encode\n\n```xs\nsecurity.jwe_encode {\n    headers = { "alg": "A256KW" }\n    claims = { "data": "secret" }\n    key = "encryption_key"\n    key_algorithm = "A256KW"\n    content_algorithm = "A256GCM"\n    ttl = 0\n} as $encrypted_token\n```\n\nEncodes a payload as a JSON Web Encryption (JWE) token with `headers`, `claims`, and a `key`. The `key_algorithm` (e.g., `A256KW`) and `content_algorithm` (e.g., `A256GCM`) secure the token, and `ttl` sets its validity (0 for no expiration). The token is stored in the variable defined by `as`, here `$encrypted_token`.\n\n# security.create_secret_key\n\n```xs\nsecurity.create_secret_key {\n    bits = 2048\n    format = "object"\n} as $secret_key\n```\n\nGenerates a secret key for digital signatures or symmetric encryption with the specified `bits` (e.g., 2048) and `format` (e.g., `object`). The key is stored in the variable defined by `as`, here `$secret_key`.\n\n# security.random_number\n\n```xs\nsecurity.random_number {\n    min = 1\n    max = 100\n} as $random_value\n```\n\nGenerates a random number between `min` and `max` (e.g., 1 to 100), stored in the variable defined by `as`, here `$random_value`.\n\n# security.check_password\n\n```xs\nsecurity.check_password {\n    text_password = $user_input_password\n    hash_password = $stored_password_hash\n} as $is_valid\n```\n\nVerifies if a plain-text password (e.g., `$user_input_password`) matches a hashed password (e.g., `$stored_password_hash`). Returns `true` if they match, `false` otherwise, stored in the variable defined by `as`, here `$is_valid`.\n\n# stream.from_jsonl\n\n```xs\nstream.from_jsonl {\n  value = $jsonl_file\n} as $jsonl_stream\n```\n\nParses a JSONL (JSON Lines) file resource and streams its row data. The `value` parameter specifies the JSONL file to process, and the resulting stream is stored in the variable defined by `as`, here `$jsonl_stream`.\n\n# storage.create_file_resource\n\n```xs\nstorage.create_file_resource {\n  filename = "report.txt"\n  filedata = $report_content\n} as $new_file\n```\n\nCreates a new file with the specified `filename` and `filedata` content. The created file resource is stored in the variable specified by `as`, here `$new_file`, for further use.\n\n# storage.sign_private_url\n\n```xs\nstorage.sign_private_url {\n  pathname = "documents/secret.pdf"\n  ttl = 60\n} as $signed_url\n```\n\nGenerates a signed URL for a private file at the specified `pathname`, allowing temporary access for a duration defined by `ttl` (in seconds). The signed URL is stored in the variable defined by `as`, here `$signed_url`.\n\n# storage.create_attachment\n\n```xs\nstorage.create_attachment  {\n  value = $input.attachment\n  access= "public"\n  filename = "attachment.pdf"\n} as $attachment_metadata\n```\n\nCreates attachment metadata from a file resource specified by `value`, with the given `filename`. The `access` parameter determines if the attachment is `public` or `private`. The metadata is stored in the variable specified by `as`, here `$attachment_metadata`.\n\n# storage.delete_file\n\n```xs\nstorage.delete_file {\n  pathname = "temp/data.csv"\n}\n```\n\nDeletes a file from storage at the specified `pathname`. This removes the file permanently from the storage system.\n\n# storage.read_file_resource\n\n```xs\nstorage.read_file_resource {\n  value = $input.file\n} as $file_content\n```\n\nRetrieves the raw data from a file resource specified by `value`. The content of the file is stored in the variable defined by `as`, here `$file_content`.\n\n# storage.create_image\n\n```xs\nstorage.create_image {\n  value = $input.image\n  access="public"\n  filename = "profile.jpg"\n} as $image_metadata\n```\n\nCreates image metadata from a file resource specified by `value`, with the given `filename`. The `access` parameter sets the image as `public` or `private`. The metadata is stored in the variable specified by `as`, here `$image_metadata`.\n\n# stream.from_csv\n\n```xs\nstream.from_csv {\n  value = $csv_file\n  separator = ","\n  enclosure = "\'"\n  escape_char = "\'"\n} as $csv_stream\n```\n\nParses a CSV file resource and streams its row data. The `value` parameter specifies the CSV file, while `separator`, `enclosure`, and `escape_char` define the CSV format. The resulting stream is stored in the variable defined by `as`, here `$csv_stream`.\n\n# stream.from_request\n\n```xs\nstream.from_request {\n  url = "http://example.com/api/v1"\n  method = "GET"\n  params = {}|set:"filter":"active"\n  headers = []|push:"Authorization: Bearer token123"\n  timeout = 15\n  follow_location = true\n} as $api_stream\n```\n\nConverts an external HTTP request into a streaming API response, returning the data as an array. It supports various HTTP methods, query parameters, headers, a `timeout` (in seconds), and an option to `follow_location` for redirects. The stream is stored in the variable specified by `as`, here `$api_stream`.\n\n# switch\n\n```xs\nswitch ($user_status) {\n  case ("active") {\n    return {\n      value = "User is active"\n    }\n  } break\n  case ("inactive") {\n    return {\n      value = "User is inactive"\n    }\n  } break\n  default {\n    return {\n      value = "User status unknown"\n    }\n  }\n}\n```\n\nImplements switch-case logic to control script flow based on the value of a variable (e.g., `$user_status`). It evaluates the variable against each `case`, executing the corresponding block if a match is found, or the `default` block if no matches occur.\n\n# text.starts_with\n\n```xs\ntext.starts_with $message {\n  value = "Hello"\n} as $starts_with_hello\n```\n\nChecks if a text string (e.g., `$message`) begins with the specified `value` (e.g., `"Hello"`). Returns `true` if it does, `false` otherwise, and stores the result in the variable defined by `as`, here `$starts_with_hello`.\n\n# text.icontains\n\n```xs\ntext.icontains $description {\n  value = "error"\n} as $has_error\n```\n\nPerforms a case-insensitive check to see if a text string (e.g., `$description`) contains the specified `value` (e.g., `"error"`). Returns `true` if found, `false` otherwise, and stores the result in `$has_error`.\n\n# text.ltrim\n\n```xs\ntext.ltrim $user_input {\n  value = " "\n}\n```\n\nRemoves leading characters (default is whitespace, or as specified by `value`) from a text string (e.g., `$user_input`). Updates the variable with the trimmed result, useful for cleaning up user input.\n\n# text.rtrim\n\n```xs\ntext.rtrim $user_input {\n  value = " "\n}\n```\n\nRemoves trailing characters (default is whitespace, or as specified by `value`) from a text string (e.g., `$user_input`). Updates the variable with the trimmed result, ensuring no unwanted trailing characters remain.\n\n# text.append\n\n```xs\ntext.append $greeting {\n  value = ", welcome!"\n}\n```\n\nAdds the specified `value` (e.g., `", welcome!"`) to the end of a text string (e.g., `$greeting`). Updates the variable with the new concatenated string, useful for building messages.\n\n# text.istarts_with\n\n```xs\ntext.istarts_with $title {\n  value = "intro"\n} as $starts_with_intro\n```\n\nPerforms a case-insensitive check to see if a text string (e.g., `$title`) starts with the specified `value` (e.g., `"intro"`). Returns `true` if it does, `false` otherwise, and stores the result in `$starts_with_intro`.\n\n# text.iends_with\n\n```xs\ntext.iends_with $filename {\n  value = "pdf"\n} as $ends_with_pdf\n```\n\nPerforms a case-insensitive check to see if a text string (e.g., `$filename`) ends with the specified `value` (e.g., `"pdf"`). Returns `true` if it does, `false` otherwise, and stores the result in `$ends_with_pdf`.\n\n# text.ends_with\n\n```xs\ntext.ends_with $url {\n  value = ".com"\n} as $is_com_domain\n```\n\nChecks if a text string (e.g., `$url`) ends with the specified `value` (e.g., `".com"`). Returns `true` if it does, `false` otherwise, and stores the result in `$is_com_domain`.\n\n# text.prepend\n\n```xs\ntext.prepend $message {\n  value = "Alert: "\n}\n```\n\nAdds the specified `value` (e.g., `"Alert: "`) to the beginning of a text string (e.g., `$message`). Updates the variable with the new concatenated string, useful for adding prefixes.\n\n# text.contains\n\n```xs\ntext.contains $log_entry {\n  value = "error"\n} as $has_error\n```\n\nChecks if a text string (e.g., `$log_entry`) contains the specified `value` (e.g., `"error"`). Returns `true` if found, `false` otherwise, and stores the result in `$has_error`.\n\n# text.trim\n\n```xs\ntext.trim $user_input {\n  value = " "\n}\n```\n\nRemoves characters (default is whitespace, or as specified by `value`) from both the beginning and end of a text string (e.g., `$user_input`). Updates the variable with the trimmed result, ensuring clean text.\n\n# throw\n\n```xs\nthrow {\n  name = "ValidationError"\n  value = "Invalid user input provided"\n}\n```\n\nThrows an error and halts the script\u2019s execution immediately. The `name` parameter specifies the error type (e.g., `"ValidationError"`), and `value` provides a custom error message to describe the issue.\n\n# try_catch\n\n```xs\ntry_catch {\n  try {\n    function.run divide_fn {\n      input = { a: 10, b: 0 }\n    }\n  }\n  catch {\n    debug.log {\n      value = "Error occurred: division by zero"\n    }\n  }\n  finally {\n    debug.log {\n      value = "Operation completed"\n    }\n  }\n}\n```\n\nExecutes a block of code in the `try` section, catching any errors in the `catch` block for error handling (e.g., logging the error). The optional `finally` block runs regardless of success or failure, useful for cleanup tasks.\n\n# util.set_header\n\n```xs\nutil.set_header {\n  value = "Set-Cookie: sessionId=e8bb43229de9; HttpOnly; Secure; Domain=foo.example.com"\n  duplicates = "replace"\n}\n```\n\nAdds a header to the response, specified by `value` (e.g., a cookie header). The `duplicates` parameter determines how to handle duplicate headers, such as `"replace"` to overwrite existing ones.\n\n# util.get_env\n\n```xs\nutil.get_env as $environment_vars\n```\n\nRetrieves all environment variables available in the script\u2019s context and stores them in the variable specified by `as`, here `$environment_vars`. Useful for accessing system-wide settings.\n\n# util.get_all_input\n\n```xs\nutil.get_all_input as $input_data\n```\n\nCaptures all parsed input data sent to the script\u2019s context and stores it in the variable specified by `as`, here `$input_data`. This provides a structured view of input parameters.\n\n# util.get_input\n\n```xs\nutil.get_input as $raw_input\n```\n\nRetrieves the raw, unparsed input data for the request and stores it in the variable specified by `as`, here `$raw_input`. This is useful for accessing the original request data before processing.\n\n# util.sleep\n\n```xs\nutil.sleep {\n  value = 5\n}\n```\n\nPauses script execution for the specified number of seconds in `value` (e.g., 5 seconds). This can be used to introduce delays between operations.\n\n# util.send_email\n\n```xs\nutil.send_email {\n  api_key = $env.secret_key\n  service_provider = "resend"\n  subject = "hellow"\n  message = "Hey there"\n  to = "some_email@xano.com"\n  bcc = []|push:"foo@goo.com"\n  cc = ["me@me.com", "john@be.com"]\n  from = "admin@xano.com"\n  reply_to = "no-reply@xano.com"\n  scheduled_at = "2025-11-26T01:01:02.00"\n} as $xano_email\n```\n\nSends an email using the specified `"resend"`, with parameters like `subject`, `message`, `to`, `from`, and optional fields such as `bcc`, `cc`, `reply_to`, and `scheduled_at`. The result of the email operation is stored in the variable defined by `as`, here `$xano_email`. Currently, Xano only supports the Resend email service provider.\n\nXano also offers a built-in email service that can be used without an external provider for testing purposes, all emails using the `xano` service provider will be routed to the admin email address.\n\n```xs\nutil.send_email {\n  service_provider = "xano"\n  subject = "hellow"\n  message = "Hey there"\n} as $xano_email\n```\n\n# util.ip_lookup\n\n```xs\nutil.ip_lookup {\n  value = "123.234.99.22"\n} as $location\n```\n\nRetrieves the geographic location of an IP address specified in `value`. The location data (e.g., city, country) is stored in the variable defined by `as`, here `$location`.\n\n# util.geo_distance\n\n```xs\nutil.geo_distance {\n  latitude_1 = 40.71\n  longitude_1 = 74\n  latitude_2 = 48.86\n  longitude_2 = 2.35\n} as $distance\n```\n\nCalculates the distance between two geographic points, specified by their `latitude_1`, `longitude_1` (first point) and `latitude_2`, `longitude_2` (second point). The computed distance is stored in the variable defined by `as`, here `$distance`.\n\n# while\n\n```xs\nwhile (`$retry_count < 5`) {\n  each {\n    var.update $retry_count {\n      value = `$retry_count + 1`\n    }\n  }\n}\n```\n\nContinuously loops through a block of code as long as the specified condition (e.g., `$retry_count < 5`) evaluates to `true`. The `each` block contains the actions to repeat until the condition becomes `false`.\n\n# zip.create_archive\n\n```xs\nzip.create_archive {\n  filename = "backup.zip"\n} as $zip_archive\n```\n\nCreates a new compressed zip archive with the specified `filename`. The created zip file resource is stored in the variable defined by `as`, here `$zip_archive`, for further use.\n\n# zip.add_to_archive\n\n```xs\nzip.add_to_archive {\n  file = $input.file\n  zip = $zip_archive\n}\n```\n\nAdds a file (specified by `file`) to an existing zip archive (specified by `zip`). This updates the zip archive with the new file content.\n\n# zip.delete_from_archive\n\n```xs\nzip.delete_from_archive {\n  filename = $input.file\n  zip = $input.file\n}\n```\n\nRemoves a file (specified by `filename`) from an existing zip archive (specified by `zip`). This deletes the file from the archive without affecting other contents.\n\n# zip.extract\n\n```xs\nzip.extract {\n  zip = $zip_archive\n} as $extracted_files\n```\n\nExtracts the contents of a zip archive (specified by `zip`) into individual files. The extracted files are stored in the variable defined by `as`, here `$extracted_files`.\n\n# zip.view_contents\n\n```xs\nzip.view_contents {\n  zip = $input.file\n} as $archive_contents\n```\n\nLists the contents of a zip archive (specified by `zip`), providing details such as file names within the archive. The list is stored in the variable defined by `as`, here `$archive_contents`.\n\n# cloud.azure.storage.sign_url\n\n```xs\ncloud.azure.storage.sign_url {\n    account_name = "my_storage_account"\n    account_key = "my_secret_key"\n    container_name = "documents"\n    path = "reports/annual.pdf"\n    ttl = 300\n} as $document_access_url\n```\n\nGenerates a signed URL for securely accessing a blob in Azure Blob Storage. The URL remains valid for the duration specified by `ttl` (in seconds), allowing temporary access to the file, and is stored in a variable for later use.\n\n# cloud.aws.s3.sign_url\n\n```xs\ncloud.aws.s3.sign_url {\n    bucket = "company_assets"\n    region = "us-east-1"\n    key = "my_aws_key"\n    secret = "my_aws_secret"\n    file_key = "images/logo.png"\n    ttl = 300\n} as $logo_access_url\n```\n\nCreates a signed URL for accessing an object in an AWS S3 bucket, providing temporary access for the time set by `ttl` (in seconds). The URL is stored in the specified variable.\n\n# cloud.aws.s3.list_directory\n\n```xs\ncloud.aws.s3.list_directory {\n    bucket = "media_library"\n    region = "us-west-2"\n    key = "my_aws_key"\n    secret = "my_aws_secret"\n    prefix = "videos/"\n    next_page_token = $previous_page_token\n} as $video_list\n```\n\nLists the contents of an AWS S3 bucket, optionally filtered by a `prefix`, with support for pagination via `next_page_token`. The resulting list is stored in the specified variable.\n\n# cloud.google.storage.upload_file\n\n```xs\ncloud.google.storage.upload_file {\n    service_account = "my_service_account_json"\n    bucket = "user_uploads"\n    filePath = "photos/vacation.jpg"\n    file = $uploaded_image\n    metadata = { "description": "Beach vacation photo" }\n}\n```\n\nUploads a file to Google Cloud Storage at the specified `filePath` in a bucket, with optional `metadata` for additional details.\n\n# cloud.elasticsearch.request\n\n```xs\ncloud.elasticsearch.request {\n    auth_type = "API Key"\n    key_id = "my_key_id"\n    access_key = "my_access_key"\n    method = "GET"\n    url = "https://my-elastic-cluster.com/posts/_search"\n    payload = { "query": { "match": { "category": "tech" } } }\n} as $search_results\n```\n\nSends an HTTP request to an Elastic Search cluster, executing the specified `method` with an optional `payload`. The response is stored in the given variable.\n\n# cloud.azure.storage.list_directory\n\n```xs\ncloud.azure.storage.list_directory {\n    account_name = "my_storage_account"\n    account_key = "my_secret_key"\n    container_name = "archives"\n    path = "2023/"\n} as $yearly_archives\n```\n\nLists the contents of an Azure Blob Storage container, optionally filtered by a `path`. The list is stored in the specified variable.\n\n# cloud.aws.opensearch.document\n\n```xs\ncloud.aws.opensearch.document {\n    auth_type = "IAM"\n    key_id = "my_aws_key"\n    access_key = "my_aws_secret"\n    region = "us-east-1"\n    base_url = "https://my-opensearch-domain.com"\n    index = "articles"\n    method = "POST"\n    doc_id = "article_123"\n} as $article_response\n```\n\nManages records (e.g., create, read, update, delete) in an AWS OpenSearch index using the specified `method`. The response is stored in the given variable.\n\n# cloud.elasticsearch.document\n\n```xs\ncloud.elasticsearch.document {\n    auth_type = "API Key"\n    key_id = "my_key_id"\n    access_key = "my_access_key"\n    base_url = "https://my-elastic-cluster.com"\n    index = "users"\n    method = "GET"\n    doc_id = "user_456"\n} as $user_profile\n```\n\nManages records in an Elastic Search index (e.g., create, read, update, delete) with the specified `method`. The response is stored in the given variable.\n\n# cloud.aws.s3.read_file\n\n```xs\ncloud.aws.s3.read_file {\n    bucket = "app_resources"\n    region = "us-west-2"\n    key = "my_aws_key"\n    secret = "my_aws_secret"\n    file_key = "configs/settings.json"\n} as $app_settings_file\n```\n\nReads a file from an AWS S3 bucket and stores its contents in a variable as a file resource.\n\n# cloud.azure.storage.delete_file\n\n```xs\ncloud.azure.storage.delete_file {\n    account_name = "my_storage_account"\n    account_key = "my_secret_key"\n    container_name = "temp_files"\n    filePath = "drafts/old_draft.docx"\n}\n```\n\nDeletes a blob from an Azure Blob Storage container at the specified `filePath`.\n\n# cloud.aws.s3.delete_file\n\n```xs\ncloud.aws.s3.delete_file {\n    bucket = "user_backups"\n    region = "us-east-1"\n    key = "my_aws_key"\n    secret = "my_aws_secret"\n    file_key = "backups/2023-01.zip"\n}\n```\n\nDeletes an object from an AWS S3 bucket at the specified `file_key`.\n\n# cloud.google.storage.read_file\n\n```xs\ncloud.google.storage.read_file {\n    service_account = "my_service_account_json"\n    bucket = "app_data"\n    filePath = "logs/error_log.txt"\n} as $error_log_file\n```\n\nReads a file from Google Cloud Storage and stores its contents in a variable as a file resource.\n\n# cloud.aws.s3.get_file_info\n\n```xs\ncloud.aws.s3.get_file_info {\n    bucket = "product_images"\n    region = "us-east-1"\n    key = "my_aws_key"\n    secret = "my_aws_secret"\n    file_key = "items/shirt.jpg"\n} as $image_metadata\n```\n\nRetrieves metadata (e.g., size, last modified) about an object in an AWS S3 bucket, storing it in a variable.\n\n# cloud.aws.opensearch.request\n\n```xs\ncloud.aws.opensearch.request {\n    auth_type = "IAM"\n    key_id = "my_aws_key"\n    access_key = "my_aws_secret"\n    region = "us-west-2"\n    method = "POST"\n    url = "https://my-opensearch-domain.com/_search"\n    query = { "query": { "term": { "status": "active" } } }\n} as $active_items\n```\n\nSends a request to AWS OpenSearch with the specified `method` and `query`, storing the response in a variable.\n\n# cloud.google.storage.list_directory\n\n```xs\ncloud.google.storage.list_directory {\n    service_account = "my_service_account_json"\n    bucket = "project_files"\n    path = "designs/"\n} as $design_files\n```\n\nLists the contents of a Google Cloud Storage bucket, optionally filtered by `path`, storing the result in a variable.\n\n# cloud.google.storage.sign_url\n\n```xs\ncloud.google.storage.sign_url {\n    service_account = "my_service_account_json"\n    bucket = "public_assets"\n    filePath = "downloads/guide.pdf"\n    method = "GET"\n    ttl = 300\n} as $guide_download_url\n```\n\nGenerates a signed URL for accessing a file in Google Cloud Storage, valid for `ttl` seconds, with the specified `method`.\n\n# cloud.google.storage.get_file_info\n\n```xs\ncloud.google.storage.get_file_info {\n    service_account = "my_service_account_json"\n    bucket = "app_assets"\n    filePath = "icons/app_icon.png"\n} as $icon_details\n```\n\nRetrieves metadata about a file in Google Cloud Storage, storing it in a variable.\n\n# cloud.azure.storage.get_file_info\n\n```xs\ncloud.azure.storage.get_file_info {\n    account_name = "my_storage_account"\n    account_key = "my_secret_key"\n    container_name = "media"\n    filePath = "videos/intro.mp4"\n} as $video_metadata\n```\n\nRetrieves metadata about a blob in Azure Blob Storage, storing it in a variable.\n\n# cloud.aws.opensearch.query\n\n```xs\ncloud.aws.opensearch.query {\n    auth_type = "IAM"\n    key_id = "my_aws_key"\n    access_key = "my_aws_secret"\n    region = "us-east-1"\n    base_url = "https://my-opensearch-domain.com"\n    index = "products"\n    return_type = "search"\n    expression = [{ "field": "price", "value": "100", "op": "lt" }]\n    size = 10\n    from = 0\n    included_fields = ["name", "price"]\n    sort = [{ "field": "price", "order": "asc" }]\n    payload = {}\n} as $cheap_products\n```\n\nPerforms a search query on AWS OpenSearch with customizable filters, pagination, and sorting, storing results in a variable.\n\n# cloud.aws.s3.upload_file\n\n```xs\ncloud.aws.s3.upload_file {\n    bucket = "user_content"\n    region = "us-west-2"\n    key = "my_aws_key"\n    secret = "my_aws_secret"\n    file_key = "uploads/profile.jpg"\n    file = $user_photo\n    metadata = { "user_id": "123" }\n    object_lock_mode = "governance"\n    object_lock_retain_until = "2025-12-31"\n} as $upload_result\n```\n\nUploads a file to an AWS S3 bucket with optional metadata and object lock settings, storing the response in a variable.\n\n# cloud.algolia.request\n\n```xs\ncloud.algolia.request {\n    application_id = "my_algolia_app_id"\n    api_key = "my_algolia_api_key"\n    url = "https://my-algolia-app.algolia.net/1/indexes/posts/query"\n    method = "POST"\n    payload = { "query": "tech" }\n} as $tech_posts\n```\n\nSends a request to Algolia with the specified `method` and `payload`, storing the response in a variable.\n\n# cloud.azure.storage.upload_file\n\n```xs\ncloud.azure.storage.upload_file {\n    account_name = "my_storage_account"\n    account_key = "my_secret_key"\n    container_name = "user_files"\n    filePath = "docs/resume.pdf"\n    file = $user_resume\n    metadata = { "owner": "Jane" }\n} as $upload_confirmation\n```\n\nUploads a file to Azure Blob Storage with optional metadata, storing the response in a variable.\n\n# cloud.google.storage.delete_file\n\n```xs\ncloud.google.storage.delete_file {\n    service_account = "my_service_account_json"\n    bucket = "temp_storage"\n    filePath = "old/temp_data.csv"\n}\n```\n\nDeletes a file from Google Cloud Storage at the specified `filePath`.\n\n# cloud.elasticsearch.query\n\n```xs\ncloud.elasticsearch.query {\n    auth_type = "API Key"\n    key_id = "my_key_id"\n    access_key = "my_access_key"\n    base_url = "https://my-elastic-cluster.com"\n    index = "orders"\n    return_type = "search"\n    expression = [{ "field": "total", "value": "50", "op": "gt" }]\n    size = 5\n    from = 0\n    included_fields = ["id", "total"]\n    sort = [{ "field": "total", "order": "desc" }]\n    payload = {}\n} as $large_orders\n```\n\nExecutes a search query on Elastic Search with filters, pagination, and sorting, storing results in a variable.\n\n# cloud.azure.storage.read_file\n\n```xs\ncloud.azure.storage.read_file {\n    account_name = "my_storage_account"\n    account_key = "my_secret_key"\n    container_name = "logs"\n    filePath = "daily/2023-10-01.log"\n} as $daily_log_file\n```\n\nReads a blob from Azure Blob Storage and stores its contents in a variable as a file resource.\n';var fP="# XanoScript Workspace\n\nThis document provides an overview of the XanoScript workspace structure and guidelines for organizing your XanoScript files within a VSCode environment. The workspace is designed to facilitate efficient development, version control, and collaboration.\n\n## Environment Variables\n\nEnvironment variables can be used in XanoScript by using the `$env` prefix. The user can set their own environment variables, Xano also provides some built-in environment variables. The following are some of the built-in environment variables:\n\n- `$env.$remote_ip`:this is a special environment variable that resolves to the IP address of the individual accessing the API endpoint.\n- `$env.$http_headers`:this is a text array of headers that are sent to the API endpoint.\n- `$env.$request_uri`:this is a special environment variable that contains the URI that is being accessed from the API.\n- `$env.$request_method`:this is the method (GET, POST, DELETE, etc) of the incoming API request.\n- `$env.$request_querystring`:this is a special environment variable that contains the query string of the URI that is being accessed from the API.\n- `$env.$datasource`:this is a special environment variable that contains which datasource is being used.\n- `$env.$branch`:this is a special environment variable that contains which branch is being used.\n\nCustom environment variables can be set in the Xano dashboard under Settings > Environment Variables. These variables can be accessed in XanoScript using the `$env` prefix followed by the variable name (e.g., `$env.MY_CUSTOM_VARIABLE`). When using custom environment variables ($env.SOME_SERVICE_API_KEY), You should inform the user to set them up in their Xano dashboard.\n";var pP=`# Guidelines for AI-Assisted Development of a Static Frontend for Xano

You are an expert frontend developer tasked with creating a frontend-only, static application that integrates with a Xano REST API. The application will be hosted on Xano's CDN, requiring no server-side rendering, and all frontend code must reside in the \`static/\` folder in the workspace (compatible with editors like VS Code).

!!! IMPORTANT !!!
DO NOT ASSUME ANYTHING ABOUT THE API FORMAT, YOU CANNOT CAPTURE ITS API INTERFACE BY JUST LOOKING AT THE QUERY/ENDPOINT CODE!
YOU MUST RETRIEVE THE API SPECIFICATIONS AND PULL THE LATEST OPENAPI SPECIFICATIONS FROM THE BACKEND!
!!! IMPORTANT !!!

Invoke the \`get_xano_api_specifications\` tool immediately to acquire comprehensive OpenAPI specifications. Catalog endpoints meticulously, noting paths, methods, schemas, authentication (e.g., JWT tokens), rate limits, and error schemas. This informs your API client design, ensuring type-safe integrations (e.g., via generated TypeScript interfaces).

## Base Template

### If no existing frontend is present

Create an html file for each feature in the \`static/\` folder. Start with \`index.html\` as the main entry point. Use Bootstrap 5 for styling and layout. Here is a basic template:

\`\`\`html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>My Project</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>
  <body>
    <h1>Hello, world!</h1>
  </body>
</html>
\`\`\`

Centralize API calls in a single \`api.js\` file, utilizing the Fetch API with async/await syntax. Ensure robust error handling and user feedback mechanisms.

### If an existing frontend is present

Understand where the frontend was built from, lots of frontend are built from Loveable, see [Building from Loveable Guide](./build_from_loveable.md) to adapt the strategy accordingly. Inquiry the user if unsure.

If an existing frontend is present, do not modify the \`index.html\` file unless explicitly instructed. Try to understand the framework and libraries used, and continue development accordingly.

Leverage existing components and styles to maintain consistency. Ensure that any new code adheres to the established coding standards and practices of the existing codebase.

### Authentication

Xano uses JWT tokens for authentication. Ensure your frontend securely handles token storage and renewal, the default endpoints for authentication read the bearer token from the \`Authorization\` header.

## Deployment

Upon completion, invoke the \`upload_static_files_to_xano\` tool to synchronize \`static/\` contents, triggering builds and yielding the hosted URL. Convey this URL to the user, along with deployment artifacts (e.g., build logs) and recommendations for monitoring (e.g., via browser dev tools or Xano analytics).

## Best Practices

!!! IMPORTANT !!!
REMEMBER TO ALWAYS PULL THE LATEST OPENAPI SPECIFICATIONS FROM THE BACKEND USING THE \`get_xano_api_specifications\` TOOL BEFORE WRITING ANY CODE.
!!! IMPORTANT !!!
`;var hP='# XanoScript Input Guidelines\n\nThis document provides comprehensive guidelines for defining and utilizing inputs in XanoScript queries and functions. Adhere to these principles when generating or reviewing XanoScript code to facilitate reliable API endpoints, reusable functions.\n\n## Core Principles\n\n- **Explicitness**: Always specify data types, optionality, and constraints to prevent runtime errors and enhance readability.\n- **Validation**: Use filters and preconditions to enforce data integrity early in the execution flow.\n- **Security**: Mark sensitive fields (e.g., passwords, emails) explicitly and apply appropriate filters (e.g., `lower` for emails).\n- **Documentation**: Include a `description` for every input field to clarify its purpose and expected format.\n- **Conciseness**: Avoid redundant validation; leverage defaults and filters where appropriate.\n\nInputs are defined within the `input` block of `query` or `function` declarations. The `response` block remains unaffected by inputs, focusing solely on outputs.\n\n```xs\nfunction foo {\n  input {\n    ...\n  }\n\n  stack {\n    ...\n  }\n\n  response = null\n}\n```\n\n## Input Structure\n\nThe `input` block accepts a series of field definitions, each following this syntax:\n\n```\n<type> <field_name>[?]? [filters=<filter_list>] {\n  description = "<explanation>"\n  [sensitive = true/false]\n  [table = "<table_name>"]\n  [schema { ... }]  // For nested objects\n}\n```\n\n- **`<type>`**: Specifies the data type (see Types section below).\n- **`?` (nullable marker)**: Append one `?` to the type for nullable fields (`int?` can be `null`).\n- **`<field_name>`**: A descriptive identifier (e.g., `user_id`).\n- **`?` (optional marker)**: Append one `?` to the field name for optional fields (not required).\n- **`?=<default>`**: Alternatively from the single `?`, use `?=<value>` to set a default value for optional fields.\n- **`filters=`**: Pipe-separated list of transformations or validations (e.g., `filters=trim|lower|min:1`).\n- **`description`**: Optional but recommended explanatory text.\n- **`sensitive`**: Boolean flag for logging/masking sensitive data from the logs (default: false).\n- **`table`**: Links to a database table for foreign key validation (e.g., primary keys).\n- **`schema`**: Nested block used by the `object` type to enforce structure.\n\n### Nullable vs Optional\n\nThe first `?` on the type indicates the field can be of the given type or `null` (nullable).\nThe second `?` on the field name indicates it is optional (not required).\n\nExamples:\n\n```xs\ninput {\n    text? required_and_nullable {\n      description = "Can be null but must be provided"\n    }\n    text required_and_not_nullable {\n      description = "Must be provided and cannot be null"\n    }\n    text? not_required_and_nullable? {\n      description = "Can be null and is optional"\n    }\n    text not_required_and_not_nullable? {\n      description = "Must be provided but cannot be null"\n    }\n}\n```\n\n### Arrays\n\nDenote arrays with `[]` after the type (e.g., `int[]` for an array of integers). To limit the number of elements, use a range (e.g., `int[1:10]`). Filters apply element-wise.\n\n```xs\ninput {\n    int[1:10] max_10_scores? filters=min:0|max:100 {\n      description = "Accepts between 1 and 10 scores between 0 and 100"\n    }\n    text[] tags? filters=trim|lower|ok:abcdefghijklmnopqrstuvwxyz0123456789, {\n      description = "Array of tags, each trimmed and lowercased"\n    }\n}\n```\n\n### Defaults\n\nAssign defaults with `?=<value>` (e.g., `int page?=1`).\n\n```xs\ninput {\n    int page?=1 filters=min:1 {\n      description = "Page number, defaults to 1"\n    }\n    int page_size?=20 filters=min:1|max:100 {\n      description = "Page size, defaults to 20, max 100"\n    }\n}\n```\n\n## Supported Types\n\nThe following types are accepted. Select based on the expected data format to enable automatic parsing and validation:\n\n| Type             | Description                                                            | Example Usage                                     |\n| ---------------- | ---------------------------------------------------------------------- | ------------------------------------------------- |\n| `int`            | Signed 32-bit integer.                                                 | `int user_id`                                     |\n| `decimal`        | Floating-point number with arbitrary precision.                        | `decimal price filters=min:0`                     |\n| `text`           | Arbitrary string (UTF-8).                                              | `text title filters=trim`                         |\n| `email`          | Validated email address.                                               | `email contact_email sensitive=true`              |\n| `password`       | Secure string for credentials (hashed internally).                     | `password api_key filters=min:12`                 |\n| `bool`           | Boolean (true/false).                                                  | `bool is_active?=true`                            |\n| `timestamp`      | Epoch milliseconds (UTC) or ISO string.                                | `timestamp created_at`                            |\n| `date`           | ISO date string (YYYY-MM-DD).                                          | `date birth_date`                                 |\n| `uuid`           | Universally unique identifier (validated format).                      | `uuid session_id?`                                |\n| `json`           | Parsed JSON object or array.                                           | `json metadata`                                   |\n| `vector`         | Fixed-size numeric array for embeddings (specify dimension if needed). | `vector embedding`                                |\n| `dblink`         | Database-linked object (auto-populates from table).                    | `dblink { table = "orders" }`                     |\n| `enum`           | Restricted to predefined values.                                       | `enum status { values = ["active", "inactive"] }` |\n| `file`           | File resource (accepts URL or data URI).                               | `file avatar`                                     |\n| `image`          | Image file (subset of `file` with validation).                         | `image profile_photo`                             |\n| `video`          | Video file.                                                            | `video tutorial`                                  |\n| `audio`          | Audio file.                                                            | `audio recording`                                 |\n| `attachment`     | Generic file attachment.                                               | `attachment document`                             |\n| `geo_point`      | Geographic point (lat, lng).                                           | `geo_point location`                              |\n| `geo_multipoint` | Array of geographic points.                                            | `geo_multipoint points`                           |\n| `geo_linestring` | Line string of coordinates.                                            | `geo_linestring path`                             |\n| `geo_polygon`    | Closed polygon of coordinates.                                         | `geo_polygon boundary`                            |\n\nFor arrays: Append `[]` (e.g., `decimal[] scores`).\n\nFor nested objects: Use `object` with a `schema` sub-block. For example we could define a `person` object like this:\n\n```xs\ninput {\n  object person? {\n    schema {\n      enum gender?=undisclosed {\n        description = "Gender identity, defaults to undisclosed"\n        values = ["undisclosed", "male", "female"]\n      }\n\n      text name filters=trim {\n        description = "Full name (required)"\n      }\n      int age? {\n        description = "Age in years (optional)"\n      }\n    }\n  }\n}\n```\n\n## Filters and Transformations\n\nFilters process inputs declaratively. Chain them with `|` (e.g., `filters=trim|lower|min:1|max:100`). Common filters include:\n\n| Filter                | Purpose                                      | Example                                |\n| --------------------- | -------------------------------------------- | -------------------------------------- |\n| `trim`                | Remove leading/trailing whitespace.          | `text name filters=trim`               |\n| `lower`               | Convert to lowercase.                        | `email addr filters=lower`             |\n| `upper`               | Convert to uppercase.                        | `text code filters=upper`              |\n| `min:<value>`         | Enforce minimum value (numeric or length).   | `int age filters=min:18`               |\n| `max:<value>`         | Enforce maximum value.                       | `text desc filters=max:500`            |\n| `startsWith:<prefix>` | Require string prefix.                       | `text code filters=startsWith:ABC`     |\n| `ok:<pattern>`        | Allow only matching characters (regex-like). | `text hex filters=ok:abcdef0123456789` |\n| `prevent:<substring>` | Block specific substrings.                   | `text msg filters=prevent:spam`        |\n| `digitOk`             | Permit only digits (for arrays/strings).     | `text[] nums filters=digitOk`          |\n| `alphaOk`             | Permit only alphabetic characters.           | `text name filters=alphaOk`            |\n\n- **Array-Specific**: Filters like `count:min:5|max:20` apply to array length.\n- **Chaining Order**: Filters execute left-to-right; transformations (e.g., `trim`) precede validations (e.g., `min`).\n- **Custom Validation**: For complex rules, use `precondition` in the `stack` block post-input.\n\n## Validation and Error Handling\n\n- **Built-in**: Filters trigger `inputerror` exceptions on failure (this is the preferred method).\n- **Preconditions**: In the `stack` (when validating complex rules), for example if we wanted to ensure that a provided start date is before an end date we could do:\n\n```xs\nprecondition ($input.start_date < $input.end_date) {\n  description = "Start date must be before end date"\n  error_type = "inputerror"\n  error = "Start date must be before end date"\n}\n```\n\n- **Error Types**: Use `inputerror` for validation, `accessdenied` for auth-related issues.\n- **Sensitive Handling**: Set `sensitive=true` on input fields to mask in logs/responses.\n\n## Best Practices\n\n1. **Optionality**: Default to required fields; use `?` sparingly to avoid null-handling complexity.\n2. **Arrays and Loops**: For array inputs, pair with `for` or `foreach` in `stack` for iteration.\n3. **Database Integration**: Use `table` for foreign keys to auto-validate against schemas.\n4. **Testing**: Include `test` blocks in functions/queries to verify input scenarios:\n\n```xs\ntest "valid input" {\n  input = {\n    field: "value"\n  }\n  expect.to_equal $response {\n    value = "expected"\n  }\n}\n```\n\n5. **Performance**: Limit array sizes with `max` filters; avoid large vectors without pagination.\n6. **Security**: Always filter user inputs; never trust raw data.\n7. **Nesting**: Limit schema depth to 2-3 levels to prevent over-complexity.\n\n## Common Pitfalls\n\n- **Missing Descriptions**: Omitting `description` reduces code clarity\u2014always include.\n- **Filter Misordering**: Validate after transformation (e.g., `trim` before `strlen`).\n- **Type Mismatches**: Enforce types strictly; use `decimal` over `int` for precision.\n- **Null Propagation**: Optional fields can cascade nulls\u2014handle in `conditional` blocks.\n- **No Comments**: Use `description` exclusively; the input section does not support inline comments.\n\nBy following these guidelines, inputs will be robust, self-documenting, and aligned with XanoScript\'s declarative paradigm. For advanced usage, refer to the full syntax reference. If discrepancies arise, prioritize schema consistency across related files.\n';var mP=`# Xano Database Query Guidelines

## db.query

The \`db.query\` is the most used and the most flexible database query, it is used to retrieve data from your database (not unlike a SQL \`SELECT\` statement). It allows you to specify the table, filters, sorting, and pagination options.

### Search Argument

The \`search\` is the equivalent of a SQL \`WHERE\` clause. It allows you to filter records based on specific conditions. The list of available operators includes:

#### Basic Comparison Operators

Basic comparison operators are:

- \`==\` (equals)
- \`!=\` (not equals)
- \`>\` (greater than)
- \`>=\` (greater than or equal)
- \`<\` (less than)
- \`<=\` (less than or equal)

**Examples**
Tests if two values are equal.

\`\`\`xs
db.query post {
  where = $db.post.user_id == $auth.id
} as $posts
\`\`\`

Tests if two values are not equal.

\`\`\`xs
db.query post {
  where = $db.post.status != "draft"
} as $published_posts
\`\`\`

#### Array Content Operators

**\`contains\` (contains) and \`not contains\` (does not contain)**
Tests if an array contains a specific value.

IMPORTANT, DO NOT USE \`icontains\` IT IS NOT VALID IN A QUERY
use \`contains\` instead as it is case insensitive by default.

Tests if a field does not contain a specific value.
\`\`\`xs
db.query post {
  description = "Posts without specific tags"
  where = $db.post.tags not contains "deprecated"
} as $current_posts
\`\`\`
#### String Content Operators

**\`includes\` (includes)**
Tests if a string includes a particular phrase / value.
\`\`\`xs
db.query post {
  description = "Posts with specific title content"
  where = $db.post.title includes "tutorial"
} as $tutorial_posts
\`\`\`


#### Array Overlap Operators

**\`overlaps\` (overlaps) and \`not overlaps\` (does not overlap)**
Tests if two arrays have any elements in common. Useful for comparing array fields.

\`\`\`xs
db.query post {
  description = "Posts with overlapping tags"
  where = $db.post.tags overlaps ["javascript", "react"]
} as $matching_posts
\`\`\`

Tests if two arrays have no elements in common.

\`\`\`xs
db.query post {
  description = "Posts without conflicting tags"
  where = $db.post.tags not overlaps ["outdated", "deprecated"]
} as $valid_posts
\`\`\`

#### Combining Conditions

You can combine multiple conditions using logical operators:

**\`&&\` (logical AND)**

\`\`\`xs
db.query post {
  where = $db.post.user_id == $auth.id && $db.post.status == "published"
} as $my_published_posts
\`\`\`

**\`||\` (logical OR)**

\`\`\`xs
db.query post {
  where = $db.post.user_id == $auth.id || $db.post.status == "published"
} as $my_published_posts
\`\`\`

#### Ignore if null Operators

When filtering data, some condition might be optional based on user input. In such cases, you can use the \`?\` operator after the comparison operator (\`==\` would become \`==?\`) to ignore that condition if the value is null. For example, if you have an optional \`category\` input parameter, you can write:

\`\`\`xs
db.query post {
  where = $db.post.category ==? $input.category
} as $filtered_posts
\`\`\`

If you have a set of advanced search filters, you can use multiple ignore-if-null conditions:

\`\`\`xs
db.query post {
  where = $db.post.category ==? $input.category && $db.post.status ==? $input.status && $db.post.created_at >=? $input.start_date && $db.post.created_at <=? $input.end_date
} as $filtered_posts
\`\`\`

This way, if any of the input parameters are null, that specific condition will be ignored in the query.

### join

binding allows you to join related tables in your query. You can specify the relationship using the \`bind\` argument, which takes an array of objects defining the join conditions.

\`\`\`xs
db.query comment {
  where = $db.post.user_id == $auth.id && $db.post.status == "published" && $db.post.created_at > ("now"|timestamp_add_days:-30)
  join = {
    post: {
      table  : "post"
      type  : "inner"
      where: $db.comment.post_id == $db.post.id
    }
  }
} as $my_published_posts
\`\`\`

The joins can be of type \`inner\`, \`left\`, or \`right\`, depending on your needs.

Note that joining a table does not return its fields; it only allows you to use those fields in the \`search\` condition. If you wanted to return fields from the joined table, you would want to either use an \`eval\` to map some of the values retrieved from the join or use an \`addon\` which would fetch the related data separately.

### Eval

Eval allows you to create computed fields based on existing fields in your database (or joined tables). You can define these computed fields using the \`eval\` argument, which takes an array of objects specifying the computation.

\`\`\`xs
db.query blog_post {
  join = {
    user: {table: "user", where: $db.post.user_id == $db.user.id}
  }

  where = $db.post.user_id == $auth.id
  eval = {status: $db.user.status, userName: $db.user.name}
  return = {type: "list"}
} as $posts
\`\`\`

### Return types

- \`count\`: Returns the number of matching records.
- \`exists\`: Returns whether any matching records exist.
- \`single\`: Returns a single matching record.
- \`list\`: Returns a list of matching records.

#### Return List

This is the default format when none is specified. You can specify pagination, sorting, and whether to include metadata.

You can specify sorting :

\`\`\`xs
db.query blog_post_comment {
  where = $db.blog_post_comment.user_id == $auth.id && $db.blog_post_comment.status == "published"
  sort = {post.created_at: "asc"}
  return = {type: "list"}
} as $my_published_posts
\`\`\`

sorting can be \`asc\`, \`desc\` or \`rand\` (random order).

You can also specify pagination (and combine it with sorting):

\`\`\`xs
db.query blog_post_comment {
  join = {
    post: {
      table : "blog_post"
      where: $db.blog_post_comment.post_id == $db.blog_post.id
    }
  }

  where = $db.blog_post_comment.user_id == $auth.id
  additional_where = $input.query
  sort = { blog_post.created_at: "asc" }
  return = { type: "list", paging: { page: $input.page, per_page: 25 } }
} as $my_published_posts
\`\`\`

paging defines the default constant you want to use for pagination, while external_simple allows you to override those values (here $input parameters).

This pagination will move the results into a new structure as:

\`\`\`json
{
  "itemsReceived": integer,
  "curPage": integer,
  "nextPage": integer,
  "prevPage": integer,
  "offset": integer,
  "perPage": integer,
  "items": [ ... ]
}
\`\`\`

#### Return Single

Returns a single matching record. If multiple records match, only the first one is returned.

\`\`\`xs
db.query comment {
  where = $db.comment.user_id == $auth.id
  return = {
    type: "single"
  }
} as $my_published_posts
\`\`\`

#### Return Count

Returns the number of matching records as an integer.

\`\`\`xs
db.query comment {
  where = $db.comment.user_id == $auth.id
  return = {
    type: "count"
  }
} as $post_count
\`\`\`

#### Return Exists

Returns whether any matching records exist as a boolean.

\`\`\`xs
db.query comment {
  where = $db.comment.user_id == $auth.id
  return = {
    type: "exists"
  }
} as $has_posts
\`\`\`

### Other convenience query operations

#### db.get

Retrieving a single record by its primary key can be done using \`db.get\`:

\`\`\`xs
db.get follow {
  field_name = "id"
  field_value = $input.follow_id
} as $follow_record
\`\`\`

#### db.has

Checking for the existence of a record can be done using \`db.has\`:

\`\`\`xs
db.has category {
  field_name = "id"
  field_value = $input.query
} as $category_exists
\`\`\`

#### Modifying your table

Adding a new record can be done using \`db.add\`:

\`\`\`xs
db.add post {
  data = {
    user_id  : $auth.id
    caption  : $input.caption
    image_url: $input.image_url
    status   : "draft"
  }
} as $new_post
\`\`\`

Editing a record can be done using \`db.edit\`. In this case we pulled the post record in a \`$post\` variable so we can default to the $post.image_url if no new image_url is provided:

\`\`\`xs
db.edit post {
  field_name = "id"
  field_value = $input.post_id
  data = {
    caption : input.value
    image_url: $input.image_url || $post.image_url
  }
} as $edited_post
\`\`\`

Adding or editing (upsert) a record can be done using \`db.add_or_edit\`. In this case, if the \`field_value\` is empty, a new record will be created; otherwise, the existing record will be updated.

\`\`\`xs
db.add_or_edit category {
  field_name = "name"
  field_value = "$input.category"
  data = {
    name: $input.name
  }
} as $category_record
\`\`\`

#### db.del

Deleting a record can be done using \`db.del\` (notice how delete does not return the deleted record):

\`\`\`xs
db.del post {
  field_name = "id"
  field_value = $input.post_id
}
\`\`\`
`;var gP=`# XanoScript Expression Guidelines

This document provides a complete reference for all XanoScript expressions. Each entry includes a description, usage example, and expected result.

These expressions can be combined using the pipe \`|\` operator to create powerful data transformations.

\`\`\`xs
var $foo {
  value = (10|add:5)|mul:2
}
\`\`\`

or applied on returned values

\`\`\`xs
db.query "users" {
  ...
} as $username|first|get:"name"|upper
\`\`\`

## Comparison

Comparison operators are used to compare two values. The result of a comparison is a boolean value, either \`true\` or \`false\`.

- **Example**: \`$a == $b\` \u2192 \`true\` if \`$a\` is equal to \`$b\`, \`false\` otherwise.
- **Example**: \`$a != $b\` \u2192 \`true\` if \`$a\` is not equal to \`$b\`, \`false\` otherwise.
- **Example**: \`$a > $b\` \u2192 \`true\` if \`$a\` is greater than \`$b\`, \`false\` otherwise.
- **Example**: \`$a < $b\` \u2192 \`true\` if \`$a\` is less than \`$b\`, \`false\` otherwise.
- **Example**: \`$a >= $b\` \u2192 \`true\` if \`$a\` is greater than or equal to \`$b\`, \`false\` otherwise.
- **Example**: \`$a <= $b\` \u2192 \`true\` if \`$a\` is less than or equal to \`$b\`, \`false\` otherwise.

\`\`\`xs
var $is_equal {
  value = $input.a == $input.b
}
\`\`\`

Comparison operators can be combined with additional expressions for more complex logic. When combining expressions, use parentheses to ensure the correct order of operations so filters are applied as intended.

\`\`\`xs
var $is_greater {
  value = ($input.a|floor) > ($input.b|rad2deg|ceil)
}
\`\`\`

Expressions can also be used in conditionals

\`\`\`xs
conditional {
  if ($input.status == "active" && $input.age > 18) {
    debug.log { value = "Active adult" }
  } elseif ($input.status == "active" && $input.age <= 18) {
    debug.log { value = "Active minor" }
  } elseif ($input.status == "inactive" && $input.age > 18) {
    debug.log { value = "Inactive adult" }
  } else {
    debug.log { value = "Inactive minor" }
  }
}
\`\`\`

## Math Expressions

- **deg2rad**  
  Convert degrees to radians.  
  Example: \`180|deg2rad\`  
  Result: \`3.141592...\`

- **rad2deg**  
  Convert radians to degrees.  
  Example: \`3.141592|rad2deg\`  
  Result: \`180\`

- **number_format**  
  Format a number with decimal and thousands separators.  
  Example: \`31253212.141592|number_format:2:.:,\`  
  Result: \`"31,253,212.14"\`

- **sin**  
  Calculates the sine of the supplied value in radians.  
  Example: \`3.14159|sin\`  
  Result: \`0\`

- **asin**  
  Calculates the arc sine of the supplied value in radians.  
  Example: \`1|asin\`  
  Result: \`1.57079...\`

- **asinh**  
  Calculates the inverse hyperbolic sine of the supplied value in radians.  
  Example: \`1|asinh\`  
  Result: \`0.88137...\`

- **cos**  
  Calculates the cosine of the supplied value in radians.  
  Example: \`1|cos\`  
  Result: \`0.54030...\`

- **acos**  
  Calculates the arc cosine of the supplied value in radians.  
  Example: \`1|acos\`  
  Result: \`0\`

- **acosh**  
  Calculates the inverse hyperbolic cosine of the supplied value in radians.  
  Example: \`11.592|acosh\`  
  Result: \`3.14159...\`

- **tan**  
  Calculates the tangent of the supplied value in radians.  
  Example: \`0.785398|tan\`  
  Result: \`1\`

- **atan**  
  Calculates the arc tangent of the supplied value in radians.  
  Example: \`1|atan\`  
  Result: \`0.78539...\`

- **atanh**  
  Calculates the inverse hyperbolic tangent of the supplied value in radians.  
  Example: \`0.6666|atanh\`  
  Result: \`0.80470...\`

- **floor**  
  Round a decimal down to its integer equivalent.  
  Example: \`2.5|floor\`  
  Result: \`2\`

- **ceil**  
  Round a decimal up to its integer equivalent.  
  Example: \`2.5|ceil\`  
  Result: \`3\`

- **round**  
  Round a decimal with optional precision.  
  Example: \`2.5432|round:1\`  
  Result: \`3\`

- **abs**  
  Returns the absolute value.  
  Example: \`-10|abs\`  
  Result: \`10\`

- **sqrt**  
  Returns the square root of the value.  
  Example: \`9|sqrt\`  
  Result: \`3\`

- **exp**  
  Returns the exponent of mathematical expression "e".  
  Example: \`0|exp\`  
  Result: \`1\`

- **log**  
  Returns the logarithm with a custom base.  
  Example: \`2|log:2\`  
  Result: \`1\`

- **log10**  
  Returns the Base-10 logarithm.  
  Example: \`100|log10\`  
  Result: \`2\`

- **ln**  
  Returns the natural logarithm.  
  Example: \`10|ln\`  
  Result: \`2.30258...\`

- **pow**  
  Returns the value raised to the power of exp.  
  Example: \`10|pow:2\`  
  Result: \`100\`

- **min**  
  Returns the min of the values of the array.  
  Example: \`[1,2,3]|array_min\`  
  Result: \`1\`

- **max**  
  Returns the max of the values of the array.  
  Example: \`[1,2,3]|max\`  
  Result: \`3\`

- **num_min**  
  Returns the min both values.  
  Example: \`1|num_min:0\`  
  Result: \`0\`

- **num_max**  
  Returns the max both values.  
  Example: \`5|num_max:20\`  
  Result: \`20\`

- **sum**  
  Returns the sum of the values of the array.  
  Example: \`[1,2,3,4]|sum\`  
  Result: \`10\`

- **avg**  
  Returns the average of the values of the array.  
  Example: \`[1,2,3,4]|avg\`  
  Result: \`2.5\`

- **product**  
  Returns the product of the values of the array.  
  Example: \`[1,2,3,4]|product\`  
  Result: \`24\`

- **add**  
  Add 2 values together and return the answer.  
  Example: \`2|add:3\`  
  Result: \`5\`

- **sub**  
  Subtract 2 values together and return the answer.  
  Example: \`2|sub:3\`  
  Result: \`-1\`

- **mul**  
  Multiply 2 values together and return the answer.  
  Example: \`2|mul:3\`  
  Result: \`6\`

- **mod**  
  Modulus 2 values together and return the answer.  
  Example: \`20|mod:3\`  
  Result: \`2\`

- **div**  
  Divide 2 values together and return the answer.  
  Example: \`20|div:4\`  
  Result: \`5\`

- **bitwise_and**  
  Bitwise AND 2 values together and return the answer.  
  Example: \`7|bitwise_and:3\`  
  Result: \`3\`

- **bitwise_or**  
  Bitwise OR 2 values together and return the answer.  
  Example: \`7|bitwise_or:9\`  
  Result: \`15\`

- **bitwise_xor**  
  Bitwise XOR 2 values together and return the answer.  
  Example: \`7|bitwise_xor:9\`  
  Result: \`14\`

## Array Expressions

- **first**  
  Get the first entry of an array.  
  Example: \`["five","six","seven"]|first\`  
  Result: \`"five"\`

- **last**  
  Get the last entry of an array.  
  Example: \`["five","six","seven"]|last\`  
  Result: \`"seven"\`

- **count**  
  Return the number of items in an object/array.  
  Example: \`["five","six","seven"]|count\`  
  Result: \`3\`

- **range**  
  Returns array of values between the specified start/stop.  
  Example: \`|range:10:15\`  
  Result: \`[10,11,12,13,14,15]\`

- **reverse**  
  Returns values of an array in reverse order.  
  Example: \`[12,13,14,15]|reverse\`  
  Result: \`[15,14,13,12]\`

- **unique**  
  Returns unique values of an array.  
  Example: \`[12,13,13,12,11]|unique\`  
  Result: \`[12,13,11]\`

- **safe_array**  
  Always returns an array. Uses the existing value if it is an array or creates an array of one element.  
  Example: \`12|safe_array\`  
  Result: \`[12]\`

- **flatten**  
  Flattens a multidimensional array into a single level array of values.  
  Example: \`[1,[2,3],[[4,5]]]|flatten\`  
  Result: \`[1,2,3,4,5]\`

- **filter_empty**  
  Returns a new array with only entries that are not empty ("", null, 0, "0", false, [], {}).  
  Example: \`[{a:1, b:null}, {a:0, b:4}]|filter_empty:a\`  
  Result: \`[{a:1, b:null}]\`

- **fsort**  
  Sort an array of elements with an optional path inside the element.  
  Example: \`[{v:"a", e:20}, {v:"z", e:10}]|fsort:v:text:true\`  
  Result: \`[{v:"z", e:10}, {v:"a", e:20}]\`

- **array_shuffle**  
  Shuffles the order of the entries in the array.  
  Example: \`[1,2,3,4]|array_shuffle\`  
  Result: \`[3,2,4,1]\`

- **array_diff**  
  Return the entries from the first array that are not in the second array. Only values are used for matching.  
  Example: \`[1,2,3,4]|array_diff:[3,2]\`  
  Result: \`[1,4]\`

- **array_diff_assoc**  
  Return the entries from the first array that are not in the second array. Values and keys are used for matching.  
  Example: \`[{"a": "green"},{"b": "brown"},{"c":"blue"},"red"]|array_diff_assoc:[{"a":"green"}, "yellow", "red"]\`  
  Result: \`[{a: "green",b: "brown", "red"]\`

- **array_intersect**  
  Return the entries from the first array that are also present in the second array. Only values are used for matching.  
  Example: \`[1,2,3,4]|intersect:[3,2]\`  
  Result: \`[2,3]\`

- **array_intersect_assoc**  
  Return the entries from the first array that are also present in the second array. Values and keys are used for matching.  
  Example: \`[{"a": "green"},{"b": "brown"},{"c":"blue"},"red"]|array_intersect_assoc:[{"a":"green"},{"b":"yellow"},"blue","red"]\`  
  Result: \`[{a: "green",b: "brown", "red"]\`

- **array_merge**  
  Merge the first level of elements of both arrays together and return the new array.  
  Example: \`[1,2,3]|merge:["a","b","c"]\`  
  Result: \`[1,2,3,"a","b","c"]\`

- **array_merge_recursive**  
  Merge the elements from all levels of both arrays together and return the new array.  
  Example: \`{color:{favorite: ["red"]}}|merge_recursive:{color: {favorite: ["green","blue"]}}\`  
  Result: \`{"color":{"favorite": ["red","green","blue"]}}\`

- **index_by**  
  Create a new array indexed off of the value of each item's path.  
  Example: \`[{id:1,g:"x"},{id:2,g:"y"},{id:3,g:"x"}]|index_by:g\`  
  Result: \`{"x": [{"id":1,"g":"x"},{"id":3,"g":"x"}], "y": [{"id":2,"g":"y"}]}\`

- **array_push**  
  Push an element on to the end of an array and return the new array.  
  Example: \`[1,2,3]|array_push:"a"\`  
  Result: \`[1,2,3,"a"]\`

- **array_pop**  
  Pops the last element of the array off and returns it.  
  Example: \`[1,2,3]|array_pop\`  
  Result: \`3\`

- **array_unshift**  
  Push an element to the beginning of an array and return the new array.  
  Example: \`[1,2,3]|array_unshift:0\`  
  Result: \`[0,1,2,3]\`

- **array_shift**  
  Shifts the first element of the array off and returns it.  
  Example: \`[1,2,3]|shift\`  
  Result: \`1\`

- **array_remove**  
  Remove any elements from the array that match the supplied value and then return the new array.  
  Example: \`[{v:1},{v:2},{v:3}]|remove:{v:2}\`  
  Result: \`[{v:1},{v:3}]\`

- **append**  
  Push an element on to the end of an array within an object and return the updated object.  
  Example: \`[1,2,3]|append:4\`  
  Result: \`[1,2,3,4]\`

- **prepend**  
  Push an element on to the beginning of an array within an object and return the updated object.  
  Example: \`[1,2,3]|prepend:0\`  
  Result: \`[0,1,2,3]\`

- **array_slice**  
  Extract a section from an array.  
  Example: \`[1,2,3,4,5]|array_slice:2:2\`  
  Result: \`[3,4]\`

- **map**  
  Creates a new array with the results of calling a provided function on every element in the calling array.  
  Example: \`[{value: 2}, {value: 5}]|map:$$.value*2\`  
  Result: \`double each value => [4,10]\`

- **filter**  
  Filters the elements of an array based on the code block returning true to keep the element or false to skip it.  
  Example: \`[{value: 2}, {value: 5}]|filter:$$.value%2==0\`  
  Result: \`only even values => [{value:2}]\`

- **some**  
  Checks if at least one element in the array passes the test implemented by the provided function.  
  Example: \`[{value: 2}, {value: 5}]|some:$$.value%2==0\`  
  Result: \`at least one value is even => true\`

- **every**  
  Checks if all elements in the array pass the test implemented by the provided function.  
  Example: \`[{value: 2}, {value: 6}]|every:$$.value%2==0\`  
  Result: \`all values are even => true\`

- **find**  
  Finds if all elements in the array pass the test implemented by the provided function.  
  Example: \`[{id: 1}, {id: 2}, {id: 3}]|find:$$.id==2\`  
  Result: \`returns {id:2}\`

- **findIndex**  
  Finds the index of the first element in the array that passes the test implemented by the provided function.  
  Example: \`[{id: 1}, {id: 2}, {id: 3}]|findIndex:$$.id==2\`  
  Result: \`returns 1\`

- **reduce**  
  Reduces the array to a single value using the code block to combine each element of the array.  
  Example: \`[1,2,3,4,5]|reduce:$$+$result:10\`  
  Result: \`returns 25\`

- **pick**  
  Pick keys from the object to create a new object of just those keys.  
  Example: \`{a:1,b:2,c:3}|pick:[a,c]\`  
  Result: \`returns {a:1,c:3}\`

- **unpick**  
  Remove keys from the object to create a new object of the remaining keys.  
  Example: \`{a:1,b:2,c:3}|unpick:[a,c]\`  
  Result: \`returns {b:2}\`

## String/Text Expressions

- **addslashes**  
  Adds a backslash to the following characters: single quote, double quote, backslash, and null character.  
  Example: \`'he said "Hi!"'|addslashes\`  
  Result: \`"he said \\\\"Hi!\\\\""\`

- **escape**  
  Converts special characters into their escaped variants. Ex: \\t for tabs and \\n for newlines.  
  Example: \`'he said\\n- "Hi!"'|escape\`  
  Result: \`"he said \\\\n-\\\\\\"Hi!\\\\\\""\`

- **list_encodings**  
  List support character encodings.  
  Example: \`|list_encodings\`  
  Result: \`["UTF-8", "ISO-8859-1", ...]\`

- **detect_encoding**  
  Detect the character encoding of the supplied text.  
  Example: \`"\xE9tude"|detect_encoding\`  
  Result: \`UTF-8\`

- **to_utf8**  
  Convert the supplied text from its binary form (ISO-8859-1) to UTF-8.  
  Example: \`"\uFFFDtudes"|to_utf8\`  
  Result: \`"\xE9tudes"\`

- **from_utf8**  
  Convert the supplied text from UTF-8 to its binary form (ISO-8859-1).  
  Example: \`"\xE9tudes"|from_utf8\`  
  Result: \`"\uFFFDtudes"\`

- **convert_encoding**  
  Convert the character encoding of the supplied text.  
  Example: \`"\xE9tudes"|convert_encoding:"ISO-8859-1":"UTF-8"\`  
  Result: \`"\uFFFDtudes"\`

- **lower**  
  Converts all characters to lower case and returns the result.  
  Example: \`"Epic Battle"|lower\`  
  Result: \`"epic battle"\`

- **upper**  
  Converts all characters to upper case and returns the result.  
  Example: \`"Epic Battle"|upper\`  
  Result: \`"EPIC BATTLE"\`

- **trim**  
  Trim whitespace or other characters from both sides and return the result.  
  Example: \`"  Epic Battle  "|trim\`  
  Result: \`"Epic Battle"\`

- **ltrim**  
  Trim whitespace or other characters from the left side and return the result.  
  Example: \`"  Epic Battle  "|ltrim\`  
  Result: \`"Epic Battle  "\`

- **rtrim**  
  Trim whitespace or other characters from the right return the result.  
  Example: \`"  Epic Battle  "|rtrim\`  
  Result: \`"  Epic Battle"\`

- **capitalize**  
  Converts the first letter of each word to a capital letter.  
  Example: \`"epic battle"|capitalize\`  
  Result: \`"Epic Battle"\`

- **substr**  
  Extracts a section of text.  
  Example: \`"Epic Battle"|substr:5:6\`  
  Result: \`"Battle"\`

- **split**  
  Splits text into an array of text and returns the result.  
  Example: \`"Epic Battle"|split:" "\`  
  Result: \`["Epic","Battle"]\`

- **join**  
  Joins an array into a text string via the separator and returns the result.  
  Example: \`["Epic","Battle"]|join:" "\`  
  Result: \`"Epic Battle"\`

- **array_slice**  
  Extract a section from an array.  
  Example: \`[1,2,3,4,5]|array_slice:2:2\`  
  Result: \`[3,4]\`

- **strlen**  
  Returns the number of characters.  
  Example: \`"Epic Battle"|strlen\`  
  Result: \`11\`

- **strip_tags**  
  Removes HTML tags from a string.  
  Example: \`"<p>Epic Battle</p>"|strip_html\`  
  Result: \`"Epic Battle"\`

- **strip_accents**  
  Removes accents from characters.  
  Example: \`"\xE9tudes"|unaccent\`  
  Result: \`"etudes"\`

- **strpos**  
  Returns the index of the case-sensitive expression or false if it can't be found.  
  Example: \`"Epic Battle"|strpos:"Battle"\`  
  Result: \`5\`

- **stripos**  
  Returns the index of the case-insensitive expression or false if it can't be found.  
  Example: \`"Epic Battle"|stripos:"battle"\`  
  Result: \`5\`

- **starts_with**  
  Returns whether or not the expression is present at the beginning.  
  Example: \`"Epic Battle"|starts_with:"Epic"\`  
  Result: \`true\`

- **istarts_with**  
  Returns whether or not the case-insensitive expression is present at the beginning.  
  Example: \`"Epic Battle"|istarts_with:"epic"\`  
  Result: \`true\`

- **ends_with**  
  Returns whether or not the expression is present at the end.  
  Example: \`"Epic Battle"|ends_with:"Battle"\`  
  Result: \`true\`

- **iends_with**  
  Returns whether or not the case-insensitive expression is present at the end.  
  Example: \`"Epic Battle"|iends_with:"battle"\`  
  Result: \`true\`

- **contains**  
  Returns whether or not the expression is found.  
  Example: \`"Epic Battle"|contains:"Battle"\`  
  Result: \`true\`

- **icontains**  
  Returns whether or not the case-insensitive expression is found.  
  Example: \`"Epic Battle"|icontains:"battle"\`  
  Result: \`true\`

- **concat**  
  Concatenates two values together.  
  Example: \`"Hello" | concat:"World!":" - "\`  
  Result: \`"Hello - World!"\`

- **sprintf**  
  Formats text with variable substitution.  
  Example: \`"Hello %s, you have %d new messages"|sprintf:"Bob":5\`  
  Result: \`"Hello Bob, you have 5 new messages"\`

- **string_replace**  
  Replace all occurrences of a text phrase with another.  
  Example: \`"Hella World"|string_replace:"o":"a"\`  
  Result: \`"Hella Warld"\`

- **regex_test**  
  Tests if a regular expression matches the supplied subject text.  
  Example: \`"/^a.*c$/"|regex_test:"abbbbc"\`  
  Result: \`true\`

- **regex_match**  
  Return the first set of matches performed by a regular expression on the supplied subject text.  
  Example: \`"/(\\\\w+)@(\\\\w+).(\\\\w+)/"|regex_match:"test@example.com"\`  
  Result: \`["test@example.com","test","example","com"]\`

- **regex_match_all**  
  Return all matches performed by a regular expression on the supplied subject text.  
  Example: \`"/\\\\b\\\\w+@\\\\w+.\\\\w+\\\\b/"|regex_match_all:"test@example.com"\`  
  Result: \`[["test@example.com"]]\`

- **regex_quote**  
  Update the supplied text value to be properly escaped for regular expressions.  
  Example: \`"Hello. How are you?"|regex_quote:"/"\`  
  Result: \`"Hello\\\\. How are you\\\\?"\`

- **regex_replace**  
  Perform a regular expression search and replace on the supplied subject text.  
  Example: \`"/\\\\s+/"|regex_replace:"-":"Hello   World"\`  
  Result: \`"Hello-World"\`

## Object/Manipulation Expressions

- **set**  
  Sets a value at the path within the object and returns the updated object.  
  Example: \`{"fizz":"buzz"}|set:"foo":"bar"\`  
  Result: \`{"fizz": "buzz","foo":"bar"}\`

- **set_conditional**  
  Sets a value at the path within the object and returns the updated object, if the conditional expression is true.  
  Example: \`{'fizz':'buzz'}|set_conditional:'foo':'bar':2==1+1\`  
  Result: \`{'fizz':'buzz','foo':'bar'}\`

- **set_ifnotempty**  
  Sets a value (if it is not empty: "", null, 0, "0", false, [], {}) at the path within the object and returns the updated object.  
  Example: \`{'fizz':'buzz'}|set_ifnotempty:'foo':'bar'\`  
  Result: \`{'fizz':'buzz','foo':'bar'}\`

- **set_ifnotnull**  
  Sets a value (if it is not null) at the path within the object and returns the updated object.  
  Example: \`{'fizz':'buzz'}|set_ifnotnull:'foo':'bar'\`  
  Result: \`{'fizz':'buzz','foo':'bar'}\`

- **first_notnull**  
  Returns the first value that is not null.  
  Example: \`null|first_notnull:0\`  
  Result: \`0\`

- **first_notempty**  
  Returns the first value that is not empty - i.e. not ("", null, 0, "0", false, [], {}).  
  Example: \`""|first_notempty:1\`  
  Result: \`1\`

- **unset**  
  Removes a value at the path within the object and returns the updated object.  
  Example: \`{'fizz':'buzz','foo':'bar'}|unset:'foo'\`  
  Result: \`{'fizz':'buzz'}\`

- **transform**  
   Processes an expression with local data bound to the $this variable.  
  Example: \`2|transform:$$+3"\` 
Result:\`5\`

- **get**  
  Returns the value of an object at the specified path.  
  Example: \`{'fizz':'buzz'}|get:'fizz'\`  
  Result: \`"buzz"\`

- **has**  
  Returns the existence of whether or not something is present in the object at the specified path.  
  Example: \`{'fizz':'buzz'}|has:'fizz'\`  
  Result: \`true\`

- **array_fill**  
  Create an array of a certain size with a default value.  
  Example: \`"v"|array_fill:0:6\`  
  Result: \`["v","v","v","v","v","v"]\`

- **array_fill_keys**  
  Create an array of keys with a default value.  
  Example: \`key|array_fill_keys:["a","b","c"]\`  
  Result: \`{"a":"key","b":"key","c":"key"}\`

- **array_keys**  
  Get the property keys of an object/array as a numerically indexed array.  
  Example: \`{"a":1,"b":2,"c":3}|array_keys\`  
  Result: \`["a","b","c"]\`

- **array_values**  
  Get the property values of an object/array as a numerically indexed array.  
  Example: \`{"a":1,"b":2,"c":3}|array_values\`  
  Result: \`[1,2,3]\`

- **array_entries**  
  Get the property entries of an object/array as a numerically indexed array of key/value pairs.  
  Example: \`{"a":1,"b":2,"c":3}|array_entries\`  
  Result: \`[{key:"a",value:1},{key:"b",value:2},{key:"c",value:3}]\`

- **create_object**  
  Creates an object based on a list of keys and a list of values.  
  Example: \`["a","b","c"]|create_object:[1,2,3]\`  
  Result: \`{"a":1,"b":2,"c":3}\`

- **create_object_from_entries**  
  Creates an object based on an array of key/value pairs. (i.e. same result as the entries filter).  
  Example: \`[{key:"a",value:1},{key:"b",value:2},{key:"c",value:3}]|create_object_from_entries\`  
  Result: \`{"a":1,"b":2,"c":3}\`

## Date/Time/Timestamp Expressions

- **to_timestamp**  
  Converts a text expression (now, next friday, Jan 1 2000) to timestamp compatible format.  
  Example: \`"next friday"|to_timestamp:"America/Los_Angeles"\`  
  Result: \`1758265200000\`

- **to_ms**  
  Converts a text expression (now, next friday, Jan 1 2000) to the number of milliseconds since the unix epoch.  
  Example: \`"next friday"|to_ms:"America/Los_Angeles"\`  
  Result: \`1758265200000\`

- **to_seconds**  
  Converts a text expression (now, next friday, Jan 1 2000) to the number of seconds since the unix epoch.  
  Example: \`"next friday"|to_seconds:"America/Los_Angeles"\`  
  Result: \`1758265200\`

- **to_minutes**  
  Converts a text expression (now, next friday, Jan 1 2000) to the number of minutes since the unix epoch.  
  Example: \`"next friday"|to_minutes:"America/Los_Angeles"\`  
  Result: \`29304420\`

- **to_hours**  
  Converts a text expression (now, next friday, Jan 1 2000) to the number of hours since the unix epoch.  
  Example: \`"next friday"|to_hours:"America/Los_Angeles"\`  
  Result: \`488407\`

- **to_days**  
  Converts a text expression (now, next friday, Jan 1 2000) to the number of days since the unix epoch.  
  Example: \`"next friday"|to_days:"America/Los_Angeles"\`  
  Result: \`20350\`

- **parse_timestamp**  
  Parse a timestamp from a flexible format.  
  Example: \`"2023-08-15 13:45:30"|parse_timestamp:"Y-m-d H:i:s":"America/Los_Angeles"\`  
  Result: \`"1692132330000"\`

- **format_timestamp**  
  Converts a timestamp into a human readable formatted date based on the supplied format.  
  Example: \`"1692132330000"|format_timestamp:"Y-m-d H:i:s":"America/New_York"\`  
  Result: \`"2023-08-15 16:45:30"\`

- **transform_timestamp**  
  Takes a timestamp and applies a relative transformation to it. Ex. -7 days, last Monday, first day of this month.  
  Example: \`"2023-08-15T20:45:30.000Z"|transform_timestamp:"-7 days":"America/Los_Angeles"\`  
  Result: \`"1691527530000"\`

- **add_secs_to_timestamp**  
  Add seconds to a timestamp. (negative values are ok)  
  Example: \`1691527530000|add_secs_to_timestamp:60\`  
  Result: \`1691527590000\`

- **add_ms_to_timestamp**  
  Add milliseconds to a timestamp. (negative values are ok)  
  Example: \`monday|add_ms_to_timestamp:500\`  
  Result: \`1758499200500\`

## Comparison/Logical Expressions

- **eq**  
  Returns a boolean if both values are equal.  
  Example: \`4|eq:4\`  
  Result: \`true\`

- **ne**  
  Returns a boolean if both values are not equal.  
  Example: \`4|ne:4\`  
  Result: \`false\`

- **gt**  
  Returns a boolean if the left value is greater than the right value.  
  Example: \`4|gt:2\`  
  Result: \`true\`

- **gte**  
  Returns a boolean if the left value is greater than or equal to the right value.  
  Example: \`4|gte:2\`  
  Result: \`true\`

- **lt**  
  Returns a boolean if the left value is less than the right value.  
  Example: \`4|lt:2\`  
  Result: \`false\`

- **lte**  
  Returns a boolean if the left value is less than or equal to the right value.  
  Example: \`4|lte:2\`  
  Result: \`false\`

- **odd**  
  Returns whether or not the value is odd.  
  Example: \`4|odd\`  
  Result: \`false\`

- **even**  
  Returns whether or not the value is even.  
  Example: \`4|even\`  
  Result: \`true\`

- **in**  
  Returns whether or not the value is in the array.  
  Example: \`[1,2,3]|in:3\`  
  Result: \`true\`

- **not**  
  Returns the opposite of the existing value evaluated as a boolean.  
  Example: \`true|not\`  
  Result: \`false\`

- **bitwise_not**  
  Returns the existing value with its bits flipped.  
  Example: \`8|bitwise_not\`  
  Result: \`-9\`

- **null**  
  Returns whether or not the value is null.  
  Example: \`8|is_null\`  
  Result: \`false\`

- **empty**  
  Returns whether or not the value is empty ("", null, 0, "0", false, [], {}).  
  Example: \`[]|is_empty\`  
  Result: \`true\`

- **is_object**  
  Returns whether or not the value is an object.  
  Example: \`{id:2, value:3, size:4}|is_object\`  
  Result: \`true\`

- **is_array**  
  Returns whether or not the value is a numerical indexed array.  
  Example: \`[1,2,3]|is_array\`  
  Result: \`true\`

- **is_int**  
  Returns whether or not the value is an integer.  
  Example: \`123|is_int\`  
  Result: \`true\`

- **is_decimal**  
  Returns whether or not the value is a decimal value.  
  Example: \`123.45|is_decimal\`  
  Result: \`true\`

- **is_bool**  
  Returns whether or not the value is a boolean.  
  Example: \`false|is_bool\`  
  Result: \`true\`

- **is_text**  
  Returns whether or not the value is text.  
  Example: \`"213"|is_text\`  
  Result: \`true\`

## Security/Crypto Expressions

- **encrypt**  
  Encrypts the value and returns the result in raw binary form.  
  Example: \`"hello"|encrypt:"aes-192-cbc":"1494AX6XJUsDe51kF9S9sA==":"27222b6032574bad"\`  
  Result: \`"\uFFFD\uFFFD\uFFFDZ \uFFFDr|5\uFFFD\uFFFD\uFFFD~\uFFFDl"\`

- **decrypt**  
  Decrypts the value and returns the result.  
  Example: \`"...encrypted..."|decrypt:"aes-192-cbc":"1494AX6XJUsDe51kF9S9sA==":"27222b6032574bad"\`  
  Result: \`"hello"\`

- **crypto_jws_encode**  
  Encodes the value and returns the result as a JWS token.  
  Example: \`"hello"|jws_encode:{sub: "1234567890",name: "John Doe",admin: true,iat: 1516239022}:"a-string-secret-at-least-256-bits-long":HS256\`  
  Result: \`"...encrypted..."\`

- **crypto_jws_decode**  
  Decodes the JWS token and returns the result.  
  Example: \`"eyJzd...ZYw"|jws_decode:{}:"a-string-secret-at-least-256-bits-long":HS256\`  
  Result: \`"hello"\`

- **crypto_jwe_encode**  
  Encodes the value and returns the result as a JWE token.  
  Example: \`"hello"|jwe_encode:{sub: "1234567890",name: "John Doe",admin: true,iat: 1516239022}:"a-string-secret-at-least-256-bits-long":"A256KW":"A256CBC-HS512"\`  
  Result: \`"...encrypted..."\`

- **crypto_jwe_decode**  
  Decodes the JWE token and returns the result.  
  Example: \`"eyJ...Xw"|jwe_decode:{}:"a-string-secret-at-least-256-bits-long":"A256KW":"A256CBC-HS512"\`  
  Result: \`"hello"\`

- **secureid_encode**  
  Returns an encrypted version of the id.  
  Example: \`12345|secureid_encode:"my_salt"\`  
  Result: \`"ZlV3Lg.-0-UZyQ9xQk"\`

- **secureid_decode**  
  Returns the id of the original encode.  
  Example: \`"ZlV3Lg.-0-UZyQ9xQk"|secureid_decode:"my_salt"\`  
  Result: \`12345\`

- **md5**  
  Returns a MD5 signature representation of the value.  
  Example: \`"some_message"|md5\`  
  Result: \`"af8a2aae147de3350f6c0f1a075ede5d"\`

- **sha1**  
  Returns a SHA1 signature representation of the value.  
  Example: \`"some_message"|sha1\`  
  Result: \`"33a374032... (truncated) ..."\`

- **sha256**  
  Returns a SHA256 signature representation of the value.  
  Example: \`"some_message"|sha256\`  
  Result: \`"6cc869f10009fa1... (truncated) ..."\`

- **sha384**  
  Returns a SHA384 signature representation of the value.  
  Example: \`"some_message"|sha384\`  
  Result: \`"17a7717060650457... (truncated) ..."\`

- **sha512**  
  Returns a SHA512 signature representation of the value.  
  Example: \`"some_message"|sha512\`  
  Result: \`"40aaa4e84e7d98e472d240f1c84298de... (truncated) ..."\`

- **hmac_md5**  
  Returns a MD5 signature representation of the value using a shared secret via the HMAC method.  
  Example: \`"some_message"|hmac_md5:MY_SECRET_KEY\`  
  Result: \`"c4c1007ea935001cc7734b360395fb1d"\`

- **hmac_sha1**  
  Returns a SHA1 signature representation of the value using a shared secret via the HMAC method.  
  Example: \`"some_message"|hmac_sha1:MY_SECRET_KEY\`  
  Result: \`"83b48df25eda2... (truncated) ..."\`

- **hmac_sha256**  
  Returns a SHA256 signature representation of the value using a shared secret via the HMAC method.  
  Example: \`"some_message"|hmac_sha256:MY_SECRET_KEY\`  
  Result: \`"3e18fc78d5326e5... (truncated) ..."\`

- **hmac_sha384**  
  Returns a SHA384 signature representation of the value using a shared secret via the HMAC method.  
  Example: \`"some_message"|hmac_sha384:MY_SECRET_KEY\`  
  Result: \`"60818f7b6e6... (truncated) ..."\`

- **hmac_sha512**  
  Returns a SHA512 signature representation of the value using a shared secret via the HMAC method.  
  Example: \`"some_message"|hmac_sha512:MY_SECRET_KEY\`  
  Result: \`"880c17f6d5fa9e1ea3b7... (truncated) ..."\`

- **uid**  
  Returns a unique 64bit unsigned int value seeded off the value.  
  Example: \`|uid\`  
  Result: \`14567891234567890\`

- **uuid4**  
  Returns a universally unique identifier.  
  Example: \`|uuid4\`  
  Result: \`"550e8400-e29b-41d4-a716-446655440000"\`

## Transform/Type Conversion Expressions

- **to_expr**  
  Converts text into an expression, processes it, and returns the result.  
  Example: \`"(2 + 1) % 2"|to_expr\`  
  Result: \`1\`

- **to_text**  
  Converts integer, decimal, or bool types to text and returns the result.  
  Example: \`1.344|to_text\`  
  Result: \`"1.344"\`

- **to_int**  
  Converts text, decimal, or bool types to an integer and returns the result.  
  Example: \`"133.45 kg"|to_int\`  
  Result: \`133\`

- **to_decimal**  
  Converts text, integer, or bool types to a decimal and returns the result.  
  Example: \`"133.45 kg"|to_decimal\`  
  Result: \`133.45\`

- **to_bool**  
  Converts text, integer, or decimal types to a bool and returns the result.  
  Example: \`"true"|to_bool\`  
  Result: \`true\`

- **json_decode**  
  Decodes the value represented as json and returns the result.  
  Example: \`'{"a":1,"b":2,"c":3}'|json_decode\`  
  Result: \`{"a":1,"b":2,"c":3}\`

- **json_encode**  
  Encodes the value and returns the result as json text.  
  Example: \`{"a":1,"b":2,"c":3}|json_encode\`  
  Result: \`'{"a":1,"b":2,"c":3}'\`

- **xml_decode**  
  Decodes XML and returns the result.  
  Example: \`"<root><a>1</a><b>2</b><c>3</c></root>"|xml_decode\`  
  Result: \`{ "root": { "@attributes": [], "value": [ { "a": { "@attributes": [], "value": "1" } }, { "b": { "@attributes": [], "value": "2" } } ] } }\`

- **yaml_decode**  
  Decodes the value represented as yaml and returns the result.  
  Example: \`"a: 1\\nb: 2\\nc: 3"|yaml_decode\`  
  Result: \`{"a":1,"b":2,"c":3}\`

- **yaml_encode**  
  Encodes the value and returns the result as yaml text.  
  Example: \`{"a":1,"b":2,"c":3}|yaml_encode\`  
  Result: \`'a: 1\\nb: 2\\nc: 3\\n'\`

- **hex2bin**  
  Converts a hex value into its binary equivalent.  
  Example: \`"68656c6c6f"|hex2bin\`  
  Result: \`"hello"\`

- **bin2hex**  
  Converts a binary value into its hex equivalent.  
  Example: \`"hello"|bin2hex\`  
  Result: \`"68656c6c6f"\`

- **dechex**  
  Converts a decimal value into its hex equivalent.  
  Example: \`"255"|dechex\`  
  Result: \`"ff"\`

- **hexdec**  
  Converts a hex value into its decimal equivalent.  
  Example: \`"ff"|hexdec\`  
  Result: \`"255"\`

- **decbin**  
  Converts a decimal value into its binary string (i.e. 01010) equivalent.  
  Example: \`"10"|decbin\`  
  Result: \`"1010"\`

- **bindec**  
  Converts a binary string (i.e. 01010) into its decimal equivalent.  
  Example: \`"1010"|bindec\`  
  Result: \`"10"\`

- **decoct**  
  Converts a decimal value into its octal equivalent.  
  Example: \`"10"|decoct\`  
  Result: \`"12"\`

- **octdec**  
  Converts an octal value into its decimal equivalent.  
  Example: \`"12"|octdec\`  
  Result: \`"10"\`

- **base_convert**  
  Converts a value between two bases.  
  Example: \`"ff"|base_convert:16:10\`  
  Result: \`"255"\`

- **base64_decode**  
  Decodes the value represented as base64 text and returns the result.  
  Example: \`"aGVsbG8="|base64_decode\`  
  Result: \`"hello"\`

- **base64_encode**  
  Encodes the value and returns the result as base64 text.  
  Example: \`"hello"|base64_encode\`  
  Result: \`"aGVsbG8="\`

- **base64_decode_urlsafe**  
  Decodes the value represented as base64 urlsafe text and returns the result.  
  Example: \`"aGVsbG8_"|base64_decode_urlsafe\`  
  Result: \`"hello?"\`

- **base64_encode_urlsafe**  
  Encodes the value and returns the result as base64 urlsafe text.  
  Example: \`"hello?"|base64_encode_urlsafe\`  
  Result: \`"aGVsbG8_"\`

- **url_decode**  
  Decodes the value represented as a url encoded value.  
  Example: \`"Hello%2C%20World%21"|url_decode\`  
  Result: \`"Hello, World!"\`

- **url_decode_rfc3986**  
  Decodes the value represented as a url encoded value using the RFC 3986 specification.  
  Example: \`"Hello%2C%20World%21"|url_decode_rfc3986\`  
  Result: \`"Hello, World!"\`

- **url_encode**  
  Encodes the value and returns the result as a url encoded value.  
  Example: \`"Hello, World!"|url_encode\`  
  Result: \`"Hello%2C%20World%21"\`

- **url_encode_rfc3986**  
  Encodes the value and returns the result as a url encoded value using the RFC 3986 specification.  
  Example: \`"Hello, World!"|url_encode_rfc3986\`  
  Result: \`"Hello%2C%20World%21"\`
`;var hu=`---
applyTo: "**/*.xs"
---

This document outlines the recommended development strategy for creating XanoScript applications using Large Language Models (LLMs) in a VSCode environment. It emphasizes a structured, phased approach to ensure clarity, modularity, and maintainability while adhering to XanoScript syntax and best practices.

You'll want to work step by step through the phases below, ensuring each is complete before moving to the next. Always reference the relevant XanoScript documentation for syntax and examples, including:

1. Create or Edit Tables: \`tables/\` directory (see [Table Guideline](./docs/table_guideline.md) and [Table Examples](./docs/table_examples.md)). It's recommended to create tables without cross reference because Xano would reject the creation of table if the table it references does not exist yet. You can then add the relationships after all tables have been created. You can push all your changes invoking the \`push_all_changes_to_xano\` tool.
2. Create or Edit Functions: \`functions/\` directory (see [Function Guideline](./docs/function_guideline.md) and [Function Examples](./docs/function_examples.md)). When defining inputs for functions, refer to the [Input Guideline](./docs/input_guideline.md) for proper syntax and best practices.
3. Create or Edit API Endpoints: \`apis/\` directory (see [API Query Guideline](./docs/api_query_guideline.md) and [API Query Examples](./docs/api_query_examples.md)). When defining inputs for API endpoints, refer to the [Input Guideline](./docs/input_guideline.md) for proper syntax and best practices.
4. Create or Edit Scheduled Tasks: \`tasks/\` directory (see [Task Guideline](./docs/task_guideline.md) and [Task Examples](./docs/task_examples.md))
5. Ensure Xano backend is in sync with VSCode by pushing changes
6. When writing queries for database operations, refer to the [Database Query Guideline](./docs/db_query_guideline.md) for proper syntax and best practices.

## AI Agent Development

When developing AI agents, follow these steps:

1. **Define Tools**: Specify any tools the agent can use, ensuring they are defined in the \`tools/\` directory (see [Tool Guideline](./docs/tool_guideline.md) and [Tool Examples](./docs/tool_examples.md)).
2. **Define the Agent**: Create a new agent in the \`agents/\` directory using the XanoScript syntax (see [Agent Guideline](./docs/agent_guideline.md) and [Agent Examples](./docs/agent_examples.md)).

## AI MCP Server Development

When developing an MCP server (Model Context Protocol) to expose your tools to external clients and AI models, follow these steps:

1. **Define Tools**: Ensure the tools you want to expose are defined in the \`tools/\` directory (see [Tool Guideline](./docs/tool_guideline.md) and [Tool Examples](./docs/tool_examples.md)).
2. **Define the MCP Server**: Create a new MCP server in the \`mcp_servers/\` directory using the XanoScript syntax (see [MCP Server Guideline](./docs/mcp_server_guideline.md) and [MCP Server Examples](./docs/mcp_server_examples.md)).

## Frontend Building

Prior to building the frontend, ensure that all the changes have been pushed to the Xano backend (you should ask the user to confirm this). You should first proceed by retrieving the latest API specifications by invoking the \`get_xano_api_specifications\` tool. This will ensure that your frontend is aligned with the most recent backend configurations. You can then proceed to create or edit static assets in the \`static/\` directory, see [Frontend Guide](./docs/frontend_guideline.md).

## Additional Guidelines

- **Xanoscript Syntax**: Adhere strictly to XanoScript syntax rules. You can use comments with the \`//\` symbol, a comment needs to be on it's own line and outside a statement. Refer to the [Xano Tips and Tricks](./docs/tips_and_tricks.md) for details.
- **Expression**: Xano offers a rich set of expressions for data manipulation. Refer to the [Expression Lexicon](./docs/expression_guideline.md) for details. Avoid chaining too many expressions in a single line for readability, instead break them into intermediate variables.
- **Xano Statements**: Familiarize yourself with the available statements in XanoScript by consulting the [Function Lexicon](./docs/functions.md). Use control flow statements like \`if\`, \`foreach\`, and \`try_catch\` to manage logic effectively.
- **User Management**: Most Xano workspaces come with a built-in user auth and user table, avoid recreating these, the user table can be extended with the necessary columns and the the built-in auth functions can be customized accordingly.
- **Building from Loveable**: If the project is being built from a Loveable-generated website, follow the specific strategy outlined in the [Building from Loveable Guide](./docs/build_from_loveable.md).
`;var _P=`---
applyTo: "apis/**/*.xs"
---

Your role is to help the user create API Groups and API endpoints in XanoScript.

- **API Groups** are folders under the \`apis/\` directory.  
  Each API group must have a definition file at \`apis/<api_group_name>/api_group.xs\`.

- **API Endpoints** are \`.xs\` files inside an API group folder.  
  Each endpoint must define:
  - The query name and HTTP verb (e.g., \`products verb=GET\`)
  - An optional \`description\` field
  - An \`input\` block for request parameters
  - A \`stack\` block for processing logic
  - A \`response\` block for returned data

Always follow the [API Query Guideline](../docs/api_query_guideline.md) for structure and best practices.  
For inspiration and reference, see [API Query Examples](../docs/api_query_examples.md). When adding inputs, refer to the [Input Guideline](../docs/input_guideline.md) for proper syntax and best practices.

**Important:**

- use \`//\` for comments, comments need to be on their own line and outside a statement.
- Each endpoint must have an \`input\`, \`stack\`, and \`response\` block.
- Use the \`verb\` field to specify the HTTP method (GET, POST, etc.).
- Document your queries with \`description\` fields.
- Validate inputs and handle errors using \`precondition\` and control flow statements.
- All statements are available for use, refer to the [Function Lexicon](../docs/xanoscript_functions.md).
- For web responses, set the appropriate content type in the response block.

For more details, always refer to the linked guidelines and examples.
`;var vP=`---
applyTo: "tasks/*.xs"
---

# Xanoscript Custom Tasks Guide

This document serves as comprehensive instructions for generating custom tasks in Xanoscript. As an AI agent (e.g., copilot), use these guidelines to create robust, scheduled automation jobs based on user requests. Emphasize reliability, idempotency, and monitoring. Capture language subtleties: stacks execute sequentially (no branching unless conditional/foreach); schedules use UTC timestamps with freq in seconds (no cron); history enables audit trails; transactions ensure atomicity; env vars for secrets. Reference examples and syntax from supporting docs.

## Core Principles

- **Automation Rigidity**: Tasks are fire-and-forget; no inputs/outputs\u2014use env vars for config.
- **Execution Flow**: Stack is linear; foreach/while for iteration; conditional for branches; try_catch for resilience.
- **Scheduling Subtleties**: \`events\` array supports multiples (e.g., daily + weekly); \`starts_on\` UTC ISO (YYYY-MM-DD HH:MM:SS+0000); \`freq\` multiples of 3600 (hourly+); \`ends_on\` optional cutoff; no overlaps\u2014system dedupes.
- **Logging/Monitoring**: \`debug.log\` to stdout (structured JSON if object); \`history = "inherit"\` logs runs to DB (table: task_history).
- **Error Handling**: No global try_catch\u2014wrap risky ops (API/DB); failures retry per policy (not defined here).
- **Idempotency**: Use timestamps/unique checks; transactions for multi-ops.
- **Extensibility**: Call functions (\`function.run\`); API/DB helpers inherit auth.

## Task Structure

Every custom task follows this template, highlighting subtleties:

\`\`\`xs
task <task_name> {
  description = "<Purpose; logic summary; schedule hint; optional>"

  stack {
    var $<var_name> {
      value = <expr: now|math.*|db.*>
      description = "<Purpose; required for traces>"
    }

    db.query <table> {
      where = <bool expr: $db.<table>.<field> == val && ...>
      [output = ["field1", "field2"]]
      description = "<Purpose>"
    } as $<result>

    foreach ($array) {
      each as $<item> {
        db.edit/del/add <table> { ... }
      }
    }


    conditional {
      if (<bool>) {

      } elseif (<bool>) {

      } else {

      }
    }


    try_catch {
      try {
        api.request { ... }
      }
      catch {
        debug.log { value = "Err: " ~ $error.message }
      }
    }

    debug.log {
      value = <str|obj: {key: val}>
      description = "<Context>"
    }
  }

  schedule = [
    {starts_on: <YYYY-MM-DD HH:MM:SS+0000>, freq: <secs: 86400 daily>, [ends_on: <cutoff>]}
  ]

  [history = "inherit"]
}
\`\`\`

- **Name**: Kebab-case (e.g., \`monthly-user-cleanup\`); stored in \`tasks/<name>.xs\`.
- **Helpers Subtleties**: \`db.*\` uses table auth; \`api.request\` needs full URL/params/headers; \`math.add\` mutates var; \`now|transform_timestamp:<rel>:"tz"\` for dates.
- **No Params**: Hardcode or \`$env.<key>\` (e.g., API keys).
- **Transactions**: \`db.transaction { stack { ... } }\`\u2014rolls back on fail.

## Step-by-Step Creation Process

1. **Analyze Request**: Identify job (e.g., "Weekly stock alert"). Note tables/queries, actions (edit/add/del/API), conditions, freq (daily=86400s).
2. **Build Stack**:
   - Init vars (timestamps, counters).
   - Query data (\`search\` as SQL WHERE).
   - Loop/process (foreach; avoid >10k items\u2014paginate).
   - Actions (DB/API); wrap in try_catch/transactions.
   - Log start/counts/end (use objects for metrics).
3. **Set Schedule**: Future \`starts_on\` (e.g., next Monday); single event unless mixed freq.
4. **Add History**: \`{inherit: true}\` for audits.
5. **Validate Subtleties**: No infinite loops (while needs break); idempotent (e.g., check exists before add); UTC for all times.
6. **Review**: Simulate flow; ensure logs cover branches/fails.

## Common Patterns

- **Cleanup**: Query expired (\`where = $db.table_name.expires_at < now\`); foreach del; count/log.
- **Reports**: Query period (\`>= transform_timestamp:"7 days ago"\`); sum/agg; db.add in transaction.
- **Notifications**: Query due (\`end_date <= now + 604800000\`); foreach API/email; log sends.
- **Alerts**: Conditional on count>0; api.realtime_event for websockets.
- **AI/External**: try_catch function.run; fallback vars.
- **Pagination**: While has_next { db.query ... after: $cursor } for large sets.
- **Math/Date**: \`$now - (7*86400*1000)\` for ms offsets.

## Best Practices

- **Naming**: Action-oriented, freq-hinted (e.g., \`hourly-cache-purge\`).
- **Documentation**: \`description\` on task/stack/blocks for traces.
- **Performance**: Limit queries (<1M rows); batch DB ops; no deep nests.
- **Security**: \`$env\` for creds; auth-aware DB.
- **Resilience**: try_catch everywhere external; log errors with context (\`$error.message\`).
- **Length**: <100 lines; extract to functions.
- **Scheduling**: Freq aligns with load (off-peak); ends_on for temp tasks.
- **Subtleties**: No parallelism (sequential); history auto-prunes old.

## References

- [Full examples](../docs/task_examples.md)
- [Syntax details](../docs/task_guideline.md)
- [Core blocks](../docs/functions.md)
`;var yP=`---
applyTo: "functions/**/*.xs"
---

# Xanoscript Custom Functions Guide

This document serves as instructions for generating custom functions in Xanoscript. As an AI agent (e.g., copilot), use these guidelines to create reusable, well-structured functions based on user requests. Always prioritize clarity, validation, and error handling. Reference examples and syntax from supporting docs.

## Core Principles

- **Reusability**: Functions should encapsulate specific logic (e.g., calculations, data processing, API integrations) for use in queries, tasks, or other functions.
- **Validation**: Use \`input\` filters, \`precondition\`, and conditionals to ensure robust inputs.
- **Documentation**: Include \`description\` in the function and blocks for readability.
- **Output**: Always end with a \`response\` block; include tests where applicable.
- **Simplicity**: Keep logic concise; use built-in helpers (e.g., \`math.add\`, \`array.filter\`) from Xanoscript syntax.
- **Edge Cases**: Handle nulls, empties, and errors explicitly.

## Function Structure

Every custom function follows this template (note the absence of comments, xanoscript does not support them, instead it uses description fields):

\`\`\`xs
function <namespace>/<function_name> {
  description = "<Brief description of purpose and inputs/outputs>"

  input {
    <type> <param_name>[?=default] [filters=<filters>]  {
      description = "<Param description>"
      [sensitive = true/false]
    }

  }

  stack {
    var $<var_name> {
      value = <expression>
      description = "<Purpose>"
    }

    precondition (<condition>) {
      error_type = "inputerror"
      error = "<Error message>"
    }
  }

  response = $<result_var>

  test "<test_name>" {
    input = { <param>: <value>, ... }
    expect.to_equal $<response>.<field> {
      value = <expected>
    }
  }
}
\`\`\`

- **Namespace**: Use folders like \`utils/\`, \`maths/\`, \`hr/\` for organization (e.g., \`utils/parse_url\`).
- **Input Types**: \`int\`, \`text\`, \`decimal\`, \`bool\`, \`timestamp\`, \`decimal[]\` (arrays), etc. Mark optional with \`?\`.
- **Filters**: \`trim\`, \`lower\`, \`min:0\`, \`max:100\`, etc.
- **Stack Logic**: Sequential execution; group complex sections with \`group { ... }\`.

## Step-by-Step Creation Process

1. **Understand Request**: Identify purpose (e.g., "Format phone numbers"). Extract inputs/outputs.
2. **Define Inputs**: List params with types, defaults, validations.
3. **Build Stack**:
   - Init vars.
   - Validate (preconditions first, then conditionals).
   - Compute core logic (loops, math, API calls).
   - Handle errors with \`throw\` or \`try_catch\`.
4. **Set Response**: Return single value or object (e.g., \`{ formatted: $result, original: $input }\`).
5. **Add Tests**: Cover happy path and 1-2 edge cases.
6. **Review**: Ensure no side effects; mock external deps (e.g., DB, API) if needed.

## Common Patterns

- **Calculations**: Use \`math.add\`, \`math.mul\` in loops for sums/products.
- **Arrays**: \`array.filter\`, \`array.merge\`, \`foreach\` for processing lists.
- **Validation**: Preconditions for quick fails; conditionals for branches.
- **API/DB**: \`api.request\` or \`db.query\` with mocks in tests.
- **Errors**: \`throw { name = "ValidationError", value = "Msg" }\`.

## Best Practices

- **Naming**: Kebab-case for names; descriptive vars (e.g., \`$total_weight\`).
- **Comments**: Use \`description\` in vars/blocks; Comments can be used using \`//\` but should be placed before or after a statement block.
- **Performance**: Avoid deep nests; use efficient helpers.
- **Security**: Mark \`sensitive = true\` for PII; validate all inputs.
- **Length**: Aim for <200 lines; refactor if complex.
- **Versioning**: If updating, note changes in description.

## References

- [Full examples](../docs/function_examples.md)
- [Function lexicon](../docs/xanoscript_functions.md)
- [Syntax details](../docs/functions.md)
- [Function guidelines (adapt for function calls)](../docs/function_guideline.md)
- [Input guidelines](../docs/input_guideline.md)

When generating, output only the Xanoscript code unless specified. If unclear, ask for clarification on inputs/outputs.
`;var wP='---\napplyTo: "tables/*.xs"\n---\n\n# Xanoscript Custom Tables Guide\n\nThis document serves as comprehensive instructions for generating custom tables in Xanoscript. As an AI agent (e.g., copilot), use these guidelines to create robust database schemas based on user requests. Emphasize data integrity, query optimization, and relational modeling. Capture language subtleties: field types enforce storage/validation; relations via `table` imply foreign keys (no auto-cascade); indexes support composite/multi-field with ops; enums are inline-defined; auth toggles row-level security. Reference examples and syntax from supporting docs.\n\n## Core Principles\n\n- **Schema Rigidity**: Fields define type-enforced columns; filters apply on insert/update (e.g., `trim` strips whitespace, `lower` normalizes case).\n- **Relations**: `table` links to another table\'s primary key; supports scalars (`int user_id { table = "user" }`) and arrays (`int[] category_ids { table = "category" }` for many-to-many).\n- **Indexing Subtleties**: `primary` auto-generates sequence/UUID; `btree` for sorted/range queries (add `|unique` for no-dups); `gin` for full-text/JSON ops; composite indexes via field arrays; `op: "asc/desc"` for sort direction; no explicit foreign key constraints\u2014handle in app logic.\n- **Security/Defaults**: `auth = true` enables per-row auth via policies; `sensitive = true` flags PII for encryption/logging; defaults (`?=now`) apply on insert if null.\n- **Extensibility**: `json` for schemaless data; `vector` for embeddings; media types (`image`, etc.) store URLs/blobs.\n- **Documentation**: `description` on table/fields for auto-gen docs; enums have inline `values` array.\n\n## Table Structure\n\nEvery custom table follows this template, highlighting subtleties:\n\n```xs\ntable <table_name> [description = "<Table purpose; optional, for metadata>"] {\n  auth = <true/false>  // true: enables row-level security; false: public access\n\n  schema {\n    <type> <field_name> [? for optional] [filters=<pipe-separated: trim|lower|min:0|max:100|etc>] [?= <default: now|null|literal>] {\n      description = "<Field purpose; required for clarity>"\n      [sensitive = true]  // Flags for encryption/auditing; optional\n      [table = "<related_table>"]  // FK relation; optional, infers type match\n    }\n    // Enum example:\n    enum <field_name>? {\n      values = ["val1", "val2"]  // Required array; strings only\n      description = "<Enum purpose>"\n    }\n    // Array example:\n    <type>[] <field_name> { table = "<related_table>" }\n  }\n\n  index = [  // Array of index defs; order matters for optimizer hints\n    {type: "primary", field: [{name: "id"}]}  // Auto: int seq or uuid gen\n    {type: "btree|unique", field: [{name: "email", op: "asc"}]}  // Unique, sorted asc\n    {type: "btree", field: [  // Composite: multi-field, ops per field\n      {name: "user_id", op: "asc"},\n      {name: "created_at", op: "desc"}\n    ]}\n    {type: "gin", field: [{name: "json_field"}]}  // For @> ops on JSON/arrays\n    // No op on gin; supports jsonb_path_op for advanced\n  ]\n}\n```\n\n- **Name**: Snake_case plural (e.g., `user_profiles`); no spaces.\n- **Types**: `int` (32-bit, auto-inc if primary), `decimal` (precise floats), `bool` (true/false), `timestamp` (UTC ms), `date` (YYYY-MM-DD), `uuid` (v4 gen), `vector` (float[] for ML), `json` (object/array), `enum` (string subset), media (`image` stores URL/blob ref).\n- **Filters**: Chained via `|`; type-specific (e.g., `email` auto-validates format).\n- **Defaults**: Evaluated at insert; `now` is UTC timestamp; supports expressions like `?=1`.\n- **Relations Subtleties**: `table` doesn\'t enforce referential integrity (no on-delete); use in queries for joins; arrays imply junction table logic in app.\n- **Index Subtleties**: `type` pipes modifiers (`btree|hash`); field array allows partial indexes (e.g., where clause via app); gin for tsvector/full-text.\n\n## Step-by-Step Creation Process\n\n1. **Analyze Request**: Map entity (e.g., "Order table with customer relation"). List fields (type, req/opt, defaults), relations (FKs/M2M), indexes (query patterns: unique on email, composite on user+date).\n2. **Define Schema**:\n   - ID first: `uuid id` or `int id` (primary).\n   - Core fields: Typed, filtered, described.\n   - Relations: Add `table` where linked.\n   - Extras: `json metadata?` for flex; enum for states.\n3. **Configure Auth/Desc**: `auth=true` for user data; table `description` if complex.\n4. **Build Indexes**:\n   - Primary: Always on ID.\n   - Unique: On natural keys (email, slug).\n   - Btree: On filters/sorts (stock asc, date desc).\n   - Gin: On searchables (JSON, full-text).\n   - Composites: Prefix common queries (user_id + timestamp).\n5. **Validate Subtleties**: Ensure type matches relations (int to int PK); test filters (min:0 prevents negatives); no cycles in relations.\n6. **Review**: Simulate inserts/queries; check for missing uniques/indexes.\n\n## Common Patterns\n\n- **Audit Fields**: `timestamp created_at?=now`, `timestamp updated_at?=now` (trigger auto-update).\n- **Status Enums**: `enum status { values = ["active", "inactive", "pending"] }`.\n- **M2M Relations**: `uuid[] tag_ids { table = "tags" }`; query via unnest/join.\n- **Searchable JSON**: `json attributes { description = "Key-value props" }` + gin index.\n- **Media**: `attachment profile_pic?` (stores file ref); sensitive if PII.\n- **Partial Indexes**: App-enforced (e.g., unique on active emails via query where).\n- **Vector Embeddings**: `vector embedding (dim:1536)` for semantic search.\n\n## Best Practices\n\n- **Naming**: Fields snake_case; consistent (e.g., `_id` suffixes for FKs).\n- **Normalization**: 3NF; use relations over duplication.\n- **Performance**: Index 80% of queries; limit composites to 3 fields; gin for >10% JSON ops.\n- **Security**: `sensitive=true` on passwords/emails; `auth=true`\n- **Extensibility**: Opt for `?` on future fields; json for variants.\n- **Length**: <30 fields/table; split if > (e.g., user vs profile).\n- **Enums**: Exhaustive values; no nulls (use separate bool?).\n- **Defaults/Subtleties**: Avoid computed defaults (use functions); timestamps auto-UTC.\n\n## References\n\n- [Full examples](../docs/table_examples.md)\n- [Syntax details](../docs/table_guideline.md)\n';var bP=`---
applyTo: "**/*.xs"
---

# Tips and Tricks

## Variable definition

Xano doesn't have a concept of variable scope, you can define a variable anywhere in the stack and use it anywhere else.

\`\`\`xs
var $greeting {
  value = "Hello, World!"
}
\`\`\`

if defining an object or array, use \`{}\` or \`[]\`:

\`\`\`xs
var $user {
  value = {
    name: "John Doe"
    email: "john.doe@example.com"
  }
}
\`\`\`

\`\`\`xs
var $numbers {
  value = [1, 2, 3, 4, 5]
}
\`\`\`

## External API requests

When making an external API request, you'll want to use \`params\` for the request body, there is \`body\` keyword

## Comments

Use description argument on the statement or a comment \`//\` above it. Do not use description on responses, they do not support it.

\`\`\`xs
// A simple hello world function
function hello_world {
  input {
    // The name of the person to greet
    text name
  }

  stack {
    // A simple greeting message
    var $greeting {
      value = "Hello, World!"
    }
  }

  response = $greeting
}
\`\`\`

## Environment Variables

Always assume secrets and other configuration values are stored in the $env.<variable_name>, it's the responsibility of the user to create the values. Do not create a \`.env\` file. When adding a new environment variable, make sure to document it clearly and provide instructions for how to set it up.

## Conditionals

Conditionals accepts only one \`if\` and one \`else\` but you can add many \`elseif\` blocks.

## Existing logic and data schema

Try to reuse existing logic and data schema whenever possible. This includes using existing functions, API groups, data models, and API endpoints to avoid duplication and ensure consistency across your application.

## Large text

When dealing with large body of text (like a webpage, email body, AI prompt) it's best practice to use the \`util.template_engine\` function to manage and format the text efficiently. This templating system uses TWIG syntax.

\`\`\`xs
    util.template_engine {
      description = "Create HTML table from event data"
      value = """
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Created At</th>
              <th>Type</th>
              <th>User ID</th>
              <th>Metadata</th>
              <th>Source</th>
              <th>IP Address</th>
            </tr>
          </thead>
          <tbody>
            {% for event in events %}
            <tr>
              <td>{{ event.id }}</td>
              <td>{{ event.created_at|format_timestamp("Y-m-d H:i:s", "UTC") }}</td>
              <td>{{ event.type }}</td>
              <td>{{ event.user_id ? event.user_id : "-" }}</td>
              <td>{{ event.metadata ? event.metadata : "-" }}</td>
              <td>{{ event.source ? event.source : "-" }}</td>
              <td>{{ event.ip_address ? event.ip_address : "-" }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        """
    } as $html_table
\`\`\`

## Filters

Xanoscript filters on inputs and values are inspired by TWIG, they use \`|\` to separate the variable from the filter. For example on an input block:

\`\`\`xs
input {
  text filters=trim|lower {
    description = "Filters to apply to the text input"
  }
}
\`\`\`

or a variable:

\`\`\`xs
var $formatted_date {
  value = $event.created_at|format_timestamp("Y-m-d H:i:s", "UTC")
}
\`\`\`

or a schema:

\`\`\`xs
table event {
  schema {
    int id
    timestamp created_at?=now
    text type filters=trim|lower
    int user_id? filters=min:0
    text metadata? filters=trim
    text source? filters=trim|lower
    text ip_address? filters=trim
  }
}
\`\`\`
`;var xP=`---
applyTo: "agents/**/*.xs"
---

# Xanoscript Agent Examples

Below are some examples of agent configurations that can be made using Xanoscript. The \`xano-free\` model is a free, rate-limited model ideal for testing and development. Other examples showcase configurations for popular LLMs like Google Gemini, OpenAI, and Anthropic Claude and will require appropriate API keys.

## Xano Test Agent

A free, rate-limited model for testing and development, powered by our included \`xano-free\` model which runs on Google Gemini. Ideal for new users.

\`\`\`xs
agent "Xano Test Agent" {
  canonical = "x-test-123"
  llm = {
    type         : "xano-free"
    system_prompt: "You are a test AI Agent. Respond clearly and concisely."
    prompt       : "{{ $args.message }}"
    max_steps    : 3
    temperature     : 0
    search_grounding: false
  }
  tools = []
}
\`\`\`

## Google Gemini Agent

An agent using Google Gemini 1.5 Flash

\`\`\`xs
agent "Google Gemini Agent" {
  description = "An agent using Google Gemini 1.5 Flash."
  canonical = "ggl-gem-456"
  llm = {
    type         : "google-genai"
    system_prompt: "You are a helpful AI Agent that uses its tools to find accurate information. Explain your reasoning."
    max_steps    : 5
    prompt       : "Fulfill this request for user {{ $args.user_id }}: {{ $args.user_message }}"
    api_key         : "{{ $env.gemini_key }}"
    model           : "gemini-1.5-flash"
    temperature     : 0.2
    search_grounding: false
    thinking_tokens : 8000
    include_thoughts: true
  }
  tools = [
    "tool-get-user-info-abc",
    "tool-search-docs-def"
  ]
}
\`\`\`

## OpenAI Agent

A simple agent config for OpenAI models.

\`\`\`xs
agent "OpenAI Agent" {
  description = "A simple agent config for OpenAI models."
  canonical = "oai-gpt-789"
  llm = {
    type         : "openai"
    system_prompt: "You are a helpful AI Agent that completes tasks accurately. Use your tools when necessary."
    max_steps    : 3
    prompt       : "Handle this request: {{ $args.user_message }}"

    api_key         : "{{ $env.openai_key }}"
    model           : "gpt-4o"
    temperature     : 0.8
    reasoning_effort: "low"
    baseURL         : ""
  }
  tools = []
}
\`\`\`

## Anthropic Claude Agent

An agent powered by Claude 3.5 Sonnet.

\`\`\`xs
agent "Anthropic Claude Agent" {
  description = "An agent powered by Claude 3.5 Sonnet."
  canonical = "ant-son-101"
  llm = {
    type         : "anthropic"
    system_prompt: "You are a thoughtful and careful AI assistant. You must use tools to verify facts before answering. Break down complex problems step-by-step."
    max_steps    : 8
    prompt       : """
      Please assist with the following task:
      {{ $args.task_description }}
      """
    api_key        : "{{ $env.anthropic_key }}"
    model          : "claude-3-5-sonnet-20240620"
    temperature    : 0.3
    send_reasoning : true
  }
  tools = ["tool-verify-facts-ghi"]
}
\`\`\`

## Customer Support Agent with Tools

This agent is configured to use a set of tools to help with customer support tasks.

\`\`\`xs
agent "Customer Support Agent" {
  canonical = "support-agent-v2"
  llm = {
    type         : "openai"
    system_prompt: "You are a customer support agent. Use your tools to find customer information and resolve their issues."
    max_steps    : 5
    prompt       : "The customer with email {{ $args.email }} has the following issue: {{ $args.issue }}"
    api_key         : "{{ $env.openai_key }}"
    model           : "gpt-4o"
    temperature     : 0.5
  }

  tools = [
    { name: "get_user_details_by_email" },
    { name: "cancel_subscription" },
    { name: "create_support_ticket" }
  ]
}
\`\`\`
`;var TP=`---
applyTo: "agents/**/*.xs"
---

# Xanoscript Syntax Guide for Xano Agents

Xano Agents are autonomous entities that leverage Large Language Models (LLMs) from providers like OpenAI, Google, and Anthropic to perform complex tasks, interact with data, and execute tools.

Agents can be called in function stacks like [api endpoint](./api_query_guideline.md), [functions](./function_guideline.md) etc ... via the Call agent statement \`ai.agent.run\`.

For example, to pass a user query to an agent named "Task Management Agent" and allow it to execute tools, you would use:

\`\`\`xs
ai.agent.run "Task Management Agent" {
  args = {}|set:"prompt":$input.user_query
  allow_tool_execution = true
} as $task_agent
\`\`\`

## Core Concepts

- **Agent**: The top-level definition, containing the agent's identity, LLM configuration, and associated tools.
- **LLM Configuration**: Defines the AI provider, model, core instructions (system prompt), and provider-specific settings (e.g., temperature, reasoning).
- **Prompt**: The user-facing input template, which can be dynamically populated at runtime.
- **Tools**: A set of pre-defined Xano functions the agent can execute to gather information or perform actions.
- **Dynamic Variables**: Placeholders that insert runtime data into prompts and settings.
  - \`{{ $args.variable_name }}\`: For runtime arguments passed into the agent.
  - \`{{ $env.variable_name }}\`: For accessing Xano Environment Variables, primarily used for API keys.

## Core Agent Syntax

Every agent is defined within an \`agent\` block.

\`\`\`xs
agent "Agent Display Name" {
  canonical = "unique-agent-id"
  description = "A brief explanation of what this agent does."
  llm = {
    type: "xano-free"
    system_prompt: "You are a test AI Agent. Respond clearly and concisely."
    prompt: "{{ $args.message }}"
    max_steps    : 3
    temperature     : 0
    search_grounding: false
  }
  tools = [
    { name: "tool-name-1" },
    { name: "tool-name-2" }
  ]
}
\`\`\`

### Key Fields

- **\`agent "Name"\`**: The top-level declaration. The name is a human-readable string.
- **\`canonical\`**: A unique, non-changeable string identifier for the agent. This is required.
- **\`description\`**: An optional string for internal documentation.
- **\`llm\`**: An object containing all configuration for the Language Model. This block is required.
- **\`tools\`**: A list of objects, where each object references a pre-configured tool by its name. See Section 5 for details.

---

## LLM Configuration (\`llm\` block)

The \`llm\` block defines the behavior of the AI model. It consists of common properties and a provider-specific configuration object.

### Common LLM Properties

These properties are required for all agent configurations, regardless of the AI provider.

\`\`\`xs
llm = {
  type: "<provider_type>"
  system_prompt: "You are a helpful AI assistant..."
  max_steps: 5
  prompt: """
    User message: {{ $args.user_message }}
    User ID: {{ $args.user_id }}
    """
}
\`\`\`

- **\`type\`** (string): Specifies the LLM provider.
  - Valid values: \`xano-free\`, \`google-genai\`, \`openai\`, \`anthropic\`.
- **\`system_prompt\`** (string): The foundational instructions for the agent. It defines its persona, goals, constraints, and how it should use tools.
- **\`max_steps\`** (integer): The maximum number of sequential LLM calls the agent can perform in a single run. This prevents infinite loops.

**Prompt or messages** (one of the following is required):

- \`prompt\` (string): A string containing the prompt. Use \`"""\` for multi-line strings.
- \`messages\` (string): An array of objects but JSON stringified; Instead of a single prompt string, you can define a series of messages to create a conversational context. Each message object must have a \`role\` (\`system\`, \`user\`, or \`assistant\`) and \`content\` (the message text). This is particularly useful for models that support chat-based interactions.

### Structured Outputs

Agents can be configured to return responses in a specific JSON format. This is defined within the \`llm\` block.

**Important Note:** When structured outputs are enabled, tool usage is disabled by the underlying model provider. So tools should not be added to an Agent with structured outputs enabled. Output follows similar rules as our [input](./input_guideline.md) are defined:

\`\`\`xs
llm = {
  structured_outputs: true

  output {
    text description? filters=trim
    bool is_correct?
  }
}
\`\`\`

## Provider-Specific Configurations

### Xano Test Model (\`xano-free\`)

A free, rate-limited model for testing and development, powered by Gemini. Ideal for new users.

- **Block name:** \`xano_free\`

| Parameter          | Type    | Description                                                 | Example |
| ------------------ | ------- | ----------------------------------------------------------- | ------- |
| \`temperature\`      | number  | Controls randomness. \`0\` is deterministic. \`1\` is creative. | \`0.5\`   |
| \`search_grounding\` | boolean | If \`true\`, enables Google Search grounding. Disables tools. | \`false\` |

\`\`\`xs
agent "Xano Test Agent" {
  canonical = "x-test-123"
  llm = {
    type: "xano-free"
    system_prompt: "You are a test AI Agent. Respond clearly and concisely."
    max_steps: 3
    prompt: "{{ $args.message }}"
    temperature: 0
    search_grounding: false
  }
  tools = []
}
\`\`\`

### Google Gemini (\`google-genai\`)

Configuration for Google's Gemini family of models.

- **Block name:** \`google_genai\`

| Parameter          | Type    | Description                                                                                                                 | Example                   |
| ------------------ | ------- | --------------------------------------------------------------------------------------------------------------------------- | ------------------------- |
| \`api_key\`          | string  | Your Google Gemini API key. **Always use an environment variable.**                                                         | \`"{{ $env.gemini_key }}"\` |
| \`model\`            | string  | The specific Gemini model to use.                                                                                           | \`"gemini-2.5-flash"\`      |
| \`temperature\`      | number  | Controls randomness. \`0.0\` to \`1.0\`.                                                                                        | \`0.7\`                     |
| \`search_grounding\` | boolean | If \`true\`, grounds the model's response in Google Search results. **Disables tools.**                                       | \`true\`                    |
| \`thinking_tokens\`  | integer | The number of tokens the model can use for internal thinking before responding. Range \`0\` to \`24576\`. Use \`-1\` for dynamic. | \`10000\`                   |
| \`include_thoughts\` | boolean | If \`true\`, the model's internal reasoning or "thoughts" will be included in the response.                                   | \`true\`                    |
| \`safety_settings\`  | string  | JSON string for configuring safety thresholds. (See Google API docs).                                                       | \`""\`                      |
| \`dynamic_retrival\` | string  | Configuration for dynamic retrieval features. (See Google API docs).                                                        | \`""\`                      |

\`\`\`xs
agent "Google Gemini Agent" {
  description = "An agent using Google Gemini 2.5 Flash."
  canonical = "ggl-gem-456"
  llm = {
    type: "google-genai"
    system_prompt: "You are a helpful AI Agent that uses its tools to find accurate information. Explain your reasoning."
    max_steps: 5
    prompt: "Fulfill this request for user {{ $args.user_id }}: {{ $args.user_message }}"
    api_key: "{{ $env.gemini_key }}"
    model: "gemini-2.5-flash"
    temperature: 0.2
    search_grounding: false
    thinking_tokens: 10000
    include_thoughts: true
  }
  tools = ["tool-get-user-info-abc", "tool-search-docs-def"]
}
\`\`\`

### OpenAI (\`openai\`)

Configuration for OpenAI's GPT models. This can also be used for other OpenAI-compatible APIs by changing the \`baseURL\`.

- **Block name:** \`openai\`

> **Using OpenAI-Compatible Endpoints**
> The \`baseURL\` parameter can be overridden to use other providers like Groq, Mistral, OpenRouter, or X.AI.
>
> - **Groq:** \`https://api.groq.com/openai/v1\`
> - **Mistral:** \`https://api.mistral.ai/v1\`
> - **OpenRouter:** \`https://openrouter.ai/api/v1\`

| Parameter          | Type   | Description                                                                                        | Example                            |
| ------------------ | ------ | -------------------------------------------------------------------------------------------------- | ---------------------------------- |
| \`api_key\`          | string | Your OpenAI API key. **Always use an environment variable.**                                       | \`"{{ $env.openai_key }}"\`          |
| \`model\`            | string | The specific OpenAI model to use.                                                                  | \`"gpt-5-mini"\`                     |
| \`temperature\`      | number | Controls randomness. \`0.0\` to \`2.0\`.                                                               | \`1.0\`                              |
| \`reasoning_effort\` | string | For reasoning models, sets how much effort is spent on thinking.                                   | \`"low"\`, \`"medium"\`, \`"high"\`      |
| \`baseURL\`          | string | Custom URL for API calls. Defaults to OpenAI. Leave blank for default.                             | \`"https://api.groq.com/openai/v1"\` |
| \`organization\`     | string | OpenAI organization ID.                                                                            | \`""\`                               |
| \`project\`          | string | OpenAI project ID.                                                                                 | \`""\`                               |
| \`compatibility\`    | string | Sets the API compatibility mode. \`strict\` or \`compatible\` use compaatible to allow other providers | \`"strict"\`                         |

\`\`\`xs
agent "OpenAI Agent" {
  description = "A simple agent config for OpenAI models."
  canonical = "oai-gpt-789"
  llm = {
    type: "openai"
    system_prompt: "You are a helpful AI Agent that completes tasks accurately. Use your tools when necessary."
    max_steps: 3
    prompt: "Handle this request: {{ $args.user_message }}"
    api_key: "{{ $env.openai_key }}"
    model: "gpt-5-mini"
    temperature: 0.8
    reasoning_effort: "low"
    baseURL: ""
  }
  tools = []
}
\`\`\`

### Anthropic (\`anthropic\`)

Configuration for Anthropic's Claude family of models.

- **Block name:** \`anthropic\`

| Parameter        | Type    | Description                                                                                          | Example                                                 |
| ---------------- | ------- | ---------------------------------------------------------------------------------------------------- | ------------------------------------------------------- |
| \`api_key\`        | string  | Your Anthropic API key. **Always use an environment variable.**                                      | \`"{{ $env.anthropic_key }}"\`                            |
| \`model\`          | string  | The specific Claude model to use.                                                                    | \`"claude-sonnet-4-5-20250929"\`                          |
| \`temperature\`    | number  | Controls randomness. \`0.0\` to \`1.0\`.                                                                 | \`0.5\`                                                   |
| \`send_reasoning\` | boolean | If \`true\`, Claude creates \`thinking\` content blocks showing its reasoning before the final response. | \`true\`                                                  |
| \`thinking\`       | string  | JSON string to enable extended thinking and set a token budget. See Anthropic docs.                  | \`"{ \\"type\\": \\"enabled\\", \\"budget_tokens\\": 10000 }"\` |

\`\`\`xs
agent "Anthropic Claude Agent" {
  description = "An agent powered by Claude 4.5 Sonnet."
  canonical = "ant-son-101"
  llm = {
    type         : "anthropic"
    system_prompt: "You are a thoughtful and careful AI assistant. You must use tools to verify facts before answering. Break down complex problems step-by-step."
    max_steps    : 8
    prompt       : """Please assist with the following task:
      {{ $args.task_description }}
      """
    api_key        : "{{ $env.anthropic_key }}"
    model          : "claude-sonnet-4-5-20250929"
    temperature    : 0.3
    send_reasoning : true
  }
  tools = ["tool-verify-facts-ghi"]
}
\`\`\`

---

## Configuring Tools (\`tools\` block)

Tools are Xano functions that an agent can execute to interact with your database, call external APIs, or perform any defined action.

### Syntax

The \`tools\` property is a list of objects, where each object specifies a tool by its unique name.

\`\`\`xs
agent "Customer Support Agent" {
  canonical = "support-agent-v2"
  llm = {

  }

  tools = [
    { name: "get_user_details_by_email" },
    { name: "cancel_subscription" },
    { name: "create_support_ticket" }
  ]
}
\`\`\`

- **\`{ name: "tool-name" }\`**: Each tool is an object with a single \`name\` key. The value must be a string that exactly matches the name of a tool created in your Xano workspace.

### Runtime Behavior and Best Practices

!IMPORTANT: DO NOT DESCRIBE THE TOOLS IN THE \`system_prompt\` OR \`prompt\`. The agent automatically receives the tool descriptions and input schemas at runtime.

## Prompting and Dynamic Variables

Prompts are the primary way to provide runtime instructions to an agent. Xanoscript uses the **Twig** templating engine, allowing you to create dynamic, context-aware prompts allowing for variable substitution using \`{{ $var.variable_name }}\` syntax.

#### Runtime Arguments (\`$args\`)

\`$args\` are variables passed into the agent when it is called from a Xano function stack. This is the primary method for providing task-specific data.

- **Syntax**: \`{{ $args.variable_name }}\`
- **Use Case**: Passing user input, session IDs, or any other data unique to a specific agent run.

**Example:**

\`\`\`xs
llm = {
  type: "openai"
  prompt: """
    {% if $args.user_input|length > 0 %}
      Generate a {{ $args.tone|capitalize }} response to the following request: "{{ $args.user_input|trim|escape }}".
      Ensure the response is concise, under {{ $args.max_length }} words, and includes relevant examples.
      {% if $args.tone == "professional" %}
        Use formal language and industry-specific terminology.
      {% elseif $args.tone == "casual" %}
        Use conversational language and relatable analogies.
      {% else %}
        Adapt tone to context, maintaining clarity.
      {% endif %}
      Format the output as a JSON object with "prompt" and "timestamp" fields, where timestamp is "{{ "now"|date("Y-m-d H:i:s") }}".
    {% else %}
      Error: No input provided, ask the user to provide input.
    {% endif %}
    """
  api_key: "{{ $env.openai_key }}"
  model: "gpt-5-mini"
  temperature: 0.7
  reasoning_effort: "medium"
  max_steps: 4
}
\`\`\`

Note the use of \`{{ $env.openai_key }}\` in the api_key field, \`$env\` variables are useful to securely pass API keys and other secrets to the agent but should be avoided in prompts and system prompts to prevent accidental exposure.

### Prompting Best Practices

1.  **Be Clear and Specific**: Write prompts that clearly define the agent's goal for the specific task. The \`system_prompt\` sets the overall persona and role, while the \`prompt\` gives the immediate task.
2.  **Provide Rich Context**: Use \`$args\` to give the agent all the context it needs. The more relevant information it has (like user history, account status, etc.), the better its decisions will be.
3.  **Use Multi-line Strings for Readability**: Use triple quotes (\`"""\`) to structure larger prompts cleanly, separating instructions from dynamic data.
4.  **Keep Logic Minimal**: Although Twig supports logic (e.g., \`{% if %}\`, \`{% for %}\`), it should be used sparingly within prompts. The agent's core strength is its own reasoning ability. Overly complex templating can be brittle and hard to debug. Leave the decision-making to the LLM.
    - **Acceptable Use of Logic:** Conditionally providing a piece of information.
      \`\`\`twig
      {% if $args.is_priority_customer %}
      This is a priority customer. Respond within 5 minutes.
      {% endif %}
      \`\`\`
5.  **Do Not Repeat Tool Instructions**: As stated above, there is no need to repeat the tool instructions in the prompt. The system handles this automatically. Focus the prompt on the _what_, _why_ and _when_, and let the agent figure out the _how_ by using its tools.
`;var RP=`---
applyTo: "mcp_servers/**/*.xs"
---

## MCP Server with Tools

This example shows a basic MCP server configuration that exposes two tools.

\`\`\`xs
mcp_server "My Mcp Server" {
  description = "An example MCP server."
  canonical = "u3D7kj5Q"
  instructions = "General guidelines for AI agents about this server's overall purpose and usage context. These instructions apply server-wide and are separate from individual tool descriptions and parameters."
  tags = ["sample_tag"]
  tools = [
    { name: "new_statements" },
    { name: "what_is_xano" }
  ]
  history = "inherit"
}
\`\`\`

## MCP Server without Tools

This example shows an MCP server that does not yet have any tools configured.

\`\`\`xs
mcp_server "Empty Mcp Server" {
  description = "An MCP server with no tools yet."
  canonical = "a1B2c3D4"
  instructions = "This server is currently under development and does not yet have any tools available."
  tags = ["development"]
  tools = []
  history = "inherit"
}
\`\`\`
`;var EP=`---
applyTo: "mcp_servers/**/*.xs"
---

# How to Define MCP Servers in XanoScript

MCP (Model Context Protocol) servers in Xano are the gateways that expose your AI Tools to external clients and AI models. They act as a standardized endpoint that AI-powered applications can connect to, discover available tools, and execute them.

MCP Servers are defined in \`.xs\` files within the \`mcp_servers/\` directory of your project. For example, you might have a file named \`mcp_servers/task_manager_mcp.xs\` that contains the definition of an MCP server dedicated to task management:

\`\`\`xs
mcp_server "Task Manager MCP" {
  canonical = "1TuBS8V2"
  instructions = "Manages tasks specifically for the user, all tools directly relate to the users records in the database. "
  tags = ["internal"]
  tools = [
    {name: "add_task"}
    {name: "delete_task"}
    {name: "edit_task"}
    {name: "get_user_tasks"}
  ]
}
\`\`\`

## Core MCP Server Syntax

Every MCP server is defined within an \`mcp_server\` block.

\`\`\`xs
mcp_server "MCP Server Display Name" {
  canonical = "unique-server-id"
  description = "A brief explanation of what this server is for."
  instructions = "These instructions apply server-wide and guide the AI on how to use the collection of tools."
  tags = ["tag1", "tag2"]
  tools = [
    { name: "tool-name-1" },
    { name: "tool-name-2" }
  ]
  history = "inherit"
}
\`\`\`

- **\`mcp_server "Name"\`**: The top-level declaration. The name is a human-readable string.
- **\`canonical\`**: A required unique, non-changeable string identifier for the server.
- **\`description\`**: An optional string for internal documentation. This is not broadcast with the server.
- **\`instructions\`**: A string containing general guidelines for AI agents about the server's overall purpose and usage context.
- **\`tags\`**: An optional list of strings for categorizing and organizing your servers.
- **\`tools\`**: A required list of objects, where each object references an AI Tool by its unique name.

## Tools Block

The \`tools\` block is a list that specifies the tools exposed by the MCP server:

\`\`\`xs
tools = [
  { name: "get_user_details_by_email" },
  { name: "cancel_subscription" },
  { name: "create_support_ticket" }
]
\`\`\`

The value of the \`name\` key must be an exact match the unique name of a tool defined in your \`tools/\` directory, see [Tool Guideline](./tool_guideline.md) for more information.

## Best Practices

- **Use a Clear Naming Convention**: Give your servers a descriptive name and a memorable canonical ID.
- **Write Comprehensive Instructions**: The server-level \`instructions\` should provide a high-level overview of what the collection of tools can accomplish. For example, "A set of tools for managing customer support tickets, including creating, updating, and closing tickets."
- **Group Related Tools**: Create logical groupings of tools within a single MCP server. For instance, a \`user-management-server\` could contain tools for creating, updating, and deleting users.
- **Use Tags for Organization**: Use tags to categorize your servers, making them easier to manage in a large project.
`;var SP=`---
applyTo: "tools/**/*.xs"
---

# Xanoscript AI Tool Examples

Below are some examples of AI Tool configurations that can be made using Xanoscript.

## Tool with API, Task, and Tool Calls

This example demonstrates a tool that utilizes all three tool-specific statements: \`api.call\`, \`task.call\`, and \`tool.call\`.

\`\`\`xs
tool new_statements {
  description = "A tool that demonstrates calling other Xano resources."

  instructions = "This tool is used to test the functionality of calling APIs, tasks, and other tools from within a tool. It takes a user's name as input and returns the result of an API call."

  input {
    text name? filters=trim {
      description = "The name of the user to be used in the various calls. Descriptions are important as they are sent to the AI."
    }
  }

  stack {
    api.call auth/login verb=POST {
      api_group = "Authentication"
      input = {email: "email@email.com", password: "password"}
    } as $endpoint1

    task.call task_example as $test1

    tool.call what_is_xano {
      input = {query: "What is Xano?"}
    } as $tool1
  }

  response = $endpoint1

  history = "inherit"
}
\`\`\`

## Simple Information Retrieval Tool

This is an example of a simple tool that retrieves information.

\`\`\`xs
tool what_is_xano {
  description = "Provides a brief description of Xano."
  instructions = "Use this tool to get a basic explanation of what Xano is."

  input {
    text query? {
      description = "A question about Xano. The content of the query is ignored, the tool always returns the same text."
    }
  }

  stack {
    var $xano_description {
      value = "Xano is a no-code backend platform that allows you to build scalable, secure, and compliant backends without writing any code."
    }
  }

  response = $xano_description

  history = 100
}
\`\`\`
`;var CP=`---
applyTo: "tools/**/*.xs"
---

# How to Define AI Tools in XanoScript

AI Tools in Xano are specialized, reusable function stacks designed to be executed by [AI Agents](./agent_guideline.md) or exposed externally through an [MCP server](./mcp_server_guideline.md), also known as Model Context Protocol Server. They act as the bridge between an AI's reasoning capabilities and your application's backend, allowing agents to query databases, call APIs, and perform complex actions.

Tools are defined in \`<tool_name>.xs\` files within the \`tools/\` directory of your project, they follow the same syntax as standard Xano [function stacks](./function_guideline.md) with some additional features tailored for AI interactions.

For example, you might have a file named \`tools/user_lookup.xs\` that contains the definition of a tool for looking up user information:

\`\`\`\`xs
tool user_lookup {
  description = "Looks up user information by user ID."
  instructions = "Use this tool to retrieve detailed information about a user given their unique user ID. Provide the user ID as input, and the tool will return the user's profile data."
  input {
    int user_id {
      description = "The unique identifier of the user to look up."
    }
  }
  stack {
    db.get user {
      field_name = "id"
      field_value = $input.user_id
      description = "Verify user exists"
    } as $user
  }

  response = $user
}

## Core Tool Syntax

Every tool is defined within a \`tool\` block.

\`\`\`xs
tool "unique_tool_name" {
  description = "A brief explanation of what this tool does."
  instructions = "Guidelines explaining how AI agents should use this tool, including use cases, input formatting, and output interpretation."
  input {

  }
  stack {

  }
  response = null
  history = false
}
\`\`\`\`

### Key Fields

- **\`tool "name"\`**: The top-level declaration. The name must be a unique string identifier, as this is how the tool is referenced by Agents and MCP servers.
- **\`description\`**: An optional string for internal documentation. This is not visible to the AI.
- **\`instructions\`**: A required string that provides the AI with the context it needs to use the tool effectively. This is a crucial field for ensuring the tool is used correctly by the agent.
- **\`input\`**: An object defining the parameters the tool accepts.
- **\`stack\`**: An object containing the sequence of operations to be executed.
- **\`response\`**: An object that specifies the data returned by the tool.

---

## Input Block

The \`input\` block defines the parameters that the tool can accept at runtime. The structure is identical to inputs in other Xano function stacks, but the \`description\` for each parameter is especially important, as it is included in the information sent to the AI.

### Input Structure

The \`input\` block accepts a series of field definitions, follow the [input guidleine](./input_guideline.md) for more details

## Stack Block and Tool-Specific Statements

The \`stack\` contains the tool's logic. In addition to all standard Xano function statements, tools have access to three unique statements for calling other Xano resources.

### 1. \`api.call\`

Executes an API endpoint from one of your API groups. This is the preferred way to interact with your backend from a tool, as it ensures that all business logic encapsulated in the API is respected.

\`\`\`xs
stack {
  api.call auth/login verb=POST {
    api_group = "Authentication"
    input = {
      email: "user@example.com",
      password: "password123"
    }
  } as $login_response
}
\`\`\`

### 2. \`task.call\`

Executes a background task. Tasks do not accept inputs or return outputs directly.

\`\`\`xs
stack {
  task.call my_background_task as $task_call_result
}
\`\`\`

### 3. \`tool.call\`

\`\`\`xs
stack {
  tool.call get_user_details {
    input = {user_id: 123}
  } as $user_details
}
\`\`\`

Executes another AI Tool. This allows you to create modular, reusable tools that can be composed together.

- **Syntax**: \`tool.call <tool_name> { ... }\`

\`\`\`xs
stack {
  tool.call get_user_details {
    input = {user_id: 123}
  } as $user_details
}
\`\`\`

## Response Block

The \`response\` block specifies the data that the tool returns to the agent or client that called it. The structure is the same as in other Xano function stacks.

**Example:**

\`\`\`xs
response = $user_details
\`\`\`

## Best Practices

- **Write Clear Instructions**: The \`instructions\` field is the most important part of your tool's definition. Be explicit about what the tool does, what each input parameter is for, and what the output means.
- **Use Descriptive Input Fields**: Clearly describe each input parameter. This information is passed to the AI and helps it construct valid requests.
- **Leverage Enums**: For inputs with a fixed set of possible values, use an \`enum\` type. This provides the AI with the exact options it can use, reducing errors.
- **Keep Tools Focused**: Design tools that perform a single, well-defined task. This makes them easier for the AI to understand and combine.
- **Handle Errors Gracefully**: Use \`filters\` on input, \`precondition\` and \`try_catch\` blocks in the stack to validate inputs and handle potential errors. Return clear error messages in the response so the AI can understand what went wrong.
`;var Rr=we(require("vscode"));var co=require("path");var U6=[{name:"function_guideline",content:tP},{name:"function_examples",content:nP},{name:"api_query_guideline",content:rP},{name:"api_query_examples",content:iP},{name:"table_guideline",content:sP},{name:"table_examples",content:oP},{name:"task_guideline",content:aP},{name:"task_examples",content:cP},{name:"unit_testing_guideline",content:uP},{name:"functions",content:dP},{name:"workspace",content:fP},{name:"tips_and_tricks",content:bP},{name:"expression_guideline",content:gP},{name:"frontend_guideline",content:pP},{name:"input_guideline",content:hP},{name:"db_query_guideline",content:mP},{name:"build_from_loveable",content:lP},{name:"agent_guideline",content:TP},{name:"agent_examples",content:xP},{name:"mcp_server_guideline",content:EP},{name:"mcp_server_examples",content:RP},{name:"tool_guideline",content:CP},{name:"tool_examples",content:SP}];async function kP(){let t=Rr.Uri.parse(Rr.workspace.workspaceFolders?.[0].uri.toString()||"");await Pr((0,co.join)(t.fsPath,"AGENTS.md"),hu),await Pr((0,co.join)(t.fsPath,"CLAUDE.md"),hu);let e=Rr.Uri.joinPath(t,"docs");try{await Rr.workspace.fs.stat(e)}catch{await Rr.workspace.fs.createDirectory(e)}for(let s of U6){let a=Rr.Uri.joinPath(e,s.name+".md");await Rr.workspace.fs.writeFile(a,Buffer.from(s.content,"utf-8"))}let n=Rr.Uri.joinPath(t,".github");try{await Rr.workspace.fs.stat(n)}catch{await Rr.workspace.fs.createDirectory(n)}await Pr((0,co.join)(n.fsPath,"copilot-instructions.md"),hu.replace(/\(\.\/docs\//g,"(../docs/"));let r=Rr.Uri.joinPath(t,".cursor","rules");try{await Rr.workspace.fs.stat(r)}catch{await Rr.workspace.fs.createDirectory(r)}await Pr((0,co.join)(r.fsPath,"xanoscript.md"),hu.replace(/\(\.\/docs\//g,"(/docs/")),await Pr((0,co.join)(t.fsPath,A.paths.apis,"AGENTS.md"),_P),await Pr((0,co.join)(t.fsPath,A.paths.tasks,"AGENTS.md"),vP),await Pr((0,co.join)(t.fsPath,A.paths.tables,"AGENTS.md"),wP),await Pr((0,co.join)(t.fsPath,A.paths.functions,"AGENTS.md"),yP),Rr.window.showInformationMessage("Agent instruction files have been set up in your project.")}var mu=we(require("vscode"));async function PP(t){if(Ul())return mu.window.showWarningMessage("A push operation is already in progress. Please wait until it completes."),!1;if(Hl())return mu.window.showErrorMessage("Cannot push changes while pulling. Please wait until the pull is complete."),!1;try{Wl(!0),await dc();let e=await Ht();e=await ff(e,t);let n=e.find(r=>r.path===t.path);return!n||n.status!=="unchanged"?(Wl(!1),!1):(await gn(e),je.refresh(),mu.window.showInformationMessage(`${t.path} successfully pushed changes to Xano`),Wl(!1),!0)}catch(e){return Wl(!1),console.error("pushCurrentNode(): Error pushing changes",e),mu.window.showErrorMessage(`Error pushing changes: ${e}`),!1}}var gp=we(require("vscode"));async function AP(t){let e;if(t){let n=await Ht(),r=t.slice(ge.length+1);e=fs(n,r)}else{let n=gp.window.activeTextEditor;if(n&&n.document){if(n.document.isDirty)if(await gp.window.showWarningMessage("Please save your changes before pushing to Xano.",{modal:!0},{title:"Save"}))await n.document.save();else return!1;let r=await Ht(),s=n.document.uri.path.slice(ge.length+1);e=fs(r,s)}}return e?PP(e):(gp.window.showErrorMessage("This file is not part of your Xano Workspace"),!1)}var gu=we(require("vscode"));async function DP(t){if(t||(t=await gu.window.showInputBox({prompt:"Enter output directory name",placeHolder:"e.g., static/src/sdk"})),!t){gu.window.showErrorMessage("Output directory is required");return}try{await IP(t),gu.window.showInformationMessage("SDK generated successfully")}catch(e){gu.window.showErrorMessage("Failed to generate SDK"),console.error("Failed to generate SDK",e)}}async function IP(t){let e=await _a(A.instanceName,A.workspaceId),n={},r={},s="";for(let a of e){let c=a.documentation.link.replace(":?","?");r=await(await fetch(c,{headers:{Accept:"application/json","Content-Type":"application/json"}})).json();let d=new URL(r.servers[0]?.url);s=d.origin;let f=d.pathname;for(let p in r.paths)n[`${f}${p}`]=r.paths[p]}console.log("Generating SDK from",s,"to",t)}var li=we(require("vscode"));var $P=require("path"),OP=we(mn());async function FP(){let e=(await eo()).mcp_server||[];if(e.length===0){li.window.showErrorMessage("No MCP servers to associate with. Please create an MCP server first.");return}let n=await li.window.showQuickPick(e.map(a=>({label:a.name})),{placeHolder:"Select the MCP server to associate with"});if(!n){li.window.showErrorMessage("No MCP server selected");return}let r=await li.window.showInputBox({prompt:"Enter the MCP trigger name",placeHolder:"e.g., user_signup_trigger",value:`${n.label}_trigger`});if(!r){li.window.showErrorMessage("MCP trigger name is required");return}r=r.replace(/([^a-zA-Z0-9/]+)/g,"_");let s=`mcp_server_trigger "${r}" {
  mcp_server = "${n.label}"
  description = "Trigger for MCP server ${n.label}"

  input {
    object toolset {
      schema {
        int id
        text name
        text instructions
      }
    }
  
    object[] tools {
      schema {
        int id
        text name
        text instructions
      }
    }
  }

  stack {
    var $toolset {
      value = $input.toolset
    }
  
    var $tools {
      value = $input.tools
    }
  }

  response = {toolset: $var.toolset, tools: $tools}
  actions = {connection: true}
}`;try{let a=li.Uri.file((0,$P.join)(ge,A.paths.mcpServerTriggers,`${(0,OP.snakeCase)(r)}.xs`));if(await li.workspace.fs.stat(a).then(l=>l,()=>null)){li.window.showErrorMessage("A file with the same name already exists");return}await li.workspace.fs.writeFile(a,Buffer.from(s)),jt(a),li.window.showInformationMessage(`MCP trigger ${r} created successfully`),await nn([a.path.slice(ge.length+1)]),je.refresh()}catch{li.window.showErrorMessage("Failed to create MCP trigger");return}}var yn=we(require("vscode"));var Dc=we(mn());var NP=require("path");var _p=["object","enum","int","timestamp","text","uuid","vector","date","bool","decimal","email","password","json","image","video","audio","attachment","geo_point","geo_multipoint","geo_linestring","geo_multilinestring","geo_polygon","geo_multipolygon"];function vp(t){let e={};for(let n of t.split(`
`))if(n.trim().startsWith("schema {")){let r=1;for(let s of t.split(`
`).slice(t.split(`
`).indexOf(n)+1)){let a=s.trim();if(!a)continue;let c=(s.match(/{/g)||[]).length,l=(s.match(/}/g)||[]).length,d=a.split(/\s+/).filter(f=>f);if(d.length>=2&&r===1){let[f,p]=d,m=f.includes("[]"),g=f.replace("[]","");if(g=g.endsWith("?")?g.slice(0,-1):g,_p.includes(g)){let w=p;p.includes("?=")?w=p.split("?=")[0]:p.endsWith("?")&&(w=p.slice(0,-1)),e[w]={type:g,isArray:m,default:p.split("?=")[1],optional:f.includes("?")&&!m,nullable:p.endsWith("?")}}}if(r+=c-l,r===0)break}}return e}async function MP(){let t=await yn.window.showQuickPick([{label:"create",description:"Create a new record"},{label:"read",description:"Returns an existing record"},{label:"update",description:"Update an existing record"},{label:"delete",description:"Delete an existing record"},{label:"list",description:"Returns a list of records"}],{placeHolder:"Select the CRUD action",canPickMany:!0});if(!t||t.length===0){yn.window.showErrorMessage("CRUD action is required");return}let e=await eo(),n=e.table||[];if(n.length===0){yn.window.showErrorMessage("No tables to associate with. Please create a table first.");return}let r=await yn.window.showQuickPick(n.map(d=>({label:d.name})),{placeHolder:"Select the table to associate with"});if(!r){yn.window.showErrorMessage("No table selected");return}let a=(e.api_group||[]).map(d=>({label:d.name}));a.push({label:"New",kind:yn.QuickPickItemKind.Separator}),a.push({label:"$(plus) API Group",description:"Create a new API Group"});let c=await yn.window.showQuickPick(a,{placeHolder:"Select the API group to host the endpoint in",ignoreFocusOut:!0});if(!c){yn.window.showErrorMessage("No API group selected");return}let l=c.label;if(l==="$(plus) API Group"&&(l=await yn.window.showInputBox({prompt:"Enter the API Group name",placeHolder:"e.g., Webhooks"}),!l||l.trim()==="")){yn.window.showErrorMessage("API Group Name is required");return}for(let d of t)await Dv({action:d.label,table:r.label,apiGroup:l})}var W6=["create","read","list","delete","update"];async function Dv(t){if(!W6.includes(t.action)){yn.window.showErrorMessage("Invalid CRUD action");return}let e=await eo(),{apiGroup:n}=t;switch((e.api_group||[]).map(a=>a.name).includes(t.apiGroup)||(n=await _f(t.apiGroup)),t.action){case"delete":await _u({...H6(t.table),apiGroup:n});break;case"read":await _u({...j6(t.table),apiGroup:n});break;case"list":await _u({...X6(t.table),apiGroup:n});break;case"update":await _u({...B6(t.table),apiGroup:n});break;case"create":await _u({...await G6(t.table),apiGroup:n});break;default:yn.window.showErrorMessage("Invalid CRUD action");return}}var _u=async t=>{let{content:e,filename:n,apiGroup:r}=t,s=yn.Uri.file(yn.workspace.workspaceFolders?.[0].uri.fsPath+`/apis/${r}/${n}`);try{if(await yn.workspace.fs.stat(s).then(c=>c,()=>null)){yn.window.showErrorMessage(`File ${n} already exists. Aborting to prevent overwrite.`);return}await yn.workspace.fs.writeFile(s,Buffer.from(e,"utf8")),jt(s),yn.window.showInformationMessage(`CRUD endpoint ${n} created successfully`),await nn([s.path.slice(ge.length+1)])}catch(a){yn.window.showErrorMessage(`Failed to create CRUD endpoint: ${a}`);return}};function H6(t){let e=(0,Dc.snakeCase)(t),n=`${e}_id`,r=`${e}_${n}_DELETE.xs`;return{content:`query ${e}/{${n}} verb=DELETE {
  description = "Delete ${t} record."

  input {
    int ${n}? filters=min:1
  }

  stack {
    db.del "${t}" {
      field_name = "id"
      field_value = $input.${n}
    }
  }

  response = null
  history = "inherit"
}`,filename:r}}function j6(t){let e=(0,Dc.snakeCase)(t),n=`${e}_id`,r=`${e}_${n}_GET.xs`;return{content:`query ${e}/{${n}} verb=GET {
  description = "Read ${t} record."

  input {
    int ${n}? filters=min:1
  }

  stack {
    db.get "${t}" {
      field_name = "id"
      field_value = $input.${n}
    } as $record
  }

  response = $var.record
  
  history = "inherit"
}`,filename:r}}function X6(t){let e=(0,Dc.snakeCase)(t),n=`${e}_GET.xs`;return{content:`query ${e} verb=GET {
  description = "Query all ${t} records"

  input {
    int page?
  }

  stack {
    db.query "${t}" {
      return = {
        type: "list", 
        paging: {
          page: $input.page, 
          per_page: 30
        }
      }
    } as $${e}_records
  }

  response = $${e}_records
  history = "inherit"
}`,filename:n}}function B6(t){let e=(0,Dc.snakeCase)(t),n=`${e}_id`,r=`${e}_${n}_PATCH.xs`;return{content:`query ${e}/{${n}} verb=PATCH {
  description = "Update ${t} record."

  input {
    int ${n}? filters=min:1
    dblink {
      table = "${t}"
    }
  }

  stack {
    util.get_input {
      encoding = "json"
    } as $raw_input
  
    db.patch test_database {
      field_name = "id"
      field_value = $input.${n}
      data = \`$input|pick:($raw_input|keys)\`|filter_null|filter_empty_text
    } as $${e}_updated_record
  }

  response = $${e}_updated_record
  history = "inherit"
}`,filename:r}}async function G6(t){let n=`${(0,Dc.snakeCase)(t)}_POST.xs`;return{content:`query marketing_campaign verb=POST {
  description = "Add marketing_campaign record"

  input {
    dblink {
      table = "marketing_campaign"
    }
  }

  stack {
    db.add marketing_campaign {
      data = {
        ${(await z6(t)).map(a=>a.endsWith("?")?a.slice(0,-1):a).filter(a=>a!=="id").map(a=>`${a}: $input.${a}`).join(`
        `)}
      }
    } as $model
  }

  response = $model
  history = "inherit"
}`,filename:n}}async function z6(t){let n=(await Ht()).filter(r=>r.type==="table");for(let r of n){let s=await yn.workspace.fs.readFile(yn.Uri.file((0,NP.join)(ge,r.path))),a=Buffer.from(s).toString("utf8");if(a.startsWith(`table ${t} `)||a.startsWith(`table "${t}" `)){let c=vp(a);return Object.keys(c)}}return[]}var qP=t=>{let e=[pt.commands.registerCommand("xanoscript.login",R1),pt.commands.registerCommand("xanoscript.signup",E1),pt.commands.registerCommand("xanoscript.selectInstance",T1),pt.commands.registerCommand("xanoscript.setupAgentInstructions",kP),pt.commands.registerCommand("xanoscript.refreshChanges",aS),pt.commands.registerCommand("xanoscript.uploadStatic",Sk),pt.commands.registerCommand("xanoscript.viewChangeDiff",lS),pt.commands.registerCommand("xanoscript.viewRemoteDiff",Pk),pt.commands.registerCommand("xanoscript.openChangedFile",dS),pt.commands.registerCommand("xanoscript.discardChanges",fS),pt.commands.registerCommand("xanoscript.runTests",Nk),pt.commands.registerCommand("xanoscript.pullChanges",rS),pt.commands.registerCommand("xanoscript.pushChanges",iS),pt.commands.registerCommand("xanoscript.pushFileChanges",AP),pt.commands.registerCommand("xanoscript.stashChanges",vS),pt.commands.registerCommand("xanoscript.applyStash",Ck),pt.commands.registerCommand("xanoscript.resetAndPull",Ik),pt.commands.registerCommand("xanoscript.generateSDK",DP),pt.commands.registerCommand("xanoscript.unStageRecord",oS),pt.commands.registerCommand("xanoscript.stageRecord",sS),pt.commands.registerCommand("xanoscript.stageAllRecords",fc),pt.commands.registerCommand("xanoscript.unstageAllRecords",hS),pt.commands.registerCommand("xanoscript.selectWorkspace",GE),pt.commands.registerCommand("xanoscript.selectBranch",XE),pt.commands.registerCommand("xanoscript.createTable",QE),pt.commands.registerCommand("xanoscript.createTask",nS),pt.commands.registerCommand("xanoscript.createCustomFunction",VE),pt.commands.registerCommand("xanoscript.createApiGroup",_f),pt.commands.registerCommand("xanoscript.createApiEndpoint",ZE),pt.commands.registerCommand("xanoscript.generateCrudEndpoint",MP),pt.commands.registerCommand("xanoscript.createWorkflowTest",Fk),pt.commands.registerCommand("xanoscript.createAgent",qk),pt.commands.registerCommand("xanoscript.createMcpServer",Wk),pt.commands.registerCommand("xanoscript.createTableTrigger",jk),pt.commands.registerCommand("xanoscript.createAgentTrigger",Gk),pt.commands.registerCommand("xanoscript.createMcpServerTrigger",FP),pt.commands.registerCommand("xanoscript.createMiddleware",Kk),pt.commands.registerCommand("xanoscript.createRealtimeChannel",Yk),pt.commands.registerCommand("xanoscript.createRealtimeTrigger",eP),pt.commands.registerCommand("xanoscript.openXanoscript",zE)];t.subscriptions.push(...e)};var eF=we(require("vscode")),ed=we(QO()),tF=we(require("path"));function nF(t){let e=t.asAbsolutePath(tF.join("dist","server.js")),n={run:{module:e,transport:ed.TransportKind.ipc},debug:{module:e,transport:ed.TransportKind.ipc,options:{execArgv:["--nolazy","--inspect=6009"]}}},r={documentSelector:[{language:"xanoscript"}],synchronize:{fileEvents:[eF.workspace.createFileSystemWatcher("**/*.xs")]}},s=new ed.LanguageClient("xanoscriptLanguageServer","XanoScript Language Server",n,r);return s.start(),s}var Ur=we(require("vscode")),cm=we(mn());var rF=require("path"),ul=Ur.window.createStatusBarItem(Ur.StatusBarAlignment.Left,100),_o=Ur.window.createStatusBarItem(Ur.StatusBarAlignment.Left,99),vo=Ur.window.createStatusBarItem(Ur.StatusBarAlignment.Left,98),ja=Ur.window.createStatusBarItem(Ur.StatusBarAlignment.Left,97),ia=Ur.window.createStatusBarItem(Ur.StatusBarAlignment.Right,100);function iF(t){ul.command="xanoscript.login",ul.tooltip="Authenticate with Xano",ul.text="$(account) ---",ul.show();let e=an.onChange(d=>{console.log("fire onchange",d),d.username?(ul.text=`$(account) ${d.username}`,_o.show()):ul.text="$(warning) Login to Xano"},!0);_o.command="xanoscript.selectInstance",_o.text=an.instanceName?an.instanceName:"$(server-environment) ---",_o.tooltip=an.instance?`Your Xano Instance: 
${an.instance}`:"Select your Xano Instance";let n=an.onChange(d=>{d.instance?(_o.text=`$(server-environment) ${(0,cm.truncate)(d.instanceName,{length:12})}`,vo.tooltip=`Your Xano Instance: 
${d.instance}`,_o.show()):_o.hide()},!0);vo.command="xanoscript.selectWorkspace",vo.tooltip="Select Xano Workspace";let r=an.onChange(d=>{d.workspace?(vo.text=`$(repo) ${(0,cm.truncate)(d.workspace,{length:12})}`,vo.tooltip=`Your Xano Workspace: 
${d.workspace} (#${A.workspaceId})`,vo.show()):vo.hide()},!0);ja.command="xanoscript.selectBranch",ja.tooltip="select Xano Branch";let s=A.onChange(d=>{d.branch?(ja.text=`$(git-branch) ${(0,cm.truncate)(d.branch,{length:12})}`,ja.show()):ja.hide()},!0),a=an.onChange(d=>{d.isAuthenticated()||(ja.hide(),_o.hide(),vo.hide())},!0);ia.command="xanoscript.runTests",ia.tooltip="Run All Unit Tests",ia.text="$(play) run",ia.backgroundColor=new Ur.ThemeColor("statusBarItem.background");function c(d){let f=d?.document?.uri?.fsPath,p=(0,rF.join)(ge,A.paths.workflowTests);f?.startsWith(p+"/")?ia.show():ia.hide()}c(Ur.window.activeTextEditor);let l=Ur.window.onDidChangeActiveTextEditor(c);ia.show(),t.subscriptions.push(_o,vo,ja,ia,e,n,r,s,l,a)}var Xs=we(require("vscode"));var um=we(mn());var _i=we(require("vscode"));var td={};async function sF(t,e,n){if(Vj(t))return td[t].value;let r=await e();return ox(t,r,n),r}function ox(t,e,n){td[t]={key:t,value:e,expires:Date.now()+n}}function Zj(t){delete td[t]}function Vj(t){if(td[t]){if(td[t].expires>Date.now())return!0;Zj(t)}return!1}function oF(t){if(!_i.workspace.workspaceFolders)return;nd();let e=_i.workspace.createFileSystemWatcher("**/.xano/config.json");e.onDidCreate(async()=>{nd(),_i.window.showInformationMessage("Xano config detected. Full features enabled.")}),e.onDidDelete(async()=>{nd(),_i.window.showWarningMessage("Xano config removed. Features disabled.")}),e.onDidChange(async()=>{nd(),_i.window.showInformationMessage("Xano config changed. Settings updated.")}),t.subscriptions.push(e),t.subscriptions.push(_i.workspace.onDidChangeWorkspaceFolders(async()=>{nd()}))}var aF=async()=>{let t=_i.workspace.workspaceFolders;if(!t)return!1;let e=t[0],n=_i.Uri.joinPath(e.uri,".xano","config.json");try{return await _i.workspace.fs.stat(n),!0}catch{return!1}};async function nd(){let t=await aF();ox("xano.enabled",t,5e3),await _i.commands.executeCommand("setContext","xano.enabled",t)}async function lm(){return sF("xano.enabled",aF,5e3)}var Yj=(0,um.debounce)(()=>Si(),1e3);function cF(t){let e=Xs.workspace.createFileSystemWatcher("**/*",!1,!1,!1);e.onDidDelete(async()=>{await lm()&&await Si()}),e.onDidCreate(async n=>{if(!await lm())return;let s=(await Xs.workspace.fs.stat(n)).type===Xs.FileType.Directory,a=n.path.slice(ge.length+1);if(s&&a.startsWith(A.paths.apis+"/")){let c=Xs.Uri.joinPath(n,"api_group.xs");try{await Xs.workspace.fs.stat(c)}catch{let l=a.slice(A.paths.apis.length+1).split("/")[0].trim();if(!l)return;await Xs.workspace.fs.writeFile(c,Buffer.from(`api_group "${l}" {
  canonical = "${(0,um.snakeCase)(l)}"
}`)),console.log("API group file created: ",c.fsPath)}}Yj()}),t.subscriptions.push(e),t.subscriptions.push(Xs.workspace.onDidSaveTextDocument(async n=>{if(!await lm())return;let r=n.uri;if(r.path.endsWith(".xs")){ya.delete(r);let s=r.path.slice(ge.length+1);console.log("XanoScript file saved: ",s),A.isXanoManagedPath(s)&&(await On(await oc(),s),je.refresh())}}))}var ht=we(require("vscode"));function lF(t){let e=t.split(`
`),n={};for(let r=0;r<e.length;r++)if(e[r].trim().startsWith("input {")){let a=1;for(let c=r+1;c<e.length;c++){let l=e[c],d=l.trim();if(!d)continue;let f=(l.match(/{/g)||[]).length,p=(l.match(/}/g)||[]).length,m=d.split(/\s+/).filter(g=>g);if(m.length>=2&&a===1){let[g,w]=m,v=g.endsWith("?")?g.slice(0,-1):g;if(_p.includes(v)){let x=w;w.includes("?=")?x=w.split("?=")[0]:w.endsWith("?")&&(x=w.slice(0,-1)),n[x]={type:v.endsWith("?")?v.slice(0,-1):v,isArray:v.endsWith("[]"),default:w.split("?=")[1],optional:v.endsWith("?"),nullable:w.endsWith("?")}}}if(a+=f-p,a===0)break}}return n}async function uF(t){let e=await Ht(),n=[],r=e.filter(s=>{if(t==="all")return!0;switch(t){case"function":return s.type==="function";case"tool":return s.type==="tool";case"api":return s.type==="api_endpoint";case"api_group":return s.type==="api_group";case"table":return s.type==="table";case"agent":return s.type==="agent";case"mcp_server":return s.type==="mcp_server";case"middleware":return s.type==="middleware";case"realtime_channel":return s.type==="realtime_channel";case"tasks":return s.type==="task";case"addons":return s.type==="add_on";default:return!1}});for(let s of r){let a=await ac(s.path),c=s.path.split("/").pop()||"",l=c.match(/^\d+_(.+)\.xs$/)||c.match(/^(.+)\.xs$/),d=l?l[1]:c,f={id:s.id,name:d,type:s.type,path:s.path};if(s.type==="table"){let p=vp(a);Object.keys(p).length>0&&(f.schema=p)}else if(s.type==="function"||s.type==="api_endpoint"||s.type==="task"||s.type==="tool"||s.type==="agent"||s.type==="mcp_server"||s.type==="workflow_test"){let p=lF(a);Object.keys(p).length>0&&(f.schema=p)}n.push(f)}return n.map(s=>JSON.stringify(s,null,2))}function dF(t){t.subscriptions.push(ht.lm.registerTool("upload_static_files_to_xano",new lx)),t.subscriptions.push(ht.lm.registerTool("get_xano_api_specifications",new fx)),t.subscriptions.push(ht.lm.registerTool("push_all_changes_to_xano",new ux)),t.subscriptions.push(ht.lm.registerTool("get_all_xano_tables",new cx)),t.subscriptions.push(ht.lm.registerTool("get_objects_specification",new dx)),t.subscriptions.push(ht.lm.registerTool("generate_xanoscript_crud_endpoint",new px)),t.subscriptions.push(ht.lm.registerTool("batch_add_records_to_xano_table",new ax)),t.subscriptions.push(ht.lm.registerTool("push_current_file_to_xano",new hx("Push Current File to Xano","xanoscript.pushFileChanges","File pushed to Xano","Failed to push file to Xano")))}var ax=class{async invoke(e){let{tableId:n,rows:r}=e.input,s=e.input.dataSource||"live",a=await n1(A.instanceName,A.workspaceId,s,n,r);return new ht.LanguageModelToolResult([new ht.LanguageModelTextPart(`Successfully added ${r.length} records to table ID ${n}
IDs: ${JSON.stringify(a)}`)])}prepareInvocation(e){let n={title:'Batch Add Records to Table"}',message:new ht.MarkdownString(e.input.invocationMessage??"Are you sure you want to add records to the specified table?")};return{invocationMessage:e.input.invocationMessage??"Adding records to table...",confirmationMessages:n}}},cx=class{async invoke(){let e=await rf(A.instanceName,A.workspaceId,!1);return new ht.LanguageModelToolResult([new ht.LanguageModelTextPart(JSON.stringify(e,null,2))])}prepareInvocation(){return{invocationMessage:"Retrieving all tables...",confirmationMessages:{title:"Get All Tables",message:new ht.MarkdownString("Retrieve all the tables and their schema from your Xano Workspace?")}}}};var lx=class{async invoke(e,n){let r=await mp(A.instanceName,A.workspaceId,e.input.name,e.input.description,n);return r==="cancelled"?new ht.LanguageModelToolResult([new ht.LanguageModelTextPart("upload canceled")]):r.custom_url?new ht.LanguageModelToolResult([new ht.LanguageModelTextPart(`upload successful at ${r.custom_url}`)]):new ht.LanguageModelToolResult([new ht.LanguageModelTextPart(`upload successful at ${r.default_url}`)])}prepareInvocation(){return{invocationMessage:"Uploading static content...",confirmationMessages:{title:"Upload Static Content",message:new ht.MarkdownString("Are you sure you want to upload static content?")}}}},ux=class{async invoke(){if(!await fc())throw new Error("No changes to push to Xano");let n=await hf();if(console.log("Push results:",n),n.failed.length>0){let r=`Some changes failed to push to Xano:
${n.failed.map(s=>`- ${s.path}: ${s.error}`).join(`
`)}`;throw new Error(r)}return new ht.LanguageModelToolResult([new ht.LanguageModelTextPart("All changes pushed to Xano")])}prepareInvocation(){return{invocationMessage:"Pushing all changes to Xano...",confirmationMessages:{title:"Push All Changes to Xano",message:new ht.MarkdownString("Are you sure you want to push all changes to Xano?")}}}},dx=class{async invoke(e){let n=await uF(e.input.category);return new ht.LanguageModelToolResult([new ht.LanguageModelTextPart(`[${n.join(`,
`)}]`)])}},fx=class{async invoke(){let e=await _a(A.instanceName,A.workspaceId),n=[];for(let r of e){let s=r.documentation.link.replace(":?","?");await fetch(s,{headers:{Accept:"application/json","Content-Type":"application/json"}}).then(a=>a.json()).then(a=>{n.push(JSON.stringify(a,null,2))})}return new ht.LanguageModelToolResult([new ht.LanguageModelTextPart(`[${n.join(`,
`)}]`)])}prepareInvocation(){return{invocationMessage:"Retrieving all backend API specifications...",confirmationMessages:{title:"Get All Backend API Specifications",message:new ht.MarkdownString("Retrieve all backend API specifications?")}}}},px=class{async invoke(e){return await Dv(e.input),new ht.LanguageModelToolResult([new ht.LanguageModelTextPart(`Successfully created endpoint ${e.input.action} (${e.input.table}) function`)])}prepareInvocation(e){let n={title:`Create ${e.input.action} endpoint for Table ${e.input.table}`,message:new ht.MarkdownString("Are you sure you want to create a CRUD endpoint?")};return{invocationMessage:`Creating ${e.input.action}@${e.input.table} endpoint...`,confirmationMessages:n}}},hx=class{constructor(e,n,r,s){this.title=e;this.command=n;this.success=r;this.failure=s}async invoke(e){if(!await ht.commands.executeCommand(this.command,e.input.path))throw new Error(this.failure);return new ht.LanguageModelToolResult([new ht.LanguageModelTextPart(this.success)])}prepareInvocation(){return{invocationMessage:"Invoking command...",confirmationMessages:{title:this.title,message:new ht.MarkdownString("Are you sure you want to invoke this command?")}}}};var gx;async function Jj(t){XR(t.secrets),an.initialize(t),oF(t),qP(t),iF(t),await Si(),t.subscriptions.push(mx.workspace.registerTextDocumentContentProvider("xano-baseline",Yd)),t.subscriptions.push(mx.workspace.registerTextDocumentContentProvider("xano-remote",Ll)),zR(t),cF(t),dF(t),gx=await nF(t),console.log("XanoScript extension activated!"),t.subscriptions.push(ya)}function Qj(){if(gx)return gx.stop()}0&&(module.exports={activate,deactivate});
/*! Bundled license information:

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
//# sourceMappingURL=extension.js.map
